<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2021.11.16 解决HEXO博客中无法显示Latex行内公式问题</title>
    <link href="/2021/11/16/20211116%E8%A7%A3%E5%86%B3hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BAlatex%E8%A1%8C%E5%86%85%E5%85%AC%E5%BC%8F%E9%97%AE%E9%A2%98/"/>
    <url>/2021/11/16/20211116%E8%A7%A3%E5%86%B3hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BAlatex%E8%A1%8C%E5%86%85%E5%85%AC%E5%BC%8F%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="解决HEXO博客中无法显示Latex行内公式问题"><a href="#解决HEXO博客中无法显示Latex行内公式问题" class="headerlink" title="解决HEXO博客中无法显示Latex行内公式问题"></a>解决HEXO博客中无法显示Latex行内公式问题</h1><h2 id="问题及原因"><a href="#问题及原因" class="headerlink" title="问题及原因"></a>问题及原因</h2><p>Hexo 默认使用 <code>hexo-renderer-marked</code> 引擎渲染网页，该引擎会把一些特殊的 <code>markdown</code> 符号转换为相应的 <code>html</code> 标签，比如在 <code>markdown</code> 语法中，下划线<code>_</code>代表斜体，会被渲染引擎处理为<code>&lt;em&gt;</code>标签。</p><p>因为类 <code>Latex</code> 格式书写的数学公式下划线<code>_</code>表示下标，有特殊的含义，如果被强制转换为<code>&lt;em&gt;</code>标签，那么 <code>MathJax</code> 引擎在渲染数学公式的时候就会出错。</p><p>类似的语义冲突的符号还包括<code>*, &#123;, &#125;, \\</code>等。</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="1-更换-Hexo-的-markdown-渲染引擎"><a href="#1-更换-Hexo-的-markdown-渲染引擎" class="headerlink" title="1.更换 Hexo 的 markdown 渲染引擎"></a>1.更换 Hexo 的 markdown 渲染引擎</h3><p>hexo-renderer-kramed 引擎是在默认的渲染引擎 hexo-renderer-marked 的基础上修改了一些 bug ，两者比较接近，也比较轻量级。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm uninstall hexo-renderer-marked --save<br>npm install hexo-renderer-kramed --save<br></code></pre></td></tr></table></figure><p>执行上面的命令即可，先卸载原来的渲染引擎，再安装新的。</p><p>然后，跟换引擎后行间公式可以正确渲染了，但是这样还没有完全解决问题，行内公式的渲染还是有问题，因为 <code>hexo-renderer-kramed</code> 引擎也有语义冲突的问题。接下来到博客根目录下，找到<code>node_modules\kramed\lib\rules\inline.js</code>，把第11行的 escape 变量的值做相应的修改：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//escape: /^\\([\\`*&#123;&#125;\[\]()#$+\-.!_&gt;])/,</span><br><span class="hljs-attr">escape</span>: <span class="hljs-regexp">/^\\([`*\[\]()#$+\-.!_&gt;])/</span>,<br></code></pre></td></tr></table></figure><p>这一步是在原基础上取消了对<code>\,&#123;,&#125;</code>的转义(escape)。<br>同时把第20行的em变量也要做相应的修改。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,</span><br><span class="hljs-attr">em</span>: <span class="hljs-regexp">/^\*((?:\*\*|[\s\S])+?)\*(?!\*)/</span>,<br></code></pre></td></tr></table></figure><p>重新启动hexo（先clean再generate）,问题完美解决。哦，如果不幸还没解决的话，看看是不是还需要在使用的主题中配置<strong>mathjax</strong>开关。</p><h3 id="2-在HEXO主题中开启-MathJax-开关"><a href="#2-在HEXO主题中开启-MathJax-开关" class="headerlink" title="2.在HEXO主题中开启 MathJax 开关"></a>2.在HEXO主题中开启 MathJax 开关</h3><p>如果使用了主题，别忘了在主题（Theme）中开启 MathJax 开关，下面以 fluid 主题为例，介绍下如何打开 MathJax 开关。</p><p>进入到主题目录，找到 _config.yml 配置问题，把 math 默认的 false 修改为true，具体如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># 数学公式，开启之前需要更换 Markdown 渲染器，否则复杂公式会有兼容问题，具体请见：https://hexo.fluid-dev.com/docs/guide/##latex-数学公式</span><br>  <span class="hljs-comment"># Mathematical formula. If enable, you need to change the Markdown renderer, see: https://hexo.fluid-dev.com/docs/en/guide/#math</span><br>  <span class="hljs-attr">math:</span><br>    <span class="hljs-comment"># 开启后文章默认可用，自定义页面如需使用，需在 Front-matter 中指定 `math: true`</span><br>    <span class="hljs-comment"># If you want to use math on the custom page, you need to set `math: true` in Front-matter</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br><br>    <span class="hljs-comment"># 开启后，只有在文章 Front-matter 里指定 `math: true` 才会在文章页启动公式转换，以便在页面不包含公式时提高加载速度</span><br>    <span class="hljs-comment"># If true, only set `math: true` in Front-matter will enable math, to load faster when the page does not contain math</span><br>    <span class="hljs-attr">specific:</span> <span class="hljs-literal">false</span><br><br>    <span class="hljs-comment"># Options: mathjax | katex</span><br>    <span class="hljs-attr">engine:</span> <span class="hljs-string">mathjax</span><br></code></pre></td></tr></table></figure><h3 id="3-在文章开头打开mathjax开关"><a href="#3-在文章开头打开mathjax开关" class="headerlink" title="3.在文章开头打开mathjax开关"></a>3.在文章开头打开mathjax开关</h3><p>需要在希望显示Latex行内公式的文章Front-matter里打开mathjax开关，如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs markdown">---<br>title: 2021.11.04 和导师talk记录<br>tags: [MY PROJECT, ASD, talk&amp;meeting]<br>index<span class="hljs-emphasis">_img: https://crosstalk.cell.com/hs-fs/hubfs/Images/Claudia%20Willmes/How%20to%20keep%20your%20virtual%20lab%20meeting%20from%20being%20just%20another%20Zoom%20call/Get-Inspired-How-to-keep-your-virtual-lab-meeting-from-being-just-another-Zoom-call-featured.png?width=1000&amp;name=Get-Inspired-How-to-keep-your-virtual-lab-meeting-from-being-just-another-Zoom-call-featured.png</span><br><span class="hljs-emphasis">date: 2021-11-04 17:18:00</span><br><span class="hljs-emphasis">categories: LEARNING RECORDS</span><br><span class="hljs-emphasis">mathjax: true</span><br><span class="hljs-emphasis">---</span><br></code></pre></td></tr></table></figure><p>之所以<strong>要在文章头里设置开关</strong>，是因为考虑只有在用到公式的页面才加载 Mathjax，这样不需要渲染数学公式的页面的访问速度就不会受到影响了。</p><h3 id="4-效果展示"><a href="#4-效果展示" class="headerlink" title="4.效果展示"></a>4.效果展示</h3><p><a href="https://jinsyliu.github.io/2021/11/04/20211105%E5%90%91%E8%80%81%E6%9D%BF%E9%87%8D%E6%96%B0%E6%B1%87%E6%8A%A5%E5%86%85%E5%AE%B9/">启用Latex行内公式的播客</a></p>]]></content>
    
    
    <categories>
      
      <category>PROBLEM SOLVING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>markdown</tag>
      
      <tag>html</tag>
      
      <tag>blog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.11.16 神经遗传学Neurogenetics与ASD相关的文献阅读报告</title>
    <link href="/2021/11/16/20211116%E7%A5%9E%E7%BB%8F%E9%81%97%E4%BC%A0%E5%AD%A6Neurogenetics%E4%B8%8EASD%E7%9B%B8%E5%85%B3%E7%9A%84%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%8A%A5%E5%91%8A/"/>
    <url>/2021/11/16/20211116%E7%A5%9E%E7%BB%8F%E9%81%97%E4%BC%A0%E5%AD%A6Neurogenetics%E4%B8%8EASD%E7%9B%B8%E5%85%B3%E7%9A%84%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%8A%A5%E5%91%8A/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-11-16-神经遗传学Neurogenetics与ASD相关的文献阅读报告"><a href="#2021-11-16-神经遗传学Neurogenetics与ASD相关的文献阅读报告" class="headerlink" title="2021.11.16 神经遗传学Neurogenetics与ASD相关的文献阅读报告"></a>2021.11.16 神经遗传学Neurogenetics与ASD相关的文献阅读报告</h1><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4912829/">Genome-scale neurogenetics: methodology and meaning</a></p><h2 id="1-遗传率Heritabilities"><a href="#1-遗传率Heritabilities" class="headerlink" title="1.遗传率Heritabilities"></a>1.遗传率Heritabilities</h2><p>双胞胎研究表明，精神分裂症、双相情感障碍、自闭症和注意力缺陷多动障碍 (ADHD) 是所有常见的、基因复杂的医学疾病中最易遗传的。 （这四种疾病的遗传率在 0.65-0.80 的范围内）在双胞胎研究中，在同卵双胞胎和异卵双胞胎之间比较了表型的一致率，从而可以估计遗传性和非遗传性的贡献——表型变异的遗传因素。 </p><blockquote><p>Sullivan PF, Daly MJ, O’Donovan M. Genetic architectures of psychiatric disorders: the emerging picture and its implications. <em>Nat. Rev. Genet.</em> 2012;13:537–551. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4110909/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/22777127">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Rev.+Genet&amp;title=Genetic+architectures+of+psychiatric+disorders:+the+emerging+picture+and+its+implications&amp;author=PF+Sullivan&amp;author=MJ+Daly&amp;author=M+O&#39;Donovan&amp;volume=13&amp;publication_year=2012&amp;pages=537-551&amp;pmid=22777127&amp;">Google Scholar</a>]</p></blockquote><p>最近，还根据无关个体共享的基因组中常见的 DNA 序列变异估计了遗传力的特定组成部分。 精神分裂症、双相情感障碍、自闭症、多动症和重度抑郁症的遗传率已经被设定了显着的下限。</p><blockquote><p>Yang J, et al. Common SNPs explain a large proportion of the heritability for human height. <em>Nat. Genet.</em> 2010;42:565–569. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3232052/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/20562875">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Common+SNPs+explain+a+large+proportion+of+the+heritability+for+human+height&amp;author=J+Yang&amp;volume=42&amp;publication_year=2010&amp;pages=565-569&amp;pmid=20562875&amp;">Google Scholar</a>]</p><p> Cross-Disorder Group of the Psychiatric Genomics Consortium and Genetic Risk Outcome of Psychosis (GROUP) Consortium Identification of risk loci with shared effects on five major psychiatric disorders: a genome-wide analysis. <em>Lancet.</em> 2013;381:1371–1379. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3714010/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23453885">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Lancet&amp;title=Identification+of+risk+loci+with+shared+effects+on+five+major+psychiatric+disorders:+a+genome-wide+analysis&amp;volume=381&amp;publication_year=2013&amp;pages=1371-1379&amp;pmid=23453885&amp;">Google Scholar</a>]</p></blockquote><h2 id="2-共病现象comorbidity"><a href="#2-共病现象comorbidity" class="headerlink" title="2.共病现象comorbidity"></a>2.共病现象comorbidity</h2><p>较早的遗传研究中的一个问题是广泛持有的假设，即命名精神疾病的每一种都代表自然的、独立的类别，这些类别可能会产生真实的结果。 但是，事实上，精神分裂症和双相情感障碍在同一家庭中同时发生的几率远高于预期。 根据流行的模型，这些家庭通常被认为是异常的，并且经常被排除在遗传研究之外。 </p><blockquote><p>Berrettini WH. Are schizophrenic and bipolar disorders related? A review of family and molecular studies. <em>Biol. Psychiatry.</em> 2000;48:531–538. [<a href="https://www.ncbi.nlm.nih.gov/pubmed/11018225">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Biol.+Psychiatry&amp;title=Are+schizophrenic+and+bipolar+disorders+related?+A+review+of+family+and+molecular+studies&amp;author=WH+Berrettini&amp;volume=48&amp;publication_year=2000&amp;pages=531-538&amp;pmid=11018225&amp;">Google Scholar</a>]</p></blockquote><p>然而，现在很明显，根据目前的定义，精神疾病彼此共享高比例的风险相关基因，这种联系至少部分解释了诊断中共享症状的高频率：即被诊断的某类精神疾病患者通常患有多种其他类型疾病，以及在其生命周期的不同时期接受了不同疾病的诊断。</p><blockquote><p>Cross-Disorder Group of the Psychiatric Genomics Consortium and Genetic Risk Outcome of Psychosis (GROUP) Consortium Identification of risk loci with shared effects on five major psychiatric disorders: a genome-wide analysis. <em>Lancet.</em> 2013;381:1371–1379. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3714010/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23453885">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Lancet&amp;title=Identification+of+risk+loci+with+shared+effects+on+five+major+psychiatric+disorders:+a+genome-wide+analysis&amp;volume=381&amp;publication_year=2013&amp;pages=1371-1379&amp;pmid=23453885&amp;">Google Scholar</a>]</p><p>Lee SH, et al. Genetic relationship between five psychiatric disorders estimated from genome-wide SNPs. <em>Nat. Genet.</em> 2013;45:984–994. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3800159/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23933821">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Genetic+relationship+between+five+psychiatric+disorders+estimated+from+genome-wide+SNPs&amp;author=SH+Lee&amp;volume=45&amp;publication_year=2013&amp;pages=984-994&amp;pmid=23933821&amp;">Google Scholar</a>]</p></blockquote><h2 id="3-如何衡量精神类疾病——类似高血压-高血脂的光谱异常（并缺乏生物标志物辅助诊断）"><a href="#3-如何衡量精神类疾病——类似高血压-高血脂的光谱异常（并缺乏生物标志物辅助诊断）" class="headerlink" title="3.如何衡量精神类疾病——类似高血压/高血脂的光谱异常（并缺乏生物标志物辅助诊断）"></a>3.如何衡量精神类疾病——类似高血压/高血脂的光谱异常（并缺乏生物标志物辅助诊断）</h2><p>现在，人们已经广泛认识到当前标准疾病分类学、精神疾病诊断和统计手册第 5 版 (DSM-5)和国际疾病分类第 10 版中精神疾病定义的科学局限性。这些手册错误地将精神障碍描述为在性质上与正常和彼此不同的类别。<strong>来自遗传学、认知神经科学、影像学和临床观察的最新数据表明，精神疾病更应被理解为在数量上而非质量上偏离健康的异质光谱，类似于高血压或血脂异常</strong>。此外，由于<strong>缺乏客观的生物标志物</strong>，DSM 系统根据相当随意的症状群来定义疾病。因此，许多疾病之间的区别没有经验支持，并且不出所料，<strong>许多有症状的个体不属于特定的诊断类别</strong>。表型的这种限制似乎与 DSM 定义的精神疾病可能表现出高遗传性或有助于成功的基因发现工作的可能性不一致。事实上，对于精神分裂症、双相情感障碍和自闭症，除了 DSM 诊断外，其症状、典型发病年龄和病程已被充分记录。尽管如此，<strong>DSM 系统的局限性可能导致患者数据集的“嘈杂”</strong>，因此，连同遗传结构的复杂性，导致需要比许多多基因遗传分析所需的更大的群体样本。精神病学以外的疾病。最终，遗传学将与其他措施一起对精神病学诊断的重大修订做出贡献。然而，<strong>许多风险相关基因的多效性表明，仅凭遗传学不足以诊断常见的精神疾病</strong>。</p><blockquote><p>American Psychiatric Association . <em>Diagnostic and Statistical Manual of Mental Disorders.</em> 5th edn. APA; Washington, DC, USA: 2013. [<a href="https://scholar.google.com/scholar_lookup?title=Diagnostic+and+Statistical+Manual+of+Mental+Disorders&amp;publication_year=2013&amp;">Google Scholar</a>]</p><p>World Health Organization . <em>The ICD-10 Classification of Mental and Behavioural Disorders.</em> WHO; Geneva: 1992. [<a href="https://scholar.google.com/scholar_lookup?title=The+ICD-10+Classification+of+Mental+and+Behavioural+Disorders&amp;publication_year=1992&amp;">Google Scholar</a>]</p><p>Hyman SE. Can neuroscience be integrated into the DSM-V? <em>Nat. Rev. Neurosci.</em> 2007;8:725–732. [<a href="https://www.ncbi.nlm.nih.gov/pubmed/17704814">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Rev.+Neurosci&amp;title=Can+neuroscience+be+integrated+into+the+DSM-V?&amp;author=SE+Hyman&amp;volume=8&amp;publication_year=2007&amp;pages=725-732&amp;pmid=17704814&amp;">Google Scholar</a>]</p></blockquote><p>==【光谱】：众多精神疾病也许不应被分开视为某种疾病表型，每一类精神疾病更应当被视为多种表型的混合。==</p><h2 id="4-遗传连锁方法在精神疾病上的失败——复杂的遗传结构、多种罕见变异、常见变异的加性效应"><a href="#4-遗传连锁方法在精神疾病上的失败——复杂的遗传结构、多种罕见变异、常见变异的加性效应" class="headerlink" title="4.遗传连锁方法在精神疾病上的失败——复杂的遗传结构、多种罕见变异、常见变异的加性效应"></a>4.遗传连锁方法在精神疾病上的失败——复杂的遗传结构、多种罕见变异、常见变异的加性效应</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs tex"><span class="hljs-params">#</span>Linkage studies 连锁分析<br><br>连锁分析试图确定家庭中受同一疾病影响的个人共享的基因组片段。潜在的假设是共享的 DNA 片段包含一个序列变异，该变异对疾病表型具有高度的渗透性。<br><br>对于具有简单单基因结构的疾病，连锁研究最为成功——即，与家族内的单个遗传变异以及其他家族中同一基因内的变异（可能不同）分离。这为基因在家族间积累提供了证据，就像囊性纤维化中的 CFTR 基因的情况一样，因为单个家族通常太小以至于在一个基因座上为零。<br><br>当扩展到受同一家族中不同变异组合或不同家族中不同基因组影响的遗传复杂疾病（例如许多精神疾病）时，连锁分析是不成功的。在这种情况下，连锁研究无法产生具有统计学意义或广泛重复的结果。今天，我们了解到精神疾病受到数百个基因中罕见和常见变异的影响；在同一家庭中观察到多个受影响的个体并不代表一个共享的、高度外显的变异的行为；并且这种变异，当它们确实存在时，只存在于一小部分家庭中。<br></code></pre></td></tr></table></figure><p><sup><a href="#fn_Linkage studies 连锁分析" id="reffn_Linkage studies 连锁分析">Linkage studies 连锁分析</a></sup>:连锁分析试图确定家庭中受同一疾病影响的个人共享的基因组片段。潜在的假设是共享的 DNA 片段包含一个序列变异，该变异对疾病表型具有高度的渗透性。对于具有简单单基因结构的疾病，连锁研究最为成功——即，与家族内的单个遗传变异以及其他家族中同一基因内的变异（可能不同）分离。这为基因在家族间积累提供了证据，就像囊性纤维化中的 CFTR 基因的情况一样，因为单个家族通常太小以至于在一个基因座上为零。当扩展到受同一家族中不同变异组合或不同家族中不同基因组影响的遗传复杂疾病（例如许多精神疾病）时，连锁分析是不成功的。在这种情况下，连锁研究无法产生具有统计学意义或广泛重复的结果。今天，我们了解到精神疾病受到数百个基因中罕见和常见变异的影响；在同一家庭中观察到多个受影响的个体并不代表一个共享的、高度外显的变异的行为；并且这种变异，当它们确实存在时，只存在于一小部分家庭中。</p><p>随着遗传连锁方法的出现，1980 年代和 1990 年代的许多科学家接受了挑战，试图在有多个受影响个体的家庭中识别与神经精神疾病共同分离的基因组片段。 连锁分析的假设是，共享疾病表型的家庭成员是由于一个或几个共享的、高度外显的风险等位基因而导致的。 虽然连锁分析成功地确定了与阿尔茨海默病、帕金森病和肌萎缩侧索硬化症的罕见家族性形式相关的外显突变，但未能发现精神疾病中广泛复制的遗传关联。</p><p>为什么当连锁分析对许多具有简单孟德尔遗传模式的疾病（包括家族性阿尔茨海默病）成功时，对精神疾病却失败了？<strong>精神疾病的遗传结构可能更加复杂，因此，即使一个家庭携带影响较大的风险变异，它的渗透性（外显率，Penetrance）往往远低于“导致”家族性阿尔茨海默病或囊性纤维化的基因座</strong>。而且，<strong>即使在一个家族携带大效应稀有变异的情况下，其他表面相似的家族也可能携带不同的稀有变异</strong>。因此，<strong>不会为任何特定基因座积累连锁证据</strong>。其次，受精神障碍影响的<strong>个体可能携带许多影响其风险的等位基因</strong>。<strong>此类风险变异可能在个人和家庭中偶然聚集</strong>，因此即使<strong>在同一家庭中，受影响的个人也可能具有共享和非共享风险等位基因</strong>。来自常见变体研究的证据（见图1）支持该模型。遗传风险来自许多不同的基因，既有个体内部的，也有不同家族的，同时也来自罕见和常见的变异。当由于许多不同基因中的等位基因的影响而在不同家族中出现疾病时——多基因性状的定义——违反了连锁分析的假设。</p><blockquote><p><strong>外显率/渗透性 penetrance</strong></p><p>外显率：携带特定基因变异同时表达相关性状的个体比例。</p><p>遗传学中的外显率是携带基因（基因型）的特定变体（或等位基因）同时表达相关性状（表型）的个体的比例。在医学遗传学中，致病突变的外显率是具有该突变的个体在所有具有该突变的个体中表现出临床症状的比例。例如，如果导致特定常染色体显性遗传疾病的基因突变具有 95% 的外显率，那么 95% 的突变患者会患上这种疾病，而 5% 不会。</p><p>一种最常以常染色体显性方式遗传的病症，如果在所有具有致病突变的个体中都存在临床症状，则被称为完全外显。一种完全外显的疾病是 1 型神经纤维瘤病——每个基因突变的人都会表现出这种疾病的症状。外显率为 100%。</p><p>一般来说，高度外显的等位基因和高度遗传的症状更容易证明，因为如果存在等位基因，通常会表达表型。孟德尔遗传概念，如隐性、显性和共显性，是对这一原则的相当简单的补充。而且，高度外显的等位基因更容易被临床医生和遗传学家注意到，而高度遗传的症状的等位基因更可能被推断存在，然后更容易被追踪。</p></blockquote><p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4912829/bin/nihms-793860-f0001.jpg" alt="An external file that holds a picture, illustration, etc. Object name is nihms-793860-f0001.jpg"></p><blockquote><p><strong>图1</strong></p><p>等位基因频率代表人群中的连续体，“常见”和“稀有”之间的界限有些随意。 在左侧，我们显示了常见变异（常见多态性）的频率和稀有变异的大范围频率。 在右侧，我们展示了用于检测这些不同类型变异的方法。 对于稀有变异，设计不仅基于等位基因频率，还基于变异是传播还是从头传播。 未描述全基因组测序，因为它尚未广泛纳入已发表的精神病遗传学研究。</p></blockquote><h2 id="5-候选基因研究法结果的可疑性"><a href="#5-候选基因研究法结果的可疑性" class="headerlink" title="5.候选基因研究法结果的可疑性"></a>5.候选基因研究法结果的可疑性</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs tex"><span class="hljs-params">#</span>Candidate-gene association studies 候选基因关联研究<br>候选基因关联研究是对特定基因中特定变异的假设驱动评估，通常根据生物学假设进行选择。这种方法与常见或罕见变异关联研究所代表的无偏见基因组规模方法形成对比。候选基因关联研究对于已确定所选基因与疾病生物学相关性的疾病最为成功。例如，候选基因研究已经确定了已知会影响血清脂质表型（如低密度脂蛋白和甘油三酯水平）的常见和罕见等位基因。对于尚未了解潜在生物学的精神疾病，候选基因研究涉及更多关于所选基因相关性的推测，因此检测到真正关联的先验概率较小。在不同实验室共同测试数百个候选假设的领域中，偶然会经常达到 0.01 或 0.001 的 P 值，即使所讨论的等位基因与表型没有真正的潜在关系。<br><br>此外，发表偏倚几乎肯定有利于正面研究的准备、提交和发表，而不是负面研究。因此，即使文献中存在多项阳性研究，也不一定意味着对表型的真正遗传影响。事实上，许多据报道与精神疾病相关的生物候选基因在当今强大的、无偏见的全基因组搜索中没有显示出关联的证据。<br></code></pre></td></tr></table></figure><blockquote><p>Cohen J, et al. Low LDL cholesterol in individuals of African descent resulting from frequent nonsense mutations in PCSK9. <em>Nat. Genet.</em> 2005;37:161–165. [<a href="https://www.ncbi.nlm.nih.gov/pubmed/15654334">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Low+LDL+cholesterol+in+individuals+of+African+descent+resulting+from+frequent+nonsense+mutations+in+PCSK9&amp;author=J+Cohen&amp;volume=37&amp;publication_year=2005&amp;pages=161-165&amp;pmid=15654334&amp;">Google Scholar</a>]</p></blockquote><p>另一项在精神疾病中鉴定疾病相关基因的失败尝试涉及生物候选基因研究。这些在 1990 年代和 2000 年代受到广泛关注的研究试图利用生物学知识为关联研究提名候选遗传变异。候选基因研究通过将患病受试者的基因型与健康对照受试者的基因型进行比较，询问感兴趣基因的特定等位基因是否与疾病（或其他感兴趣的表型）在统计上相关。潜在的假设是，对精神障碍（或认知能力或情绪处理的个体差异）的分子生物学有足够的了解，可以提名具有大量先验关联概率的候选基因。在精神分裂症方面，发表了 1,400 多项候选基因研究，其中一半集中在相同的 18 个基因上 (<a href="http://szgene.org)。可能是由于对多重假设检验的理解不够充分，当任何测试关联达到名义显着性水平（例如">http://szgene.org)。可能是由于对多重假设检验的理解不够充分，当任何测试关联达到名义显着性水平（例如</a> p = 0.05）时，候选基因研究经常被报告为具有阳性结果。在每年测试数千个此类假设的领域中，预计即使没有任何真正的潜在遗传关系，也会有数百个此类分析偶然得出达到此适度阈值的 p 值。例如，虽然 PubMed 搜索可以找到关于 DISC1、NRG1 和其他精神分裂症候选基因的大量文献，但实际结果似乎是随机的，并且对报告为阳性的遗传变异或其推定影响的方向性几乎没有或没有达成共识。此外，今天的全基因组研究已经在大型、强大的队列中检查了这些相同的等位基因，在这些候选基因座中的大多数基因座上都没有找到相关性的适度证据。</p><h2 id="6-新方法——常见变异及其生物学解释"><a href="#6-新方法——常见变异及其生物学解释" class="headerlink" title="6.新方法——常见变异及其生物学解释"></a>6.新方法——常见变异及其生物学解释</h2><p>如今，具有强大统计支持的遗传发现大量出现在常见变异关联研究 (CVAS) 中，这些研究通常被称为全基因组关联研究 (GWAS)。如框下所述，这些研究得出的令人信服的证据水平反映了评估具有不同遗传背景的数千名受试者的常见等位基因的能力。国际联盟的大规模荟萃分析自信地确定了 20 个有阿尔茨海默病风险的基因座（在一项对 72,000 个基因组的研究中），10 个或更多影响双相情感障碍的基因座（15,000 个基因组）和 100 个或更多影响精神分裂症的基因座（82,000 个基因组） ）。这些结果反映了高水平的统计显着性；多个队列中的复制分析也支持了许多。此外，这些结果在特定分子复合物和生物途径中的强烈聚集具有科学真理的意义。例如，在精神分裂症中，编码兴奋性突触的突触后成分和 L 型钙通道亚基的基因在新出现的遗传发现中不成比例地代表。</p><blockquote><p>Lambert JC, et al. Meta-analysis of 74,046 individuals identifies 11 new susceptibility loci for Alzheimer’s disease. <em>Nat. Genet.</em> 2013;45:1452–1458. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3896259/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/24162737">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Meta-analysis+of+74,046+individuals+identifies+11+new+susceptibility+loci+for+Alzheimer&#39;s+disease&amp;author=JC+Lambert&amp;volume=45&amp;publication_year=2013&amp;pages=1452-1458&amp;pmid=24162737&amp;">Google Scholar</a>]</p><p>Psychiatric GCBDWG. Large-scale genome-wide association analysis of bipolar disorder identifies a new susceptibility locus near ODZ4. <em>Nat. Genet.</em> 2011;43:977–983. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3637176/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/21926972">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Large-scale+genome-wide+association+analysis+of+bipolar+disorder+identifies+a+new+susceptibility+locus+near+ODZ4&amp;author=GCBDWG+Psychiatric&amp;volume=43&amp;publication_year=2011&amp;pages=977-983&amp;pmid=21926972&amp;">Google Scholar</a>]</p><p>Ripke S, et al. Genome-wide association analysis identifies 13 new risk loci for schizophrenia. <em>Nat. Genet.</em> 2013;45:1150–1159. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3827979/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23974872">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Genome-wide+association+analysis+identifies+13+new+risk+loci+for+schizophrenia&amp;author=S+Ripke&amp;volume=45&amp;publication_year=2013&amp;pages=1150-1159&amp;pmid=23974872&amp;">Google Scholar</a>]</p></blockquote><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs tex"><span class="hljs-params">#</span>Common-variant association studies 共变关联研究<br><br>全基因组共同变异关联研究 (CVAS) 涉及在全基因组搜索中分析数百万个常见序列多态性（单核苷酸多态性，SNP），以寻找在受影响个体中比在未受影响个体中更常见的等位基因。 CVAS 更常被称为全基因组关联研究 (GWAS)，尽管这个术语可能令人困惑，因为通过测序进行的稀有变异研究也代表全基因组关联搜索。 （由于术语“CVAS”的使用是新的，我们在这里使用两个首字母缩略词。）<br><br>在不到 100,000 年（5,000 代）的时间里，人口从几千人扩大到 70 亿人。 100,000 年前存在于这些小的祖先种群中的序列变异今天很普遍，并且在世界各地都有发现。这允许在数千种遗传背景和不同环境背景下评估此类多态性与疾病的关系。人类种群包含大约 1000 万个常见的序列多态性，几乎所有这些都可以追溯到这些祖先种群。全基因组测序允许对这些多态性进行系统编目，如 1000 基因组计划。此外，染色体上彼此靠近的多态性通常相互之间具有很强的统计关系——一种称为连锁不平衡（LD）的现象——这样，通过对整个基因组中仅几十万个精心选择的多态性进行基因分型，人们可以从统计上推断（impute）大多数其他人的状态。因此，在 CVAS (GWAS) 中，大量样本可以通过低成本 SNP 阵列（约 100 美元/样本）进行基因分型，旨在检测数十万个常见变异，其他变异在统计上推算。 （常见变异的等位基因状态也可以通过测序来确定；当其成本开始接近基于阵列的分析时，常见变异研究可能最终会使用测序，但目前使用阵列支持对更大的队列进行分析。）<br><br>由于全基因组搜索伴随着多重假设检验的高负担，CVAS (GWAS) 需要高水平的统计证据来证明与疾病的关系：典型的阈值为 5 × 10−8。当变异只是许多常见风险因素之一时，很难达到这个水平，因此 CVAS (GWAS) 成功的主要决定因素是样本量。<br><br>用于精神疾病的 CVAS (GWAS) 最初似乎不成功，尽管随着样本量的扩大，它们现在涉及大量特定位点。<br><br>在 CVAS 中报告的与疾病相关的 SNP 几乎总是一组序列多态性的标记，这些序列多态性在基因组附近并作为单倍型分离在一起。单倍型是一组序列等位基因，它们在人类群体中在很少被重组破坏的短染色体片段上一起传播。正是这种由 SNP“标记”的单倍型与疾病相关；单倍型可能包含一个或多个影响与疾病相关的生物学过程的功能变异。<br></code></pre></td></tr></table></figure><blockquote><p>Zuk O, et al. Searching for missing heritability: designing rare variant association studies. <em>Proc. Natl. Acad. Sci. USA.</em> 2014;111:E455–E464. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3910587/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/24443550">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Proc.+Natl.+Acad.+Sci.+USA&amp;title=Searching+for+missing+heritability:+designing+rare+variant+association+studies&amp;author=O+Zuk&amp;volume=111&amp;publication_year=2014&amp;pages=E455-E464&amp;pmid=24443550&amp;">Google Scholar</a>]</p><p>The 1000 Genomes Project Consortium A map of human genome variation from population-scale sequencing. <em>Nature.</em> 2010;467:1061–1073. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3042601/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/20981092">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=A+map+of+human+genome+variation+from+population-scale+sequencing&amp;volume=467&amp;publication_year=2010&amp;pages=1061-1073&amp;pmid=20981092&amp;">Google Scholar</a>]</p><p>Cross-Disorder Group of the Psychiatric Genomics Consortium and Genetic Risk Outcome of Psychosis (GROUP) Consortium Identification of risk loci with shared effects on five major psychiatric disorders: a genome-wide analysis. <em>Lancet.</em> 2013;381:1371–1379. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3714010/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23453885">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Lancet&amp;title=Identification+of+risk+loci+with+shared+effects+on+five+major+psychiatric+disorders:+a+genome-wide+analysis&amp;volume=381&amp;publication_year=2013&amp;pages=1371-1379&amp;pmid=23453885&amp;">Google Scholar</a>]</p></blockquote><h3 id="6-1-等位基因在合适遗传背景下的组合——效应叠加"><a href="#6-1-等位基因在合适遗传背景下的组合——效应叠加" class="headerlink" title="6.1 等位基因在合适遗传背景下的组合——效应叠加"></a>6.1 等位基因在合适遗传背景下的组合——效应叠加</h3><p>共同变异关联研究（见上框）中涉及的常见单倍型是遗传”轻推“而非遗传“猛推”。例如，用于精神分裂症和双相情感障碍的 CVAS (GWAS) 都发现与 CACNA1C 基因中同一组常见 SNP 的关联，编码 L 型钙通道的一个亚基——一种分子复合物，也与精神疾病表型有关其他亚基中的常见多态性，例如 CACNB2。 CACNA1C 的风险单倍型——单倍型是一组基因组附近的等位基因，它们分离为一个单位——在欧洲血统的人群中以 35% 的等位基因频率存在。每个遗传拷贝都会增加大约 15% 的风险，从而将携带者的风险从大约 1.00% 的平均人群患病率增加到 1.15%。<strong>每个这样的风险等位基因只能解释人群中风险变化的一小部分</strong>。此外，<strong>在每个携带这种遗传风险因素的人中（我们大多数人携带一个副本；许多人携带两个副本），它在包含许多其他相似程度的遗传影响（一些增加的风险，一些保护性）的遗传背景中起作用</strong>。</p><blockquote><p>Cross-Disorder Group of the Psychiatric Genomics Consortium and Genetic Risk Outcome of Psychosis (GROUP) Consortium Identification of risk loci with shared effects on five major psychiatric disorders: a genome-wide analysis. <em>Lancet.</em> 2013;381:1371–1379. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3714010/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23453885">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Lancet&amp;title=Identification+of+risk+loci+with+shared+effects+on+five+major+psychiatric+disorders:+a+genome-wide+analysis&amp;volume=381&amp;publication_year=2013&amp;pages=1371-1379&amp;pmid=23453885&amp;">Google Scholar</a>]</p><p>Psychiatric GCBDWG. Large-scale genome-wide association analysis of bipolar disorder identifies a new susceptibility locus near ODZ4. <em>Nat. Genet.</em> 2011;43:977–983. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3637176/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/21926972">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Large-scale+genome-wide+association+analysis+of+bipolar+disorder+identifies+a+new+susceptibility+locus+near+ODZ4&amp;author=GCBDWG+Psychiatric&amp;volume=43&amp;publication_year=2011&amp;pages=977-983&amp;pmid=21926972&amp;">Google Scholar</a>]</p><p>Ripke S, et al. Genome-wide association analysis identifies 13 new risk loci for schizophrenia. <em>Nat. Genet.</em> 2013;45:1150–1159. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3827979/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23974872">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Genome-wide+association+analysis+identifies+13+new+risk+loci+for+schizophrenia&amp;author=S+Ripke&amp;volume=45&amp;publication_year=2013&amp;pages=1150-1159&amp;pmid=23974872&amp;">Google Scholar</a>]</p></blockquote><p><strong>中等效应的等位基因通常存在于效应较大的基因中</strong>。 例如，CACNA1C 还包含严重破坏器官发育的罕见变异（包括 Timothy 综合征的孟德尔遗传方式）。 这些大效应变异严重干扰了大脑和其他器官系统的发育和功能，以至于掩盖了大多数精神病学表型。 <strong>在 CVAS (GWAS) 中确定的影响可能代表相关基因表达的更温和和组织特异性的扰动</strong>，而不是敲除，或者<strong>在 Timothy 综合征的情况下，这些温和的变异表达出了有害的功能</strong>。 CVAS (GWAS) 允许这种部分扰动与表型的自然变异有关。 尽管如此，这些遗传扰动的部分和组织特异性使它们难以通过传统的生物学方法进行研究。</p><blockquote><p>Splawski I, et al. Ca(V)1.2 calcium channel dysfunction causes a multisystem disorder including arrhythmia and autism. <em>Cell.</em> 2004;119:19–31. [<a href="https://www.ncbi.nlm.nih.gov/pubmed/15454078">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Cell&amp;title=Ca(V">Google Scholar</a>1.2+calcium+channel+dysfunction+causes+a+multisystem+disorder+including+arrhythmia+and+autism&amp;author=I+Splawski&amp;volume=119&amp;publication_year=2004&amp;pages=19-31&amp;pmid=15454078&amp;)]</p></blockquote><p><strong>常见的变异以不同的组合出现在每个人类基因组中</strong>。 <strong>个别常见变异的解释力不大的部分原因可能是，在不同的人群中，每个变异只是表型受许多遗传和环境的影响之一</strong>。 随着功能等位基因开始在受控环境中的同基因背景下被鉴定和实验研究，它们与特定分子和细胞表型的关系可能比现在更加清晰。 分析此类变体的一项重要技术可能涉及在细胞系或动物模型中精确编辑基因组的技术。</p><blockquote><p>Cong L, et al. Multiplex genome engineering using CRISPR/Cas systems. <em>Science.</em> 2013;339:819–823. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3795411/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23287718">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=Multiplex+genome+engineering+using+CRISPR/Cas+systems&amp;author=L+Cong&amp;volume=339&amp;publication_year=2013&amp;pages=819-823&amp;pmid=23287718&amp;">Google Scholar</a>]</p><p>Mali P, et al. RNA-guided human genome engineering via Cas9. <em>Science.</em> 2013;339:823–826. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3712628/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/23287722">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=RNA-guided+human+genome+engineering+via+Cas9&amp;author=P+Mali&amp;volume=339&amp;publication_year=2013&amp;pages=823-826&amp;pmid=23287722&amp;">Google Scholar</a>]</p></blockquote><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs objectivec">#Studies of <span class="hljs-keyword">copy</span> number variation (<span class="hljs-built_in">CNV</span>) 拷贝数变异研究<br>用于对整个基因组中常见的单核苷酸多态性 (SNP) 进行基因分型的早期基于阵列的工具经过重新设计，用于同时分析拷贝数变异 (<span class="hljs-built_in">CNV</span>)——基因组片段的缺失和重复。这样的努力产生了惊人的快速结果。事实证明，<span class="hljs-built_in">CNV</span> 是早期研究中基于阵列的 CVAS (GWAS) 的主要早期发现，用于自闭症和精神分裂症，样本量低至数千。随着此类研究的扩大，已发现十多个基因座，其中 <span class="hljs-number">0.1</span><span class="hljs-number">-1</span>% 的受影响个体存在大 (&gt;<span class="hljs-number">200</span> kb)、重复性缺失或重复，但在一般人群中罕见 <span class="hljs-number">3</span><span class="hljs-number">-30</span> 倍。大多数这样的结果现在都得到了很好的复制。将 <span class="hljs-built_in">CNV</span> 用于神经生物学的挑战有两个：它们的内在复杂性和它们导致多种疾病表型的频率。由于许多 <span class="hljs-built_in">CNV</span> 包含大量基因，已证明很难确定它们的破坏作用是由单个基因介导还是由 <span class="hljs-built_in">CNV</span> 内基因之间的相互作用介导，更不用说涉及哪些特定基因了。复发性 <span class="hljs-built_in">CNV</span> 中最具渗透性的中枢神经系统表型是智力障碍，其中一小部分受影响的人还患有注意力缺陷多动障碍、自闭症或精神分裂症。事实上，任何个体的 <span class="hljs-built_in">CNV</span> 与表型的关系很可能取决于遗传背景以及非遗传因素<br><br>迄今为止对 <span class="hljs-built_in">CNV</span> 结果的分析支持自闭症和精神分裂症的多基因模型。在任何基因组位点发现的大 (<span class="hljs-number">500</span> kb)、从头、基因 <span class="hljs-built_in">CNV</span> 在自闭症患者中的观察频率是对照组的数倍<span class="hljs-number">46</span>。然而，这些 <span class="hljs-built_in">CNV</span> 分布在大量基因组位点（只有一小部分来自同一位点的反复突变），因此估计人类基因组的至少 <span class="hljs-number">130</span><span class="hljs-number">-234</span> 个区域可以发生突变，从而显着增加自闭症风险。<br><br><span class="hljs-built_in">CNV</span> 的另一个重要教训与部分外显有关。大的缺失和重复（<span class="hljs-number">4</span> 到 <span class="hljs-number">50</span> 个基因）是强烈的遗传扰动，但与精神分裂症有关的大的、反复出现的 <span class="hljs-built_in">CNV</span> 的比值比为 <span class="hljs-number">3</span> 到 <span class="hljs-number">30</span>——也就是说，它们可能会将风险从 <span class="hljs-number">1</span>% 的背景率增加到 <span class="hljs-number">3</span>- <span class="hljs-number">30</span>%。因此，尽管最近的一项研究表明，他们可能经常对认知和智商产生亚临床影响，但绝大多数携带者都没有相关的表型。<br></code></pre></td></tr></table></figure><blockquote><p>Weiss LA, et al. A genome-wide linkage and association scan reveals novel loci for autism. <em>Nature.</em> 2009;461:802–808. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2772655/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/19812673">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=A+genome-wide+linkage+and+association+scan+reveals+novel+loci+for+autism&amp;author=LA+Weiss&amp;volume=461&amp;publication_year=2009&amp;pages=802-808&amp;pmid=19812673&amp;">Google Scholar</a>]</p><p>The International Schizophrenia Consortium et al. Common polygenic variation contributes to risk of schizophrenia and bipolar disorder. <em>Nature.</em> 2009;460:748–752. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3912837/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/19571811">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=Common+polygenic+variation+contributes+to+risk+of+schizophrenia+and+bipolar+disorder&amp;volume=460&amp;publication_year=2009&amp;pages=748-752&amp;pmid=19571811&amp;">Google Scholar</a>]</p><p>Rees E, et al. Analysis of copy number variations at 15 schizophrenia-associated loci. <em>Br. J. Psychiatry.</em> 2014;204:108–114. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3909838/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/24311552">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Br.+J.+Psychiatry&amp;title=Analysis+of+copy+number+variations+at+15+schizophrenia-associated+loci&amp;author=E+Rees&amp;volume=204&amp;publication_year=2014&amp;pages=108-114&amp;pmid=24311552&amp;">Google Scholar</a>]</p><p>Sanders SJ, et al. Multiple recurrent <em>de novo</em> CNVs, including duplications of the 7q11.23 Williams syndrome region, are strongly associated with autism. <em>Neuron.</em> 2011;70:863–885. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3939065/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/21658581">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Neuron&amp;title=Multiple+recurrent+de+novo+CNVs,+including+duplications+of+the+7q11.23+Williams+syndrome+region,+are+strongly+associated+with+autism&amp;author=SJ+Sanders&amp;volume=70&amp;publication_year=2011&amp;pages=863-885&amp;pmid=21658581&amp;">Google Scholar</a>]</p></blockquote><h3 id="6-2-对潜在功能等位基因认识有限"><a href="#6-2-对潜在功能等位基因认识有限" class="headerlink" title="6.2 对潜在功能等位基因认识有限"></a>6.2 对潜在功能等位基因认识有限</h3><h4 id="Gene-property-analysis-for-tissue-specificity"><a href="#Gene-property-analysis-for-tissue-specificity" class="headerlink" title="Gene property analysis for tissue specificity"></a>Gene property analysis for tissue specificity</h4><p>在共同变异关联研究中确定的给定 SNP 通常是一组 5-50 个共同多态性的分子代理（或“标签”），这些多态性共同分离为一个单倍型。 该单倍型上影响表型的特定等位基因最初并不为人所知——迄今为止仅在少数情况下被鉴定。 此外，功能等位基因的遗传结构可能与相关 SNP 的遗传结构不同：与单倍型的关联也可能来自在该单倍型上分离的低频等位基因，或来自同一位点的多种遗传效应的组合。 我们对潜在功能等位基因的了解仍然有限，这使得模拟细胞系或动物的遗传扰动具有挑战性。</p><blockquote><p>Musunuru K, et al. From noncoding variant to phenotype via SORT1 at the 1p13 cholesterol locus. <em>Nature.</em> 2010;466:714–719. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3062476/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/20686566">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=From+noncoding+variant+to+phenotype+via+SORT1+at+the+1p13+cholesterol+locus&amp;author=K+Musunuru&amp;volume=466&amp;publication_year=2010&amp;pages=714-719&amp;pmid=20686566&amp;">Google Scholar</a>]</p><p>McCarroll SA, et al. Deletion polymorphism upstream of IRGM associated with altered IRGM expression and Crohn’s disease. <em>Nat. Genet.</em> 2008;40:1107–1112. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2731799/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/19165925">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Deletion+polymorphism+upstream+of+IRGM+associated+with+altered+IRGM+expression+and+Crohn&#39;s+disease&amp;author=SA+McCarroll&amp;volume=40&amp;publication_year=2008&amp;pages=1107-1112&amp;pmid=19165925&amp;">Google Scholar</a>]</p><p>Bauer DE, et al. An erythroid enhancer of BCL11A subject to genetic variation determines fetal hemoglobin level. <em>Science.</em> 2013;342:253–257. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4018826/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/24115442">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=An+erythroid+enhancer+of+BCL11A+subject+to+genetic+variation+determines+fetal+hemoglobin+level&amp;author=DE+Bauer&amp;volume=342&amp;publication_year=2013&amp;pages=253-257&amp;pmid=24115442&amp;">Google Scholar</a>]</p></blockquote><h3 id="6-3-非编码突变与调控DNA"><a href="#6-3-非编码突变与调控DNA" class="headerlink" title="6.3 非编码突变与调控DNA"></a>6.3 非编码突变与调控DNA</h3><p><strong>Noncoding variants and regulatory DNA</strong></p><p><strong>CVAS (GWAS) 中涉及的大多数单倍型不包含蛋白质改变变体，而是位于大内含子内或附近基因上游的序列中，这些位置通常包含组织特异性增强子元件</strong>。因此，虽然它们通常可以映射到可识别的基因，但风险相关序列变异对这些基因的功能影响很难以系统的方式建立。人们可能会得出结论，<strong>它们的影响不是来自“破碎的”蛋白质，而是来自表达水平的定量变化或细胞类型特异性表达模式的改变</strong>。<strong>功能等位基因已被确定的案例支持组织特异性影响基因表达的假设。人类基因中的非编码变异很难在其他生物体中建模，因为调控序列似乎在更快的时间尺度上进化，并且表现出比蛋白质编码序列更少的保守性</strong>。虽然识别非编码序列中的功能等位基因是一个具有挑战性的问题，但在不同细胞类型中注释染色质状态的数据资源可能会加速进展。总体而言，非编码变异可能是在种群中发现的自然多态性不同于科学家经常在模式生物中产生的严重突变的一种方式，后者产生的表型远远超出生物体的正常范围。</p><blockquote><p>Musunuru K, et al. From noncoding variant to phenotype via SORT1 at the 1p13 cholesterol locus. <em>Nature.</em> 2010;466:714–719. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3062476/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/20686566">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=From+noncoding+variant+to+phenotype+via+SORT1+at+the+1p13+cholesterol+locus&amp;author=K+Musunuru&amp;volume=466&amp;publication_year=2010&amp;pages=714-719&amp;pmid=20686566&amp;">Google Scholar</a>]</p><p>McCarroll SA, et al. Deletion polymorphism upstream of IRGM associated with altered IRGM expression and Crohn’s disease. <em>Nat. Genet.</em> 2008;40:1107–1112. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2731799/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/19165925">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Genet&amp;title=Deletion+polymorphism+upstream+of+IRGM+associated+with+altered+IRGM+expression+and+Crohn&#39;s+disease&amp;author=SA+McCarroll&amp;volume=40&amp;publication_year=2008&amp;pages=1107-1112&amp;pmid=19165925&amp;">Google Scholar</a>]</p><p>Bauer DE, et al. An erythroid enhancer of BCL11A subject to genetic variation determines fetal hemoglobin level. <em>Science.</em> 2013;342:253–257. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4018826/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/24115442">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=An+erythroid+enhancer+of+BCL11A+subject+to+genetic+variation+determines+fetal+hemoglobin+level&amp;author=DE+Bauer&amp;volume=342&amp;publication_year=2013&amp;pages=253-257&amp;pmid=24115442&amp;">Google Scholar</a>]</p><p>The ENCODE Project Consortium An integrated encyclopedia of DNA elements in the human genome. <em>Nature.</em> 2012;489:57–74. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3439153/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/22955616">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=An+integrated+encyclopedia+of+DNA+elements+in+the+human+genome&amp;volume=489&amp;publication_year=2012&amp;pages=57-74&amp;pmid=22955616&amp;">Google Scholar</a>]</p></blockquote><h3 id="6-3-新出现的基因结果：罕见变异"><a href="#6-3-新出现的基因结果：罕见变异" class="headerlink" title="6.3 新出现的基因结果：罕见变异"></a>6.3 新出现的基因结果：罕见变异</h3><p><strong>Interpreting emerging genetic results: rare variants</strong></p><p>虽然今天关于罕见变异对多基因表型的贡献知之甚少，但有一个强有力的理论案例表明其中一些非常重要：<strong>通过纯化选择，强烈易患疾病的等位基因可能保持在低频率</strong>。 必须通过测序在每个基因组中确定这种罕见的变异。 对大量受影响个体的 DNA 进行测序，可以开始探索此类变异与精神病和其他表型的关系。 基因组测序技术的创新开始允许大规模开展此类研究。</p><p>任何稀有变异关联研究 (RVAS) 的基本挑战是，人类基因组包含数以千计的变异，这些变异会改变或终止蛋白质序列，使疾病因果关系与任何特定变异的分配复杂化。<strong>人类种群的自然变异与在大多数模式生物中研究突变的同基因环境形成鲜明对比。在不同的人群中，只有在许多个体中观察到此类变异时，特定基因中的基因禁用和基因改变变异的特性才变得清晰。</strong>对于许多具有可识别和不寻常的定义表型的罕见单基因疾病（如歌舞伎综合征），这些结果很快就产生了外显子组测序，因为大多数患者在同一基因中有突变。<strong>对于多基因疾病，在单个基因甚至开始从整个基因组的变迁背景中脱颖而出之前，需要更大的样本</strong>。<strong>此外，即使已经确定了罕见的大效应变异——今天最明显的例子是 CNV——它们仅对成人发病的精神病表型（如精神分裂症）显示出部分外显率；大多数携带者没有精神病学诊断，但对 IQ 和认知的亚临床影响可能更常见。</strong></p><blockquote><p>MacArthur DG, et al. A systematic survey of loss-of-function variants in human protein-coding genes. <em>Science.</em> 2012;335:823–828. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3299548/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/22344438">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Science&amp;title=A+systematic+survey+of+loss-of-function+variants+in+human+protein-coding+genes&amp;author=DG+MacArthur&amp;volume=335&amp;publication_year=2012&amp;pages=823-828&amp;pmid=22344438&amp;">Google Scholar</a>]</p></blockquote><p>尽管如此，<strong>当在大量个体中确定罕见变异时，可以开始聚集成模式，揭示这些变异在受影响或未受影响的个体中过多。</strong>罕见变异的最强影响，包括从头突变，已被记录在先天性和儿童早期发病的疾病中，例如智力障碍（ ID）和自闭症。在这些疾病中，受影响的个体似乎增加了蛋白质破坏突变的可能性，并且<strong>在特定基因（如 CHD8、SCN2A、GRIN2B 和 DYRK1A）中以统计学上的升高率反复观察到此类突变，通常具有广泛的表型影响，包括癫痫发作和严重智力障碍</strong>。<u>在高度遗传的迟发性疾病（例如精神分裂症）中，受影响的个体似乎携带罕见的外显子突变，其比例仅略高于普通人群，但低于自闭症或智力障碍患者。这种更微妙的富集表明，与自闭症和智力障碍等早发性发育障碍相比，此类突变在精神分裂症中的作用更小。</u>事实上，精神分裂症患者的突变尚未显示出个体基因积累的证据，尽管作为一个群体，他们<strong>表现出一组功能相关的大脑表达基因之间的统计富集模式</strong>，例如那些编码兴奋性突触的突触后成分的基因和编码脆弱 X 智力低下蛋白 (FMRP)的 RNA 靶标。</p><blockquote><p>Purcell SM, et al. A polygenic burden of rare disruptive mutations in schizophrenia. <em>Nature.</em> 2014;506:185–190. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4136494/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/24463508">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=A+polygenic+burden+of+rare+disruptive+mutations+in+schizophrenia&amp;author=SM+Purcell&amp;volume=506&amp;publication_year=2014&amp;pages=185-190&amp;pmid=24463508&amp;">Google Scholar</a>]</p><p>Fromer M, et al. <em>De novo</em> mutations in schizophrenia implicate synaptic networks. <em>Nature.</em> 2014;506:179–184. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4237002/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/24463507">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=De+novo+mutations+in+schizophrenia+implicate+synaptic+networks&amp;author=M+Fromer&amp;volume=506&amp;publication_year=2014&amp;pages=179-184&amp;pmid=24463507&amp;">Google Scholar</a>]</p><p>Sanders SJ, et al. <em>De novo</em> mutations revealed by whole-exome sequencing are strongly associated with autism. <em>Nature.</em> 2012;485:237–241. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3667984/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/22495306">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=De+novo+mutations+revealed+by+whole-exome+sequencing+are+strongly+associated+with+autism&amp;author=SJ+Sanders&amp;volume=485&amp;publication_year=2012&amp;pages=237-241&amp;pmid=22495306&amp;">Google Scholar</a>]</p><p>Iossifov I, et al. <em>De novo</em> gene disruptions in children on the autistic spectrum. <em>Neuron.</em> 2012;74:285–299. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3619976/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/22542183">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Neuron&amp;title=De+novo+gene+disruptions+in+children+on+the+autistic+spectrum&amp;author=I+Iossifov&amp;volume=74&amp;publication_year=2012&amp;pages=285-299&amp;pmid=22542183&amp;">Google Scholar</a>]</p><p>Neale BM, et al. Patterns and rates of exonic <em>de novo</em> mutations in autism spectrum disorders. <em>Nature.</em> 2012;485:242–245. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3613847/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/22495311">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=Patterns+and+rates+of+exonic+de+novo+mutations+in+autism+spectrum+disorders&amp;author=BM+Neale&amp;volume=485&amp;publication_year=2012&amp;pages=242-245&amp;pmid=22495311&amp;">Google Scholar</a>]</p><p>O’Roak BJ, et al. Sporadic autism exomes reveal a highly interconnected protein network of <em>de novo</em> mutations. <em>Nature.</em> 2012;485:246–250. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3350576/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/22495309">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nature&amp;title=Sporadic+autism+exomes+reveal+a+highly+interconnected+protein+network+of+de+novo+mutations&amp;author=BJ+O&#39;Roak&amp;volume=485&amp;publication_year=2012&amp;pages=246-250&amp;pmid=22495309&amp;">Google Scholar</a>]</p></blockquote><p>随着基于测序的研究扩展到更多的患者和对照，越来越多的基因可能与等位基因系列的罕见变异有关。通过允许测量跨等位基因系列的功能效应，探索它们对细胞表型的影响，并尝试将它们与患者的临床显着表型联系起来，这些发现将为生物学研究提供巨大的机会。与 CVAS (GWAS) 中涉及的调节变体相比，大效应的蛋白质改变变体通常为生物学研究提供了一个更容易的起点。然而，<strong>RVAS 仍然远远缺乏在成人发病的精神疾病中涉及大量特定基因所需的样本量</strong>。生物学家面临的一个<strong>关键挑战是决定何时值得进行功能研究——特别是避免因生物学合理性和“就这样”故事而产生的过早假设</strong>。证明在未受影响的个体队列中不存在相似浓度的稀有变异（在途径和特定基因中）将增强对 RVAS 结果的信心。将外显子组和全基因组测序研究扩展到更大的受影响和未受影响的个体队列，将是获得在神经生物学上可操作且具有合理可信度的遗传发现的关键。</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs clean">#Rare-variant association studies 罕见变异关联研究<br>稀有变异关联研究（RVAS，通常称为“测序研究”或“外显子组测序研究”）涉及通过测序寻找稀有序列变异，包括新的（“从头”）突变。大多数罕见变异发生的频率太低，无法对单个变异进行关联测试；因此，对稀有变异的分析涉及将这些变异聚合到基于基因或通路的集合中，并将它们的聚合频率作为一个组进行评估。<br><br>迄今为止，大多数稀有变异研究都集中在人类基因组的蛋白质编码部分（外显子组）——这既是因为潜在的功能性变异可以与中性或同义变异区分开来，而且因为外显子组（仅占总基因组的 <span class="hljs-number">1.5</span>%）人类基因组）需要比全基因组更少的测序，从而允许在一项研究中对更多的患者进行测序。随着测序成本的下降，外显子组测序研究可能让位于更多的全基因组测序研究。<br><br>稀有变异研究涉及三种主要设计之一：病例对照、三重奏和其他家庭设计。<br><br>## <span class="hljs-number">1.</span><span class="hljs-keyword">case</span> control 病例对照<br><br>病例对照研究是 CVAS 疾病关联的主要支柱。对于罕见的变异，它们涉及通过相同的方法同时对来自同一人群的大量受影响和未受影响的个体进行测序。来自对照个体的数据用于校准观察到的任何一组变异的惊人程度——例如，一个给定的基因（或一组功能相关的基因）是否比未受影响的基因包含更多的功能丧失变异个人。仔细的统计校准很重要，因为基因组充满了罕见的序列变异；平均而言，每个人拥有数以千计的蛋白质改变序列变体，其中大约 <span class="hljs-number">100</span> 个会破坏所编码蛋白质的功能。<br><br>病例对照 RVAS 的设计涉及围绕选择样本的重要方法论问题。首先，病例和对照必须很好地匹配——它们来自同一人群并同时使用相同的方法进行分析——因为祖先可以深刻地影响基因组中变异的数量，以及实验室和计算方法影响确定这些变异的程度。这也适用于 CVAS。其次，随着研究的发展超出了对个体人群的初步探索，一个越来越重要的决定将涉及在未来的研究中对哪些人群进行测序。例如，APP 和 PCSK9 的罕见保护性等位基因由于它们在研究人群中的相对丰富而被发现<span class="hljs-number">46</span>,<span class="hljs-number">48</span>。具有独特历史（例如瓶颈）的种群对于揭示隐性变异的影响可能特别有用。<br><br>## <span class="hljs-number">2.</span>Trios 家系<br><br>基于家系的研究侧重于新突变，以此过滤掉每个人遗传的数千种蛋白质改变变体。在这些研究中，DNA 是从受影响的个人及其未受影响的父母那里收集的。对父亲、母亲和先证者进行测序可以将新突变与大量遗传变异区分开来。大多数基因组包含大约 <span class="hljs-number">60</span> 个新的突变，在父母双方的基因组中都不存在；通常，外显子组中会出现这些新突变中的大约 <span class="hljs-number">0</span><span class="hljs-number">-2</span> 个，其中大约一半会影响编码蛋白质的序列。<br><br>家系突变研究中的分析挑战在于，所有个体的很大一部分（无论表型如何）都会出现改变蛋白质的突变；因此，确定导致受影响个体疾病的子集具有挑战性。因此，基于三重奏的研究在看似非随机的突变（在受影响的个体中）中寻找模式——例如此类突变倾向于聚集在特定基因或具有相关功能或表达模式的基因群中。对于简单的单基因疾病，这通常会导致快速识别有罪的基因。对于遗传复杂的精神疾病，分析挑战要困难得多，涉及在单个基因或功能相关基因的大群中逐渐增加统计证据，例如，通过共定位或类似的功能注释来定义编码的蛋白质。通常只有少数已确定的突变会导致这种模式，因此统计能力一直是做出此类推断的关键。例如，通过基于三重奏的研究，CHD8 被认为是一种自闭症基因，尽管 CHD8 突变存在于不到 <span class="hljs-number">1</span>% 的病例中；[在这种模式变得清晰之前，需要对数百个三重奏进行测序。在设计针对其他复杂疾病的基于三重奏的研究时，可以尝试通过选择散发病例（受影响的个体而没有受影响的亲属）来增加有影响的突变的频率。新突变也可能在患有涉及多种或更多严重表型（如自闭症、癫痫和低智商）的综合征而不是更常见的疾病表现的患者中富集。<br><br>## <span class="hljs-number">3.</span>Other family-based designs 其他基于家系的设计<br><br>其他研究设计利用最初为连锁分析收集的队列（即，有多个受影响个体的家庭），并试图通过做出连锁分析做出的各种假设来筛选大型测序数据集——例如，受影响的个体来自相同的家庭必须彼此共享一个共同的因果变异。此类分析的挑战在于，即使是在任何家庭中随机选择的个体也会共享其基因组的很大一部分，而基因组的这一共享部分将包括影响大量基因序列的罕见和常见变异。因此，个体变异的优先排序通常涉及基于生物学候选资格或来自其他研究的独立形式的遗传证据的评估。一种越来越普遍的设计是将家族分析视为一个假设生成过程，然后在更大的、强大的病例对照队列中对指定的基因进行测序和分析，以测试正式的疾病关联。<br></code></pre></td></tr></table></figure><h2 id="7-多基因精神疾病对神经生物学的挑战"><a href="#7-多基因精神疾病对神经生物学的挑战" class="headerlink" title="7.多基因精神疾病对神经生物学的挑战"></a>7.多基因精神疾病对神经生物学的挑战</h2><p>如上所述，精神疾病分析中出现的常见和罕见等位基因的外显率有限，与许多其他等位基因（遗传背景）协同作用并导致多种表型（多效性）。然而，出于实际原因，对疾病相关基因进行功能分析的主要现代实验方法是基于引入小鼠的高外显率变体。基于新兴的精神疾病多基因结构，我们建议当前的方法必须越来越多地辅以新的方法，这些方法允许更高的吞吐量（比例如突变小鼠的生产），这些方法本质上更具诱导性，并且允许对生物系统的分析，超出了关于假定因果等位基因的单一假设。我们必须超越从研究文献中小而互不连贯的岛屿得出的狭隘病理生理学假设，转向收集信息和从神经生物学系统中获得洞察力的系统方法。正如基因组规模的实验工具和数据资源以及数据收集和分析的无偏见（无假设）方法给遗传学带来了新的生命一样，它们也可能为分子和细胞神经生物学提供新的机会。为了了解遗传扰动如何影响特定细胞群，生物学家需要对每个大脑区域中存在的细胞群进行更好的普查，以及系统地识别细胞状态扰动的实验工具。这不仅需要开发新的实验工具，例如基于干细胞技术的单细胞表达谱和细胞模型的可扩展方法，还需要开发新一代的基础数据资源，例如每个主要的参考转录组。大脑中的细胞群。单细胞蛋白质组学尚不可行，但开发可以确定假定通路或网络中的哪些蛋白质实际上同时存在于同一细胞中的方法至关重要。最终，验证还需要来自死后人类大脑的数据。我们不认为神经生物学家在探索疾病相关等位基因的功能之前应该等待这些数据；相反，我们敦促并行开发此类分子资源，以减少与治疗靶标识别和靶标验证过程相关的投机风险。</p><p>系统神经生物学家也不会缺乏挑战。 毕竟，精神障碍的症状和损害是由神经回路功能异常引起的。 因此，疾病机制的成功研究可能需要对神经元结构、功能和连接性进行可扩展的分析，这些分析适用于体外原代或重编程神经元 reprogrammed neurons in vitro（人类、啮齿动物或其他物种）和多种动物模型，包括果蝇、斑马鱼、啮齿动物和非人类灵长类动物。</p><p>在研究结构上和功能上都保守的神经回路时，用于转化神经生物学的基因工程小鼠的研究仍然很重要 - 可能与潜在的分子网络一起，就像重复行为中基底神经节回路功能障碍的情况一样——在进化中。然而，由于啮齿动物和人类大脑结构（细胞类型、回路和区域结构）的差异，对啮齿动物的高级大脑功能（例如工作记忆和社会认知）的缺陷进行建模具有挑战性。精神分裂症患者大脑背外侧前额叶皮层的结构和功能缺陷被认为是工作记忆缺陷的重要原因。这种结构是灵长类动物独有的，这使得使用啮齿动物研究作为治疗效果的预测指标具有挑战性。现在似乎可以转向其他模型，例如普通狨猴，一种具有快速繁殖周期的小型新世界猴子，来研究精神疾病的神经回路和生物标志物 39。</p><p>选择的模型不仅应基于当前方法实验的可行性，而且更重要的是基于所提出的问题。<strong>对于试图将基本生物学发现转化为对发病机制的理解或治疗方法的发现的研究，关注与人类的进化保护尤为重要</strong>。<u>所谓的“表面效度”——动物模型中的生理发现或行为与人类疾病的相似性——是一个非常危险的指引，即使所研究的行为从动物模型看起来与人类相似。</u><strong>相同的结构或行为可以通过来自非常不同的潜在机制的趋同进化产生。除非潜在机制是保守的，否则认知或行为表型在动物模型和健康人或生病的人中是否看起来非常相似或相同都无关紧要。</strong>药物作用于分子网络内的靶标，从而影响突触和回路，并且仅因此影响认知、情绪和行为。</p><blockquote><p>Nestler EJ, Hyman SE. Animal models of neuropsychiatric disorders. <em>Nat. Neurosci.</em> 2010;13:1161–1169. [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3750731/">PMC free article</a>] [<a href="https://www.ncbi.nlm.nih.gov/pubmed/20877280">PubMed</a>] [<a href="https://scholar.google.com/scholar_lookup?journal=Nat.+Neurosci&amp;title=Animal+models+of+neuropsychiatric+disorders&amp;author=EJ+Nestler&amp;author=SE+Hyman&amp;volume=13&amp;publication_year=2010&amp;pages=1161-1169&amp;pmid=20877280&amp;">Google Scholar</a>]</p></blockquote><h2 id="8-神经生物学与人类遗传学的融合"><a href="#8-神经生物学与人类遗传学的融合" class="headerlink" title="8.神经生物学与人类遗传学的融合"></a>8.神经生物学与人类遗传学的融合</h2><p>精神病学研究的重要未来进展可能出现在神经生物学和人类遗传学的界面上。这两个领域具有巨大的潜在协同作用；然而，迄今为止，他们几乎没有意识到这些协同作用，他们单独的成功涉及揭示生物系统中非常不同类型的关系。生物学探究基于在良好控制的实验中建立因果关系。当它们涉及具有高度渗透性遗传缺陷（例如纯合敲除）和其他戏剧性实验扰动的实验时，这种关系通常最为清晰。这项工作建立了关于神经元和回路组件如何工作的强大模型——尽管对这些组件的自然变异如何成为常见精神病表型的基础知之甚少。精神疾病的人类遗传学研究最初围绕着对类似简单、一般、高外显率关系的不成功探索，然后围绕着一个不成功的假设，即可以从生物学理解中预测相关候选基因。今天大多数已确认的基因发现都来自于无偏见的全基因组搜索，并接受了当数百种适度的、常见的并且通常是一种或几种具有较强影响力（但仅部分渗透）、罕见的遗传扰动存在于每个基因组。这创造了大量的基因发现，而这些发现并不存在简单的生物学手册。</p><p>这样的剧本将需要在未来几年内完成。这些理解大脑功能和功能障碍的方法的综合，将提出基本的智力挑战ーー我们希望，还有重要的科学见解和医学变革观点。</p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
      <tag>ASD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.11.15 GWAS与ASD相关文献阅读报告</title>
    <link href="/2021/11/15/20211115GWAS%E4%B8%8EASD%E7%9B%B8%E5%85%B3%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%8A%A5%E5%91%8A/"/>
    <url>/2021/11/15/20211115GWAS%E4%B8%8EASD%E7%9B%B8%E5%85%B3%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%8A%A5%E5%91%8A/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-11-15-GWAS与ASD相关文献阅读报告"><a href="#2021-11-15-GWAS与ASD相关文献阅读报告" class="headerlink" title="2021-11-15 GWAS与ASD相关文献阅读报告"></a>2021-11-15 GWAS与ASD相关文献阅读报告</h1><p><a href="https://link.springer.com/article/10.1007/s40473-014-0023-0#Abs1">Genome-Wide Association Studies of Autism</a></p><h2 id="1-染色体突变（chromosomal-mutation）可导致自闭症的易感性"><a href="#1-染色体突变（chromosomal-mutation）可导致自闭症的易感性" class="headerlink" title="1.染色体突变（chromosomal mutation）可导致自闭症的易感性"></a>1.染色体突变（chromosomal mutation）可导致自闭症的易感性</h2><p>连锁研究和细胞遗传学分析导致鉴定了几种新的候选基因，包括神经蛋白 (NRXN) 和神经蛋白 (NLGN)。 据报道，2q31、3q、7q22 和 7q34 存在显着的基因组连锁 。多项研究涉及几个感兴趣的区域，包括 1p13.2、1q31.1、5p13、8q24、13q、15q、16p、17q、19p 和 Xq。 除了 1p13.2 和 2q32 之外，这些区域中的大多数都报告了染色体突变 。</p><blockquote><p>Gupta, Abha R., and Matthew W. State. “Recent advances in the genetics of autism.” <em>Biological psychiatry</em> 61.4 (2007): 429-437.</p><p>Veenstra-VanderWeele, Jeremy, Susan L. Christian, and Edwin H. Cook, Jr. “Autism as a paradigmatic complex genetic disorder.” <em>Annu. Rev. Genomics Hum. Genet.</em> 5 (2004): 379-405.</p></blockquote><h2 id="2-拷贝数变异是与自闭症风险相关的遗传变异之一。"><a href="#2-拷贝数变异是与自闭症风险相关的遗传变异之一。" class="headerlink" title="2.拷贝数变异是与自闭症风险相关的遗传变异之一。"></a>2.拷贝数变异是与自闭症风险相关的遗传变异之一。</h2><p>最确定的自闭症相关 CNV 包括 7q11.23、15q11-13、16p11.2 和 22q11.2 基因座，以及 NRXN1、CNTN4、NLGN 和 SHANK3 基因 。 CNV 已被证明是导致自闭症表型的遗传负担的关键来源。</p><blockquote><p>Durand, Christelle M., et al. “Mutations in the gene encoding the synaptic scaffolding protein SHANK3 are associated with autism spectrum disorders.” <em>Nature genetics</em> 39.1 (2007): 25-27.</p><p>Glessner, Joseph T., et al. “Autism genome-wide copy number variation reveals ubiquitin and neuronal genes.” <em>Nature</em> 459.7246 (2009): 569-573.</p><p>Sanders, Stephan J., et al. “Multiple recurrent de novo CNVs, including duplications of the 7q11. 23 Williams syndrome region, are strongly associated with autism.” <em>Neuron</em> 70.5 (2011): 863-885.</p><p>Bucan, Maja, et al. “Genome-wide analyses of exonic copy number variants in a family-based study point to novel autism susceptibility genes.” <em>PLoS genetics</em> 5.6 (2009): e1000536.</p><p>Elia, Josephine, et al. “Genome-wide copy number variation study associates metabotropic glutamate receptor gene networks with attention deficit hyperactivity disorder.” <em>Nature genetics</em> 44.1 (2012): 78-84.</p><p>Gai, X., et al. “Rare structural variation of synapse and neurotransmission genes in autism.” <em>Molecular psychiatry</em> 17.4 (2012): 402-411.</p><p>Girirajan, Santhosh, et al. “Refinement and discovery of new hotspots of copy-number variation associated with autism spectrum disorder.” <em>The American Journal of Human Genetics</em> 92.2 (2013): 221-237.</p><p>Glessner, Joseph T., John JM Connolly, and Hakon Hakonarson. “Rare genomic deletions and duplications and their role in neurodevelopmental disorders.” <em>Behavioral Neurogenetics</em> (2011): 345-360.</p><p>Glessner, Joseph T., Jin Li, and Hakon Hakonarson. “ParseCNV integrative copy number variation association software with quality tracking.” <em>Nucleic acids research</em> 41.5 (2013): e64-e64.</p><p>Hadley, Dexter, et al. “The impact of the metabotropic glutamate receptor and other gene family interaction networks on autism.” <em>Nature communications</em> 5.1 (2014): 1-10.</p><p>Levy, Dan, et al. “Rare de novo and transmitted copy-number variation in autistic spectrum disorders.” <em>Neuron</em> 70.5 (2011): 886-897.</p><p>Matsunami, Nori, et al. “Identification of rare recurrent copy number variants in high-risk autism families and their prevalence in a large ASD population.” <em>PloS one</em> 8.1 (2013): e52239.</p><p>Pinto, Dalila, et al. “Functional impact of global rare copy number variation in autism spectrum disorders.” <em>Nature</em> 466.7304 (2010): 368-372.</p></blockquote><h2 id="3-新突变在自闭症发展中也有一定的作用。"><a href="#3-新突变在自闭症发展中也有一定的作用。" class="headerlink" title="3.新突变在自闭症发展中也有一定的作用。"></a>3.新突变在自闭症发展中也有一定的作用。</h2><p>最近进行的外显子组测序研究表明，数百个从头突变在自闭症的发展中具有一定作用，明确的证据表明一些特定基因（CHD8、KATANAL2、SCN2A、NTNG1）。 总之，这些结构变异或从头突变，其中许多是高度外显或蛋白质改变但个别罕见，占孤独症遗传风险的有限比例。 相比之下，通过 GWAS 在 CDH9-CDH10、SEMA5A 和 MACROD2 基因座仅报告了少量常见变异。</p><p>此外，稀有变异可能非常重要，因为纯化选择（purifying selection）使个体易患自闭症的等位基因可能保持在罕见的频率上。 有许多变异会以每个基因组数千个的数量级改变或终止蛋白质序列，从而使某些变异的因果关系分配变得复杂。 罕见的变异可能仅对自闭症表型有部分外显率（penetrance），导致对智商或认知的亚临床影响（subclinical impact），并污染对照人群，这些人群可能不像 GWAS 的病例人群那样仔细筛选。</p><blockquote><p><strong>background selection</strong> &amp; <strong>purifying selection</strong></p><blockquote><p><a href="https://en.wikipedia.org/wiki/Negative_selection_(natural_selection">Negative selection (natural selection)</a>)</p><blockquote><p>在自然选择中，负选择或纯化选择是选择性去除有害的等位基因。这可以通过清除由随机突变引起的有害遗传多态性来稳定选择。 </p><p>可以在群体遗传学水平上清除有害等位基因，只需一个单点突变即可作为选择单位。在这种情况下，有害点突变的携带者每代产生更少的后代，从而降低了基因库中突变的频率。</p><p>在基因座上的强负选择的情况下，有害变体的清除将导致连锁变异的偶尔移除，从而导致被选择基因座周围的变异水平降低。由于与有害等位基因的这种空间接近性而偶然清除非有害等位基因称为<strong>背景选择</strong>。 这种效应随着突变率的降低而增加，但随着重组率的升高而降低。 </p><p><strong>纯化选择</strong>可以分为通过非随机交配进行清除和通过遗传漂变进行清除。通过遗传漂变清除主要可以去除深度隐性等位基因，而自然选择可以去除任何类型的有害等位基因。 </p></blockquote></blockquote><p>Neale, Benjamin M., et al. “Patterns and rates of exonic de novo mutations in autism spectrum disorders.” <em>Nature</em> 485.7397 (2012): 242-245.</p><p>O’Roak, Brian J., et al. “Sporadic autism exomes reveal a highly interconnected protein network of de novo mutations.” <em>Nature</em> 485.7397 (2012): 246-250.</p><p>Sanders, Stephan J., et al. “De novo mutations revealed by whole-exome sequencing are strongly associated with autism.” <em>Nature</em> 485.7397 (2012): 237-241.</p><p>Iossifov, Ivan, et al. “De novo gene disruptions in children on the autistic spectrum.” <em>Neuron</em> 74.2 (2012): 285-299.</p><p>McCarroll, Steven A., Guoping Feng, and Steven E. Hyman. “Genome-scale neurogenetics: methodology and meaning.” <em>Nature neuroscience</em> 17.6 (2014): 756-763.</p><blockquote><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4912829/">Genome-scale neurogenetics: methodology and meaning</a></p></blockquote></blockquote><h2 id="4-互作、多因素与表型异质性"><a href="#4-互作、多因素与表型异质性" class="headerlink" title="4.互作、多因素与表型异质性"></a>4.互作、多因素与表型异质性</h2><p>自闭症具有表型异质性的特点，并且在病因上是多因素的。 多个常见变异共同或通过与环境因素的相互作用占自闭症风险的一定比例的假设激发了 GWAS 的基本原理。 </p><h2 id="5-自闭症与兴奋性突触和L型钙通道"><a href="#5-自闭症与兴奋性突触和L型钙通道" class="headerlink" title="5.自闭症与兴奋性突触和L型钙通道"></a>5.自闭症与兴奋性突触和L型钙通道</h2><p>兴奋性突触和 L 型钙通道的突触后成分已成为神经精神病学 GWAS 中出现的主要生物学类别。 具体而言，NRXN、CNTN、GRM、泛素和 SLIT 基因成员显示出多个基因家族成员，这些成员具有与自闭症和相关神经发育障碍相关的变异。</p><h2 id="6-复杂的遗传结构（精神类疾病的多基因性）"><a href="#6-复杂的遗传结构（精神类疾病的多基因性）" class="headerlink" title="6.复杂的遗传结构（精神类疾病的多基因性）"></a>6.复杂的遗传结构（精神类疾病的多基因性）</h2><p>与其他常见疾病相比，解析精神疾病的遗传学需要更大的人口样本，这很可能是由于精神疾病的复杂遗传结构。 遗传风险是个体内部和家庭之间的许多不同基因以及罕见和常见变异协同作用的结果，使得精神疾病具有多基因性。</p><h2 id="7-常见变异的加性效应"><a href="#7-常见变异的加性效应" class="headerlink" title="7.常见变异的加性效应"></a>7.常见变异的加性效应</h2><p>GWAS 确定的许多常见变异具有适度的影响。 具体而言，它们在其他变体的遗传背景中充当遗传风险因素，增加对自闭症的风险或保护，并在蛋白质序列或表达水平上以一定范围内的作用。 克莱等人使用模拟来检查自闭症易感性的加性模型，其中自闭症被大量累积增加 ASD 风险的变体所强调，但单独产生的影响非常小。 他们的模型表明，在多重家族中，大约 60% 的易感性可归因于累加效应，而在单一家族中，这一比例接近 40%。</p><blockquote><p>Abrahams, Brett S., and Daniel H. Geschwind. “Advances in autism genetics: on the threshold of a new neurobiology.” <em>Nature reviews genetics</em> 9.5 (2008): 341-355.</p><p>Klei, Lambertus, et al. “Common genetic variants, acting additively, are a major source of risk for autism.” <em>Molecular autism</em> 3.1 (2012): 1-13.</p></blockquote><h2 id="8-泛素化"><a href="#8-泛素化" class="headerlink" title="8.泛素化"></a>8.泛素化</h2><p>TRIM33 是一种 E3 泛素连接酶，是自闭症中最新的重要 GWAS。据报道，泛素 E3 连接酶的突变与其他神经精神疾病有关，例如 Angelman 综合征，其表型与自闭症 (UBE3A) 重叠；Charcot-Marie-Tooth 病 (LRSAM1)；青少年发病的帕金森病（PARK2);和 X 连锁精神发育迟滞 (CUL4B)。此外，在影响泛素通路的对照中未发现的 CNV，包括 UBE3A、PARK2、RFWD2 和 FBXO40，在自闭症患者中富集。 TRIM33 中的 SNP，rs6537825，显示出与自闭症的最强关联，是非同义的，导致异亮氨酸到苏氨酸的取代，并对大脑中的 TRIM33 表达具有显着的顺式作用调节作用。功能多态性可能会略微改变泛素-蛋白酶体系统的功能，从而降低其效率。 TRIM33 在自闭症患者和正常受试者的人脑中差异表达，据报道，在独立的死后人脑样本中，TRIM33 是与整个基因组差异表达相关的主要位点之一。在患有自闭症和相关疾病的男性中发现 TRIM32/ASTN2被破坏。</p><blockquote><p>Kishino, Tatsuya, Marc Lalande, and Joseph Wagstaff. “UBE3A/E6-AP mutations cause Angelman syndrome.” <em>Nature genetics</em> 15.1 (1997): 70-73.</p><p>Guernsey, Duane L., et al. “Mutation in the gene encoding ubiquitin ligase LRSAM1 in patients with Charcot-Marie-Tooth disease.” <em>PLoS genetics</em> 6.8 (2010): e1001081.</p><p>Abbas, Nacer, et al. “A wide variety of mutations in the parkin gene are responsible for autosomal recessive parkinsonism in Europe.” <em>Human molecular genetics</em> 8.4 (1999): 567-574.</p><p>Tarpey, Patrick S., et al. “Mutations in CUL4B, which encodes a ubiquitin E3 ligase subunit, cause an X-linked mental retardation syndrome associated with aggressive outbursts, seizures, relative macrocephaly, central obesity, hypogonadism, pes cavus, and tremor.” <em>The American Journal of Human Genetics</em> 80.2 (2007): 345-352.</p><p>Zou, Yongxin, et al. “Mutation in CUL4B, which encodes a member of cullin-RING ubiquitin ligase complex, causes X-linked mental retardation.” <em>The American Journal of Human Genetics</em> 80.3 (2007): 561-566.</p><p>Glessner, Joseph T., et al. “Autism genome-wide copy number variation reveals ubiquitin and neuronal genes.” <em>Nature</em> 459.7246 (2009): 569-573.</p><p>Chow, Maggie L., et al. “Age-dependent brain gene expression and copy number anomalies in autism suggest distinct pathological processes at young versus mature ages.” <em>PLoS genetics</em> 8.3 (2012): e1002592.</p><p>Lionel, Anath C., et al. “Disruption of the ASTN2/TRIM32 locus at 9q33. 1 is a risk factor in males for autism spectrum disorders, ADHD and other neurodevelopmental phenotypes.” <em>Human molecular genetics</em> 23.10 (2014): 2752-2768.</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
      <tag>ASD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.11.11 海洋微生物中抗肿瘤肽活性的分离鉴定（背景资料）</title>
    <link href="/2021/11/11/20211111%E6%B5%B7%E6%B4%8B%E5%BE%AE%E7%94%9F%E7%89%A9%E4%B8%AD%E6%8A%97%E8%82%BF%E7%98%A4%E8%82%BD%E6%B4%BB%E6%80%A7%E7%9A%84%E5%88%86%E7%A6%BB%E9%89%B4%E5%AE%9A%E8%83%8C%E6%99%AF%E8%B5%84%E6%96%99/"/>
    <url>/2021/11/11/20211111%E6%B5%B7%E6%B4%8B%E5%BE%AE%E7%94%9F%E7%89%A9%E4%B8%AD%E6%8A%97%E8%82%BF%E7%98%A4%E8%82%BD%E6%B4%BB%E6%80%A7%E7%9A%84%E5%88%86%E7%A6%BB%E9%89%B4%E5%AE%9A%E8%83%8C%E6%99%AF%E8%B5%84%E6%96%99/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-11-11-海洋微生物中抗肿瘤肽活性的分离鉴定（背景资料）"><a href="#2021-11-11-海洋微生物中抗肿瘤肽活性的分离鉴定（背景资料）" class="headerlink" title="2021.11.11 海洋微生物中抗肿瘤肽活性的分离鉴定（背景资料）"></a>2021.11.11 海洋微生物中抗肿瘤肽活性的分离鉴定（背景资料）</h1><p><strong>背景资料pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20211111%E6%B5%B7%E6%B4%8B%E5%BE%AE%E7%94%9F%E7%89%A9%E4%B8%AD%E6%8A%97%E8%82%BF%E7%98%A4%E8%82%BD%E6%B4%BB%E6%80%A7%E7%9A%84%E5%88%86%E7%A6%BB%E9%89%B4%E5%AE%9A.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>microorganism</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.11.10 未整合到论文中的观点/见解(after talk)</title>
    <link href="/2021/11/10/20211110%E6%9C%AA%E6%95%B4%E5%90%88%E5%88%B0%E5%BC%80%E9%A2%98%E6%8A%A5%E5%91%8A%E4%B8%AD%E7%9A%84%E8%A7%82%E7%82%B9%E8%A7%81%E8%A7%A3/"/>
    <url>/2021/11/10/20211110%E6%9C%AA%E6%95%B4%E5%90%88%E5%88%B0%E5%BC%80%E9%A2%98%E6%8A%A5%E5%91%8A%E4%B8%AD%E7%9A%84%E8%A7%82%E7%82%B9%E8%A7%81%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-11-10-导师建议与未整合到论文中的观点-见解"><a href="#2021-11-10-导师建议与未整合到论文中的观点-见解" class="headerlink" title="2021.11.10 导师建议与未整合到论文中的观点/见解"></a>2021.11.10 导师建议与未整合到论文中的观点/见解</h1><p>在过去的十年中，全基因组关联研究(GWAS)已经成功地鉴定了多种表型的新的遗传变异。然而，尽管样本量不断增加，GWAS 发现的遗传变异一般只占表型遗传力的一小部分[2,3]。最重要的是，GWAS 表明，许多表型，如身高[4]、精神分裂症[5]和 BMI [6]是高度多基因的，受到成千上万个具有小个体效应的遗传变异的影响，需要非常大的样本量来检测它们。</p><blockquote><p>说明GWAS研究发现单一致病基因的时代已经过去了，现在需要对这类多基因遗传病改变研究策略。</p><p>另外，也需要把多个SNP整合在一起，重新回归到基因上。</p></blockquote><p>基因和基因组分析被认为是可能比GWAS中典型的单SNP分析更强大的替代品[7]。在基因分析中，遗传标记数据被汇总到整个基因的水平，测试基因中所有标记与表型的联合关联。同样，在基因组分析中，单个基因被聚集到具有某些生物、功能或其他特征的基因组中。这种聚合的好处是大大减少了需要进行的测试的数量，并有可能检测到由多个较弱的关联组成的效应，否则会被忽略。此外，基因组分析可以深入了解特定的生物途径或细胞功能在表型的遗传病理学中的参与情况。基因组分析方法可细分为自足式和竞争式分析，自足式是测试基因组是否包含任何关联，竞争式是测试基因组中的关联是否大于其他基因[7]。</p><blockquote><p>需要从【基因分析】转变为【基因组分析】</p></blockquote><p>修改意见：</p><ol><li>补充说明对性染色体的研究目标和方法，或阐述为什么性染色体不应当纳入GWAS的研究范围。</li><li>补充说明PASCAL算法是否考虑到了基因位点的自由性（及基因间的连锁不平衡）</li><li>补充说明每次计算时的具体方法，同时补充每次筛选时P value的阈值限定以及原因</li></ol><p>PPT重点：</p><p>2021-11-04之前做好汇报PPT，重点在详细阐述计算方法与原理，同时应当准备好筛选后的基因列表/集合数据。</p><p>改进要点：</p><p>记录脑内高表达基因和基因权重</p><h2 id="bibtex"><a href="#bibtex" class="headerlink" title="bibtex"></a>bibtex</h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml">@article</span><span class="hljs-template-variable">&#123;lamparter2016fast,</span><br><span class="hljs-template-variable">  title=&#123;Fast and rigorous computation of gene and pathway scores from SNP-based summary statistics&#125;</span><span class="xml">,</span><br><span class="xml">  author=</span><span class="hljs-template-variable">&#123;Lamparter, David and Marbach, Daniel and Rueedi, Rico and Kutalik, Zolt&#123;\&#x27;a&#125;</span><span class="xml">n and Bergmann, Sven&#125;,</span><br><span class="xml">  journal=</span><span class="hljs-template-variable">&#123;PLoS computational biology&#125;</span><span class="xml">,</span><br><span class="xml">  volume=</span><span class="hljs-template-variable">&#123;12&#125;</span><span class="xml">,</span><br><span class="xml">  number=</span><span class="hljs-template-variable">&#123;1&#125;</span><span class="xml">,</span><br><span class="xml">  pages=</span><span class="hljs-template-variable">&#123;e1004714&#125;</span><span class="xml">,</span><br><span class="xml">  year=</span><span class="hljs-template-variable">&#123;2016&#125;</span><span class="xml">,</span><br><span class="xml">  publisher=</span><span class="hljs-template-variable">&#123;Public Library of Science San Francisco, CA USA&#125;</span><span class="xml"></span><br><span class="xml">&#125;</span><br><span class="xml"></span><br><span class="xml">@article</span><span class="hljs-template-variable">&#123;de2015magma,</span><br><span class="hljs-template-variable">  title=&#123;MAGMA: generalized gene-set analysis of GWAS data&#125;</span><span class="xml">,</span><br><span class="xml">  author=</span><span class="hljs-template-variable">&#123;de Leeuw, Christiaan A and Mooij, Joris M and Heskes, Tom and Posthuma, Danielle&#125;</span><span class="xml">,</span><br><span class="xml">  journal=</span><span class="hljs-template-variable">&#123;PLoS computational biology&#125;</span><span class="xml">,</span><br><span class="xml">  volume=</span><span class="hljs-template-variable">&#123;11&#125;</span><span class="xml">,</span><br><span class="xml">  number=</span><span class="hljs-template-variable">&#123;4&#125;</span><span class="xml">,</span><br><span class="xml">  pages=</span><span class="hljs-template-variable">&#123;e1004219&#125;</span><span class="xml">,</span><br><span class="xml">  year=</span><span class="hljs-template-variable">&#123;2015&#125;</span><span class="xml">,</span><br><span class="xml">  publisher=</span><span class="hljs-template-variable">&#123;Public Library of Science San Francisco, CA USA&#125;</span><span class="xml"></span><br><span class="xml">&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>talk&amp;meeting</tag>
      
      <tag>ASD</tag>
      
      <tag>MY PROJECT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.11.09 AO3 WINCEST FANFIC TAG DATA ANALYSIS</title>
    <link href="/2021/11/09/20211109_AO3_WINCEST_FANFIC_TAG_DATA_ANALYSIS/"/>
    <url>/2021/11/09/20211109_AO3_WINCEST_FANFIC_TAG_DATA_ANALYSIS/</url>
    
    <content type="html"><![CDATA[<h1 id="20211109-AO3-WINCEST-FANFIC-TAG-DATA-ANALYSIS"><a href="#20211109-AO3-WINCEST-FANFIC-TAG-DATA-ANALYSIS" class="headerlink" title="20211109 AO3 WINCEST FANFIC TAG DATA ANALYSIS"></a>20211109 AO3 WINCEST FANFIC TAG DATA ANALYSIS</h1><h2 id="1-统计检验-相关性"><a href="#1-统计检验-相关性" class="headerlink" title="1. 统计检验-相关性"></a>1. 统计检验-相关性</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs R">wincest_bottom_dean_winchester &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">30</span>,<span class="hljs-number">134</span>,<span class="hljs-number">265</span>,<span class="hljs-number">291</span>,<span class="hljs-number">266</span>,<span class="hljs-number">260</span>,<span class="hljs-number">172</span>,<span class="hljs-number">228</span>,<span class="hljs-number">274</span>)<br>wincest_bottom_sam_winchester &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">13</span>,<span class="hljs-number">17</span>,<span class="hljs-number">88</span>,<span class="hljs-number">57</span>,<span class="hljs-number">62</span>,<span class="hljs-number">155</span>,<span class="hljs-number">153</span>,<span class="hljs-number">233</span>)<br>wincest_top_dean_winchester &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-number">4</span>,<span class="hljs-number">20</span>,<span class="hljs-number">107</span>,<span class="hljs-number">262</span>,<span class="hljs-number">321</span>,<span class="hljs-number">233</span>,<span class="hljs-number">176</span>,<span class="hljs-number">256</span>,<span class="hljs-number">186</span>,<span class="hljs-number">263</span>)<br>wincest_top_sam_winchester &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-number">20</span>,<span class="hljs-number">120</span>,<span class="hljs-number">208</span>,<span class="hljs-number">242</span>,<span class="hljs-number">203</span>,<span class="hljs-number">204</span>,<span class="hljs-number">143</span>,<span class="hljs-number">168</span>,<span class="hljs-number">220</span>)<br><br>wilcox.test(wincest_bottom_dean_winchester,wincest_bottom_sam_winchester,exact = <span class="hljs-literal">FALSE</span>)<br><span class="hljs-comment">## Wilcoxon rank sum test with continuity correction</span><br><span class="hljs-comment">## </span><br><span class="hljs-comment">## data:  wincest_bottom_dean_winchester and wincest_bottom_sam_winchester</span><br><span class="hljs-comment">## W = 134, p-value = 0.1028</span><br><span class="hljs-comment">## alternative hypothesis: true location shift is not equal to 0</span><br><br>wilcox.test(wincest_top_dean_winchester,wincest_top_sam_winchester,exact = <span class="hljs-literal">FALSE</span>)<br><span class="hljs-comment">## Wilcoxon rank sum test with continuity correction</span><br><span class="hljs-comment">## </span><br><span class="hljs-comment">## data:  wincest_top_dean_winchester and wincest_top_sam_winchester</span><br><span class="hljs-comment">## W = 112, p-value = 0.5348</span><br><span class="hljs-comment">## alternative hypothesis: true location shift is not equal to 0</span><br><br>fanfic_sd_data &lt;- as.data.frame(cbind(wincest_bottom_dean_winchester,wincest_top_sam_winchester))<br>colnames(fanfic_sd_data)=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;wincest_bottom_dean_winchester&quot;</span>,<span class="hljs-string">&quot;wincest_top_sam_winchester&quot;</span>)<br>head(fanfic_sd_data)<br>library(ggplot2)<br>library(dplyr)<br>cor(wincest_bottom_dean_winchester,wincest_top_sam_winchester,method=<span class="hljs-string">&quot;pearson&quot;</span>)<br><span class="hljs-comment">## [1] 0.9975497</span><br>ggplot(fanfic_sd_data,aes(x=wincest_bottom_dean_winchester,y=wincest_top_sam_winchester))+ geom_point(size=<span class="hljs-number">1</span>,shape=<span class="hljs-number">15</span>)+geom_smooth(method=lm)<br><br>fanfic_ds_data &lt;- as.data.frame(cbind(wincest_top_dean_winchester,wincest_bottom_sam_winchester))<br>colnames(fanfic_ds_data)=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;wincest_top_dean_winchester&quot;</span>,<span class="hljs-string">&quot;wincest_bottom_sam_winchester&quot;</span>)<br>head(fanfic_ds_data)<br>cor(wincest_top_dean_winchester,wincest_bottom_sam_winchester,method=<span class="hljs-string">&quot;pearson&quot;</span>)<br><span class="hljs-comment">## [1] 0.6998077</span><br>ggplot(fanfic_ds_data,aes(x=wincest_top_dean_winchester,y=wincest_bottom_sam_winchester))+ geom_point(size=<span class="hljs-number">1</span>,shape=<span class="hljs-number">15</span>)+geom_smooth(method=lm)<br><span class="hljs-comment">#事实上，考虑到作品发布和时序有关，应该选用spearman检验，而不是pearson检验。</span><br></code></pre></td></tr></table></figure><p><img src="fanfic_ds_data_cor.png" alt="fanfic_ds_data_cor"></p><p><img src="fanfic_sd_data_cor.png" alt="fanfic_sd_data_cor"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs R">fanfic_sd_data &lt;- scale(fanfic_sd_data)<br>cov_spearman &lt;- cov(fanfic_sd_data, method = <span class="hljs-string">&#x27;spearman&#x27;</span>)<br>cov_spearman<br><span class="hljs-comment">##                                wincest_bottom_dean_winchester wincest_top_sam_winchester</span><br><span class="hljs-comment">## wincest_bottom_dean_winchester                       1.000000                   0.972467</span><br><span class="hljs-comment">## wincest_top_sam_winchester                           0.972467                   1.000000</span><br>cor_spearman &lt;- cor(fanfic_sd_data, method = <span class="hljs-string">&#x27;spearman&#x27;</span>)<br>cor_spearman<br><span class="hljs-comment">##                                wincest_bottom_dean_winchester wincest_top_sam_winchester</span><br><span class="hljs-comment">## wincest_bottom_dean_winchester                       17.46154                   16.98077</span><br><span class="hljs-comment">## wincest_top_sam_winchester                           16.98077                   17.46154</span><br><br>fanfic_ds_data &lt;- scale(fanfic_ds_data)<br>cov_spearman &lt;- cov(fanfic_ds_data, method = <span class="hljs-string">&#x27;spearman&#x27;</span>)<br>cov_spearman<br><span class="hljs-comment">##                               wincest_top_dean_winchester wincest_bottom_sam_winchester</span><br><span class="hljs-comment">## wincest_top_dean_winchester                      17.42308                      15.50000</span><br><span class="hljs-comment">## wincest_bottom_sam_winchester                    15.50000                      17.46154</span><br>cor_spearman &lt;- cor(fanfic_ds_data, method = <span class="hljs-string">&#x27;spearman&#x27;</span>)<br>cor_spearman<br><span class="hljs-comment">##                               wincest_top_dean_winchester wincest_bottom_sam_winchester</span><br><span class="hljs-comment">## wincest_top_dean_winchester                     1.0000000                     0.8886444</span><br><span class="hljs-comment">## wincest_bottom_sam_winchester                   0.8886444                     1.0000000</span><br></code></pre></td></tr></table></figure><h2 id="2-2007-2020年wincest作品左右位相关tag数变化"><a href="#2-2007-2020年wincest作品左右位相关tag数变化" class="headerlink" title="2. 2007-2020年wincest作品左右位相关tag数变化"></a>2. 2007-2020年wincest作品左右位相关tag数变化</h2><p>统计结果：</p><div class="table-container"><table><thead><tr><th></th><th>2007</th><th>2008</th><th>2009</th><th>2010</th><th>2011</th><th>2012</th><th>2013</th><th>2014</th><th>2015</th><th>2016</th><th>2017</th><th>2018</th><th>2019</th><th>2020</th></tr></thead><tbody><tr><td>#Top Dean Winchester/Bottom Sam Winchester#</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>2</td><td>31</td><td>18</td><td>13</td><td>70</td><td>70</td><td>107</td></tr><tr><td>#Top Sam Winchester/Bottom Dean Winchester#</td><td>0</td><td>2</td><td>0</td><td>0</td><td>0</td><td>3</td><td>3</td><td>33</td><td>30</td><td>33</td><td>43</td><td>63</td><td>75</td><td>104</td></tr><tr><td>Wincest #Bottom Dean Winchester#</td><td>3</td><td>2</td><td>3</td><td>6</td><td>7</td><td>30</td><td>134</td><td>265</td><td>291</td><td>266</td><td>260</td><td>172</td><td>228</td><td>274</td></tr><tr><td>Wincest #Bottom Sam Winchester#</td><td>0</td><td>0</td><td>10</td><td>5</td><td>1</td><td>4</td><td>13</td><td>17</td><td>88</td><td>57</td><td>62</td><td>155</td><td>153</td><td>233</td></tr><tr><td>Wincest #Top Dean Winchester#</td><td>0</td><td>0</td><td>10</td><td>10</td><td>4</td><td>20</td><td>107</td><td>262</td><td>321</td><td>233</td><td>176</td><td>256</td><td>186</td><td>263</td></tr><tr><td>Wincest #Top Sam Winchester#</td><td>1</td><td>2</td><td>2</td><td>5</td><td>4</td><td>20</td><td>120</td><td>208</td><td>242</td><td>203</td><td>204</td><td>143</td><td>168</td><td>220</td></tr></tbody></table></div><p>可视化：</p><p><a href="https://public.flourish.studio/visualisation/7766073/">Flourish bar chart race visualising</a></p>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>AO3</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AO3 data scraping and visualising</title>
    <link href="/2021/11/08/20211108ao3_data_scraping&amp;visualising/"/>
    <url>/2021/11/08/20211108ao3_data_scraping&amp;visualising/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-11-08-AO3-data-scraping-and-visualising"><a href="#2021-11-08-AO3-data-scraping-and-visualising" class="headerlink" title="2021-11-08: AO3 data scraping and visualising"></a>2021-11-08: AO3 data scraping and visualising</h1><p>Access date: 2021-11-03</p><p><a href="https://github.com/radiolarian/AO3Scraper">scraping API (python)</a></p><p><a href="https://drive.google.com/drive/folders/1UUJwPtN7pZlpKXOautc8qhKkKfqLhvq4?usp=sharing">Google drive</a></p><h2 id="1-get-access-to-ao3-work-ids"><a href="#1-get-access-to-ao3-work-ids" class="headerlink" title="1. get access to ao3 work ids"></a>1. get access to ao3 work ids</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ao3_work_ids.py <span class="hljs-string">&quot;url&quot;</span> --out_csv wincest_bottomd.csv<br></code></pre></td></tr></table></figure><blockquote><p>url: <a href="https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Bottom+Dean+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural">https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Bottom+Dean+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural</a><br>num_requested_fic: 2206<br>retreived on: 2021-11-03 17:06:29.160746</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ao3_work_ids.py <span class="hljs-string">&quot;url&quot;</span> --out_csv wincest_bottoms.csv<br></code></pre></td></tr></table></figure><blockquote><p>url: <a href="https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Bottom+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural">https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Bottom+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural</a><br>num_requested_fic: 1045<br>retreived on: 2021-11-03 16:32:33.772992</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ao3_work_ids.py <span class="hljs-string">&quot;url&quot;</span> --out_csv wincest_ds.csv<br></code></pre></td></tr></table></figure><blockquote><p>url: <a href="https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Top+Dean+Winchester%2FBottom+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural">https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Top+Dean+Winchester%2FBottom+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural</a><br>num_requested_fic: 465<br>retreived on: 2021-11-03 16:40:31.729596</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ao3_work_ids.py <span class="hljs-string">&quot;url&quot;</span> --out_csv wincest_sd.csv<br></code></pre></td></tr></table></figure><blockquote><p>url: <a href="https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Bottom+Dean+Winchester%2FTop+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural">https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Bottom+Dean+Winchester%2FTop+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural</a><br>num_requested_fic: 509<br>retreived on: 2021-11-03 18:24:05.750942</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ao3_work_ids.py <span class="hljs-string">&quot;url&quot;</span> --out_csv wincest_topd.csv<br></code></pre></td></tr></table></figure><blockquote><p>url: <a href="https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Top+Dean+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural">https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Top+Dean+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural</a><br>num_requested_fic: 2102<br>retreived on: 2021-11-03 16:01:01.307065</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ao3_work_ids.py <span class="hljs-string">&quot;url&quot;</span> --out_csv wincest_tops.csv<br></code></pre></td></tr></table></figure><blockquote><p>url: <a href="https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Top+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural">https://archiveofourown.org/works?utf8=%E2%9C%93&amp;work_search%5Bsort_column%5D=revised_at&amp;include_work_search%5Brelationship_ids%5D%5B%5D=35&amp;work_search%5Bother_tag_names%5D=Top+Sam+Winchester&amp;work_search%5Bexcluded_tag_names%5D=&amp;work_search%5Bcrossover%5D=&amp;work_search%5Bcomplete%5D=&amp;work_search%5Bwords_from%5D=&amp;work_search%5Bwords_to%5D=&amp;work_search%5Bdate_from%5D=&amp;work_search%5Bdate_to%5D=&amp;work_search%5Bquery%5D=&amp;work_search%5Blanguage_id%5D=&amp;commit=Sort+and+Filter&amp;tag_id=Supernatural</a><br>num_requested_fic: 1776<br>retreived on: 2021-11-03 18:12:29.245470</p></blockquote><h2 id="2-get-the-fics"><a href="#2-get-the-fics" class="headerlink" title="2. get the fics"></a>2. get the fics</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python ao3_get_fanfics.py wincest.csv --csv wincest_fanfic.csv<br></code></pre></td></tr></table></figure><ol><li>Generating fics-rating bar chart race by Flourish</li></ol><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs R">wincest_bottomd_fanfic &lt;- read.csv(<span class="hljs-string">&quot;wincest_bottomd_fanfic.csv&quot;</span>)<br><span class="hljs-built_in">min</span>(wincest_bottomd_fanfic$published)<br><span class="hljs-comment">#2007</span><br><span class="hljs-built_in">max</span>(wincest_bottomd_fanfic$published)<br><span class="hljs-comment">#2021</span><br><br>Explicit &lt;- wincest_bottomd_fanfic[which(wincest_bottomd_fanfic$rating == <span class="hljs-string">&quot;Explicit&quot;</span>),]<br>Mature &lt;- wincest_bottomd_fanfic[which(wincest_bottomd_fanfic$rating == <span class="hljs-string">&quot;Mature&quot;</span>), ]<br><br><span class="hljs-comment"># as same as Explicit</span><br>startday2007 &lt;- <span class="hljs-string">&quot;2007-01-01&quot;</span><br>endday2007 &lt;- <span class="hljs-string">&quot;2007-12-31&quot;</span><br>Mature_2007 &lt;- Mature[which(Mature$published &gt;= startday2007 &amp; Mature$published &lt;= endday2007), ]<br><br>startday2008 &lt;- <span class="hljs-string">&quot;2008-01-01&quot;</span><br>endday2008 &lt;- <span class="hljs-string">&quot;2008-12-31&quot;</span><br>Mature_2008 &lt;- Mature[which(Mature$published &gt;= startday2008 &amp; Mature$published &lt;= endday2008), ]<br><br>startday2009 &lt;- <span class="hljs-string">&quot;2009-01-01&quot;</span><br>endday2009 &lt;- <span class="hljs-string">&quot;2009-12-31&quot;</span><br>Mature_2009 &lt;- Mature[which(Mature$published &gt;= startday2009 &amp; Mature$published &lt;= endday2009), ]<br><br>startday2010 &lt;- <span class="hljs-string">&quot;2010-01-01&quot;</span><br>endday2010 &lt;- <span class="hljs-string">&quot;2010-12-31&quot;</span><br>Mature_2010 &lt;- Mature[which(Mature$published &gt;= startday2010 &amp; Mature$published &lt;= endday2010), ]<br><br>startday2011 &lt;- <span class="hljs-string">&quot;2011-01-01&quot;</span><br>endday2011 &lt;- <span class="hljs-string">&quot;2011-12-31&quot;</span><br>Mature_2011 &lt;- Mature[which(Mature$published &gt;= startday2011 &amp; Mature$published &lt;= endday2011), ]<br><br>startday2012 &lt;- <span class="hljs-string">&quot;2012-01-01&quot;</span><br>endday2012 &lt;- <span class="hljs-string">&quot;2012-12-31&quot;</span><br>Mature_2012 &lt;- Mature[which(Mature$published &gt;= startday2012 &amp; Mature$published &lt;= endday2012), ]<br><br>startday2013 &lt;- <span class="hljs-string">&quot;2013-01-01&quot;</span><br>endday2013 &lt;- <span class="hljs-string">&quot;2013-12-31&quot;</span><br>Mature_2013 &lt;- Mature[which(Mature$published &gt;= startday2013 &amp; Mature$published &lt;= endday2013), ]<br><br>startday2014 &lt;- <span class="hljs-string">&quot;2014-01-01&quot;</span><br>endday2014 &lt;- <span class="hljs-string">&quot;2014-12-31&quot;</span><br>Mature_2014 &lt;- Mature[which(Mature$published &gt;= startday2014 &amp; Mature$published &lt;= endday2014), ]<br><br>startday2015 &lt;- <span class="hljs-string">&quot;2015-01-01&quot;</span><br>endday2015 &lt;- <span class="hljs-string">&quot;2015-12-31&quot;</span><br>Mature_2015 &lt;- Mature[which(Mature$published &gt;= startday2015 &amp; Mature$published &lt;= endday2015), ]<br><br>startday2016 &lt;- <span class="hljs-string">&quot;2016-01-01&quot;</span><br>endday2016 &lt;- <span class="hljs-string">&quot;2016-12-31&quot;</span><br>Mature_2016 &lt;- Mature[which(Mature$published &gt;= startday2016 &amp; Mature$published &lt;= endday2016), ]<br><br>startday2017 &lt;- <span class="hljs-string">&quot;2017-01-01&quot;</span><br>endday2017 &lt;- <span class="hljs-string">&quot;2017-12-31&quot;</span><br>Mature_2017 &lt;- Mature[which(Mature$published &gt;= startday2017 &amp; Mature$published &lt;= endday2017), ]<br><br>startday2018 &lt;- <span class="hljs-string">&quot;2018-01-01&quot;</span><br>endday2018 &lt;- <span class="hljs-string">&quot;2018-12-31&quot;</span><br>Explicit_2018 &lt;- Explicit[which(Explicit$published &gt;= startday2018 &amp; Explicit$published &lt;= endday2018), ]<br><br>startday2019 &lt;- <span class="hljs-string">&quot;2019-01-01&quot;</span><br>endday2019 &lt;- <span class="hljs-string">&quot;2019-12-31&quot;</span><br>Mature_2019 &lt;- Mature[which(Mature$published &gt;= startday2019 &amp; Mature$published &lt;= endday2019), ]<br><br>startday2020 &lt;- <span class="hljs-string">&quot;2020-01-01&quot;</span><br>endday2020 &lt;- <span class="hljs-string">&quot;2020-12-31&quot;</span><br>Mature_2020 &lt;- Mature[which(Mature$published &gt;= startday2020 &amp; Mature$published &lt;= endday2020), ]<br></code></pre></td></tr></table></figure><p> now manually generating csv.file in excel</p><p>it should look like:</p><div class="table-container"><table><thead><tr><th>Year</th><th>2007</th><th>2008</th><th>2009</th><th>2010</th><th>2011</th><th>2012</th><th>2013</th><th>2014</th><th>2015</th><th>2016</th><th>2017</th><th>2018</th><th>2019</th><th>2020</th></tr></thead><tbody><tr><td>Explicit</td><td>3</td><td>2</td><td>1</td><td>3</td><td>3</td><td>22</td><td>112</td><td>197</td><td>237</td><td>204</td><td>188</td><td>130</td><td>167</td><td>204</td></tr><tr><td>Mature</td><td>0</td><td>0</td><td>2</td><td>4</td><td>3</td><td>9</td><td>22</td><td>46</td><td>39</td><td>38</td><td>48</td><td>20</td><td>29</td><td>48</td></tr></tbody></table></div><p><a href="https://public.flourish.studio/visualisation/7761199/">Flourish bar chart race visualising</a></p><h2 id="4-genrating-additional-tags-wordcloud"><a href="#4-genrating-additional-tags-wordcloud" class="headerlink" title="4. genrating additional tags wordcloud"></a>4. genrating additional tags wordcloud</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs R">library(tm)<br>library(wordcloud)<br>library(RColorBrewer)<br>library(wordcloud2)<br>library(<span class="hljs-string">&quot;corpus&quot;</span>)<br>library(<span class="hljs-string">&quot;textreadr&quot;</span>)<br><br>wincest_bottomd_fanfic_tags &lt;- read_doc(<span class="hljs-string">&quot;bottomd_tags.doc&quot;</span>, skip = <span class="hljs-number">0</span>, remove.empty = <span class="hljs-literal">TRUE</span>, trim = <span class="hljs-literal">TRUE</span>, format = <span class="hljs-literal">FALSE</span>)<br><span class="hljs-built_in">class</span>(wincest_bottomd_fanfic_tags)<br><span class="hljs-comment"># large charactar</span><br>wincest_bottomd_fanfic_tags_corpus &lt;- Corpus(VectorSource(wincest_bottomd_fanfic_tags)) <span class="hljs-comment">#Create a corpus </span><br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, removeNumbers) <span class="hljs-comment">#filtering</span><br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, removePunctuation)<br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, stripWhitespace)<br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, content_transformer(tolower))<br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, removeWords, stopwords(<span class="hljs-string">&quot;english&quot;</span>))<br><br>toSpace &lt;- content_transformer(<span class="hljs-keyword">function</span>(x, pattern) gsub(pattern, <span class="hljs-string">&quot; &quot;</span>, x)) <span class="hljs-comment">#filtering specific words</span><br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, toSpace, <span class="hljs-string">&quot;winchester dean&quot;</span>)<br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, toSpace, <span class="hljs-string">&quot;dean&quot;</span>)<br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, toSpace, <span class="hljs-string">&quot;sam&quot;</span>)<br>wincest_bottomd_fanfic_tags_corpus &lt;- tm_map(wincest_bottomd_fanfic_tags_corpus, toSpace, <span class="hljs-string">&quot;castiel&quot;</span>)<br><br>dtm &lt;- TermDocumentMatrix(wincest_bottomd_fanfic_tags_corpus) <br>matrix &lt;- as.matrix(dtm) <br>words &lt;- sort(rowSums(matrix),decreasing=<span class="hljs-literal">TRUE</span>) <br>df &lt;- data.frame(word = <span class="hljs-built_in">names</span>(words),freq=words)<br><br>set.seed(<span class="hljs-number">1234</span>) <span class="hljs-comment"># for reproducibility </span><br>wordcloud(words = df$word, freq = df$freq, min.freq = <span class="hljs-number">1</span>,           max.words=<span class="hljs-number">200</span>, random.order=<span class="hljs-literal">FALSE</span>, rot.per=<span class="hljs-number">0.35</span>,            colors=brewer.pal(<span class="hljs-number">8</span>, <span class="hljs-string">&quot;Dark2&quot;</span>))<br></code></pre></td></tr></table></figure><p><img src="without_filtering.png" alt="without filtering"></p><p><img src="filtered.png" alt="filtered"></p><h2 id="5-Try-to-generate-fanfic-body-wordcloud-but-failed"><a href="#5-Try-to-generate-fanfic-body-wordcloud-but-failed" class="headerlink" title="5. Try to generate fanfic body wordcloud (but failed)"></a>5. Try to generate fanfic body wordcloud (but failed)</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs R">wincest_bottomd_fanfic_body &lt;- readLines(<span class="hljs-string">&quot;bottomd_body.txt&quot;</span>)<br><span class="hljs-comment"># large charactar</span><br>wincest_bottomd_fanfic_body_corpus &lt;- Corpus(VectorSource(wincest_bottomd_fanfic_body)) <span class="hljs-comment">#Create a corpus </span><br>wincest_bottomd_fanfic_body_corpus &lt;- tm_map(wincest_bottomd_fanfic_body_corpus, removeNumbers)<br>wincest_bottomd_fanfic_body_corpus &lt;- tm_map(wincest_bottomd_fanfic_body_corpus, removePunctuation)<br>wincest_bottomd_fanfic_body_corpus &lt;- tm_map(wincest_bottomd_fanfic_body_corpus, stripWhitespace)<br>wincest_bottomd_fanfic_body_corpus &lt;- tm_map(wincest_bottomd_fanfic_body_corpus, content_transformer(tolower))<br>wincest_bottomd_fanfic_body_corpus &lt;- tm_map(wincest_bottomd_fanfic_body_corpus, removeWords, stopwords(<span class="hljs-string">&quot;english&quot;</span>))<br><br>dtm &lt;- TermDocumentMatrix(wincest_bottomd_fanfic_body_corpus) <br>View(dtm)<br><span class="hljs-built_in">class</span>(dtm)<br><span class="hljs-comment"># [1] &quot;TermDocumentMatrix&quot;    &quot;simple_triplet_matrix&quot;</span><br><br>matrix &lt;- as.matrix(dtm) <br><span class="hljs-comment"># 错误: 矢量内存用完了(达到了极限?)</span><br>words &lt;- sort(rowSums(matrix),decreasing=<span class="hljs-literal">TRUE</span>) <br><span class="hljs-comment"># Error in rowSums(matrix) : &#x27;x&#x27;必需是阵列，而且至少得有两个维度</span><br>df &lt;- data.frame(word = <span class="hljs-built_in">names</span>(words),freq=words)<br><span class="hljs-comment"># Error in as.data.frame.default(x[[i]], optional = TRUE) : </span><br><span class="hljs-comment"># cannot coerce class ‘&quot;function&quot;’ to a data.frame</span><br>set.seed(<span class="hljs-number">1234</span>) <span class="hljs-comment"># for reproducibility </span><br>wordcloud(words = df$word, freq = df$freq, min.freq = <span class="hljs-number">1</span>,           max.words=<span class="hljs-number">200</span>, random.order=<span class="hljs-literal">FALSE</span>, rot.per=<span class="hljs-number">0.35</span>,            colors=brewer.pal(<span class="hljs-number">8</span>, <span class="hljs-string">&quot;Dark2&quot;</span>))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>AO3</tag>
      
      <tag>data scraping</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.11.04 和导师talk记录</title>
    <link href="/2021/11/04/20211105%E5%90%91%E8%80%81%E6%9D%BF%E9%87%8D%E6%96%B0%E6%B1%87%E6%8A%A5%E5%86%85%E5%AE%B9/"/>
    <url>/2021/11/04/20211105%E5%90%91%E8%80%81%E6%9D%BF%E9%87%8D%E6%96%B0%E6%B1%87%E6%8A%A5%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-11-04-REPORT"><a href="#2021-11-04-REPORT" class="headerlink" title="2021-11-04 REPORT"></a>2021-11-04 REPORT</h1><h2 id="X染色体"><a href="#X染色体" class="headerlink" title="X染色体"></a>X染色体</h2><p><img src="https://onlinelibrary.wiley.com/cms/asset/4c424bf7-db0d-485f-afb2-c4b4cd58eb8f/gepi21782-fig-0001-m.png" alt="image"></p><blockquote><p>包含性染色体处理的GWAS理想流程</p></blockquote><p>实际实施过程中存在的问题：</p><ol><li><p>抽样过程中的男女性别比例控制</p><blockquote><p>实验组和control组性别比例差异，可能导致第一类错误</p></blockquote></li><li><p>基因分型芯片的选择</p><blockquote><p>在考虑性染色体的GWAS研究中，X染色体在不同类型芯片上的覆盖率很重要。一般来说，可以通过与染色体物理长度相关的单核苷酸多态性(SNPs)的数量来估计染色体的覆盖率。虽然X染色体的长度约占整个人类基因组的5% ，但在常用的基因分型平芯片上，X染色体SNP的覆盖率分别为：2.0% (GeneChip Human Mapping 500K Array Set by Affymetrix) ，2.6% (HumanOmni5-Quad BeadChip by Illumina)到3.5% (Genome-Wide Human SNP Array 6.0 by Affymetrix)。</p><p>而且，在1KG计划中鉴定的X染色体上SNP的比例也仅有4%左右。</p></blockquote></li><li><p>QC过程中，在X染色体上丢失的 SNPs 比例比在常染色体上丢失的多。因此，就质量控制的结果而言，X染色体的数据质量比常染色体低。</p></li></ol><p>不过，总体来说，特殊的遗传情况可以通过合理选择调用、归因和关联算法来处理。虽然需要承认没有单一的最佳分析方法，但因此在分析中包括X染色体变体是可控的。</p><blockquote><p>在将X染色体默认纳入GWAS的努力中，一个重要的障碍是: 目前不能简单地将x染色体与常染色体分析一起运行。对于基因型的调用，应该考虑男性和女性的不同模型。同样，对于X染色体的归因，需要设置额外的参数。</p><p>尽管统计技术应当是可实现的，但X染色体上的关联分析工具很少在典型的软件包中实现，如PLINK和SNPTEST。</p><blockquote><p>在PLINK中，实现了没有失活的加性模型的测试，在SNPTEST中，一些测试在新的测试版程序中实现了，但没有描述这些是如何计算的。</p><p>因此，大多数有关X染色体的计算需要单独实现。</p></blockquote><p>不过，通过选择合理的算法和参数设置，将X染色体纳入GWAS应当是可以实现的。</p></blockquote><h2 id="GWAS-summary-statistics"><a href="#GWAS-summary-statistics" class="headerlink" title="GWAS summary statistics"></a>GWAS summary statistics</h2><p>一般包含以下内容：</p><div class="table-container"><table><thead><tr><th>列标</th><th>缩写</th><th>描述</th><th>例子</th></tr></thead><tbody><tr><td>chromosome/染色体</td><td>CHR</td><td>突变所在的染色体</td><td>8</td></tr><tr><td>variant_id/突变ID</td><td>SNP</td><td>突变的rs_id</td><td>Rs62513865</td></tr><tr><td>base_pair_location/基对位置</td><td>BP</td><td>突变的基对位置</td><td>101592213</td></tr><tr><td>effect_allele/效应等位基因</td><td>/</td><td>该突变的效应等位基因</td><td>G</td></tr><tr><td>other_allele/其他等位基因</td><td>/</td><td>无效等位基因</td><td>A</td></tr><tr><td>effect_allele_frequency/效应等位基因频率</td><td>/</td><td>影响等位基因在对照群体中的频率</td><td>0.998</td></tr><tr><td>odds_ratio/优势比</td><td>OR</td><td>变异/性状关联的优势比</td><td>1.00652</td></tr><tr><td>standard_error/标准误差</td><td>SE</td><td>变异/性状关联的标准错误</td><td>0.0165</td></tr><tr><td>p_value/P值</td><td>P</td><td>变异/性状关联的 p 值</td><td>0.808600</td></tr></tbody></table></div><h2 id="PASCAL算法"><a href="#PASCAL算法" class="headerlink" title="PASCAL算法"></a>PASCAL算法</h2><p>Pascal（通路评分算法）\parencite{lamparter2016fast}是一个易于使用的工具，用于从GWAS结果中进行基因评分和通路分析。Pascal使用外部数据来估计连锁不平衡性。因此，用户只需要提供基因组范围的SNP p值。然后，Pascal得出基因和预定义路径的p值。Pascal不使用蒙特卡洛模拟来推导基因的p值。这导致了速度和准确性的提高。这种基因评分的速度可以用来控制路径评分的假阳性率。对于路径评分，PASCAL实施并测试了富集策略，与超几何富集相比，非常有利。这种比较是在大量的GWAS结果的基础上进行的，使我们有信心推荐Pascal用于GWAS结果的下游分析。Pascal主要是用Java编写的，已经在Unix系统和Mac OsX上进行了测试。</p><p>pascal计算包中即包含1KG-EUR的数据用于计算连锁不平衡。</p><p><img src="https://www2.unil.ch/cbg/images/thumb/e/e1/PascalFigure1.jpg/500px-PascalFigure1.jpg" alt="PascalFigure1.jpg"></p><blockquote><p>【计算基因和通路分数的方法概述】</p><p>(a) PASCAL通过汇总GWAS荟萃分析中的SNP p值来计算基因分数（因此不需要单个基因型），同时利用外部数据校正连锁不平衡（LD）结构。计算方案如下：在给定参考群体的LD信息的情况下，有效而准确地计算基因P值。因此，有两种方案可供选择：最大和卡方统计，它们分别基于最显著的SNP和整个区域的平均关联信号。</p><p>(b) PASCAL使用外部数据库为每个输出的途径定义基因集。然后，PASCAL通过合并属于相同途径的基因，即基因集的得分来计算途径得分。快速基因评分法使PASCAL能够动态地重新计算基因分数，方法是将处于LD中的、因而不能独立处理的各途径基因的SNP p值汇总。这相当于融合基因并计算一个新的分数，将相应基因座的全部LD结构考虑在内。PASCAL使用两种无参数程序之一（卡方或经验分数）评估高分（可能融合）基因的通路富集，避免了标准二元富集测试所固有的p值截止。</p></blockquote><p><img src="https://www2.unil.ch/cbg/images/thumb/c/c5/Pascal_network_analysis.png/260px-Pascal_network_analysis.png" alt="Pascal network analysis.png"></p><blockquote><p>【pascal网络分析（实例）】</p><p>Pascal的效率和准确性为大规模的分析打开了大门，因为在大多数基于网络的GWAS分析方法中，总结基因层面的SNP p值是一个关键步骤。Pascal是这项工作的关键，开发者整合了37个GWAS数据集和近400个组织特异性基因调控回路，系统地分析了受性状相关基因变异干扰的基因的相互联系。这项研究表明，疾病相关的遗传变异往往会扰乱细胞类型或组织中的调控模块，而这些调控模块对该疾病具有高度的特异性，从而对疾病机制有了新的认识。</p></blockquote><h3 id="PASCAL的基本介绍"><a href="#PASCAL的基本介绍" class="headerlink" title="PASCAL的基本介绍"></a><strong>PASCAL的基本介绍</strong></h3><blockquote><p>全基因组关联研究（GWAS）通常产生与性状或疾病相关的SNPs列表。然而，这样的输出结果几乎没有揭示潜在的分子机制，需要有工具从SNP水平的结果中提取生物学洞察力。路径分析工具整合了来自基因组不同位置的多个SNPs的信号，以便将相关的基因组区域映射到已确立的路径上，即已知的协同作用的基因集。</p><p>路径分析的目的是通过将观察到的SNP集合的关联信号汇总为路径水平的信号来提供对相关生物过程的洞察力。这通常分两步进行：首先，单个SNPs被映射到基因上，它们的关联P值被合并为基因分数；其次，基因被分组为路径，它们的基因分数被合并为路径分数。现有的工具在每个步骤所使用的方法以及为纠正由于连锁不平衡引起的相关性而采用的策略上有所不同。</p><p>SNPs通常根据物理距离、连锁不平衡（LD）或两者的结合被映射到基因。基因通常被分配到使用成熟的数据库（如基因本体论、KEGG、PANTHER、REACTOME、BIOCARTA）或内部注释（例如，基于共表达）的路径。</p><p>现在已经开发了各种方法，将SNP的汇总统计数字汇总到基因分数中。一个常见的汇总方法是只使用包括感兴趣的基因在内的窗口内最有意义的SNP，例如通过指定最大齐次方（MOCS）作为基因评分统计量（贡献齐次方值可以通过使用反齐次方量化转换从SNP p值中获得）。另一种方法是结合基因区域内所有SNP的结果，例如使用秩和（SOCS）统计法。MOCS和SOCS统计都会受到基因的几个特性的干扰。具体来说，在这两种情况下，必须对基因大小和 LD 结构进行校正，以获得一个良好校准的统计量的 P 值。在本文的其余部分，我们也将MOCS和SOCS统计的P值分别称为最大基因分数和总基因分数。P值可以通过表型标签互换来估计，但这种方法既需要计算，又需要获得实际研究的基因型数据，而这些数据很少被共享。因此，人们往往只能获得关联的汇总统计，而不能获得单个基因型。在这种情况下，一种方法是回归出混杂因素。这种方法在流行的MAGENTA工具中被采用，但只提供了部分解决方案，因为大量的残余混杂因素仍然存在。</p><p>在此采取的另一种方法是，利用MOCS和SOCS统计量的无效分布只取决于贡献基因型的成对相关矩阵这一事实。在没有原始基因型的情况下，这个相关矩阵仍然可以从种族匹配的、公开的基因型数据中估计出来，正如和其他人提出的用于GWAS结果的条件性多SNP分析。这种方法已经在Versatile Gene-based Association Study (VEGAS)软件中实现，产生的结果接近于表型标签互换的结果。然而，虽然VEGAS比通过表型标签互换估计的速度快，但它仍然依赖蒙特卡洛方法来估计P值。这就限制了它对高度显著的基因分数的效率。</p><p>一旦基因分数被计算出来，路径分析工具就会使用各种策略在相关基因组之间进行汇总。最常见的用于分析GWAS元分析结果的方法，如流行的GWAS途径分析工具MAGENTA，是基于二元富集度测试，它依靠一个阈值参数来定义哪些基因与性状显著相关。然而，在这种策略下，刚刚错过阈值的弱相关基因的潜在贡献就会丧失，而且对于如何设置阈值参数也没有明确的指导。事实上，在不知道其他选择是否会产生更好的结果的情况下，保持默认参数似乎是一种常见的做法。</p><p>在这项工作中，PASCAL开发者着重于改进路径富集分析的两个主要方面。首先，研究者为MOCS和SOCS统计的P值估计纳入了数字和分析解决方案。这消除了对表型排列或蒙特卡洛模拟的需要，从而使分数计算更快。第二，研究者开发了严格的I型错误控制策略，并实施了改良的Fisher方法来计算无参数的通路得分[19]。虽然算法的某些元素已经在统计遗传学的其他领域提出，但这一方法的新颖性在于将复杂的分析方法独特地结合在一起用于路径分析，从而提高了计算速度、精度、I型误差控制和功率。</p><blockquote><h3 id="PASCAL的优点"><a href="#PASCAL的优点" class="headerlink" title="PASCAL的优点"></a>PASCAL的优点</h3><ol><li><p>速度快。与VEGAS相比，PASCAL的计算速度大大加快了，所需的时间大幅缩短。对于HapMap估算的数据，VEGAS花了29小时计算18132个基因分数，在单核计算机上运行的PASCAL只花了大约30分钟。对于1KG的输入数据，PASCAL在两个小时内完成了任意一个统计量的计算，而VEGAS则需要10多天。</p></li><li><p>和经典基因分数评分算法有很好的一致性。Pascal和VEGAS的基因分数之间有很好的一致性，但低于$10^{-6}$的基因分数除外（因为将VEGAS限制在108次蒙特卡洛运行，它不能以良好的精度估计小于$10^{-6}$的p值）。相比之下，Pascal可以在p值低至$10^{-15}$的情况下，以较高的精度计算基因得分。总之，Pascal算法中的分析方案在效率和精度方面都有很大的提高。直接比较Pascal的总分和最大基因分数，发现两种评分方法之间有很好的一致性。在两种方法的结果不一致的情况下，最大分值往往更有意义。</p></li><li><p>PASCAL能够控制由于邻近基因引起的膨胀</p><p> 一般来说，从基因分数计算路径分数的方法都假定这些分数在无效假设下是独立的。然而，相邻的基因由于LD的关系往往有相关的分数，而且有时是同一pathway的一部分。这就导致了在无效假设下的路径得分P值分布不均匀。MAGENTA处理这个问题的方法是根据LD修剪基因分数，只使用该区域的最高基因分数。但是，这在计算路径得分时，会对高基因得分产生偏差。</p><p> PASCAL的快速基因分数计算方法允许用基因融合的策略来解决这个问题。简而言之，对于每条孕育着相关基因的途径，使用与单个基因相同的方法对每个相关基因组（即融合基因）重新计算基因得分，从而将相应区域的全部LD结构考虑在内。</p></li><li><p>相对于超几何通路富集检验，PASCAL的灵敏度和特异度都更高。</p><p> 从基因（或SNP）的排序列表中得出路径分数的常用统计方法是，首先应用一个固定的阈值，以定义一个被认为与给定性状显著相关的元素子集。然后用一个超几何测试来计算路径统计，评估该路径是否包含比预期更多的重要元素。例如，MAGENTA工具中就采用了这种方法。另一个常见的策略是使用秩和（Wilcoxon）检验。</p></li><li><p>在路径的丰富程度上，相对于基于超几何测验的路径，PASCAL具有更高的效率</p><p> 帕斯卡发现了许多生物学上可能的通路，但是标准的二元富集分析没有发现。</p></li></ol></blockquote><h3 id="PASCAL计算原理"><a href="#PASCAL计算原理" class="headerlink" title="PASCAL计算原理"></a><strong>PASCAL计算原理</strong></h3><ol><li><p>gene score</p><blockquote><p>Pascal基因评分方法包括以下步骤：首先，如果SNPs位于基因体周围的特定窗口内，就将这个SNP分配给基因。PASCAL的开发者使用了从基因向上和向下延伸50kb的窗口。由于需要一个参考群体来估计SNP关联值的Z-cores之间的相关结构，开发者使用了1000基因组计划（1KG）的欧洲人群，这使得研究者可以将自定义方法灵活地应用于来自不同板块（HapMap、1KG估算、metaboChip或ImmunoChip）的汇总统计。</p><p>0假设：（在无效假设下，可以证明我们基因区的n个SNPs的Z-cores为多变量正态。）</p><blockquote><p>$z \sim N_n(0,\Sigma) $</p></blockquote><p>$\Sigma$是成对的SNP-by-SNP的协变量矩阵</p><p>在这里，定义基础统计量：SOCS($T_{sum}$) 和 MOCS($T_{max}$) 为：</p><blockquote><p>$T_{sum} = \sum_{i=1}^n z_i^2$</p><p>$T_{max} = max(z_i^2)$</p></blockquote><p>可以分别证明，$T_{sum}$ 是按照 $\chi_1^2$分布的随机变量的加权和分布的。</p><p>$T_{sum} \sim \sum_i\lambda_i\chi_1^2$</p><p>其中$\lambda_i$是$\Sigma$的第i个特征值。它的分布函数可以用数字来评估。为了估计$T_{max}$的无效分布，我们利用了以下事实:</p><blockquote><p>$P[T_{max} \geq t]  = P[max(|z_i|) \geq t] = 1 - P(|z_i| &lt; t, i = 1,2,…n)$ </p></blockquote><p>这相当于对多变量正态进行矩形积分，对此有一个有效的算法。目前这种积分的实现适合于估计大于$10^{-15}$的p值。为了估算低于这个限度的基因P值，我们将该区域SNP的最小P值与该基因内的有效测试数相乘（见基因分数计算的算法细节）。</p></blockquote></li><li><p>gene fusion</p><blockquote><p>路径分析方法通常假设用于定义路径富集的基因分数是独立的。然而，功能相关的基因经常在基因组上聚集，并且在LD中藏有SNP，导致相关的基因分数违反这一假设。为了规避这个问题，我们为一个给定的途径检查其在染色体上物理上接近的任何基因是否在LD中。如果是的话，在计算通路得分时，我们考虑由该基因簇的所有SNP组成的单一实体（所谓的融合基因）。然后，我们用这个融合基因来替换基因簇中的基因，并计算其基因得分，但只用于计算这一特定途径的得分。然后根据独立通路基因和融合基因的P值计算出通路得分，融合基因整合了依赖通路基因的关联信号。通过这种方式，相邻的通路基因的LD结构被考虑在内。我们的基因评分方法有利于这种方法，因为它对于重新计算所有融合基因的分数具有足够的速度和可扩展性。</p></blockquote></li><li><p>pathway scores</p><blockquote><p>对于路径分析，我们提出了一种无参数的富集策略，不需要指定基因得分阈值，因此允许弱关联基因对路径富集作出贡献。一般的方法包括三个步骤。(1)对基因分数进行转换，使其遵循目标分布；(2)通过对路径成员基因和融合基因的转换分数进行加总，计算出测试统计量；(3)用分析或经验方法评估观察到的测试统计量是否高于预期，即路径中的性状相关基因被富集了。我们考虑了这种途径评分方法的两种变体。第</p><p>一种变体被称为chi-squared方法。</p><ol><li>对基因得分的P值进行排序，使最低的P值得到最高的排序。然后将排名值除以基因数加1，得到均匀分布。</li><li>均匀分布值通过$\chi_1^2$量化函数进行转换，得到$\chi_1^2$分布的基因分数。</li><li>对大小为m的给定途径的$\chi_1^2$基因分数进行加总，并根据$\chi_m^2$分布进行测试。</li></ol><p>第二个变种是经验抽样法。</p><ol><li>基因分数的P值直接用$\chi_1^2$量化函数进行转换，得到新的基因分数$F_{\chi_1^2}^{-1}(1-p)$</li><li>一个大小为m的通路的原始通路得分是通过对所有通路基因的转换后的基因得分进行求和来计算的。</li><li>p值的蒙特卡洛估计是通过随机抽查m大小的基因集，并计算达到比给定途径基因集更高分值的基因集的比例来获得的。</li></ol><p>对于PASCAL的基准测试程序，研究者结合从MsigDB下载的KEGG、REACTOME和BIOCARTA的结果，创建了一个通路库。</p></blockquote></li><li><p>derivation of  the sum-score</p><blockquote><p>把Z视为将表型回归到一个基因区的n个SNPs中的每一个的Z统计量的向量。根据结构，每个Z统计量在空值下的平均值为零。当结果性状和基因型都被标准化时，线性回归的Z-统计量基本上是基因型和表现型向量的标量乘积。换句话说，该区域的每个Z统计量代表了同一组独立、同分布的随机变量的加权平均。可以证明，即两个Z-统计量之间的相关性等于权重之间的相关性，即相应SNP之间的相关性。因此，Z的协方差矩阵只是一对SNP-by-SNP的相关矩阵，用Σ表示。此外，中心极限定理确保在样本量足够大的情况下，Z统计量是正态分布。这些事实加在一起，可以得出——在不存在信号的无效假设下，Z遵循多变量正态分布，即 $z \sim N_n(0,\Sigma)$</p><p>$\Sigma$的特征值分解为： $\Sigma = \Gamma\Lambda\Gamma^T$</p><p>其中Γ和Λ分别是特征向量和特征值的矩阵。将z与Σ的平方根的倒数相乘，会得到一个独立随机变量的向量。让y被定义为:</p><p>$y = \Lambda^{-1/2}\Gamma^Tz$</p><p>然后：</p><p>$y \sim N_n(0,I_n)$</p><p>随后：</p><p>$z^Tz = z^T\Gamma\Gamma^Tz = y^T\Lambda Y \sim \sum_i \lambda_i\chi_1^2$</p><p>其中，$\lambda_i$是$\Sigma$的第i个特征值，代表卡方分布。</p></blockquote></li><li><p>参数设置</p><blockquote><p>如果没有另外说明，PASCAL总是在以下设置下使用：PASCAL将基因区域向上游和下游扩展了50kb用于基因评分。只使用欧洲1KG样本中MAF达到0.05的SNPs。对于路径得分的计算，我们删除了HLA-区域。基因融合参数被设置为1Mb，这样在计算一个特定的通路得分时，所有相距不到1Mb的通路成员基因都被融合起来进行计算。</p></blockquote></li><li><p>路径得分的I型错误控制的模拟设置</p><blockquote><p>使用了EUR-1KG队列中379人的基因型。相应的表型值被模拟为独立的、标准的正态分布变量。使用线性回归计算2,692,429个被测SNPs中每个的单变量Z-cores。模拟重复了100次。由于我们调查了基因融合的影响，LD矩阵是由同一数据集估计的，以避免任何可能来自样本外LD估计的影响。</p></blockquote></li><li><p>基因分数计算的算法细节</p><p> max-score</p><blockquote><p>该算法首先尝试使用蒙特卡洛模拟来推导p值。如果p值太小，无法在几次蒙特卡洛抽签中估计出来，那么该程序就会使用矩形多变量正态积分的算法[41]。所使用的积分算法的实现适合于估计大于$10^{-15}$的p值。此外，由于数值稳定性的考虑，这种实现方式仅限于大小低于1000的相关矩阵。因此，处于非常高的LD（$r^2$&gt;0.98）的SNPs被修剪以降低相关矩阵的大小。如果超过1000个SNPs落入基因，或者基因的p值低于$10^{-15}$，我们通过将基因区域的最小SNP-wise p值乘以有效测试数来近似计算基因得分。有效检测次数是指解释99.5%的总变异所需的最小主成分数。</p></blockquote><p> sum-score</p><blockquote><p>该算法依靠戴维斯算法来计算独立分布的随机变量的加权和的分布函数值。如果出现收敛问题，则使用Farebrother算法作为备份。</p></blockquote><p> web-resource</p><blockquote><p>PASCAL在线执行程序：<a href="http://www2.unil.ch/cbg/index.php?title=Pascal">http://www2.unil.ch/cbg/index.php?title=Pascal</a></p><p>PASCAL源代码：<a href="https://github.com/dlampart/Pascal">https://github.com/dlampart/Pascal</a></p></blockquote></li></ol></blockquote><p>总结来说，PASCAL是一种新型的GBA（gene-based analysis）方法。</p><p>其他常用的GBA方法还有：MAGMA，VEGAS。</p><blockquote><p><strong>MAGMA</strong> \parencite{de2015magma}</p><p>目前有各种基因和基因组分析的方法[7-13]。然而，大多数现有方法的一个问题是，它们首先总结每个标记的关联，然后再将其汇总到基因或基因组。正如Moskvina等人所证明的，这使得统计能力强烈依赖于局部的连锁不平衡（LD），也降低了检测依赖于多个标记的关联的能力。 另一个问题是，目前的基因组分析方法通常使用基于排列组合的方法。这些方法通常在计算上要求很高，而且由于没有使用参数模型，所以往往没有明确评估哪一个无效假设，以及做了哪些假设。这使得确定分析的属性更加困难，如基因组的显著性与其组成基因的显著性之间的关系，或分析是否纠正了多基因结构。这使结果的解释变得复杂，并阻碍了不同基因组分析方法的结果之间的比较。</p><p>为了解决此类问题，研究者开发了MAGMA（Multi-marker Analysis of GenoMic Annotation），这是一个快速灵活的工具，用于GWAS基因型数据的基因和基因组分析。MAGMA的基因分析使用多元回归方法，以适当纳入标记物之间的LD，并检测多标记物效应。基因组分析是围绕该基因分析建立的一个独立层，提供了独立改变和扩展基因和基因组分析的灵活性。自足的和竞争性的基因组分析都是通过基因水平的回归模型实现的。这种回归方法提供了一个通用的框架，它也可以分析连续的基因属性，如基因表达水平，以及基因组和其他基因属性的条件分析，并且可以扩展到允许对多个基因组和其他基因属性进行联合和交互分析。更传统的基因分析模型也得到了实现，以进行比较并提供SNP汇总统计的分析。</p><blockquote><p><strong>模型结构</strong></p><p>MAGMA基因组分析分为两个不同的、基本独立的部分。在第一部分，进行基因分析以量化每个基因与表型的关联程度。此外，还估计了基因之间的相关关系。这些相关性反映了基因之间的LD，在基因组分析中需要补偿基因之间的依赖关系。基因P值和基因相关矩阵随后被用于第二部分，进行实际的基因组分析。</p><p>以这种方式将这两部分分析解耦的好处是，每一部分都可以独立于另一部分进行改变，简化了对模型任何一部分的改变和扩展的开发。此外，由于第二部分只使用第一部分的输出，而不是原始基因型数据，它们不需要在同一时间或地点进行，这使得在同一数据上进行多个基因组分析或在大规模合作中分析多个数据集变得更加直接。</p><p><strong>基因分析</strong></p><p>MAGMA的基因分析是基于一个多线性主成分回归模型，使用F-检验来计算基因的P值。该模型首先将一个基因的SNP矩阵投射到其主成分（PC）上，修剪掉特征值很小的PC，然后在线性回归模型中使用这些PC作为表型的预测因子。这通过去除多余的参数来提高功率，并保证在存在高度串联的SNP时模型是可识别的。默认情况下，SNP数据矩阵中只有0.1%的方差被修剪掉了。</p><blockquote><p>模型：$ Y = \alpha_{0g}\vec{1} + X^*_g\alpha_g + W\beta_g + \varepsilon_g $</p><p>$X^*_g$是PCs矩阵</p><p>$Y$是表型</p><p>$W$是模型的协变量矩阵</p><p>向量$\alpha_g$是遗传效应</p><p>$\beta_g$是可选的协变量效应</p><p>$\alpha_0g$是截距</p><p>$\varepsilon_g$是余向量</p><p>F-test的0假设为：$\alpha_g = \vec0$  即在所有协变量的条件下，基因g对表型Y没有影响。（完全随机设计的单因素方差分析（completely randomized design one-way ANOVA））</p></blockquote><p>这种基因分析模型的选择是出于对统计和实际问题的平衡。这种多元回归模型确保SNP之间的LD被充分考虑。它还提供了灵活性，可以根据需要容纳额外的协变量和交互项而不改变模型。同时，由于F检验有一个已知的渐进抽样分布，基因P值的计算时间非常短，使基因分析比基于互换的替代方法快得多。</p><p>当Y是一个二元表型时，线性回归模型也被应用。虽然这违反了F-检验的一些假设，但将F-检验的p值与基于permutation的F-统计量的p值进行比较表明，F-检验仍然是准确的。因此，MAGMA默认使用渐进式F-检验的P值，尽管它也提供了一个选项，使用自适应的互换程序计算基于互换的P值。此外，与逻辑回归模型的比较表明，线性模型的结果实际上等同于更传统的逻辑回归模型的结果，但没有计算成本。</p><p><strong>基因集合分析</strong></p><p>1.基因组分析</p><p>为了进行基因组分析，对于每个基因g，用上一步基因分析计算出的基因p值pg被转换成Z值 $z_g = \Phi^{-1}(1-p_g) $</p><p>其中 $\Phi^{-1}$ 是probit函数。这就产生了一个大致正态分布的变量Z，其元素 $Z_g$ 反映了每个基因与表型的关联强度，数值越高，对应的关联越强。</p><p>2.Self-contained gene-set analysis</p><p>Self-contained gene-set analysis检验确定基因组中的基因是否与所关注的表型共同相关。因此，使用上述的变量Z，可以为每个基因组s制定一个非常简单的仅有截距的线性回归模型：$Z_s = \beta_0\vec1 + \varepsilon_s$</p><p>其中 $Z_s$  是 Z 的子向量，对应于基因集合s中的基因。评估 $β_0 = 0$ 与备选的 $β_0 &gt; 0$，可以得到一个self-contained test，因为在0假设下，没有一个基因与表型相关，即 $z_g$ 对每个基因g都有一个标准的正常分布。</p><p>3.竞争性基因组分析</p><p>竞争性基因组分析检测一个基因组中的基因是否比其他基因与所关注的表型有更强的关联。为了在回归框架内测试这一点，模型首先被扩展到包括数据中的所有基因。然后定义一个带有元素 $s_g$ 的二元指标变量 $S_s$，对于基因组s中的每个基因g，$s_g=1$，否则为0。把 $S_s$ 作为Z的预测因子，就得到了这个模型: $Z = \beta_0\vec1 + S_s\beta_s + \varepsilon$</p><p>这个模型中的参数 $β_s$ 反映了基因组中的基因和基因组外的基因之间的关联性差异，因此，对零假设 $β_s=0$ 和单边选择 $β_s&gt;0$ 进行检验，可以得到一个竞争性检验。请注意，这相当于单边双样本t检验，即比较基因组基因的平均关联和不在基因组中的基因的平均关联。同样，Self-contained gene-set analysis相当于单边单样本t检验，将基因组基因的平均关联性与0进行比较。</p><p>应该清楚的是，在这个框架中，基因组分析模型是形式更普遍的基因水平回归模型的一个具体实例。在这个广义的基因组分析模型中$Z = \beta_0\vec1 + C_1\beta_1 + C_2\beta_2 + … + \varepsilon $</p><p>变量 $C_1$，$C_2$，…，可以反映任何基因属性，从用于竞争性基因组分析的二进制指标到连续变量，如基因大小和表达水平。这种基因属性的任何转换和相互作用也可以被加入。因此，这种通用的基因组分析模型允许测试基因组和其他基因特性的任何组合的条件效应、联合效应和交互效应。在实践中，MAGMA中实现的竞争性基因组分析实际上默认使用这样一个广义模型，对 $β_s$ 进行条件测试，并对基因大小、基因密度和（如果适用，例如在荟萃分析中）基础样本大小的差异（如果存在这种影响）的潜在混杂效应进行校正。这是通过将这些变量以及这些变量的对数作为协变量添加到基因级回归模型中来实现的。基因密度被定义为有效基因大小与基因中SNP总数之比，而有效基因大小又被定义为剪枝后剩余的主成分数量。</p><p>在这个基因级回归框架中出现的一个复杂情况是，标准线性回归模型假设误差项具有独立的正态分布，即 $\varepsilon \sim MVN(\vec0, \sigma^2I)$</p><p>然而，由于LD，相邻的基因一般会有相关性，违反了这个假设。这个问题可以通过使用广义最小二乘法来解决，并假设$\varepsilon \sim MVN(\vec0, \sigma^2R)$</p><p>在MAGMA中，所需的基因-基因相关矩阵R是通过使用基因分析多元回归模型中每对基因的模型平方和（SSM）之间的相关性来近似计算的，在它们共同的无效假设下，即没有关联。这些相关性是每对基因中SNP之间相关性的函数，因此能很好地反映LD，而且由于它们有一个方便的闭式解，所以很容易计算（见 “补充方法-实施细节”）。请注意，对于自足式分析，只使用与基因组中的基因相对应的子矩阵 $R_s$，而不是R。此外，由于自足式的无效假设保证所有的 $z_g$ 具有标准的正态分布，所以误差方差 $σ^2$ 可以设置为1。</p><p><strong>SNP汇总统计的分析</strong></p><p>由于原始基因型数据可能并不总是可用于分析，MAGMA还提供更传统的SNP-wise基因分析模型，即PLINK和VEGAS中实现的类型。这些SNP-wise模型首先分析一个基因中的单个SNP，并将产生的SNP p值合并为一个基因测试统计，因此即使只有SNP p值可用，也可以使用。尽管评估基因测试统计需要对基因中SNP之间的LD进行估计，但基于与计算SNP p值的数据具有相似血统的参考数据的估计已被证明可以产生准确的结果。</p><p>在MAGMA中实现了两种类型的基因检验统计：一种是基因中SNP的 $\chi^2$ 统计量的平均值，另一种是基因中SNP的顶级 $\chi^2$ 统计量。对于平均 $\chi^2$ 统计量，通过使用已知的抽样分布近似值，可以得到一个基因P值[20,21]。对于顶级 $\chi^2$ 统计量来说，这样的近似值是不可用的，因此要用自适应的置换程序来获得经验基因P值。首先为参考数据生成一个随机表型，从标准正态分布中提取。然后对其进行置换，并对每次置换计算每个基因的顶级 $\chi^2$ 统计量。然后计算一个基因的经验P值，即该基因的permuted top  $\chi^2$ 统计量高于其观察的top  $\chi^2$ 统计量的比例。在分析过程中，为提高计算效率，每个基因所需的排列组合数是自适应确定的。进一步的细节可以在 “补充方法-SNP-wise基因分析 “中找到。</p><p>MAGMA的SNP-wise模型也可用于分析原始基因型数据，在这种情况下，原始基因型数据代替了参考数据，SNP的p值在内部计算。基于这些SNP-wise模型的基因组分析与基于多元回归基因分析模型的基因组分析的方式相同。分析得出的基因P值以同样的方式转换为Z值，作为基因组分析的输入。同样，基因-基因相关矩阵R也是用与多元回归模型相同的公式得到的，但使用参考数据来计算。</p></blockquote></blockquote><h2 id="未来研究计划（初步）"><a href="#未来研究计划（初步）" class="headerlink" title="未来研究计划（初步）"></a>未来研究计划（初步）</h2><ol><li>重新进行此前的工作流程，并参考其他统计资料为PASCAL mapping到的基因界定筛选p值，对pipeline进行改进。</li><li>申请获得PGC及ATLAS GWAS原始数据的使用许可，并调研数据可用性。</li><li>考虑将X染色体纳入ASD GWAS研究范围，并在前人研究的基础上，将特殊的遗传情况通过合理选择调用、归因和关联算法来处理。</li><li>下载PGC数据库中有关ASD共病的GWAS summary statistics，根据此前的pipeline筛选PASCAL得分较高的基因，并对潜在的共病相关基因进行基因组分析/基因网络分析。</li></ol>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>talk&amp;meeting</tag>
      
      <tag>ASD</tag>
      
      <tag>MY PROJECT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.10.29 SIBS研究生开题文件</title>
    <link href="/2021/10/29/20211029%E7%A0%94%E7%A9%B6%E7%94%9F%E5%BC%80%E9%A2%98%E8%AE%BA%E6%96%87/"/>
    <url>/2021/10/29/20211029%E7%A0%94%E7%A9%B6%E7%94%9F%E5%BC%80%E9%A2%98%E8%AE%BA%E6%96%87/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-10-29-SIBS研究生开题文件"><a href="#2021-10-29-SIBS研究生开题文件" class="headerlink" title="2021.10.29 SIBS研究生开题文件"></a>2021.10.29 SIBS研究生开题文件</h1><p><strong>开题报告pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20211029%E7%A0%94%E7%A9%B6%E7%94%9F%E5%AD%A6%E4%BD%8D%E8%AE%BA%E6%96%87%E5%BC%80%E9%A2%98%E6%8A%A5%E5%91%8A.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><p><strong>文献综述pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20211029%E7%A0%94%E7%A9%B6%E7%94%9F%E6%96%87%E7%8C%AE%E7%BB%BC%E8%BF%B0%E6%B1%87%E6%8A%A5.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><p><strong>参考文献pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20211029%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>SIBS STUDY MATERIAL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
      <tag>ASD</tag>
      
      <tag>MY PROJECT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021-10-14 GWAS PRS TEST</title>
    <link href="/2021/10/14/20211014PRS-test/"/>
    <url>/2021/10/14/20211014PRS-test/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-10-14-GWAS-PRS-TEST"><a href="#2021-10-14-GWAS-PRS-TEST" class="headerlink" title="2021-10-14 GWAS PRS TEST"></a>2021-10-14 GWAS PRS TEST</h1><p><strong>运行环境：</strong></p><p>MacOS Catalina 10.15.7</p><p><strong>软件及网页工具：</strong></p><p>PRSice_mac (<a href="https://choishingwan.github.io/PRS-Tutorial/base/">https://choishingwan.github.io/PRS-Tutorial/base/</a>)</p><p>PLINK v1.90b4 64-bit (20 Mar 2017)</p><p>LDpred2</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">install.packages(<span class="hljs-string">&quot;bigsnpr&quot;</span>)<br>library(bigsnpr)<br></code></pre></td></tr></table></figure><p>lassosum（未安装，failed）</p><h2 id="1-QC-of-base-data"><a href="#1-QC-of-base-data" class="headerlink" title="1.QC of base data"></a>1.QC of base data</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gunzip -c Height.gwas.txt.gz | head<br></code></pre></td></tr></table></figure><p>根据PRSice的tutorial，输入文件（GWAS statistic summary）应包含以下列：</p><div class="table-container"><table><thead><tr><th>CHR</th><th>BP</th><th>SNP</th><th>A1</th><th>A2</th><th>N</th><th>SE</th><th>P</th><th>OR</th><th>INFO</th><th>MAF</th></tr></thead><tbody><tr><td>1</td><td>756604</td><td>rs3131962</td><td>A</td><td>G</td><td>388028</td><td>0.00301666</td><td>0.483171</td><td>0.997886915712657</td><td>0.890557941364774</td><td>0.369389592764921</td></tr><tr><td>1</td><td>768448</td><td>rs12562034</td><td>A</td><td>G</td><td>388028</td><td>0.00329472</td><td>0.834808</td><td>1.00068731609353</td><td>0.895893511351165</td><td>0.336845754096289</td></tr><tr><td>1</td><td>779322</td><td>rs4040617</td><td>G</td><td>A</td><td>388028</td><td>0.00303344</td><td>0.42897</td><td>0.997603556067569</td><td>0.897508290615237</td><td>0.377368010940814</td></tr></tbody></table></div><ul><li><strong>CHR</strong>: The chromosome in which the SNP resides</li><li><strong>BP</strong>: Chromosomal co-ordinate of the SNP</li><li><strong>SNP</strong>: SNP ID, usually in the form of rs-ID</li><li><strong>A1</strong>: The effect allele of the SNP</li><li><strong>A2</strong>: The non-effect allele of the SNP</li><li><strong>N</strong>: Number of samples used to obtain the effect size estimate</li><li><strong>SE</strong>: The standard error (SE) of the effect size esimate</li><li><strong>P</strong>: The P-value of association between the SNP genotypes and the base phenotype</li><li><strong>OR</strong>: The effect size estimate of the SNP, if the outcome is binary/case-control. If the outcome is continuous or treated as continuous then this will usually be BETA</li><li><strong>INFO</strong>: The imputation information score</li><li><strong>MAF</strong>: The minor allele frequency (MAF) of the SNP</li></ul><p>查看当前使用的来自PGC数据库：<a href="https://www.med.unc.edu/pgc/download-results/的数据集，该数据包含以下列：">https://www.med.unc.edu/pgc/download-results/的数据集，该数据包含以下列：</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">##   CHR        SNP        BP A1 A2  INFO      OR     SE        P</span><br><span class="hljs-comment">## 1   8 rs62513865 101592213  T  C 0.949 1.00652 0.0270 0.808600</span><br><span class="hljs-comment">## 2   8 rs79643588 106973048  A  G 0.997 1.01786 0.0240 0.460600</span><br><span class="hljs-comment">## 3   8 rs17396518 108690829  T  G 0.987 0.96127 0.0140 0.004647</span><br><span class="hljs-comment">## 4   8   rs983166 108681675  A  C 0.998 0.97990 0.0139 0.145200</span><br><span class="hljs-comment">## 5   8 rs28842593 103044620  T  C 0.857 0.99591 0.0203 0.841500</span><br><span class="hljs-comment">## 6   8 rs35107696 109712249  A AT 0.999 1.01308 0.0165 0.430200</span><br></code></pre></td></tr></table></figure><h3 id="1-1-QC-checklist-Base-data-Heritability-check"><a href="#1-1-QC-checklist-Base-data-Heritability-check" class="headerlink" title="1.1 QC checklist: Base data-Heritability check"></a>1.1 QC checklist: Base data-Heritability check</h3><p>遗传力应＞0.05</p><h3 id="1-2-QC-checklist-Base-data-Effect-allele"><a href="#1-2-QC-checklist-Base-data-Effect-allele" class="headerlink" title="1.2 QC checklist: Base data-Effect allele"></a>1.2 QC checklist: Base data-Effect allele</h3><p>必须了解哪个等位基因是效应等位基因，哪个是无效等位基因，才能确保 PRS 的结果是正确的。</p><blockquote><p>一些 GWAS 结果文件没有明确哪个等位基因是有效等位基因，哪个是无效等位基因。如果在计算生产者责任计划时作出不正确的假设，那么生产者责任计划对目标数据的影响将是错误的。</p></blockquote><h3 id="1-3-QC-checklist-Base-data-Genome-build"><a href="#1-3-QC-checklist-Base-data-Genome-build" class="headerlink" title="1.3 QC checklist: Base data-Genome build"></a>1.3 QC checklist: Base data-Genome build</h3><p>概要统计应该与我们将要使用的目标数据基因组构建相同。你必须检查你的基础数据和目标数据是否在同一个基因组构建上，如果他们不是，那么就使用一个工具，比如 LiftOver，使构建在数据集上保持一致。</p><h3 id="1-4-QC-checklist-Base-data-Standard-GWAS-QC"><a href="#1-4-QC-checklist-Base-data-Standard-GWAS-QC" class="headerlink" title="1.4 QC checklist: Base data-Standard GWAS QC"></a>1.4 QC checklist: Base data-Standard GWAS QC</h3><p>正如文中所描述的那样，基础数据和目标数据都应该受到 GWAS 中执行的标准严格的质量控制步骤的约束。如果基础数据是从公共来源获得的汇总统计数据，那么你能够在这些数据上执行的典型 QC 步骤是根据 INFO 得分和 MAF 过滤 SNPs。由于较低的统计能力(和较高的基因分型错误概率) ，较低的微小等位基因频率(MAF)或估算信息得分(INFO)的 SNPs 更有可能产生假阳性结果。</p><p>因此，低 MAF 和 INFO 的 SNPs 在执行下游分析之前通常会被去除。我们建议移除 MAF &lt; 1% 和 INFO &lt; 0.8的 SNPs (如果灵敏度检查显示可靠的结果，那么在非常大的基本样本量情况下，这些阈值可以降低)。这些 SNP 过滤器可以通过以下代码实现:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">gunzip -c Height.gwas.txt.gz |<br>awk <span class="hljs-string">&#x27;NR==1 || ($11 &gt; 0.01) &amp;&amp; ($10 &gt; 0.8) &#123;print&#125;&#x27;</span> |<br>gzip  &gt; Height.gz<br><span class="hljs-comment">#$11表示第11列MAF</span><br><span class="hljs-comment">#实例命令</span><br></code></pre></td></tr></table></figure><p>PGC数据集以做过移除，故不需要这一步。</p><h3 id="1-5-QC-checklist-Base-data-Mismatching-SNPs"><a href="#1-5-QC-checklist-Base-data-Mismatching-SNPs" class="headerlink" title="1.5 QC checklist: Base data-Mismatching SNPs"></a>1.5 QC checklist: Base data-Mismatching SNPs</h3><p>基准数据和目标数据中报告的等位基因不匹配的SNP可以通过将等位基因与目标数据中的互补等位基因进行 “链式翻转 “来解决，如基准数据中的A/C和目标数据中的G/T的SNP，或者不可解决，如基准中的C/G和目标中的C/T的SNP。大多数多基因评分软件对可解决的SNP自动进行链式翻转，并删除不可解决的不匹配的SNP。</p><p>因为我们需要目标数据来知道哪些 SNPs 具有不匹配的等位基因，所以我们将在目标数据中执行这种链翻转。</p><h3 id="1-6-QC-checklist-Base-data-Duplicate-SNPs"><a href="#1-6-QC-checklist-Base-data-Duplicate-SNPs" class="headerlink" title="1.6 QC checklist: Base data-Duplicate SNPs"></a>1.6 QC checklist: Base data-Duplicate SNPs</h3><p>如果在生成基础数据时发生了错误，那么基础数据文件中可能有重复的SNPs。大多数PRS软件不允许在基础数据输入中出现重复的SNPs，因此应使用下面的命令将其删除。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">gunzip -c Height.gwas.txt.gz |<br>awk <span class="hljs-string">&#x27;&#123;seen[$3]++; if(seen[$3]==1)&#123; print&#125;&#125;&#x27;</span> |<br>gzip - &gt; Height.nodup.gz<br><span class="hljs-comment">#$3表示第三列SNP</span><br><span class="hljs-comment">#示例命令</span><br></code></pre></td></tr></table></figure><p>本实验中需要的命令为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">gzip iPSYCH_PGC_ASD_Nov2017 &gt; iPSYCH_PGC_ASD_Nov2017_20211014.gz<br><br>gunzip -c iPSYCH_PGC_ASD_Nov2017_20211014.gz |<br>awk <span class="hljs-string">&#x27;&#123;seen[$2]++; if(seen[$2]==1)&#123; print&#125;&#125;&#x27;</span> |<br>gzip - &gt; iPSYCH_PGC_ASD_Nov2017_20211014.gz<br><span class="hljs-comment">#$2表示第2列SNP</span><br></code></pre></td></tr></table></figure><h3 id="1-7-QC-checklist-Base-data-Ambiguous-SNPs"><a href="#1-7-QC-checklist-Base-data-Ambiguous-SNPs" class="headerlink" title="1.7 QC checklist: Base data-Ambiguous SNPs"></a>1.7 QC checklist: Base data-Ambiguous SNPs</h3><p>如果碱基和目标数据是使用不同的基因分型芯片产生的，并且用于其中一个的染色体链（+/-）是未知的，那么就不可能在不同的数据集中配对模糊的SNP的等位基因（即那些具有互补等位基因的SNP，要么是C/G或A/T SNP），因为它将不知道碱基和目标数据是否指的是同一个等位基因。虽然可以用等位基因频率来推断哪些等位基因在同一条链上，但对于MAF接近50%的SNP或当碱基和目标数据来自不同人群时，其准确性可能很低。因此，我们建议删除所有模糊的SNPs，以避免引入这种潜在的系统误差来源。</p><p>模糊的SNP可以在基础数据中被删除，那么在随后的分析中就不会有这样的SNP，因为分析只对基础数据和目标数据之间重叠的SNP进行。</p><p>可用以下代码保留无歧义的SNP：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">gunzip -c Height.nodup.gz |<br>awk <span class="hljs-string">&#x27;!( ($4==&quot;A&quot; &amp;&amp; $5==&quot;T&quot;) ||</span><br><span class="hljs-string">        ($4==&quot;T&quot; &amp;&amp; $5==&quot;A&quot;) || </span><br><span class="hljs-string">        ($4==&quot;G&quot; &amp;&amp; $5==&quot;C&quot;) || </span><br><span class="hljs-string">        ($4==&quot;C&quot; &amp;&amp; $5==&quot;G&quot;)) &#123;print&#125;&#x27;</span> |<br>    gzip &gt; Height.QC.gz<br><span class="hljs-comment">#示例代码</span><br></code></pre></td></tr></table></figure><p>本实验中需要的命令为</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">gunzip -c iPSYCH_PGC_ASD_Nov2017_20211014.gz |<br>awk <span class="hljs-string">&#x27;!( ($4==&quot;A&quot; &amp;&amp; $5==&quot;T&quot;) || </span><br><span class="hljs-string">        ($4==&quot;T&quot; &amp;&amp; $5==&quot;A&quot;) || </span><br><span class="hljs-string">        ($4==&quot;G&quot; &amp;&amp; $5==&quot;C&quot;) || </span><br><span class="hljs-string">        ($4==&quot;C&quot; &amp;&amp; $5==&quot;G&quot;)) &#123;print&#125;&#x27;</span> |<br>    gzip &gt; iPSYCH_PGC_ASD_Nov2017_20211014.gz<br></code></pre></td></tr></table></figure><h3 id="1-8-QC-checklist-Base-data-Sex-chromosomes"><a href="#1-8-QC-checklist-Base-data-Sex-chromosomes" class="headerlink" title="1.8 QC checklist: Base data-Sex chromosomes"></a>1.8 QC checklist: Base data-Sex chromosomes</h3><p>有时会出现样本标签错误，这可能导致无效的结果。误标样本的一个迹象是报告的性别与性染色体所显示的性别不同。虽然这可能是由于性别和性别认同的不同，但它也可能反映了样本的误标或误报，因此，生物性别和报告性别不匹配的个体通常被删除。见目标数据部分，其中进行了性别检查。</p><h3 id="1-9-QC-checklist-Base-data-Sample-overlap"><a href="#1-9-QC-checklist-Base-data-Sample-overlap" class="headerlink" title="1.9 QC checklist: Base data-Sample overlap"></a>1.9 QC checklist: Base data-Sample overlap</h3><p>由于目标数据是模拟的，所以这里的基础数据和目标数据之间没有重叠的样本。</p><h3 id="1-10-QC-checklist-Base-data-Relatedness"><a href="#1-10-QC-checklist-Base-data-Relatedness" class="headerlink" title="1.10 QC checklist: Base data-Relatedness"></a>1.10 QC checklist: Base data-Relatedness</h3><p>基础数据和目标数据内部和之间的密切相关的个体可能导致重叠的结果，限制了结果的普遍性(参见论文的相关章节)。目标数据中的相关性在目标数据部分中进行测试。</p><h2 id="2-QC-of-Target-Data"><a href="#2-QC-of-Target-Data" class="headerlink" title="2. QC of Target Data"></a>2. QC of Target Data</h2><h3 id="2-1-Obtaining-the-target-data"><a href="#2-1-Obtaining-the-target-data" class="headerlink" title="2.1 Obtaining the target data"></a>2.1 Obtaining the target data</h3><p>目标数据由单个级别的基因型-表型数据组成，通常在您的实验室/部门/协作中生成。在本教程中，我们使用千人基因组计划的欧洲样本模拟了一些基因型-表型数据。你可在此下载有关资料。</p><blockquote><p> 目标数据——包含来自一个样本的个体的基因型和通常的表型(s) ，与 GWAS 样本无关。</p><p>（需要Plink）</p></blockquote><p>解压</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">unzip EUR.zip<br></code></pre></td></tr></table></figure><h3 id="2-2-QC-checklist-Target-data"><a href="#2-2-QC-checklist-Target-data" class="headerlink" title="2.2 QC checklist: Target data"></a>2.2 QC checklist: Target data</h3><p>以下是包含目标数据的质量控制检查表的质量控制步骤。</p><h3 id="2-3-QC-checklist-Sample-size"><a href="#2-3-QC-checklist-Sample-size" class="headerlink" title="2.3 QC checklist: Sample size"></a>2.3 QC checklist: Sample size</h3><p>我们建议使用者只对至少100个人的目标数据进行PRS分析。这里我们的目标数据的样本量是503人。</p><h3 id="2-4-QC-checklist-File-transfer"><a href="#2-4-QC-checklist-File-transfer" class="headerlink" title="2.4 QC checklist: File transfer"></a>2.4 QC checklist: File transfer</h3><p>通常情况下，我们不需要下载和传输目标数据文件，因为它通常是在本地生成的。然而，该文件应该包含一个md5sum代码，以防我们将数据文件发送给合作者，他们可能想确认该文件在传输过程中没有变化。</p><p>每个目标文件的 md5sum 代码：</p><div class="table-container"><table><thead><tr><th>File</th><th>md5sum</th></tr></thead><tbody><tr><td><strong>EUR.bed</strong></td><td>98bcef133f683b1272d3ea5f97742e0e</td></tr><tr><td><strong>EUR.bim</strong></td><td>6b286002904880055a9c94e01522f059</td></tr><tr><td><strong>EUR.cov</strong></td><td>85ed18288c708e095385418517e9c3bd</td></tr><tr><td><strong>EUR.fam</strong></td><td>e7b856f0c7bcaffc8405926d08386e97</td></tr><tr><td><strong>EUR.height</strong></td><td>dd445ce969a81cded20da5c88b82d4df</td></tr></tbody></table></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">md5sum EUR.zip<br></code></pre></td></tr></table></figure><p>如果文件是完整的，那么 md5sum 生成一个字符串，在这种情况下应该是和上表相符。如果生成了不同的字符串，则文件已损坏。</p><h3 id="2-5-QC-checklist-Genome-build"><a href="#2-5-QC-checklist-Genome-build" class="headerlink" title="2.5 QC checklist: Genome build"></a>2.5 QC checklist: Genome build</h3><p>如基础数据部分所述，我们的基础和目标数据的基因组构建是相同的，因为它应该是相同的。</p><h3 id="2-6-QC-checklist-Standard-GWAS-QC"><a href="#2-6-QC-checklist-Standard-GWAS-QC" class="headerlink" title="2.6 QC checklist: Standard GWAS QC"></a>2.6 QC checklist: Standard GWAS QC</h3><p>目标数据的质量必须至少控制在 GWAS 研究中实施的标准之下，例如去除基因分型率低的 SNPs，低次等位基因频率，脱离 Hardy-Weinberg 平衡，去除基因分型率低的个体。</p><p>下面的 plink 命令将其中一些 QC 指标应用于目标数据:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR \<br>    --maf 0.01 \<br>    --hwe 1e-6 \<br>    --geno 0.01 \<br>    --mind 0.01 \<br>    --write-snplist \<br>    --make-just-fam \<br>    --out EUR.QC<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">PLINK v1.<span class="hljs-number">90</span>b4 <span class="hljs-number">64</span>-<span class="hljs-built_in">bit</span> (<span class="hljs-number">20</span> Mar <span class="hljs-number">2017</span>)             www.cog-genomics.org/plink/<span class="hljs-number">1.9</span>/<br>(C) <span class="hljs-number">2005</span>-<span class="hljs-number">2017</span> Shaun Purcell, Christopher Chang   GNU General Public License v3<br>Logging <span class="hljs-keyword">to</span> EUR.QC.log.<br>Options <span class="hljs-keyword">in</span> effect:<br>  <span class="hljs-comment">--bfile EUR</span><br>  <span class="hljs-comment">--geno 0.01</span><br>  <span class="hljs-comment">--hwe 1e-6</span><br>  <span class="hljs-comment">--maf 0.01</span><br>  <span class="hljs-comment">--make-just-fam</span><br>  <span class="hljs-comment">--mind 0.01</span><br>  <span class="hljs-comment">--out EUR.QC</span><br>  <span class="hljs-comment">--write-snplist</span><br><br><span class="hljs-number">8192</span> MB RAM detected; reserving <span class="hljs-number">4096</span> MB <span class="hljs-keyword">for</span> main workspace.<br><span class="hljs-number">551892</span> variants loaded from .bim <span class="hljs-keyword">file</span>.<br><span class="hljs-number">503</span> people (<span class="hljs-number">240</span> males, <span class="hljs-number">263</span> females) loaded from .fam.<br><span class="hljs-number">14</span> people removed due <span class="hljs-keyword">to</span> missing genotype data (<span class="hljs-comment">--mind).</span><br>IDs written <span class="hljs-keyword">to</span> EUR.QC.irem .<br>Using <span class="hljs-number">1</span> thread (no multithreaded calculations invoked).<br>Before main variant filters, <span class="hljs-number">489</span> founders <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> nonfounders present.<br>Calculating allele frequencies... done.<br><span class="hljs-literal">Warning</span>: <span class="hljs-number">1806</span> het. haploid genotypes present (see EUR.QC.hh ); many commands<br>treat these as missing.<br>Total genotyping rate <span class="hljs-keyword">in</span> remaining samples <span class="hljs-keyword">is</span> <span class="hljs-number">0.999816</span>.<br><span class="hljs-number">5353</span> variants removed due <span class="hljs-keyword">to</span> missing genotype data (<span class="hljs-comment">--geno).</span><br><span class="hljs-literal">Warning</span>: <span class="hljs-comment">--hwe observation counts vary by more than 10%, due to the X</span><br>chromosome.  You may want <span class="hljs-keyword">to</span> <span class="hljs-keyword">use</span> a less stringent <span class="hljs-comment">--hwe p-value threshold for X</span><br>chromosome variants.<br><span class="hljs-comment">--hwe: 944 variants removed due to Hardy-Weinberg exact test.</span><br><span class="hljs-number">5061</span> variants removed due <span class="hljs-keyword">to</span> minor allele threshold(s)<br>(<span class="hljs-comment">--maf/--max-maf/--mac/--max-mac).</span><br><span class="hljs-number">540534</span> variants <span class="hljs-keyword">and</span> <span class="hljs-number">489</span> people pass filters <span class="hljs-keyword">and</span> QC.<br><span class="hljs-literal">Note</span>: No phenotypes present.<br>List <span class="hljs-keyword">of</span> variant IDs written <span class="hljs-keyword">to</span> EUR.QC.snplist .<br><span class="hljs-comment">--make-just-fam to EUR.QC.fam ... done.</span><br></code></pre></td></tr></table></figure><p>每个参数对应于以下内容：</p><div class="table-container"><table><thead><tr><th>Parameter</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>bfile</td><td>EUR</td><td>Informs <code>plink</code> that the input genotype files should have a prefix of <code>EUR</code></td></tr><tr><td>maf</td><td>0.01</td><td>Removes all SNPs with minor allele frequency less than 0.01. Genotyping errors typically have a larger influence on SNPs with low MAF. Studies with large sample sizes could apply a lower MAF threshold</td></tr><tr><td>hwe</td><td>1e-6</td><td>Removes SNPs with low P-value from the Hardy-Weinberg Equilibrium Fisher’s exact or chi-squared test. SNPs with significant P-values from the HWE test are more likely affected by genotyping error or the effects of natural selection. Filtering should be performed on the control samples to avoid filtering SNPs that are causal (under selection in cases). When phenotype information is included, plink will automatically perform the filtering in the controls.</td></tr><tr><td>geno</td><td>0.01</td><td>Excludes SNPs that are missing in a high fraction of subjects. A two-stage filtering process is usually performed (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001694/">Marees et al</a>).</td></tr><tr><td>mind</td><td>0.01</td><td>Excludes individuals who have a high rate of genotype missingness, since this may indicate problems in the DNA sample or processing. (see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001694/">Marees et al</a> for more details).</td></tr><tr><td>make-just-fam</td><td>-</td><td>Informs <code>plink</code> to only generate the QC’ed sample name to avoid generating the .bed file.</td></tr><tr><td>write-snplist</td><td>-</td><td>Informs <code>plink</code> to only generate the QC’ed SNP list to avoid generating the .bed file.</td></tr><tr><td>out</td><td>EUR.QC</td><td>Informs <code>plink</code> that all output should have a prefix of <code>EUR.QC</code></td></tr></tbody></table></div><blockquote><p>通常，我们可以使用新的样本列表生成一个新的基因型文件。但是，这会占用大量的存储空间。使用<code>plink</code>‘s <code>--extract</code>, <code>--exclude</code>, <code>--keep</code>, <code>--remove</code>, <code>--make-just-fam</code> and <code>--write-snplist</code> functions,我们可以单独处理示例和 SNPs 列表，而无需复制基因型文件，从而减少存储空间的使用。</p></blockquote><p>个体中非常高或低的杂合率可能是由于 DNA 污染或高度近交所致。因此，具有极端杂合性的样品通常会在下游分析之前被移除。</p><p>首先，我们执行修剪以去除高度相关的 SNPs:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR \<br>    --keep EUR.QC.fam \<br>    --extract EUR.QC.snplist \<br>    --indep-pairwise 200 50 0.25 \<br>    --out EUR.QC<br></code></pre></td></tr></table></figure><p>每个参数对应于以下内容：</p><div class="table-container"><table><thead><tr><th>Parameter</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>bfile</td><td>EUR</td><td>Informs <code>plink</code> that the input genotype files should have a prefix of <code>EUR</code></td></tr><tr><td>keep</td><td>EUR.QC.fam</td><td>Informs <code>plink</code> that we only want to use samples in <code>EUR.QC.fam</code> in the analysis</td></tr><tr><td>extract</td><td>EUR.QC.snplist</td><td>Informs <code>plink</code> that we only want to use SNPs in <code>EUR.QC.snplist</code> in the analysis</td></tr><tr><td>indep-pairwise</td><td>200 50 0.25</td><td>Informs <code>plink</code> that we wish to perform pruning with a window size of 200 variants, sliding across the genome with step size of 50 variants at a time, and filter out any SNPs with LD r2r2 higher than 0.25</td></tr><tr><td>out</td><td>EUR.QC</td><td>Informs <code>plink</code> that all output should have a prefix of <code>EUR.QC</code></td></tr></tbody></table></div><p>这将生成两个文件1) EUR.QC.prune.in 和2) EUR.QC.prune.out。</p><p>return</p><figure class="highlight mercury"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs mercury">PLINK v1.<span class="hljs-number">90</span>b4 <span class="hljs-number">64</span>-bit (<span class="hljs-number">20</span> Mar <span class="hljs-number">2017</span>)             www.cog-genomics.org/plink/<span class="hljs-number">1.9</span>/<br>(C) <span class="hljs-number">2005</span>-<span class="hljs-number">2017</span> Shaun Purcell, Christopher Chang   GNU General Public License v3<br>Logging to EUR.QC.log.<br>Options in effect:<br>  --bfile EUR<br>  --extract EUR.QC.snplist<br>  --indep-pairwise <span class="hljs-number">200</span> <span class="hljs-number">50</span> <span class="hljs-number">0.25</span><br>  --keep EUR.QC.fam<br>  --out EUR.QC<br><br><span class="hljs-number">8192</span> MB RAM detected; reserving <span class="hljs-number">4096</span> MB for main workspace.<br><span class="hljs-number">551892</span> variants loaded from .bim file.<br><span class="hljs-number">503</span> people (<span class="hljs-number">240</span> males, <span class="hljs-number">263</span> females) loaded from .fam.<br>--extract: <span class="hljs-number">540534</span> variants remaining.<br>--keep: <span class="hljs-number">489</span> people remaining.<br>Using <span class="hljs-number">1</span> thread (no multithreaded calculations invoked).<br>Before main variant filters, <span class="hljs-number">489</span> founders and <span class="hljs-number">0</span> nonfounders present.<br>Calculating allele frequencies... done.<br>Warning: <span class="hljs-number">1273</span> het. haploid genotypes present (see EUR.QC.hh ); many commands<br>treat these as missing.<br>Total genotyping rate in remaining samples <span class="hljs-keyword">is</span> <span class="hljs-number">0.999919</span>.<br><span class="hljs-number">540534</span> variants and <span class="hljs-number">489</span> people pass filters and QC.<br>Note: No phenotypes present.<br>Pruned <span class="hljs-number">20214</span> variants from chromosome <span class="hljs-number">1</span>, leaving <span class="hljs-number">21127</span>.<br>Pruned <span class="hljs-number">20984</span> variants from chromosome <span class="hljs-number">2</span>, leaving <span class="hljs-number">20879</span>.<br>Pruned <span class="hljs-number">17463</span> variants from chromosome <span class="hljs-number">3</span>, leaving <span class="hljs-number">17812</span>.<br>Pruned <span class="hljs-number">16344</span> variants from chromosome <span class="hljs-number">4</span>, leaving <span class="hljs-number">16690</span>.<br>Pruned <span class="hljs-number">15027</span> variants from chromosome <span class="hljs-number">5</span>, leaving <span class="hljs-number">15981</span>.<br>Pruned <span class="hljs-number">20731</span> variants from chromosome <span class="hljs-number">6</span>, leaving <span class="hljs-number">15475</span>.<br>Pruned <span class="hljs-number">14046</span> variants from chromosome <span class="hljs-number">7</span>, leaving <span class="hljs-number">14606</span>.<br>Pruned <span class="hljs-number">13289</span> variants from chromosome <span class="hljs-number">8</span>, leaving <span class="hljs-number">13667</span>.<br>Pruned <span class="hljs-number">10723</span> variants from chromosome <span class="hljs-number">9</span>, leaving <span class="hljs-number">11951</span>.<br>Pruned <span class="hljs-number">12722</span> variants from chromosome <span class="hljs-number">10</span>, leaving <span class="hljs-number">13383</span>.<br>Pruned <span class="hljs-number">13053</span> variants from chromosome <span class="hljs-number">11</span>, leaving <span class="hljs-number">12666</span>.<br>Pruned <span class="hljs-number">11654</span> variants from chromosome <span class="hljs-number">12</span>, leaving <span class="hljs-number">12500</span>.<br>Pruned <span class="hljs-number">8429</span> variants from chromosome <span class="hljs-number">13</span>, leaving <span class="hljs-number">9609</span>.<br>Pruned <span class="hljs-number">8072</span> variants from chromosome <span class="hljs-number">14</span>, leaving <span class="hljs-number">8791</span>.<br>Pruned <span class="hljs-number">7978</span> variants from chromosome <span class="hljs-number">15</span>, leaving <span class="hljs-number">8470</span>.<br>Pruned <span class="hljs-number">8808</span> variants from chromosome <span class="hljs-number">16</span>, leaving <span class="hljs-number">9500</span>.<br>Pruned <span class="hljs-number">8032</span> variants from chromosome <span class="hljs-number">17</span>, leaving <span class="hljs-number">8724</span>.<br>Pruned <span class="hljs-number">7204</span> variants from chromosome <span class="hljs-number">18</span>, leaving <span class="hljs-number">8560</span>.<br>Pruned <span class="hljs-number">7014</span> variants from chromosome <span class="hljs-number">19</span>, leaving <span class="hljs-number">6726</span>.<br>Pruned <span class="hljs-number">6341</span> variants from chromosome <span class="hljs-number">20</span>, leaving <span class="hljs-number">7508</span>.<br>Pruned <span class="hljs-number">3629</span> variants from chromosome <span class="hljs-number">21</span>, leaving <span class="hljs-number">4280</span>.<br>Pruned <span class="hljs-number">4085</span> variants from chromosome <span class="hljs-number">22</span>, leaving <span class="hljs-number">4323</span>.<br>Pruned <span class="hljs-number">16235</span> variants from chromosome <span class="hljs-number">23</span>, leaving <span class="hljs-number">5229</span>.<br>Pruning complete.  <span class="hljs-number">272077</span> of <span class="hljs-number">540534</span> variants removed.<br>Marker lists written to EUR.QC.prune.in and EUR.QC.prune.out .<br></code></pre></td></tr></table></figure><p>杂合性率可以通过 plink 计算出来:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR \<br>    --extract EUR.QC.prune.in \<br>    --keep EUR.QC.fam \<br>    --het \<br>    --out EUR.QC<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">PLINK v1.<span class="hljs-number">90</span>b4 <span class="hljs-number">64</span>-bit (<span class="hljs-number">20</span> Mar <span class="hljs-number">2017</span>)             www.cog-genomics.org/plink/<span class="hljs-number">1.9</span>/<br>(C) <span class="hljs-number">2005</span>-<span class="hljs-number">2017</span> Shaun Purcell, Christopher Chang   GNU General Public License v3<br>Logging <span class="hljs-keyword">to</span> <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>log.<br>Options <span class="hljs-keyword">in</span> effect:<br>  --bfile EUR<br>  --extract <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>prune.<span class="hljs-keyword">in</span><br>  --het<br>  --keep <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>fam<br>  --out EUR.QC<br><br><span class="hljs-number">8192</span> MB RAM detected; reserving <span class="hljs-number">4096</span> MB <span class="hljs-keyword">for</span> main workspace.<br><span class="hljs-number">551892</span> variants loaded from .bim file.<br><span class="hljs-number">503</span> people (<span class="hljs-number">240</span> males, <span class="hljs-number">263</span> females) loaded from .fam.<br>--extract: <span class="hljs-number">268457</span> variants remaining.<br>--keep: <span class="hljs-number">489</span> people remaining.<br>Using <span class="hljs-number">1</span> thread (no multithreaded calculations invoked).<br>Before main variant filters, <span class="hljs-number">489</span> founders <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> nonfounders present.<br>Calculating allele frequencies... <span class="hljs-keyword">done</span>.<br>Warning: <span class="hljs-number">558</span> het. haploid genotypes present (see <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>hh ); many commands<br>treat these <span class="hljs-keyword">as</span> missing.<br>Total genotyping rate <span class="hljs-keyword">in</span> remaining samples is <span class="hljs-number">0.999958</span>.<br><span class="hljs-number">268457</span> variants <span class="hljs-keyword">and</span> <span class="hljs-number">489</span> people pass filters <span class="hljs-keyword">and</span> QC.<br>Note: No phenotypes present.<br>--het: <span class="hljs-number">263228</span> variants scanned, report written <span class="hljs-keyword">to</span> <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>het .<br></code></pre></td></tr></table></figure><p> 这将生成 EUR.QC.het 文件，其中包含用于评估杂合性的 f 系数估计。我们将从平均值中删除 f 系数大于3的个体，这可以使用下面的 r 命令执行(假设你已经下载了 r，那么你可以在终端中键入 r 来打开一个 r 会话) :</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs r">dat &lt;- read.table(<span class="hljs-string">&quot;EUR.QC.het&quot;</span>, header=<span class="hljs-built_in">T</span>) <span class="hljs-comment"># Read in the EUR.het file, specify it has header</span><br>m &lt;- mean(dat$<span class="hljs-built_in">F</span>) <span class="hljs-comment"># Calculate the mean  </span><br>s &lt;- sd(dat$<span class="hljs-built_in">F</span>) <span class="hljs-comment"># Calculate the SD</span><br>valid &lt;- subset(dat, <span class="hljs-built_in">F</span> &lt;= m+<span class="hljs-number">3</span>*s &amp; <span class="hljs-built_in">F</span> &gt;= m-<span class="hljs-number">3</span>*s) <span class="hljs-comment"># Get any samples with F coefficient within 3 SD of the population mean</span><br>write.table(valid[,<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)], <span class="hljs-string">&quot;EUR.valid.sample&quot;</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-built_in">F</span>, row.names=<span class="hljs-built_in">F</span>) <span class="hljs-comment"># print FID and IID for valid samples</span><br>q() <span class="hljs-comment"># exit R</span><br></code></pre></td></tr></table></figure><h3 id="2-7-QC-checklist-Ambiguous-SNPs"><a href="#2-7-QC-checklist-Ambiguous-SNPs" class="headerlink" title="2.7 QC checklist: Ambiguous SNPs"></a>2.7 QC checklist: Ambiguous SNPs</h3><p>这些将在基础数据中被删除。</p><h3 id="2-8-QC-checklist-Mismatching-SNPs"><a href="#2-8-QC-checklist-Mismatching-SNPs" class="headerlink" title="2.8 QC checklist: Mismatching SNPs"></a>2.8 QC checklist: Mismatching SNPs</h3><p>在基础数据和目标数据中报告的等位基因不匹配的 SNP，可以通过将等位基因翻转到它们的互补等位基因来解决，例如目标数据，例如基础数据中有 a/c 的 SNP 和目标数据中的 g/t。这可以通过以下步骤来实现:</p><blockquote><p>大多数 PRS 软件将自动执行链切换，因此这一步骤通常是不需要的。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#将 bim 文件、汇总统计和 QC SNP 列表加载到 r 中</span><br><br><span class="hljs-comment">#有data.table和magritr包</span><br><span class="hljs-comment"># magrittr allow us to do piping, which help to reduce the </span><br><span class="hljs-comment"># amount of intermediate data types</span><br>library(data.table)<br>library(magrittr)<br>setwd(<span class="hljs-string">&quot;/Volumes/My Passport for Mac/data/EUR&quot;</span>)<br><span class="hljs-comment"># Read in bim file </span><br>bim &lt;- fread(<span class="hljs-string">&quot;EUR.bim&quot;</span>) %&gt;%<br>    <span class="hljs-comment"># Note: . represents the output from previous step</span><br>    <span class="hljs-comment"># The syntax here means, setnames of the data read from</span><br>    <span class="hljs-comment"># the bim file, and replace the original column names by </span><br>    <span class="hljs-comment"># the new names</span><br>    setnames(., colnames(.), <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;CHR&quot;</span>, <span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;CM&quot;</span>, <span class="hljs-string">&quot;BP&quot;</span>, <span class="hljs-string">&quot;B.A1&quot;</span>, <span class="hljs-string">&quot;B.A2&quot;</span>)) %&gt;%<br>    <span class="hljs-comment"># And immediately change the alleles to upper cases</span><br>    .[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;B.A1&quot;</span>,<span class="hljs-string">&quot;B.A2&quot;</span>):=<span class="hljs-built_in">list</span>(toupper(B.A1), toupper(B.A2))]<br><span class="hljs-comment"># Read in summary statistic data (require data.table v1.12.0+)</span><br>height &lt;- fread(<span class="hljs-string">&quot;/Volumes/My\ Passport\ for\ Mac/data/14671989/iPSYCH_PGC_ASD_Nov2017.gz&quot;</span>) %&gt;%<br>    <span class="hljs-comment"># And immediately change the alleles to upper cases</span><br>    .[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;A1&quot;</span>,<span class="hljs-string">&quot;A2&quot;</span>):=<span class="hljs-built_in">list</span>(toupper(A1), toupper(A2))]<br><span class="hljs-comment"># Read in QCed SNPs</span><br>qc &lt;- fread(<span class="hljs-string">&quot;EUR.QC.snplist&quot;</span>, header=<span class="hljs-built_in">F</span>)<br><br><span class="hljs-comment"># 识别需要翻转 dna 链的 SNPs</span><br><span class="hljs-comment"># Merge summary statistic with target</span><br>info &lt;- merge(bim, height, by=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;CHR&quot;</span>, <span class="hljs-string">&quot;BP&quot;</span>)) %&gt;%<br>    <span class="hljs-comment"># And filter out QCed SNPs</span><br>    .[SNP %in% qc[,V1]]<br><br><span class="hljs-comment"># Function for calculating the complementary allele</span><br>complement &lt;- <span class="hljs-keyword">function</span>(x)&#123;<br>    <span class="hljs-built_in">switch</span> (x,<br>        <span class="hljs-string">&quot;A&quot;</span> = <span class="hljs-string">&quot;T&quot;</span>,<br>        <span class="hljs-string">&quot;C&quot;</span> = <span class="hljs-string">&quot;G&quot;</span>,<br>        <span class="hljs-string">&quot;T&quot;</span> = <span class="hljs-string">&quot;A&quot;</span>,<br>        <span class="hljs-string">&quot;G&quot;</span> = <span class="hljs-string">&quot;C&quot;</span>,<br>        <span class="hljs-built_in">return</span>(<span class="hljs-literal">NA</span>)<br>    )<br>&#125; <br><span class="hljs-comment"># Get SNPs that have the same alleles across base and target</span><br>info.match &lt;- info[A1 == B.A1 &amp; A2 == B.A2, SNP]<br><span class="hljs-comment"># Identify SNPs that are complementary between base and target</span><br>com.snps &lt;- info[sapply(B.A1, complement) == A1 &amp;<br>                    sapply(B.A2, complement) == A2, SNP]<br><span class="hljs-comment"># Now update the bim file</span><br>bim[SNP %in% com.snps, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;B.A1&quot;</span>, <span class="hljs-string">&quot;B.A2&quot;</span>) :=<br>        <span class="hljs-built_in">list</span>(sapply(B.A1, complement),<br>            sapply(B.A2, complement))]<br><br><span class="hljs-comment">#识别需要在目标中重新编码的 SNPs (以确保在目标数据中编码的等位基因是基础摘要统计中的有效等位基因)</span><br><span class="hljs-comment"># identify SNPs that need recoding</span><br>recode.snps &lt;- info[B.A1==A2 &amp; B.A2==A1, SNP]<br><span class="hljs-comment"># Update the bim file</span><br>bim[SNP %in% recode.snps, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;B.A1&quot;</span>, <span class="hljs-string">&quot;B.A2&quot;</span>) :=<br>        <span class="hljs-built_in">list</span>(B.A2, B.A1)]<br><br><span class="hljs-comment"># identify SNPs that need recoding &amp; complement</span><br>com.recode &lt;- info[sapply(B.A1, complement) == A2 &amp;<br>                    sapply(B.A2, complement) == A1, SNP]<br><span class="hljs-comment"># Now update the bim file</span><br>bim[SNP %in% com.recode, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;B.A1&quot;</span>, <span class="hljs-string">&quot;B.A2&quot;</span>) :=<br>        <span class="hljs-built_in">list</span>(sapply(B.A2, complement),<br>            sapply(B.A1, complement))]<br><span class="hljs-comment"># Write the updated bim file</span><br>fwrite(bim[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;B.A1&quot;</span>)], <span class="hljs-string">&quot;EUR.a1&quot;</span>, col.names=<span class="hljs-built_in">F</span>, sep=<span class="hljs-string">&quot;\t&quot;</span>)<br><br><span class="hljs-comment"># 确定在基因组和目标上有不同等位基因的 SNPs (通常是由于基因组构建或 Indel 的不同)</span><br>mismatch &lt;- bim[!(SNP %in% info.match |<br>                    SNP %in% com.snps |<br>                    SNP %in% recode.snps |<br>                    SNP %in% com.recode), SNP]<br>write.table(mismatch, <span class="hljs-string">&quot;EUR.mismatch&quot;</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-built_in">F</span>, row.names=<span class="hljs-built_in">F</span>, col.names=<span class="hljs-built_in">F</span>)<br>q() <span class="hljs-comment"># exit R</span><br></code></pre></td></tr></table></figure><h3 id="2-9-QC-checklist-Duplicate-SNPs"><a href="#2-9-QC-checklist-Duplicate-SNPs" class="headerlink" title="2.9 QC checklist: Duplicate SNPs"></a>2.9 QC checklist: Duplicate SNPs</h3><p>确保删除目标数据中任何重复的 SNPs (这些目标数据是模拟的，因此不包括重复的 SNPs)。</p><h3 id="2-10-QC-checklist-Sex-chromosomes"><a href="#2-10-QC-checklist-Sex-chromosomes" class="headerlink" title="2.10 QC checklist: Sex chromosomes"></a>2.10 QC checklist: Sex chromosomes</h3><p>有时样品标签会出现错误，可能导致无效的结果。标签错误的一个迹象是报告的性别和性染色体之间的差异。虽然这可能是由于性别和性别认同的差异，但也可能反映出样本标签错误或误报，因此，生物性别和报告性别不匹配的个人通常被剔除。性别检查可以在 PLINK 中进行，如果个体的 x 染色体纯合度估计值(f 统计量) &lt; 0.2，如果估计值大于0.8，个体被称为女性。</p><p>在执行性别检查之前，应该进行修剪。然后可以很容易地使用 plink 进行性别检查。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR \<br>    --extract EUR.QC.prune.in \<br>    --keep EUR.valid.sample \<br>    --check-sex \<br>    --out EUR.QC<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">PLINK v1.<span class="hljs-number">90</span>b4 <span class="hljs-number">64</span>-bit (<span class="hljs-number">20</span> Mar <span class="hljs-number">2017</span>)             www.cog-genomics.org/plink/<span class="hljs-number">1.9</span>/<br>(C) <span class="hljs-number">2005</span>-<span class="hljs-number">2017</span> Shaun Purcell, Christopher Chang   GNU General Public License v3<br>Logging <span class="hljs-keyword">to</span> <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>log.<br>Options <span class="hljs-keyword">in</span> effect:<br>  --bfile EUR<br>  --check-sex<br>  --extract <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>prune.<span class="hljs-keyword">in</span><br>  --keep <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span></span>valid.sample<br>  --out EUR.QC<br><br><span class="hljs-number">8192</span> MB RAM detected; reserving <span class="hljs-number">4096</span> MB <span class="hljs-keyword">for</span> main workspace.<br><span class="hljs-number">551892</span> variants loaded from .bim file.<br><span class="hljs-number">503</span> people (<span class="hljs-number">240</span> males, <span class="hljs-number">263</span> females) loaded from .fam.<br>--extract: <span class="hljs-number">268457</span> variants remaining.<br>--keep: <span class="hljs-number">487</span> people remaining.<br>Using <span class="hljs-number">1</span> thread (no multithreaded calculations invoked).<br>Before main variant filters, <span class="hljs-number">487</span> founders <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> nonfounders present.<br>Calculating allele frequencies... <span class="hljs-keyword">done</span>.<br>Warning: <span class="hljs-number">558</span> het. haploid genotypes present (see <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>hh ); many commands<br>treat these <span class="hljs-keyword">as</span> missing.<br>Total genotyping rate <span class="hljs-keyword">in</span> remaining samples is <span class="hljs-number">0.999958</span>.<br><span class="hljs-number">268457</span> variants <span class="hljs-keyword">and</span> <span class="hljs-number">487</span> people pass filters <span class="hljs-keyword">and</span> QC.<br>Note: No phenotypes present.<br>--check-sex: <span class="hljs-number">5229</span> Xchr <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> Ychr variant(s) scanned, <span class="hljs-number">4</span> problems detected.<br>Report written <span class="hljs-keyword">to</span> <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>sexcheck .<br></code></pre></td></tr></table></figure><p>这将生成一个名为 EUR.QC.sexcheck 的文件，其中包含每个人的 f- 统计信息。如果 f 统计值大于0.8，个体通常被称为生物学上的男性，如果 f &lt; 0.2，则被称为生物学上的女性。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R">library(data.table)<br><span class="hljs-comment"># Read in file</span><br>valid &lt;- fread(<span class="hljs-string">&quot;EUR.valid.sample&quot;</span>)<br>dat &lt;- fread(<span class="hljs-string">&quot;EUR.QC.sexcheck&quot;</span>)[FID%in%valid$FID]<br>fwrite(dat[STATUS==<span class="hljs-string">&quot;OK&quot;</span>,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;FID&quot;</span>,<span class="hljs-string">&quot;IID&quot;</span>)], <span class="hljs-string">&quot;EUR.QC.valid&quot;</span>, sep=<span class="hljs-string">&quot;\t&quot;</span>) <br>q() <span class="hljs-comment"># exit R</span><br></code></pre></td></tr></table></figure><h3 id="2-11-QC-checklist-Sample-overlap"><a href="#2-11-QC-checklist-Sample-overlap" class="headerlink" title="2.11 QC checklist: Sample overlap"></a>2.11 QC checklist: Sample overlap</h3><p>由于目标数据是模拟的，所以这里的基础数据和目标数据之间没有重叠的样本(参见文件的相关部分讨论避免样本重叠的重要性)。</p><h3 id="2-12-QC-checklist-Relatedness"><a href="#2-12-QC-checklist-Relatedness" class="headerlink" title="2.12 QC checklist: Relatedness"></a>2.12 QC checklist: Relatedness</h3><p>目标数据中密切相关的个体可能导致过度拟合的结果，限制了结果的通用性。</p><p>在计算相关性之前，应该执行修剪。样本中有一个一级或二级亲属的个体(^ π &gt; 0.125)可以通过以下命令删除:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR \<br>    --extract EUR.QC.prune.in \<br>    --keep EUR.QC.valid \<br>    --rel-cutoff 0.125 \<br>    --out EUR.QC<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs applescript">PLINK v1<span class="hljs-number">.90</span>b4 <span class="hljs-number">64</span>-bit (<span class="hljs-number">20</span> Mar <span class="hljs-number">2017</span>)             www.cog-genomics.org/plink/<span class="hljs-number">1.9</span>/<br>(C) <span class="hljs-number">2005</span><span class="hljs-number">-2017</span> Shaun Purcell, Christopher Chang   GNU General Public License v3<br>Logging <span class="hljs-keyword">to</span> EUR.QC.<span class="hljs-built_in">log</span>.<br>Options <span class="hljs-keyword">in</span> effect:<br>  <span class="hljs-comment">--bfile EUR</span><br>  <span class="hljs-comment">--extract EUR.QC.prune.in</span><br>  <span class="hljs-comment">--keep EUR.QC.valid</span><br>  <span class="hljs-comment">--out EUR.QC</span><br>  <span class="hljs-comment">--rel-cutoff 0.125</span><br><br><span class="hljs-number">8192</span> MB RAM detected; reserving <span class="hljs-number">4096</span> MB <span class="hljs-keyword">for</span> main workspace.<br><span class="hljs-number">551892</span> variants loaded <span class="hljs-keyword">from</span> .bim <span class="hljs-built_in">file</span>.<br><span class="hljs-number">503</span> people (<span class="hljs-number">240</span> males, <span class="hljs-number">263</span> females) loaded <span class="hljs-keyword">from</span> .fam.<br><span class="hljs-comment">--extract: 268457 variants remaining.</span><br><span class="hljs-comment">--keep: 483 people remaining.</span><br>Using up <span class="hljs-keyword">to</span> <span class="hljs-number">4</span> threads (change this <span class="hljs-keyword">with</span> <span class="hljs-comment">--threads).</span><br>Before main variant filters, <span class="hljs-number">483</span> founders <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> nonfounders present.<br>Calculating allele frequencies... done.<br>Total genotyping rate <span class="hljs-keyword">in</span> remaining samples <span class="hljs-keyword">is</span> <span class="hljs-number">0.999957</span>.<br><span class="hljs-number">268457</span> variants <span class="hljs-keyword">and</span> <span class="hljs-number">483</span> people pass filters <span class="hljs-keyword">and</span> QC (<span class="hljs-keyword">before</span> <span class="hljs-comment">--rel-cutoff).</span><br>Note: No phenotypes present.<br>Excluding <span class="hljs-number">5229</span> variants <span class="hljs-keyword">on</span> non-autosomes <span class="hljs-keyword">from</span> relationship matrix calc.<br>Relationship matrix calculation complete.<br><span class="hljs-number">0</span> people excluded <span class="hljs-keyword">by</span> <span class="hljs-comment">--rel-cutoff.</span><br>Remaining sample IDs written <span class="hljs-keyword">to</span> EUR.QC.rel.<span class="hljs-built_in">id</span> .<br></code></pre></td></tr></table></figure><h3 id="2-13-QC-checklist-Generate-final-QC’ed-target-data-file"><a href="#2-13-QC-checklist-Generate-final-QC’ed-target-data-file" class="headerlink" title="2.13 QC checklist: Generate final QC’ed target data file"></a>2.13 QC checklist: Generate final QC’ed target data file</h3><p>在执行完整的分析之后，您可以使用以下命令生成一个 QC’ed 数据集:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR \<br>    --make-bed \<br>    --keep EUR.QC.rel.id \<br>    --out EUR.QC \<br>    --extract EUR.QC.snplist \<br>    --exclude EUR.mismatch \<br>    --a1-allele EUR.a1<br></code></pre></td></tr></table></figure><p>每个参数对应于以下内容</p><div class="table-container"><table><thead><tr><th>Parameter</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>bfile</td><td>EUR</td><td>Informs <code>plink</code> that the input genotype files should have a prefix of <code>EUR</code></td></tr><tr><td>keep</td><td>EUR.QC.rel.id</td><td>Informs <code>plink</code> that we only want to keep samples in <code>EUR.QC.rel.id</code></td></tr><tr><td>extract</td><td>EUR.QC.snplist</td><td>Informs <code>plink</code> that we only want to use SNPs in <code>EUR.QC.snplist</code> in the analysis</td></tr><tr><td>exclude</td><td>EUR.mismatch</td><td>Informs <code>plink</code> that we wish to remove any SNPs in <code>EUR.mismatch</code></td></tr><tr><td>a1-allele</td><td>EUR.a1</td><td>Fix all A1 alleles to those specified in <code>EUR.a1</code></td></tr><tr><td>out</td><td>EUR.QC</td><td>Informs <code>plink</code> that all output should have a prefix of <code>EUR.QC</code></td></tr></tbody></table></div><p>return</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">PLINK v1.<span class="hljs-number">90</span>b4 <span class="hljs-number">64</span>-bit (<span class="hljs-number">20</span> Mar <span class="hljs-number">2017</span>)             www.cog-genomics.org/plink/<span class="hljs-number">1.9</span>/<br>(C) <span class="hljs-number">2005</span>-<span class="hljs-number">2017</span> Shaun Purcell, Christopher Chang   GNU General Public License v3<br>Logging <span class="hljs-keyword">to</span> <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>log.<br>Options <span class="hljs-keyword">in</span> effect:<br>  --a1-allele <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span></span>a1<br>  --bfile EUR<br>  --exclude <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span></span>mismatch<br>  --extract <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>snplist<br>  --keep <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>rel.id<br>  --make-bed<br>  --out EUR.QC<br><br><span class="hljs-number">8192</span> MB RAM detected; reserving <span class="hljs-number">4096</span> MB <span class="hljs-keyword">for</span> main workspace.<br><span class="hljs-number">551892</span> variants loaded from .bim file.<br><span class="hljs-number">503</span> people (<span class="hljs-number">240</span> males, <span class="hljs-number">263</span> females) loaded from .fam.<br>--extract: <span class="hljs-number">540534</span> variants remaining.<br>--exclude: <span class="hljs-number">465549</span> variants remaining.<br>--keep: <span class="hljs-number">483</span> people remaining.<br>Using <span class="hljs-number">1</span> thread (no multithreaded calculations invoked).<br>Before main variant filters, <span class="hljs-number">483</span> founders <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> nonfounders present.<br>Calculating allele frequencies... <span class="hljs-keyword">done</span>.<br>--a1-allele: <span class="hljs-number">465549</span> assignments made.<br><span class="hljs-number">465549</span> variants <span class="hljs-keyword">and</span> <span class="hljs-number">483</span> people pass filters <span class="hljs-keyword">and</span> QC.<br>Note: No phenotypes present.<br>--make-bed <span class="hljs-keyword">to</span> <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>bed + <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>bim + <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EUR</span>.</span><span class="hljs-module"><span class="hljs-identifier">QC</span>.</span></span>fam<span class="hljs-operator"> ... </span><span class="hljs-keyword">done</span>.<br></code></pre></td></tr></table></figure><h2 id="3-calculating-PRS"><a href="#3-calculating-PRS" class="headerlink" title="3. calculating PRS"></a>3. calculating PRS</h2><h2 id="3-1-plink"><a href="#3-1-plink" class="headerlink" title="3.1 plink"></a>3.1 plink</h2><h4 id="3-1-1-Required-Data"><a href="#3-1-1-Required-Data" class="headerlink" title="3.1.1 Required Data"></a>3.1.1 Required Data</h4><p>在之前，我们已经生成了以下文件</p><div class="table-container"><table><thead><tr><th>File Name</th><th>Description</th></tr></thead><tbody><tr><td><strong>Height.QC.gz</strong></td><td>The post-QCed summary statistic</td></tr><tr><td><strong>EUR.QC.bed</strong></td><td>The genotype file after performing some basic filtering</td></tr><tr><td><strong>EUR.QC.bim</strong></td><td>This file contains the SNPs that passed the basic filtering</td></tr><tr><td><strong>EUR.QC.fam</strong></td><td>This file contains the samples that passed the basic filtering</td></tr><tr><td><strong>EUR.height</strong></td><td>This file contains the phenotype of the samples</td></tr><tr><td><strong>EUR.cov</strong></td><td>This file contains the covariates of the samples</td></tr></tbody></table></div><h4 id="3-1-2-Update-Effect-Size"><a href="#3-1-2-Update-Effect-Size" class="headerlink" title="3.1.2 Update Effect Size"></a>3.1.2 Update Effect Size</h4><p>当效应大小与疾病风险有关，因此以优势比(OR)而不是 BETA (连续性状)给出时，则 PRS 被计算为 OR 的乘积。为了简化这个计算，我们使用 OR 的自然对数，这样可以用求和来计算 PRS (之后可以反向转换)。我们可以用 r 得到转换后的汇总统计量:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">library(data.table)<br>dat &lt;- fread(<span class="hljs-string">&quot;Height.QC.gz&quot;</span>)<br>fwrite(dat[,BETA:=<span class="hljs-built_in">log</span>(OR)], <span class="hljs-string">&quot;Height.QC.Transformed&quot;</span>, sep=<span class="hljs-string">&quot;\t&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="3-1-3-Clumping"><a href="#3-1-3-Clumping" class="headerlink" title="3.1.3 Clumping"></a>3.1.3 Clumping</h4><p>连接不平衡，相当于整个基因组中遗传变体基因型之间的相关性，使得识别因果独立遗传变体的贡献极具挑战性。捕捉合适水平的因果信号的方法之一是进行聚类，即删除SNP，只保留弱相关的SNP，但优先保留与所研究表型最相关的SNP。可以使用plink中的以下命令进行聚类。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR.QC \<br>    --clump-p1 1 \<br>    --clump-r2 0.1 \<br>    --clump-kb 250 \<br>    --clump Height.QC.Transformed \<br>    --clump-snp-field SNP \<br>    --clump-field P \<br>    --out EUR<br></code></pre></td></tr></table></figure><p>相应的参数见下表：</p><div class="table-container"><table><thead><tr><th>Parameter</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>clump-p1</td><td>1</td><td>P-value threshold for a SNP to be included as an index SNP. 1 is selected such that all SNPs are include for clumping</td></tr><tr><td>clump-r2</td><td>0.1</td><td>SNPs having r2r2 higher than 0.1 with the index SNPs will be removed</td></tr><tr><td>clump-kb</td><td>250</td><td>SNPs within 250k of the index SNP are considered for clumping</td></tr><tr><td>clump</td><td>Height.QC.Transformed</td><td>Base data (summary statistic) file containing the P-value information</td></tr><tr><td>clump-snp-field</td><td>SNP</td><td>Specifies that the column <code>SNP</code> contains the SNP IDs</td></tr><tr><td>clump-field</td><td>P</td><td>Specifies that the column <code>P</code> contains the P-value information</td></tr></tbody></table></div><p>return</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">PLINK v1<span class="hljs-number">.90</span>b4 <span class="hljs-number">64</span>-bit (<span class="hljs-number">20</span> Mar <span class="hljs-number">2017</span>)             www.cog-genomics.org/plink/<span class="hljs-number">1.9</span>/<br>(C) <span class="hljs-number">2005</span><span class="hljs-number">-2017</span> Shaun Purcell, Christopher Chang   GNU General Public License v3<br>Logging <span class="hljs-built_in">to</span> EUR.<span class="hljs-built_in">log</span>.<br>Options <span class="hljs-keyword">in</span> effect:<br>  <span class="hljs-comment">--bfile EUR.QC</span><br>  <span class="hljs-comment">--clump Height.QC.Transformed</span><br>  <span class="hljs-comment">--clump-field P</span><br>  <span class="hljs-comment">--clump-kb 250</span><br>  <span class="hljs-comment">--clump-p1 1</span><br>  <span class="hljs-comment">--clump-r2 0.1</span><br>  <span class="hljs-comment">--clump-snp-field SNP</span><br>  <span class="hljs-comment">--out EUR</span><br><br><span class="hljs-number">8192</span> MB RAM detected; reserving <span class="hljs-number">4096</span> MB <span class="hljs-keyword">for</span> main workspace.<br><span class="hljs-number">465549</span> variants loaded <span class="hljs-built_in">from</span> .bim <span class="hljs-built_in">file</span>.<br><span class="hljs-number">483</span> people (<span class="hljs-number">232</span> males, <span class="hljs-number">251</span> females) loaded <span class="hljs-built_in">from</span> .fam.<br>Using <span class="hljs-number">1</span> thread (no multithreaded calculations invoked).<br>Before main variant filters, <span class="hljs-number">483</span> founders <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> nonfounders present.<br>Calculating allele frequencies... done.<br><span class="hljs-number">465549</span> variants <span class="hljs-keyword">and</span> <span class="hljs-number">483</span> people pass filters <span class="hljs-keyword">and</span> QC.<br>Note: No phenotypes present.<br>Warning: <span class="hljs-string">&#x27;rs1076829&#x27;</span> is missing <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> main dataset, <span class="hljs-keyword">and</span> is <span class="hljs-keyword">a</span> top variant.<br>Warning: <span class="hljs-string">&#x27;rs3129818&#x27;</span> is missing <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> main dataset, <span class="hljs-keyword">and</span> is <span class="hljs-keyword">a</span> top variant.<br>Warning: <span class="hljs-string">&#x27;rs3118359&#x27;</span> is missing <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> main dataset, <span class="hljs-keyword">and</span> is <span class="hljs-keyword">a</span> top variant.<br><span class="hljs-number">59884</span> more top variant IDs missing; see <span class="hljs-built_in">log</span> <span class="hljs-built_in">file</span>.<br><span class="hljs-comment">--clump: 164619 clumps formed from 439730 top variants.</span><br>Results written <span class="hljs-built_in">to</span> EUR.clumped .<br></code></pre></td></tr></table></figure><p>由-clump 计算的 r2 值是基于最大似然单倍型频率估计</p><p>这将生成 eur.clandped，包含执行成丛后的索引 SNPs。我们可以通过执行以下命令提取索引 SNP ID:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">awk <span class="hljs-string">&#x27;NR!=1&#123;print $3&#125;&#x27;</span> EUR.clumped &gt;  EUR.valid.snp<br></code></pre></td></tr></table></figure><blockquote><p>如果你的目标数据很小(例如 n &lt; 500) ，你可以使用千人基因组计划样本来计算 LD。确保使用最接近反映基本样本的总体。</p></blockquote><h4 id="3-1-4-Generate-PRS"><a href="#3-1-4-Generate-PRS" class="headerlink" title="3.1.4 Generate PRS"></a>3.1.4 Generate PRS</h4><p>plink提供了两个有效的函数 —score 和 —q-score-range 用于计算PRS得分</p><p>为此，我们需要以下文件：</p><p>基础数据文件 Height.QC.Transformed</p><p>一个包含SNP ID和它们相应的P值的文件（$3是因为SNP ID位于第三列；$8是因为P值位于第八列)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">awk <span class="hljs-string">&#x27;&#123;print $3,$8&#125;&#x27;</span> Height.QC.Transformed &gt; SNP.pvalue<br></code></pre></td></tr></table></figure><p>一个包含将SNPs纳入PRS的不同P值阈值的文件。这里计算与几个阈值相对应的PRS，以示说明。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0.001 0 0.001&quot;</span> &gt; range_list <br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0.05 0 0.05&quot;</span> &gt;&gt; range_list<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0.1 0 0.1&quot;</span> &gt;&gt; range_list<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0.2 0 0.2&quot;</span> &gt;&gt; range_list<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0.3 0 0.3&quot;</span> &gt;&gt; range_list<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0.4 0 0.4&quot;</span> &gt;&gt; range_list<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;0.5 0 0.5&quot;</span> &gt;&gt; range_list<br></code></pre></td></tr></table></figure><p>然后我们可以使用以下命令计算PRS:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">plink \<br>    --bfile EUR.QC \<br>    --score Height.QC.Transformed 3 4 12 header \<br>    --q-score-range range_list SNP.pvalue \<br>    --extract EUR.valid.snp \<br>    --out EUR<br></code></pre></td></tr></table></figure><p>参数如下：</p><div class="table-container"><table><thead><tr><th>Paramter</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>score</td><td>Height.QC.Transformed 3 4 12 header</td><td>We read from the <strong>Height.QC.Transformed</strong> file, assuming that the <code>3</code>st column is the SNP ID; <code>4</code>th column is the effective allele information; the <code>12</code>th column is the effect size estimate; and that the file contains a <code>header</code></td></tr><tr><td>q-score-range</td><td>range_list SNP.pvalue</td><td>We want to calculate PRS based on the thresholds defined in <strong>range_list</strong>, where the threshold values (P-values) were stored in <strong>SNP.pvalue</strong></td></tr></tbody></table></div><p>这将会产生7个文件：</p><ol><li>EUR.0.5.profile</li><li>EUR.0.4.profile</li><li>EUR.0.3.profile</li><li>EUR.0.2.profile</li><li>EUR.0.1.profile</li><li>EUR.0.05.profile</li><li>EUR.0.001.profile</li></ol><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-10-15 上午11.01.09.png" alt="截屏2021-10-15 上午11.01.09"></p><h4 id="3-1-5-Accounting-for-Population-Stratification"><a href="#3-1-5-Accounting-for-Population-Stratification" class="headerlink" title="3.1.5 Accounting for Population Stratification"></a>3.1.5 Accounting for Population Stratification</h4><p>人口结构是 GWAS 中混杂的主要来源，通常由主成分(pc)作为协变量来解释。我们可以将pc纳入我们的 PRS 分析，以考虑人口分层。</p><p>我们可以使用 plink 计算 pc:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># First, we need to perform prunning</span><br>plink \<br>    --bfile EUR.QC \<br>    --indep-pairwise 200 50 0.25 \<br>    --out EUR<br><span class="hljs-comment"># Then we calculate the first 6 PCs</span><br>plink \<br>    --bfile EUR.QC \<br>    --extract EUR.prune.in \<br>    --pca 6 \<br>    --out EUR<br></code></pre></td></tr></table></figure><p>在这里 pc 已经被存储在 EUR.eigenvec 文件中，并且可以用作回归模型中的协变量来解释种群分层。</p><h4 id="3-1-6-Finding-the-“best-fit”-PRS"><a href="#3-1-6-Finding-the-“best-fit”-PRS" class="headerlink" title="3.1.6 Finding the “best-fit” PRS"></a>3.1.6 Finding the “best-fit” PRS</h4><p>在C+T方法下提供 “最佳拟合 “PRS的P值阈值通常是未知的。为了接近 “最佳拟合 “的PRS，我们可以在一系列P值阈值下计算的PRS之间进行回归，然后选择能够解释最高表型变异的PRS（请参见我们论文中关于过拟合问题的第4.6节）。这可以用R语言实现，方法如下。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs R">library(data.table)<br>library(magrittr)<br>p.threshold &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">0.001</span>,<span class="hljs-number">0.05</span>,<span class="hljs-number">0.1</span>,<span class="hljs-number">0.2</span>,<span class="hljs-number">0.3</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.5</span>)<br>phenotype &lt;- fread(<span class="hljs-string">&quot;EUR.height&quot;</span>)<br>pcs &lt;- fread(<span class="hljs-string">&quot;EUR.eigenvec&quot;</span>, header=<span class="hljs-built_in">F</span>) %&gt;%<br>    setnames(., colnames(.), <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;FID&quot;</span>, <span class="hljs-string">&quot;IID&quot;</span>, paste0(<span class="hljs-string">&quot;PC&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">6</span>)) )<br>covariate &lt;- fread(<span class="hljs-string">&quot;EUR.cov&quot;</span>)<br>pheno &lt;- merge(phenotype, covariate) %&gt;%<br>        merge(., pcs)<br>null.r2 &lt;- summary(lm(Height~., data=pheno[,-<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;FID&quot;</span>, <span class="hljs-string">&quot;IID&quot;</span>)]))$r.squared<br>prs.result &lt;- <span class="hljs-literal">NULL</span><br><span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> p.threshold)&#123;<br>    pheno.prs &lt;- paste0(<span class="hljs-string">&quot;EUR.&quot;</span>, i, <span class="hljs-string">&quot;.profile&quot;</span>) %&gt;%<br>        fread(.) %&gt;%<br>        .[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;FID&quot;</span>, <span class="hljs-string">&quot;IID&quot;</span>, <span class="hljs-string">&quot;SCORE&quot;</span>)] %&gt;%<br>        merge(., pheno, by=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;FID&quot;</span>, <span class="hljs-string">&quot;IID&quot;</span>))<br><br>    model &lt;- lm(Height~., data=pheno.prs[,-<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;FID&quot;</span>,<span class="hljs-string">&quot;IID&quot;</span>)]) %&gt;%<br>            summary<br>    model.r2 &lt;- model$r.squared<br>    prs.r2 &lt;- model.r2-null.r2<br>    prs.coef &lt;- model$coeff[<span class="hljs-string">&quot;SCORE&quot;</span>,]<br>    prs.result %&lt;&gt;% rbind(.,<br>        data.frame(Threshold=i, R2=prs.r2, <br>                    P=<span class="hljs-built_in">as.numeric</span>(prs.coef[<span class="hljs-number">4</span>]), <br>                    BETA=<span class="hljs-built_in">as.numeric</span>(prs.coef[<span class="hljs-number">1</span>]),<br>                    SE=<span class="hljs-built_in">as.numeric</span>(prs.coef[<span class="hljs-number">2</span>])))<br>&#125;<br>print(prs.result[which.max(prs.result$R2),])<br><br><span class="hljs-comment">##   Threshold        R2            P    BETA       SE</span><br><span class="hljs-comment">## 5       0.3 0.1594805 4.312232e-25 40639.7 3700.694</span><br></code></pre></td></tr></table></figure><p>因此，能够产生最佳拟合PRS的P值是：0.3</p><p>最佳拟合的PRS可以解释的phenotypic variation是：0.1594805</p>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
      <tag>PRS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.9.27实验记录iPSYCH_PGC_ASD_Nov2017</title>
    <link href="/2021/09/27/20210927asd/"/>
    <url>/2021/09/27/20210927asd/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-9-27实验记录iPSYCH-PGC-ASD-Nov2017"><a href="#2021-9-27实验记录iPSYCH-PGC-ASD-Nov2017" class="headerlink" title="2021.9.27实验记录iPSYCH_PGC_ASD_Nov2017"></a>2021.9.27实验记录iPSYCH_PGC_ASD_Nov2017</h1><p><strong>参考文献：</strong></p><blockquote><p>Alonso-Gonzalez, Aitana, et al. “Novel gene-based analysis of ASD GWAS: Insight into the biological role of associated genes.” <em>Frontiers in genetics</em> 10 (2019): 733.</p></blockquote><p><strong>数据来源：</strong></p><p>PGC数据库：<a href="https://www.med.unc.edu/pgc/download-results/">https://www.med.unc.edu/pgc/download-results/</a></p><p><strong>数据描述：</strong></p><div class="table-container"><table><thead><tr><th style="text-align:left">pgcGroup</th><th style="text-align:left">phenotype</th><th style="text-align:left">publication</th><th style="text-align:left">journal</th><th style="text-align:left">pubMedIDlink</th><th style="text-align:left">Data DOI</th></tr></thead><tbody><tr><td style="text-align:left">ASD</td><td style="text-align:left">Autism spectrum disorder</td><td style="text-align:left">asd2019</td><td style="text-align:left">Nature Genetics</td><td style="text-align:left"><a href="https://pubmed.ncbi.nlm.nih.gov/30804558">30804558</a></td><td style="text-align:left">10.6084/m9.figshare.14671989</td></tr></tbody></table></div><p><strong>运行环境：</strong></p><p>MacOS Catalina 10.15.7</p><p><strong>软件及网页工具：</strong></p><p>R version 4.0.2 (2020-06-22) </p><p>Pascal (Pathway scoring algorithm) (<a href="https://www2.unil.ch/cbg/index.php?title=PASCAL">https://www2.unil.ch/cbg/index.php?title=PASCAL</a>)</p><p>FunCoup v.4.0 (<a href="http://funcoup.sbc.su.se/search/">http://funcoup.sbc.su.se/search/</a>)</p><p>PathwAX II (<a href="https://pathwax.sbc.su.se/">https://pathwax.sbc.su.se/</a>)</p><p>GENE2FUNC (<a href="http://fuma.ctglab.nl/">http://fuma.ctglab.nl/</a>)</p><p>dbMDEGA (<a href="https://dbmdega.shinyapps.io/dbMDEGA/">https://dbmdega.shinyapps.io/dbMDEGA/</a>)</p><p>LocusZoom tool (<a href="http://locuszoom.org/">http://locuszoom.org/</a>) </p><h2 id="1-查看PGC统计摘要文件格式"><a href="#1-查看PGC统计摘要文件格式" class="headerlink" title="1.查看PGC统计摘要文件格式"></a>1.查看PGC统计摘要文件格式</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">iPSYCH_PGC_ASD_Nov2017 &lt;- read.delim(<span class="hljs-string">&quot;/Users/keqinliu/Downloads/14671989/iPSYCH_PGC_ASD_Nov2017&quot;</span>)<br>print(head(iPSYCH_PGC_ASD_Nov2017))<br><span class="hljs-comment">##   CHR        SNP        BP A1 A2  INFO      OR     SE        P</span><br><span class="hljs-comment">## 1   8 rs62513865 101592213  T  C 0.949 1.00652 0.0270 0.808600</span><br><span class="hljs-comment">## 2   8 rs79643588 106973048  A  G 0.997 1.01786 0.0240 0.460600</span><br><span class="hljs-comment">## 3   8 rs17396518 108690829  T  G 0.987 0.96127 0.0140 0.004647</span><br><span class="hljs-comment">## 4   8   rs983166 108681675  A  C 0.998 0.97990 0.0139 0.145200</span><br><span class="hljs-comment">## 5   8 rs28842593 103044620  T  C 0.857 0.99591 0.0203 0.841500</span><br><span class="hljs-comment">## 6   8 rs35107696 109712249  A AT 0.999 1.01308 0.0165 0.430200</span><br></code></pre></td></tr></table></figure><h2 id="2-运行PASCAL"><a href="#2-运行PASCAL" class="headerlink" title="2.运行PASCAL"></a>2.运行PASCAL</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">(base) KeqindeMacBook-Air:PASCAL keqinliu$ Pascal --pval=/Users/keqinliu/Downloads/iPSYCH_PGC_ASD_Nov2017 --runpathway=on --mergedistance=1<br></code></pre></td></tr></table></figure><p>出现报错：</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">Hello I&#x27;m Pascal<br>WARN: Unknown option (ignored): --mergedistance=1<br>genescoring not set. set to sum as default.<br>2021/09/27_10:29:05:N<br><span class="hljs-section">SETTINGS FILE</span><br><span class="hljs-section">-------------</span><br><br><span class="hljs-bullet">- </span>No settings file specified<br><span class="hljs-bullet">- </span>Loading default settings<br><br>random seed:<br>2<br>Writing file: output/settingsOut.txt<br>Class found = ch.unil.genescore.main.Settings<br>Package = package ch.unil.genescore.main<br><span class="hljs-section">LOADING INPUT FILES</span><br><span class="hljs-section">-------------------</span><br><br>Load annotation: resources/annotation/ucsc/ucsc<span class="hljs-emphasis">_known_genes_2013-09-03.txt</span><br><span class="hljs-emphasis">Loading annotation: resources/annotation/ucsc/ucsc_known_genes_2013-09-03.txt</span><br><span class="hljs-emphasis">Reading file: resources/annotation/ucsc/ucsc_known_genes_2013-09-03.txt</span><br><span class="hljs-emphasis">Reading file: resources/annotation/hla/hlaGenesEntrezIds.txt</span><br><span class="hljs-emphasis">- 205 genes removed because they are in the excluded genes file</span><br><span class="hljs-emphasis">Reading file: /Users/keqinliu/Downloads/iPSYCH_PGC_ASD_</span>Nov2017<br><span class="hljs-symbol">WARNING: </span>snp CHRhas no valid p-value (use NA or NaN for omitted values).<br><span class="hljs-symbol">WARNING: </span>snp 8has no valid p-value (use NA or NaN for omitted values).<br><span class="hljs-symbol">WARNING: </span>snp 8has no valid p-value (use NA or NaN for omitted values).<br></code></pre></td></tr></table></figure><p>检查报错，发现Pascal提示snp无有效p-value</p><p>于是检查Pascal自带的示例文件 EUR.CARDIoGRAM_2010_lipids.HDL_ONE.txt</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">rs3764261</span><span class="hljs-number">7</span>.<span class="hljs-number">10</span>e-<span class="hljs-number">380</span><br><span class="hljs-attribute">rs173539</span><span class="hljs-number">2</span>.<span class="hljs-number">50</span>e-<span class="hljs-number">379</span><br><span class="hljs-attribute">rs247616</span><span class="hljs-number">8</span>.<span class="hljs-number">54</span>e-<span class="hljs-number">378</span><br><span class="hljs-attribute">rs7205804</span><span class="hljs-number">2</span>.<span class="hljs-number">00</span>e-<span class="hljs-number">329</span><br><span class="hljs-attribute">rs1532624</span><span class="hljs-number">2</span>.<span class="hljs-number">93</span>e-<span class="hljs-number">327</span><br><span class="hljs-attribute">rs11508026</span><span class="hljs-number">2</span>.<span class="hljs-number">08</span>e-<span class="hljs-number">323</span><br><span class="hljs-attribute">rs1800775</span><span class="hljs-number">2</span>.<span class="hljs-number">06</span>e-<span class="hljs-number">306</span><br><span class="hljs-attribute">rs711752</span><span class="hljs-number">2</span>.<span class="hljs-number">07</span>e-<span class="hljs-number">297</span><br><span class="hljs-attribute">rs1864163</span><span class="hljs-number">3</span>.<span class="hljs-number">69</span>e-<span class="hljs-number">281</span><br><span class="hljs-attribute">rs11076175</span><span class="hljs-number">3</span>.<span class="hljs-number">99</span>e-<span class="hljs-number">272</span><br><span class="hljs-attribute">rs9939224</span><span class="hljs-number">5</span>.<span class="hljs-number">61</span>e-<span class="hljs-number">272</span><br><span class="hljs-attribute">rs7499892</span><span class="hljs-number">1</span>.<span class="hljs-number">17</span>e-<span class="hljs-number">271</span><br><span class="hljs-attribute">rs7203984</span><span class="hljs-number">2</span>.<span class="hljs-number">34</span>e-<span class="hljs-number">242</span><br><span class="hljs-attribute">rs9926440</span><span class="hljs-number">4</span>.<span class="hljs-number">43</span>e-<span class="hljs-number">215</span><br><span class="hljs-attribute">rs9929488</span><span class="hljs-number">4</span>.<span class="hljs-number">26</span>e-<span class="hljs-number">190</span><br><span class="hljs-attribute">rs12448528</span><span class="hljs-number">5</span>.<span class="hljs-number">60</span>e-<span class="hljs-number">170</span><br><span class="hljs-attribute">rs9989419</span><span class="hljs-number">2</span>.<span class="hljs-number">96</span>e-<span class="hljs-number">162</span><br><span class="hljs-attribute">rs12708967</span><span class="hljs-number">6</span>.<span class="hljs-number">48</span>e-<span class="hljs-number">160</span><br><span class="hljs-attribute">rs289714</span><span class="hljs-number">3</span>.<span class="hljs-number">05</span>e-<span class="hljs-number">153</span><br><span class="hljs-attribute">rs17368435</span><span class="hljs-number">8</span>.<span class="hljs-number">57</span>e-<span class="hljs-number">121</span><br></code></pre></td></tr></table></figure><p>于是决定将iPSYCH_PGC_ASD_Nov2017统计摘要格式更改为Pascal示例文件的格式：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs r">iPSYCH_PGC_ASD_Nov2017 &lt;- read.delim(<span class="hljs-string">&quot;/Users/keqinliu/Downloads/iPSYCH_PGC_ASD_Nov2017&quot;</span>)<br>print(head(iPSYCH_PGC_ASD_Nov2017))<br><br>new &lt;- cbind(iPSYCH_PGC_ASD_Nov2017$SNP, iPSYCH_PGC_ASD_Nov2017$P)<br>print(head(new))<br><span class="hljs-comment">##     [,1]         [,2]      </span><br><span class="hljs-comment">## [1,] &quot;rs62513865&quot; &quot;0.8086&quot;  </span><br><span class="hljs-comment">## [2,] &quot;rs79643588&quot; &quot;0.4606&quot;  </span><br><span class="hljs-comment">## [3,] &quot;rs17396518&quot; &quot;0.004647&quot;</span><br><span class="hljs-comment">## [4,] &quot;rs983166&quot;   &quot;0.1452&quot;  </span><br><span class="hljs-comment">## [5,] &quot;rs28842593&quot; &quot;0.8415&quot;  </span><br><span class="hljs-comment">## [6,] &quot;rs35107696&quot; &quot;0.4302&quot;  </span><br></code></pre></td></tr></table></figure><p>将修改后的文件保存为：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">write_excel_csv(new, file=<span class="hljs-string">&quot;iPSYCH_PGC_ASD_Nov2017_new&quot;</span>, delim = <span class="hljs-string">&quot; &quot;</span>)<br></code></pre></td></tr></table></figure><p>运行Pascal</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">(base) KeqindeMacBook-Air:PASCAL keqinliu$ Pascal --pval=/Users/keqinliu/iPSYCH_PGC_ASD_Nov2017_new --runpathway=on --chr=8<br></code></pre></td></tr></table></figure><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs crystal">Writing <span class="hljs-symbol">file:</span> output/iPSYCH_PGC_ASD_Nov2017_new.sum.numSnpError.chr8.txt<br><br>Reading <span class="hljs-symbol">file:</span> resources/genesets/msigdb/msigBIOCARTA_KEGG_REACTOME.gmt<br><br><span class="hljs-symbol">Loaded:</span><br>- <span class="hljs-number">1077</span> gene sets<br>- <span class="hljs-number">799</span> genes <span class="hljs-keyword">with</span> pathway / gene set <span class="hljs-keyword">annotation</span><br><span class="hljs-symbol">Ignored:</span><br>- <span class="hljs-number">7584</span> genes not found in loaded genome <span class="hljs-keyword">annotation</span> (<span class="hljs-title">UCSC</span> <span class="hljs-title">known</span> <span class="hljs-title">genes</span><br></code></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">CREATING META-GENES</span><br><span class="hljs-section">-------------------</span><br><br>Merging genes of the same pathway that are &lt;1.0mb apart:<br><span class="hljs-bullet">- </span>42 meta-genes created<br><span class="hljs-bullet">- </span>5.023809523809524 genes per meta-gene on average (min=2, max=8)<br><br>Computing gene scores for meta-genes ...<br>Writing file: output/iPSYCH<span class="hljs-emphasis">_PGC_ASD_Nov2017_new.sum.fusion.genescores.chr8.txt</span><br><span class="hljs-emphasis">Format: gene_</span>id, symbol, #snps, runtime, [warnings]<br></code></pre></td></tr></table></figure><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams">- Runtime: <span class="hljs-number">0</span>h <span class="hljs-number">0</span><span class="hljs-built_in">min</span> <span class="hljs-number">14</span>s <span class="hljs-number">139</span>ms<br>- <span class="hljs-number">1077</span> gene <span class="hljs-keyword">sets</span> with <span class="hljs-comment">p-value &lt; 1.0</span><br><br>Writing <span class="hljs-comment">file: output</span>/iPSYCH_PGC_ASD_Nov2017_new.PathwaySet--msigBIOCARTA_KEGG_REACTOME--<span class="hljs-keyword">sum</span>.chr8.txt<br></code></pre></td></tr></table></figure><h2 id="3-Pascal生成文件"><a href="#3-Pascal生成文件" class="headerlink" title="3.Pascal生成文件"></a>3.Pascal生成文件</h2><p>共5个：</p><p>iPSYCH_PGC_ASD_Nov2017_new.PathwaySet—msigBIOCARTA_KEGG_REACTOME—sum.chr8.txt</p><p>iPSYCH_PGC_ASD_Nov2017_new.sum.genescores.chr8.txt</p><p>iPSYCH_PGC_ASD_Nov2017_new.sum.fusion.genescores.chr8.txt</p><p>iPSYCH_PGC_ASD_Nov2017_new.sum.numSnpError.chr8.txt</p><p>settingsOut.txt</p><h3 id="3-1-检查生成的sum-genescores"><a href="#3-1-检查生成的sum-genescores" class="headerlink" title="3.1.检查生成的sum_genescores"></a>3.1.检查生成的sum_genescores</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs r">sum_genescores &lt;- read.delim(<span class="hljs-string">&quot;/Users/keqinliu/iPSYCH_PGC_ASD_Nov2017_new.sum.genescores.chr8.txt&quot;</span>)<br>print(head(sum_genescores))<br>sum_genescores[order(sum_genescores$pvalue),] <span class="hljs-comment">#按照pvalue升序排列，筛选前10位。</span><br></code></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>chromosome</th><th>start</th><th>end</th><th>strand</th><th>gene_id</th><th>gene_symbol</th><th>numSnps</th><th>pvalue</th></tr></thead><tbody><tr><td>chr8</td><td>10530146</td><td>10558103</td><td>+</td><td>203076</td><td>C8orf74</td><td>314</td><td>1.773485e-06</td></tr><tr><td>chr8</td><td>10581277</td><td>10697299</td><td>-</td><td>83595</td><td>SOX7</td><td>752</td><td>4.839478e-06</td></tr><tr><td>chr8</td><td>10622883</td><td>10697299</td><td>-</td><td>54984</td><td>PINX1</td><td>684</td><td>7.776723e-06</td></tr><tr><td>chr8</td><td>8641998</td><td>8751131</td><td>-</td><td>9258</td><td>MFHAS1</td><td>853</td><td>7.811383e-06</td></tr><tr><td>chr8</td><td>10682882</td><td>10682953</td><td>-</td><td>100302166</td><td>MIR1322</td><td>429</td><td>2.032506e-05</td></tr><tr><td>chr8</td><td>11278972</td><td>11324276</td><td>-</td><td>83648</td><td>FAM167A</td><td>557</td><td>2.310428e-05</td></tr><tr><td>chr8</td><td>11225910</td><td>11296166</td><td>+</td><td>83656</td><td>C8orf12</td><td>622</td><td>2.538882e-05</td></tr><tr><td>chr8</td><td>8860313</td><td>8890849</td><td>+</td><td>90459</td><td>ERI1</td><td>504</td><td>3.097496e-05</td></tr><tr><td>chr8</td><td>11351520</td><td>11422108</td><td>+</td><td>640</td><td>BLK</td><td>582</td><td>3.772496e-05</td></tr><tr><td>chr8</td><td>8993763</td><td>9009152</td><td>-</td><td>79660</td><td>PPP1R3B</td><td>287</td><td>3.868200e-05</td></tr></tbody></table></div><h3 id="3-2-检查生成的pathwayset"><a href="#3-2-检查生成的pathwayset" class="headerlink" title="3.2.检查生成的pathwayset"></a>3.2.检查生成的pathwayset</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">PathwaySet &lt;- read.delim(<span class="hljs-string">&quot;/Volumes/My\ Passport\ for\ Mac/biosoftware/PASCAL/output/iPSYCH_PGC_ASD_Nov2017_new.PathwaySet--msigBIOCARTA_KEGG_REACTOME--sum.chr8.txt&quot;</span>)<br>print(head(PathwaySet))<br>PathwaySet[order(PathwaySet$chi2Pvalue),] <span class="hljs-comment">#按照chi1Pvalue升序排列，筛选pvalue均＜0.05</span><br></code></pre></td></tr></table></figure><div class="table-container"><table><thead><tr><th>Name</th><th>chi2Pvalue</th><th>empPvalue</th></tr></thead><tbody><tr><td>REACTOME_ACTIVATION_OF_KAINATE_RECEPTORS_UPON_GLUTAMATE_BINDING</td><td>0.02750000</td><td>0.02767</td></tr><tr><td>REACTOME_IONOTROPIC_ACTIVITY_OF_KAINATE_RECEPTORS</td><td>0.02750000</td><td>0.02720</td></tr><tr><td>REACTOME_SIGNAL_TRANSDUCTION_BY_L1</td><td>0.03125000</td><td>0.03123</td></tr><tr><td>REACTOME_ANTIGEN_ACTIVATES_B_CELL_RECEPTOR_LEADING_TO_GENERATION_OF_SECOND_MESSENGERS</td><td>0.03131834</td><td>0.02722</td></tr><tr><td>BIOCARTA_ALK_PATHWAY</td><td>0.03875000</td><td>0.03838</td></tr><tr><td>REACTOME_SYNTHESIS_SECRETION_AND_INACTIVATION_OF_GIP</td><td>0.03875000</td><td>0.03918</td></tr><tr><td>REACTOME_INCRETIN_SYNTHESIS_SECRETION_AND_INACTIVATION</td><td>0.03875000</td><td>0.03938</td></tr></tbody></table></div><h2 id="4-funcoup5检查基因网络"><a href="#4-funcoup5检查基因网络" class="headerlink" title="4.funcoup5检查基因网络"></a>4.funcoup5检查基因网络</h2><p><a href="https://funcoup5.scilifelab.se/">https://funcoup5.scilifelab.se/</a></p><p>查询：C8orf74 SOX7 PINX1 MFHAS1 MIR1322 FAM167A C8orf12 ERI1 BLK PPP1R3B</p><p><img src="FunCoup_subnetwork.png" alt="FunCoup_subnetwork (1)"></p><h2 id="5-PathwAX-II查询"><a href="#5-PathwAX-II查询" class="headerlink" title="5.PathwAX II查询"></a>5.PathwAX II查询</h2><p><a href="https://pathwax.sbc.su.se/">https://pathwax.sbc.su.se/</a></p><p><strong>查询内容：</strong></p><blockquote><p>C8orf74 SOX7 PINX1 MFHAS1 MIR1322 FAM167A C8orf12 ERI1 BLK PPP1R3B</p></blockquote><p><img src="kegg_pathway.png" alt="截屏2021-09-27 下午2.12.56"></p><div class="table-container"><table><thead><tr><th><strong>Pathway</strong></th><th><strong>PathwaySize</strong></th><th><strong>CrossTalk</strong></th><th><strong>type</strong></th><th><strong>pValue</strong></th><th><strong>FWER</strong></th></tr></thead><tbody><tr><td><strong>Focal adhesion</strong></td><td>198</td><td>77</td><td>enrichment</td><td>2.89E-15</td><td>8.44E-13</td></tr><tr><td><strong>Pathways in cancer</strong></td><td>533</td><td>128</td><td>enrichment</td><td>1.91E-14</td><td>5.57E-12</td></tr><tr><td><strong>Regulation of actin cytoskeleton</strong></td><td>211</td><td>81</td><td>enrichment</td><td>4.4E-13</td><td>1.28E-10</td></tr><tr><td><strong>Proteoglycans in cancer</strong></td><td>203</td><td>75</td><td>enrichment</td><td>6.16E-11</td><td>1.8E-08</td></tr><tr><td><strong>PI3K-Akt signaling pathway</strong></td><td>356</td><td>85</td><td>enrichment</td><td>2.94E-10</td><td>8.6E-08</td></tr><tr><td><strong>Cellular senescence</strong></td><td>160</td><td>81</td><td>enrichment</td><td>6.69E-10</td><td>1.95E-07</td></tr><tr><td><strong>Rap1 signaling pathway</strong></td><td>213</td><td>57</td><td>enrichment</td><td>1.61E-09</td><td>4.7E-07</td></tr><tr><td><strong>Oocyte meiosis</strong></td><td>126</td><td>81</td><td>enrichment</td><td>2.33E-09</td><td>6.8E-07</td></tr><tr><td><strong>Cell cycle</strong></td><td>126</td><td>90</td><td>enrichment</td><td>1.08E-08</td><td>0.00000315</td></tr><tr><td><strong>Gap junction</strong></td><td>90</td><td>55</td><td>enrichment</td><td>1.46E-08</td><td>0.00000426</td></tr><tr><td><strong>Human cytomegalovirus infection</strong></td><td>225</td><td>64</td><td>enrichment</td><td>3.09E-08</td><td>0.00000903</td></tr><tr><td><strong>ECM-receptor interaction</strong></td><td>88</td><td>17</td><td>enrichment</td><td>3.18E-08</td><td>0.00000927</td></tr><tr><td><strong>Axon guidance</strong></td><td>182</td><td>42</td><td>enrichment</td><td>3.94E-08</td><td>0.0000115</td></tr><tr><td><strong>Pathogenic Escherichia coli infection</strong></td><td>202</td><td>89</td><td>enrichment</td><td>9.19E-08</td><td>0.0000268</td></tr><tr><td><strong>FoxO signaling pathway</strong></td><td>132</td><td>45</td><td>enrichment</td><td>1.06E-07</td><td>0.0000309</td></tr><tr><td><strong>Estrogen signaling pathway</strong></td><td>139</td><td>60</td><td>enrichment</td><td>1.09E-07</td><td>0.0000318</td></tr><tr><td><strong>Cushing syndrome</strong></td><td>155</td><td>40</td><td>enrichment</td><td>1.23E-07</td><td>0.0000359</td></tr><tr><td><strong>Shigellosis</strong></td><td>205</td><td>81</td><td>enrichment</td><td>1.35E-07</td><td>0.0000394</td></tr><tr><td><strong>Small cell lung cancer</strong></td><td>93</td><td>29</td><td>enrichment</td><td>2.45E-07</td><td>0.0000715</td></tr><tr><td><strong>Viral carcinogenesis</strong></td><td>201</td><td>115</td><td>enrichment</td><td>2.71E-07</td><td>0.0000791</td></tr><tr><td><strong>Leukocyte transendothelial migration</strong></td><td>113</td><td>39</td><td>enrichment</td><td>4.52E-07</td><td>0.000132</td></tr><tr><td><strong>Yersinia infection</strong></td><td>120</td><td>41</td><td>enrichment</td><td>6.16E-07</td><td>0.000180</td></tr><tr><td><strong>Prostate cancer</strong></td><td>98</td><td>42</td><td>enrichment</td><td>9.26E-07</td><td>0.000271</td></tr><tr><td><strong>ErbB signaling pathway</strong></td><td>87</td><td>31</td><td>enrichment</td><td>9.57E-07</td><td>0.000279</td></tr><tr><td><strong>Vascular smooth muscle contraction</strong></td><td>133</td><td>39</td><td>enrichment</td><td>9.63E-07</td><td>0.000281</td></tr><tr><td><strong>Bacterial invasion of epithelial cells</strong></td><td>72</td><td>44</td><td>enrichment</td><td>0.00000102</td><td>0.000298</td></tr><tr><td><strong>cAMP signaling pathway</strong></td><td>219</td><td>51</td><td>enrichment</td><td>0.00000104</td><td>0.000305</td></tr><tr><td><strong>Human papillomavirus infection</strong></td><td>334</td><td>81</td><td>enrichment</td><td>0.00000125</td><td>0.000364</td></tr><tr><td><strong>Hepatitis B</strong></td><td>165</td><td>56</td><td>enrichment</td><td>0.00000159</td><td>0.000465</td></tr><tr><td><strong>Adherens junction</strong></td><td>69</td><td>35</td><td>enrichment</td><td>0.00000197</td><td>0.000575</td></tr><tr><td><strong>Platelet activation</strong></td><td>124</td><td>41</td><td>enrichment</td><td>0.00000198</td><td>0.000577</td></tr><tr><td><strong>GnRH signaling pathway</strong></td><td>95</td><td>34</td><td>enrichment</td><td>0.00000215</td><td>0.000628</td></tr><tr><td><strong>Fluid shear stress and atherosclerosis</strong></td><td>137</td><td>55</td><td>enrichment</td><td>0.00000220</td><td>0.000642</td></tr><tr><td><strong>AGE-RAGE signaling pathway in diabetic complications</strong></td><td>102</td><td>29</td><td>enrichment</td><td>0.00000245</td><td>0.000715</td></tr><tr><td><strong>Neurotrophin signaling pathway</strong></td><td>120</td><td>47</td><td>enrichment</td><td>0.00000271</td><td>0.000793</td></tr><tr><td><strong>Glioma</strong></td><td>77</td><td>35</td><td>enrichment</td><td>0.00000296</td><td>0.000864</td></tr><tr><td><strong>Gastric cancer</strong></td><td>149</td><td>34</td><td>enrichment</td><td>0.00000298</td><td>0.000870</td></tr><tr><td><strong>Oxytocin signaling pathway</strong></td><td>154</td><td>47</td><td>enrichment</td><td>0.00000315</td><td>0.000919</td></tr><tr><td><strong>VEGF signaling pathway</strong></td><td>61</td><td>27</td><td>enrichment</td><td>0.00000367</td><td>0.00107</td></tr><tr><td><strong>Growth hormone synthesis, secretion and action</strong></td><td>123</td><td>34</td><td>enrichment</td><td>0.00000567</td><td>0.00166</td></tr><tr><td><strong>Non-small cell lung cancer</strong></td><td>68</td><td>27</td><td>enrichment</td><td>0.00000570</td><td>0.00166</td></tr><tr><td><strong>Human immunodeficiency virus 1 infection</strong></td><td>212</td><td>67</td><td>enrichment</td><td>0.00000617</td><td>0.00180</td></tr><tr><td><strong>Phospholipase D signaling pathway</strong></td><td>149</td><td>30</td><td>enrichment</td><td>0.00000917</td><td>0.00268</td></tr><tr><td><strong>Progesterone-mediated oocyte maturation</strong></td><td>97</td><td>43</td><td>enrichment</td><td>0.00000923</td><td>0.00269</td></tr><tr><td><strong>Tight junction</strong></td><td>171</td><td>61</td><td>enrichment</td><td>0.0000120</td><td>0.00350</td></tr><tr><td><strong>Pertussis</strong></td><td>81</td><td>31</td><td>enrichment</td><td>0.0000155</td><td>0.00453</td></tr><tr><td><strong>p53 signaling pathway</strong></td><td>73</td><td>25</td><td>enrichment</td><td>0.0000162</td><td>0.00472</td></tr><tr><td><strong>Fc gamma R-mediated phagocytosis</strong></td><td>94</td><td>36</td><td>enrichment</td><td>0.0000182</td><td>0.00531</td></tr><tr><td><strong>Chemokine signaling pathway</strong></td><td>190</td><td>39</td><td>enrichment</td><td>0.0000198</td><td>0.00579</td></tr><tr><td><strong>Glycolysis / Gluconeogenesis</strong></td><td>68</td><td>49</td><td>enrichment</td><td>0.0000209</td><td>0.00611</td></tr><tr><td><strong>Long-term potentiation</strong></td><td>69</td><td>35</td><td>enrichment</td><td>0.0000231</td><td>0.00676</td></tr><tr><td><strong>Apelin signaling pathway</strong></td><td>138</td><td>37</td><td>enrichment</td><td>0.0000265</td><td>0.00773</td></tr><tr><td><strong>Melanogenesis</strong></td><td>102</td><td>31</td><td>enrichment</td><td>0.0000271</td><td>0.00791</td></tr><tr><td><strong>Ras signaling pathway</strong></td><td>233</td><td>44</td><td>enrichment</td><td>0.0000395</td><td>0.0115</td></tr><tr><td><strong>Bladder cancer</strong></td><td>41</td><td>20</td><td>enrichment</td><td>0.0000413</td><td>0.0121</td></tr><tr><td><strong>Chronic myeloid leukemia</strong></td><td>77</td><td>34</td><td>enrichment</td><td>0.0000428</td><td>0.0125</td></tr><tr><td><strong>Adrenergic signaling in cardiomyocytes</strong></td><td>151</td><td>45</td><td>enrichment</td><td>0.0000495</td><td>0.0144</td></tr><tr><td><strong>Hepatitis C</strong></td><td>159</td><td>54</td><td>enrichment</td><td>0.0000526</td><td>0.0153</td></tr><tr><td><strong>HIF-1 signaling pathway</strong></td><td>111</td><td>47</td><td>enrichment</td><td>0.0000530</td><td>0.0155</td></tr><tr><td><strong>Renal cell carcinoma</strong></td><td>70</td><td>33</td><td>enrichment</td><td>0.0000626</td><td>0.0183</td></tr><tr><td><strong>Relaxin signaling pathway</strong></td><td>130</td><td>30</td><td>enrichment</td><td>0.0000653</td><td>0.0191</td></tr><tr><td><strong>cGMP-PKG signaling pathway</strong></td><td>168</td><td>50</td><td>enrichment</td><td>0.0000727</td><td>0.0212</td></tr><tr><td><strong>Melanoma</strong></td><td>73</td><td>21</td><td>enrichment</td><td>0.0000757</td><td>0.0221</td></tr><tr><td><strong>T cell receptor signaling pathway</strong></td><td>104</td><td>28</td><td>enrichment</td><td>0.0000766</td><td>0.0224</td></tr><tr><td><strong>Hepatocellular carcinoma</strong></td><td>168</td><td>41</td><td>enrichment</td><td>0.0000805</td><td>0.0235</td></tr><tr><td><strong>MicroRNAs in cancer</strong></td><td>164</td><td>45</td><td>enrichment</td><td>0.0000844</td><td>0.0246</td></tr><tr><td><strong>Hippo signaling pathway</strong></td><td>153</td><td>46</td><td>enrichment</td><td>0.0000869</td><td>0.0254</td></tr><tr><td><strong>Kaposi sarcoma-associated herpesvirus infection</strong></td><td>188</td><td>44</td><td>enrichment</td><td>0.000106</td><td>0.0311</td></tr><tr><td><strong>Natural killer cell mediated cytotoxicity</strong></td><td>124</td><td>24</td><td>enrichment</td><td>0.000106</td><td>0.0311</td></tr><tr><td><strong>Prolactin signaling pathway</strong></td><td>72</td><td>23</td><td>enrichment</td><td>0.000119</td><td>0.0346</td></tr><tr><td><strong>Circadian entrainment</strong></td><td>99</td><td>26</td><td>enrichment</td><td>0.000127</td><td>0.0370</td></tr></tbody></table></div><blockquote><p> Failed query mapping: C20ORF20, FLJ20674</p></blockquote><p><img src="gene_network.png" alt="截屏2021-09-27 下午2.13.35"></p><h2 id="6-GENE2FUNC-功能注释"><a href="#6-GENE2FUNC-功能注释" class="headerlink" title="6.GENE2FUNC 功能注释"></a>6.GENE2FUNC 功能注释</h2><p><a href="https://fuma.ctglab.nl/snp2gene">https://fuma.ctglab.nl/snp2gene</a></p><p>先使用fuma工具，为snp添加基因注释</p><blockquote><p>用户名称：Liu Keqin</p><p>登录邮箱：liukeqin2020@sibs.ac.cn</p></blockquote><p><strong>运行参数记录</strong></p><blockquote><div class="table-container"><table><thead><tr><th>created_at</th><th>2021-09-27 09:44:20</th></tr></thead><tbody><tr><td>title</td><td>20210927</td></tr><tr><td>FUMA</td><td>v1.3.6d</td></tr><tr><td>MAGMA</td><td>v1.08</td></tr><tr><td>GWAScatalog</td><td>e104_r2021-09-15</td></tr><tr><td>ANNOVAR</td><td>2017-07-17</td></tr><tr><td>gwasfile</td><td>iPSYCH_PGC_ASD_Nov2017</td></tr><tr><td>chrcol</td><td>CHR</td></tr><tr><td>poscol</td><td>BP</td></tr><tr><td>rsIDcol</td><td>SNP</td></tr><tr><td>pcol</td><td>P</td></tr><tr><td>eacol</td><td>A1</td></tr><tr><td>neacol</td><td>A2</td></tr><tr><td>orcol</td><td>OR</td></tr><tr><td>becol</td><td>NA</td></tr><tr><td>secol</td><td>SE</td></tr><tr><td>leadSNPsfile</td><td>NA</td></tr><tr><td>addleadSNPs</td><td>1</td></tr><tr><td>regionsfile</td><td>NA</td></tr><tr><td>N</td><td>18381</td></tr><tr><td>Ncol</td><td>NA</td></tr><tr><td>exMHC</td><td>1</td></tr><tr><td>MHCopt</td><td>annot</td></tr><tr><td>extMHC</td><td>NA</td></tr><tr><td>ensembl</td><td>v92</td></tr><tr><td>genetype</td><td>protein_coding</td></tr><tr><td>leadP</td><td>5e-8</td></tr><tr><td>gwasP</td><td>0.05</td></tr><tr><td>r2</td><td>0.6</td></tr><tr><td>r2_2</td><td>0.1</td></tr><tr><td>refpanel</td><td>1KG/Phase3</td></tr><tr><td>pop</td><td>EUR</td></tr><tr><td>MAF</td><td>0</td></tr><tr><td>refSNPs</td><td>1</td></tr><tr><td>mergeDist</td><td>250</td></tr><tr><td>magma</td><td>1</td></tr><tr><td>magma_window</td><td>0</td></tr><tr><td>magma_exp</td><td>GTEx/v8/gtex_v8_ts_avg_log2TPM, GTEx/v8/gtex_v8_ts_general_avg_log2TPM</td></tr><tr><td>posMap</td><td>1</td></tr><tr><td>posMapWindowSize</td><td>10</td></tr><tr><td>posMapAnnot</td><td>NA</td></tr><tr><td>posMapCADDth</td><td>0</td></tr><tr><td>posMapRDBth</td><td>NA</td></tr><tr><td>posMapChr15</td><td>NA</td></tr><tr><td>posMapChr15Max</td><td>NA</td></tr><tr><td>posMapChr15Meth</td><td>NA</td></tr><tr><td>posMapAnnoDs</td><td>NA</td></tr><tr><td>posMapAnnoMeth</td><td>NA</td></tr><tr><td>eqtlMap</td><td>0</td></tr><tr><td>eqtlMaptss</td><td>NA</td></tr><tr><td>eqtlMapSig</td><td>1</td></tr><tr><td>eqtlMapP</td><td>1</td></tr><tr><td>eqtlMapCADDth</td><td>0</td></tr><tr><td>eqtlMapRDBth</td><td>NA</td></tr><tr><td>eqtlMapChr15</td><td>NA</td></tr><tr><td>eqtlMapChr15Max</td><td>NA</td></tr><tr><td>eqtlMapChr15Meth</td><td>NA</td></tr><tr><td>eqtlMapAnnoDs</td><td>NA</td></tr><tr><td>eqtlMapAnnoMeth</td><td>NA</td></tr><tr><td>ciMap</td><td>0</td></tr><tr><td>ciMapBuiltin</td><td>NA</td></tr><tr><td>ciMapFileN</td><td>0</td></tr><tr><td>ciMapFiles</td><td>NA</td></tr><tr><td>ciMapFDR</td><td>NA</td></tr><tr><td>ciMapPromWindow</td><td>NA</td></tr><tr><td>ciMapRoadmap</td><td>NA</td></tr><tr><td>ciMapEnhFilt</td><td>0</td></tr><tr><td>ciMapPromFilt</td><td>0</td></tr><tr><td>ciMapCADDth</td><td>0</td></tr><tr><td>ciMapRDBth</td><td>NA</td></tr><tr><td>ciMapChr15</td><td>NA</td></tr><tr><td>ciMapChr15Max</td><td>NA</td></tr><tr><td>ciMapChr15Meth</td><td>NA</td></tr><tr><td>ciMapAnnoDs</td><td>NA</td></tr><tr><td>ciMapAnnoMeth</td><td>NA</td></tr></tbody></table></div></blockquote><h3 id="Manhattan-Plot-GWAS-summary-statistics"><a href="#Manhattan-Plot-GWAS-summary-statistics" class="headerlink" title="Manhattan Plot (GWAS summary statistics)"></a>Manhattan Plot (GWAS summary statistics)</h3><p>For plotting, overlapping data points are not drawn (filtering was performed only for SNPs with P-value ≥ 1e-5, see tutorial for details).</p><p><img src="manhattan_FUMA_jobs147024.png" alt="manhattan_FUMA_jobs147024"></p><h3 id="Mahattan-Plot-gene-based-test"><a href="#Mahattan-Plot-gene-based-test" class="headerlink" title="Mahattan Plot (gene-based test)"></a>Mahattan Plot (gene-based test)</h3><p>Input SNPs were mapped to 18937 protein coding genes. Genome wide significance (red dashed line in the plot) was defined at P = 0.05/18937 = 2.640e-6.</p><p>标注top20的基因：</p><p><img src="geneManhattan_FUMA_jobs147024.png" alt="geneManhattan_FUMA_jobs147024"></p><h3 id="QQ-plot-GWAS-summary-statisics"><a href="#QQ-plot-GWAS-summary-statisics" class="headerlink" title="QQ plot (GWAS summary statisics)"></a>QQ plot (GWAS summary statisics)</h3><p>For plotting purposes, overlapping data points are not drawn (filtering was performed only for SNPs with P-value ≥ 1e-5, see tutorial for details).</p><p><img src="QQplot_FUMA_jobs147024.png" alt="QQplot_FUMA_jobs147024"></p><h3 id="QQ-plot-gene-based-test"><a href="#QQ-plot-gene-based-test" class="headerlink" title="QQ plot (gene-based test)"></a>QQ plot (gene-based test)</h3><p>This is a Q-Q plot of the gene-based test computed by MAGMA.</p><p><img src="geneQQplot_FUMA_jobs147024.png" alt="geneQQplot_FUMA_jobs147024"></p><h3 id="MAGMA-Gene-Set-Analysis"><a href="#MAGMA-Gene-Set-Analysis" class="headerlink" title="MAGMA Gene-Set Analysis"></a>MAGMA Gene-Set Analysis</h3><p>MAGMA gene-set analysis is performed for curated gene sets and GO terms obtained from MsigDB (see here for details).<br>The table displays either significant gene sets with Pbon &lt; 0.05 or top 10 gene sets when there are less than 10 significant gene sets. Full results are downloadable from “Download” tab.<br>Note that MAGMA gene-set analyses uses the full distribution of SNP p-values and is different from a pathway enrichment test as implemented in GENE2FUNC that only tests for enrichment of prioritized genes.</p><div class="table-container"><table><thead><tr><th style="text-align:left">Gene Set</th><th style="text-align:left">N genes</th><th style="text-align:left">Beta</th><th style="text-align:left">Beta STD</th><th style="text-align:left">SE</th><th style="text-align:left">P</th><th style="text-align:left">Pbon</th></tr></thead><tbody><tr><td style="text-align:left">GO_bp:go_macrophage_colony_stimulating_factor_production</td><td style="text-align:left">5</td><td style="text-align:left">1.394</td><td style="text-align:left">0.022649</td><td style="text-align:left">0.35169</td><td style="text-align:left">3.7034e-05</td><td style="text-align:left">0.573434456</td></tr><tr><td style="text-align:left">GO_cc:go_extrinsic_component_of_postsynaptic_membrane</td><td style="text-align:left">8</td><td style="text-align:left">1.057</td><td style="text-align:left">0.021721</td><td style="text-align:left">0.28832</td><td style="text-align:left">0.00012356</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">GO_bp:go_granulocyte_colony_stimulating_factor_production</td><td style="text-align:left">5</td><td style="text-align:left">1.3071</td><td style="text-align:left">0.021236</td><td style="text-align:left">0.36585</td><td style="text-align:left">0.00017718</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">GO_mf:go_neurotransmitter_receptor_activity</td><td style="text-align:left">108</td><td style="text-align:left">0.3108</td><td style="text-align:left">0.023405</td><td style="text-align:left">0.088422</td><td style="text-align:left">0.00022052</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">GO_cc:go_extrinsic_component_of_synaptic_membrane</td><td style="text-align:left">12</td><td style="text-align:left">0.87453</td><td style="text-align:left">0.022008</td><td style="text-align:left">0.25263</td><td style="text-align:left">0.00026897</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">GO_bp:go_extraembryonic_membrane_development</td><td style="text-align:left">9</td><td style="text-align:left">1.1923</td><td style="text-align:left">0.025987</td><td style="text-align:left">0.35019</td><td style="text-align:left">0.00033198</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">Curated_gene_sets:pid_ncadherin_pathway</td><td style="text-align:left">33</td><td style="text-align:left">0.49317</td><td style="text-align:left">0.02057</td><td style="text-align:left">0.1451</td><td style="text-align:left">0.00033919</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">GO_bp:go_histone_h3_k27_demethylation</td><td style="text-align:left">2</td><td style="text-align:left">1.65</td><td style="text-align:left">0.016957</td><td style="text-align:left">0.49</td><td style="text-align:left">0.0003802</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">GO_mf:go_histone_demethylase_activity_h3_k27_specific_</td><td style="text-align:left">2</td><td style="text-align:left">1.65</td><td style="text-align:left">0.016957</td><td style="text-align:left">0.49</td><td style="text-align:left">0.0003802</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">GO_cc:go_t_tubule</td><td style="text-align:left">52</td><td style="text-align:left">0.43768</td><td style="text-align:left">0.022904</td><td style="text-align:left">0.13185</td><td style="text-align:left">0.00045174</td><td style="text-align:left">1</td></tr></tbody></table></div><h3 id="MAGMA-Tissue-Expression-Analysis"><a href="#MAGMA-Tissue-Expression-Analysis" class="headerlink" title="MAGMA Tissue Expression Analysis"></a>MAGMA Tissue Expression Analysis</h3><p>MAGMA gene-property analysis is performed for gene expression of user selected data sets.<br>Note that MAGMA gene-property analyses uses the full distribution of SNP p-values and is different from a enrichment test of DEG (differentially expressed genes) as implemented in GENE2FUNC that only tests for enrichment of prioritised genes.</p><p><img src="magma_exp_gtex_v8_ts_avg_log2TPM_FUMA_jobs147024.png" alt="magma_exp_gtex_v8_ts_avg_log2TPM_FUMA_jobs147024"></p><p><img src="magma_exp_gtex_v8_ts_general_avg_log2TPM_FUMA_jobs147024.png" alt="magma_exp_gtex_v8_ts_general_avg_log2TPM_FUMA_jobs147024"></p><h3 id="Summary-of-SNPs-and-mapped-genes"><a href="#Summary-of-SNPs-and-mapped-genes" class="headerlink" title="Summary of SNPs and mapped genes"></a>Summary of SNPs and mapped genes</h3><div class="table-container"><table><thead><tr><th>item</th><th>number</th></tr></thead><tbody><tr><td>Genomic risk loci</td><td>3</td></tr><tr><td>lead SNPs</td><td>3</td></tr><tr><td>Ind. Sig. SNPs</td><td>7</td></tr><tr><td>candidate SNPs</td><td>447</td></tr><tr><td>candidate GWAS tagged SNPs</td><td>422</td></tr><tr><td>mapped genes</td><td>8</td></tr></tbody></table></div><h3 id="Functional-consequences-of-SNPs-on-genes"><a href="#Functional-consequences-of-SNPs-on-genes" class="headerlink" title="Functional consequences of SNPs on genes"></a>Functional consequences of SNPs on genes</h3><p><img src="snpAnnotPlot_FUMA_jobs147024.png" alt="snpAnnotPlot_FUMA_jobs147024"></p><h3 id="Summary-per-genomic-risk-locus"><a href="#Summary-per-genomic-risk-locus" class="headerlink" title="Summary per genomic risk locus"></a>Summary per genomic risk locus</h3><p><img src="lociPlot_FUMA_jobs147024.png" alt="lociPlot_FUMA_jobs147024"></p><h3 id="Genomic-Locus"><a href="#Genomic-Locus" class="headerlink" title="Genomic Locus"></a>Genomic Locus</h3><div class="table-container"><table><thead><tr><th style="text-align:left">Genomic Locus</th><th style="text-align:left">uniqID</th><th style="text-align:left">rsID</th><th style="text-align:left">chr</th><th style="text-align:left">pos</th><th style="text-align:left">P-value</th><th style="text-align:left">start</th><th style="text-align:left">end</th><th style="text-align:left">nSNPs</th><th style="text-align:left">nGWASSNPs</th><th style="text-align:left">nIndSigSNPs</th><th style="text-align:left">IndSigSNPs</th><th style="text-align:left">nLeadSNPs</th><th style="text-align:left">LeadSNPs</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:left">8:10576775:C:G</td><td style="text-align:left">rs10099100</td><td style="text-align:left">8</td><td style="text-align:left">10576775</td><td style="text-align:left">1.065e-08</td><td style="text-align:left">10571591</td><td style="text-align:left">10583506</td><td style="text-align:left">6</td><td style="text-align:left">6</td><td style="text-align:left">1</td><td style="text-align:left">rs10099100</td><td style="text-align:left">1</td><td style="text-align:left">rs10099100</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">20:14836243:G:GTTTTTTT</td><td style="text-align:left">rs71190156</td><td style="text-align:left">20</td><td style="text-align:left">14836243</td><td style="text-align:left">2.752e-08</td><td style="text-align:left">14697386</td><td style="text-align:left">14836243</td><td style="text-align:left">49</td><td style="text-align:left">49</td><td style="text-align:left">1</td><td style="text-align:left">rs71190156</td><td style="text-align:left">1</td><td style="text-align:left">rs71190156</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">20:21248116:A:G</td><td style="text-align:left">rs910805</td><td style="text-align:left">20</td><td style="text-align:left">21248116</td><td style="text-align:left">2.041e-09</td><td style="text-align:left">20118473</td><td style="text-align:left">22105020</td><td style="text-align:left">392</td><td style="text-align:left">367</td><td style="text-align:left">5</td><td style="text-align:left">rs910805;rs12625304;rs6035820</td><td style="text-align:left">1</td><td style="text-align:left">rs910805</td></tr></tbody></table></div><h3 id="lead-SNPs"><a href="#lead-SNPs" class="headerlink" title="lead SNPs"></a>lead SNPs</h3><div class="table-container"><table><thead><tr><th style="text-align:left">No</th><th style="text-align:left">Genomic Locus</th><th style="text-align:left">uniqID</th><th style="text-align:left">rsID</th><th style="text-align:left">chr</th><th style="text-align:left">pos</th><th style="text-align:left">P-value</th><th style="text-align:left">nIndSigSNPs</th><th style="text-align:left">IndSigSNPs</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">8:10576775:C:G</td><td style="text-align:left">rs10099100</td><td style="text-align:left">8</td><td style="text-align:left">10576775</td><td style="text-align:left">1.065e-08</td><td style="text-align:left">1</td><td style="text-align:left">rs10099100</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">20:14836243:G:GTTTTTTT</td><td style="text-align:left">rs71190156</td><td style="text-align:left">20</td><td style="text-align:left">14836243</td><td style="text-align:left">2.752e-08</td><td style="text-align:left">1</td><td style="text-align:left">rs71190156</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">3</td><td style="text-align:left">20:21248116:A:G</td><td style="text-align:left">rs910805</td><td style="text-align:left">20</td><td style="text-align:left">21248116</td><td style="text-align:left">2.041e-09</td><td style="text-align:left">5</td><td style="text-align:left">rs910805;rs12625304;rs6035820</td></tr></tbody></table></div><h3 id="Ind-Sig-SNPs"><a href="#Ind-Sig-SNPs" class="headerlink" title="Ind.Sig.SNPs"></a>Ind.Sig.SNPs</h3><div class="table-container"><table><thead><tr><th style="text-align:left">No</th><th style="text-align:left">Genomic Locus</th><th style="text-align:left">uniqID</th><th style="text-align:left">rsID</th><th style="text-align:left">chr</th><th style="text-align:left">pos</th><th style="text-align:left">P-value</th><th style="text-align:left">nSNPs</th><th style="text-align:left">nGWASSNPs</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">8:10576775:C:G</td><td style="text-align:left">rs10099100</td><td style="text-align:left">8</td><td style="text-align:left">10576775</td><td style="text-align:left">1.065e-08</td><td style="text-align:left">6</td><td style="text-align:left">6</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">20:14836243:G:GTTTTTTT</td><td style="text-align:left">rs71190156</td><td style="text-align:left">20</td><td style="text-align:left">14836243</td><td style="text-align:left">2.752e-08</td><td style="text-align:left">49</td><td style="text-align:left">49</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">3</td><td style="text-align:left">20:21182388:C:T</td><td style="text-align:left">rs12625304</td><td style="text-align:left">20</td><td style="text-align:left">21182388</td><td style="text-align:left">8.16e-09</td><td style="text-align:left">4</td><td style="text-align:left">4</td></tr><tr><td style="text-align:left">6</td><td style="text-align:left">3</td><td style="text-align:left">20:21241417:A:T</td><td style="text-align:left">rs6035820</td><td style="text-align:left">20</td><td style="text-align:left">21241417</td><td style="text-align:left">2.867e-08</td><td style="text-align:left">162</td><td style="text-align:left">162</td></tr><tr><td style="text-align:left">7</td><td style="text-align:left">3</td><td style="text-align:left">20:21248116:A:G</td><td style="text-align:left">rs910805</td><td style="text-align:left">20</td><td style="text-align:left">21248116</td><td style="text-align:left">2.041e-09</td><td style="text-align:left">182</td><td style="text-align:left">182</td></tr></tbody></table></div><h3 id="mapped-genes"><a href="#mapped-genes" class="headerlink" title="mapped genes"></a>mapped genes</h3><div class="table-container"><table><thead><tr><th style="text-align:left">Gene</th><th style="text-align:left">Symbol</th><th style="text-align:left">HUGO</th><th style="text-align:left">entrezID</th><th style="text-align:left">chr</th><th style="text-align:left">start</th><th style="text-align:left">end</th><th style="text-align:left">strand</th><th style="text-align:left">type</th><th style="text-align:left">pLI</th><th style="text-align:left">ncRVIS</th><th style="text-align:left">posMapSNPs</th><th style="text-align:left">posMapMaxCADD</th><th style="text-align:left">minGwasP</th><th style="text-align:left">Genomic Locus</th><th style="text-align:left">IndSigSNPs</th></tr></thead><tbody><tr><td style="text-align:left">ENSG00000088930</td><td style="text-align:left">XRN2</td><td style="text-align:left">XRN2</td><td style="text-align:left">22803</td><td style="text-align:left">20</td><td style="text-align:left">21283942</td><td style="text-align:left">21370463</td><td style="text-align:left">1</td><td style="text-align:left">protein_coding</td><td style="text-align:left">0.813170185835591</td><td style="text-align:left">-0.511318347</td><td style="text-align:left">103</td><td style="text-align:left">13.49</td><td style="text-align:left">1.589e-08</td><td style="text-align:left">3</td><td style="text-align:left">rs910805;rs6035820;rs12625304</td></tr><tr><td style="text-align:left">ENSG00000125816</td><td style="text-align:left">NKX2-4</td><td style="text-align:left">NKX2-4</td><td style="text-align:left">644524</td><td style="text-align:left">20</td><td style="text-align:left">21376005</td><td style="text-align:left">21378666</td><td style="text-align:left">-1</td><td style="text-align:left">protein_coding</td><td style="text-align:left">0.278447692496314</td><td style="text-align:left">-0.618232094</td><td style="text-align:left">14</td><td style="text-align:left">11.39</td><td style="text-align:left">2.126e-08</td><td style="text-align:left">3</td><td style="text-align:left">rs910805;rs6035820</td></tr><tr><td style="text-align:left">ENSG00000171056</td><td style="text-align:left">SOX7</td><td style="text-align:left">SOX7</td><td style="text-align:left">83595</td><td style="text-align:left">8</td><td style="text-align:left">10581278</td><td style="text-align:left">10697357</td><td style="text-align:left">-1</td><td style="text-align:left">protein_coding</td><td style="text-align:left">0.131241610927833</td><td style="text-align:left">0.638029508</td><td style="text-align:left">6</td><td style="text-align:left">17.85</td><td style="text-align:left">1.065e-08</td><td style="text-align:left">1</td><td style="text-align:left">rs10099100</td></tr><tr><td style="text-align:left">ENSG00000172264</td><td style="text-align:left">MACROD2</td><td style="text-align:left">MACROD2</td><td style="text-align:left">140733</td><td style="text-align:left">20</td><td style="text-align:left">13976015</td><td style="text-align:left">16033842</td><td style="text-align:left">1</td><td style="text-align:left">protein_coding</td><td style="text-align:left">0.0113567470210345</td><td style="text-align:left">3.34668599</td><td style="text-align:left">49</td><td style="text-align:left">20.4</td><td style="text-align:left">2.752e-08</td><td style="text-align:left">2</td><td style="text-align:left">rs71190156</td></tr><tr><td style="text-align:left">ENSG00000183638</td><td style="text-align:left">RP1L1</td><td style="text-align:left">RP1L1</td><td style="text-align:left">94137</td><td style="text-align:left">8</td><td style="text-align:left">10463859</td><td style="text-align:left">10569697</td><td style="text-align:left">-1</td><td style="text-align:left">protein_coding</td><td style="text-align:left">NA</td><td style="text-align:left">1.244966111</td><td style="text-align:left">5</td><td style="text-align:left">3.864</td><td style="text-align:left">1.065e-08</td><td style="text-align:left">1</td><td style="text-align:left">rs10099100</td></tr><tr><td style="text-align:left">ENSG00000258724</td><td style="text-align:left">SOX7</td><td style="text-align:left">SOX7</td><td style="text-align:left">83595</td><td style="text-align:left">8</td><td style="text-align:left">10582909</td><td style="text-align:left">10697357</td><td style="text-align:left">-1</td><td style="text-align:left">protein_coding</td><td style="text-align:left">NA</td><td style="text-align:left">0.638029508</td><td style="text-align:left">4</td><td style="text-align:left">17.85</td><td style="text-align:left">1.065e-08</td><td style="text-align:left">1</td><td style="text-align:left">rs10099100</td></tr></tbody></table></div><h2 id="7-使用Locus-Zoom绘制Regional-Plots"><a href="#7-使用Locus-Zoom绘制Regional-Plots" class="headerlink" title="7.使用Locus Zoom绘制Regional Plots"></a>7.使用Locus Zoom绘制Regional Plots</h2><p>首先检查每个染色体上包含SNPs的主要区域：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R">iPSYCH_PGC_ASD_Nov2017 &lt;- read.delim(<span class="hljs-string">&quot;/Volumes/My\ Passport\ for\ Mac/data/14671989/iPSYCH_PGC_ASD_Nov2017&quot;</span>)<br>print(head(iPSYCH_PGC_ASD_Nov2017))<br>subset_ch2 &lt;- subset(iPSYCH_PGC_ASD_Nov2017, CHR==<span class="hljs-string">&quot;2&quot;</span>)<br>subset_ch2[order(subset_ch2$P),]<br><span class="hljs-comment">##         CHR            SNP        BP               A1    A2  INFO      OR     SE         P</span><br><span class="hljs-comment">## 4810052   2     rs59566011 159385181               GA     G 0.947 1.07315 0.0144 9.304e-07</span><br><span class="hljs-comment">## 4805439   2     rs70994211 159385148                T    TA 0.990 0.93557 0.0143 3.410e-06</span><br><span class="hljs-comment">## 3955815   2      rs6430841 140318199                A     G 1.000 1.08275 0.0176 6.402e-06</span><br><span class="hljs-comment">## 349794    2      rs7578456 202235348                A     G 0.991 1.06556 0.0141 6.532e-06</span><br><span class="hljs-comment">## 346713    2      rs2110688 202223429                T     C 0.997 1.06492 0.0141 8.044e-06</span><br></code></pre></td></tr></table></figure><p>然后将iPSYCH_PGC_ASD_Nov2017作为输入数据，使用Locus Zoom网页工具绘制Regional Plots (<a href="http://locuszoom.org/genform.php?type=yourdata">http://locuszoom.org/genform.php?type=yourdata</a>)</p><blockquote><p>值得注意的是，输入Locus Zoom的数据，需要选择PLINK生成的格式，选择以制表符作为分隔符，其他非必须参数可选择默认。</p><p>其中，绘图用的mark是SNP，p.value为SNP对应的P。</p></blockquote><p>根据step6生成的曼哈顿图，这里重点关注6，8，17，20号染色体。</p><p>发现6号染色体上的SNPs的对应P值均大于0.05，于是不予考虑。</p><h3 id="EUR-8号染色体-10mb-11mb"><a href="#EUR-8号染色体-10mb-11mb" class="headerlink" title="EUR-8号染色体-10mb-11mb"></a>EUR-8号染色体-10mb-11mb</h3><embed id="pdfPlayer" src="EUR.chr8.10-11mb.pdf" type="application/pdf" width="100%" height="600" ><h3 id="EUR-17号染色体-44mb-45mb"><a href="#EUR-17号染色体-44mb-45mb" class="headerlink" title="EUR-17号染色体-44mb-45mb"></a>EUR-17号染色体-44mb-45mb</h3><embed id="pdfPlayer" src="EUR.chr17.44-45mb.pdf" type="application/pdf" width="100%" height="600" ><h3 id="EUR-20号染色体-21mb-22mb"><a href="#EUR-20号染色体-21mb-22mb" class="headerlink" title="EUR-20号染色体-21mb-22mb"></a>EUR-20号染色体-21mb-22mb</h3><embed id="pdfPlayer" src="EUR.chr20.21-22mb.pdf" type="application/pdf" width="100%" height="600" >]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
      <tag>ASD</tag>
      
      <tag>SNP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MODERNA mRNA 疫苗项目概述</title>
    <link href="/2021/09/18/20210918MODERNAmRNA%E7%96%AB%E8%8B%97%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0/"/>
    <url>/2021/09/18/20210918MODERNAmRNA%E7%96%AB%E8%8B%97%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="MODERNA-mRNA-疫苗项目概述"><a href="#MODERNA-mRNA-疫苗项目概述" class="headerlink" title="MODERNA mRNA 疫苗项目概述"></a>MODERNA mRNA 疫苗项目概述</h1><p>Moderna的研究性个性化癌症疫苗（PCV）旨在利用从个人肿瘤中识别出的新抗原，对身体的免疫系统进行编程，以引起更有效的抗肿瘤反应。在对肿瘤进行测序后，Moderna的专利算法预测新抗原（由肿瘤特异性突变基因编码的抗原）最有可能触发免疫系统攻击特定癌症。今天，编码多达34个独特的新抗原的mRNA可以在一个疫苗中递送。Moderna公司在其马萨诸塞州的生产设施内的个性化疫苗部门开发和制造这些研究性PCV。</p><p>Moderna正与合作者Merck和AstraZeneca一起开发这些潜在的mRNA治疗方法。</p><h2 id="时间线"><a href="#时间线" class="headerlink" title="时间线"></a>时间线</h2><p>【2016年12月13日】</p><p>Moderna宣布正在开发一种基于 mRNA 的个性化癌症疫苗 (PCV) ，利用 mRNA 疫苗技术平台，向患者体内注射编码每个病人特定肿瘤中的独特突变（即新抗原）的肽的 mRNA。</p><p>【2019年6月1日】</p><p>数据显示，mRNA个性化癌症疫苗mRNA-4157，单独或与 Merck 公司的pembrolizumab (KEYTRUDA®)联合使用，在所有测试剂量下均耐受良好，并能引起新抗原特异性T细胞反应。在对患者进行单药治疗或与pembrolizumab（彭布鲁利珠单抗）联合治疗时，没有疫苗相关的严重不良事件报告。</p><p>【2020年11月9日】</p><p>亚利桑那大学健康科学学院的一项临床试验旨在研究一种个性化癌症疫苗与免疫治疗药物Pembrolizumab联合使用的安全性和有效性，在癌症免疫治疗协会年度会议上公布了有希望的初步数据后，该试验将扩大其队列。</p><p>【2020年11月11日】</p><p>Moderna公司在癌症免疫治疗协会年会上分享了该公司正在进行的mRNA个性化癌症疫苗（PCV）mRNA-4157与Merck公司Keytruda®1联合研究的扩大队列的中期数据。分享的数据显示，mRNA-4157与Keytruda®联合使用在所有剂量水平上都具有良好的耐受性，并且在HPV（-）HNSCC患者中产生了以RECIST 1.1标准衡量的肿瘤缩小反应。</p><h2 id="两项进行中的临床试验"><a href="#两项进行中的临床试验" class="headerlink" title="两项进行中的临床试验"></a>两项进行中的临床试验</h2><p>【Clinical Trial NCT03313778】</p><p>这项1期研究的目的是评估mRNA-4157单独应用于已切除实体瘤受试者以及与pembrolizumab联合应用于不可切除的实体瘤受试者的安全性、耐受性和免疫原性。</p><p>【Clinical Trial NCT03897881】</p><p>这项2期研究的目的是评估与单独使用pembrolizumab相比，完全切除的皮肤黑色素瘤和高复发风险的患者使用mRNA-4157和pembrolizumab的术后辅助治疗是否能改善无复发生存（RFS）。</p><h2 id="相关文献"><a href="#相关文献" class="headerlink" title="相关文献"></a>相关文献</h2><p>【Clinical Trial NCT03313778】</p><p>该研究评估mRNA-4157作为单药治疗切除的实体瘤患者（A部分）和/与pembrolizumab联合治疗晚期/转移性实体瘤患者（B部分）的安全性和有效性。A-B部分中选定的实体肿瘤包括黑色素瘤、膀胱癌、HPV阴性（HPV-neg）HNSCC、NSCLC、SCLC、MSI-高（MSI-h）或TMB-高的癌症。扩展队列包括无CPI的MSS-CRC和HPV阴性HNSCC患者（C部分）和切除的黑色素瘤患者（D部分）。患者接受最多9个周期（Q3W）的mRNA-4157肌肉注射，单次注射量不超过1毫克（A部分）或与pembrolizumab联合使用（200毫克静脉注射Q3W，B-D部分）。Pembrolizumab在第一次服用mRNA-4157的剂量之前进行两个周期的治疗，在联合治疗9个周期后可继续服用。终点包括安全性、耐受性、疗效和生物标志物评估。</p><blockquote><p>Bauman J, Burris H, Clarke J<em>, et al</em> 798 Safety, tolerability, and immunogenicity of mRNA-4157 in combination with pembrolizumab in subjects with unresectable solid tumors (KEYNOTE-603): an update Journal for ImmunoTherapy of Cancer 2020;<strong>8:</strong>doi: 10.1136/jitc-2020-SITC2020.0798</p></blockquote><p>该研究旨在在进行一项mRNA-4157的I期剂量递增研究，即在切除的实体瘤（黑色素瘤、膀胱癌、HPV阴性HNSCC、NSCLC、SCLC、MSI高或TMB高的癌症）患者中作为辅助性单药治疗，以及在晚期或转移性癌症患者中与pembrolizumab联合使用，以评估安全性。mRNA-4157是一种脂质封装的个性化疫苗，编码多个新抗原，采用专有算法，旨在诱导新抗原特异性T细胞和相关的抗肿瘤反应。患者可通过肌肉注射（0.04-1毫克）接受最多9个周期（Q3W）的mRNA-4157。在联合治疗组中，在与mRNA-4157联合治疗之前，pembrolizumab（200毫克）要进行两个周期的治疗；在完成9个周期的联合治疗后，患者可以继续使用pembrolizumab。主要终点包括安全性、耐受性和推荐的2期剂量。结果。33名患者接受了mRNA-4157；13人作为单药治疗，20人与pembrolizumab联合治疗。没有DLTs的报告，与治疗相关的AEs一般都是低级的和可逆的，没有观察到药物相关的SAEs或AEs≥3级。在接受辅助性单药治疗的13名患者中（3名黑色素瘤，8名NSCLC，2名MSI-High），12名患者在研究中仍然无病，中位随访时间为8个月。20名患者接受了联合治疗（1名TMB-高，4名膀胱癌，2名HNSCC，1名黑色素瘤，7名NSCLC，2名SCLC，3名MSI-高），12名患者在之前的CPI治疗中出现进展，16名患者已被重新分期，有1名CR（接种疫苗前服用pembrolizumab），2名PR，5名SD至少5个联合周期，5名PD，2名iuPD，1名患者反应无价值但仍在研究。新抗原特异性T细胞反应已被PBMCs的IFN-γ ELISpot检测到。结论：mRNA-4157在所有测试的剂量水平上都是安全和耐受性良好的。与pembrolizumab联合使用已观察到临床反应，新抗原特异性T细胞已被诱导，支持mRNA-4157推进到第二阶段。</p><blockquote><p>Burris, Howard A., et al. “A phase I multicenter study to assess the safety, tolerability, and immunogenicity of mRNA-4157 alone in patients with resected solid tumors and in combination with pembrolizumab in patients with unresectable solid tumors.” (2019): 2523-2523.</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vaccine</tag>
      
      <tag>mRNA</tag>
      
      <tag>mRNA vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.9.10-9.16实验记录:GWAS analysis in R</title>
    <link href="/2021/09/16/20210910to0916gwasanalysisinr/"/>
    <url>/2021/09/16/20210910to0916gwasanalysisinr/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-9-10-9-16实验记录-GWAS-analysis-in-R"><a href="#2021-9-10-9-16实验记录-GWAS-analysis-in-R" class="headerlink" title="2021.9.10-9.16实验记录: GWAS analysis in R"></a>2021.9.10-9.16实验记录: GWAS analysis in R</h1><h2 id="R代码教程"><a href="#R代码教程" class="headerlink" title="R代码教程"></a>R代码教程</h2><p>全基因组关联分析策略通常包括四个广泛定义的部分。(i) 数据预处理data pre‐processing；(ii) 新数据生成new data generation；(iii) 统计分析statistical analysis；和(iv) 分析后询问post‐analytic interrogation。这些调查的一个主要目标是识别和描述SNPs与疾病进展或疾病结果措施之间的关联。</p><p>根据这四个阶段产生的十个步骤如下：</p><ol><li>将数据读入R，创建R对象 reading data into R to create an R object</li><li>SNP级过滤（第一部分）SNP‐level filtering (part 1)</li><li>样本级过滤 sample‐level filtering</li><li>SNP级过滤（第二部分）SNP‐level filtering (part 2)</li><li>主成分分析（PCA）principal component analysis (PCA)</li><li>非类型基因型的归因 imputation of non‐typed genotypes</li><li>类型SNP的关联分析 association analysis of typed SNPs</li><li>归因数据的关联分析 association analysis of imputed data</li><li>归因和类型SNP结果的整合 integration of imputed and typed SNP results</li><li>关联结果的可视化和质量控制 visualization and quality control of association findings</li></ol><p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5019244/bin/SIM-34-3769-g001.jpg" alt="An external file that holds a picture, illustration, etc. Object name is SIM-34-3769-g001.jpg"></p><blockquote><p>Substructure 亚结构，也称为群体混合和群体分层，是指群体遗传历史(例如，迁徙、选择和/或种族融合)导致群体内存在遗传多样性(例如，不同等位基因频率)。</p></blockquote><h3 id="数据预处理data-pre‐processing"><a href="#数据预处理data-pre‐processing" class="headerlink" title="数据预处理data pre‐processing"></a>数据预处理data pre‐processing</h3><p>在本例中，样本使用Affymetrix 6.0 GeneChip进行基因分型，并以.CEL格式提供给用户。</p><blockquote><p>基于期望最大化类型算法的Birdseed调用算法被应用于生成每个样本在每个SNP上的基因型和置信度分数。</p><p>反过来，PERL和unix脚本被用来将这些转换成.ped和.map文件。</p><p>注意，虽然R可以读取.ped和.map文件，但通常最好先将这两个文件转换为.bim、.bed和.fam文件。将文本文件转化成二进制文件，可以大大缩减文件大小。</p></blockquote><p>本教程主要利用了几个R包（来自Bioconductor）</p><p>snpStats</p><blockquote><p>具有以各种格式读取基因型数据并进行质量控制、估算和关联分析的功能</p></blockquote><p>SNPRelate</p><blockquote><p>包括样本级质量控制和计算效率高的主成分(PC)计算的功能</p></blockquote><p>其他软件包包括数据可视化/代码的功能(ggplot2、 LDheatmap、 postgwas)、数据操作(plyr)和并行处理(doparlel) ，以及它们的依赖关系。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs R">setwd(<span class="hljs-string">&quot;/Users/keqinliu/Downloads/GWASTutorial_Files&quot;</span>) <span class="hljs-comment">#先设置工作目录</span><br>getwd() <span class="hljs-comment">#检查工作目录</span><br><span class="hljs-comment">## [1] &quot;/Users/keqinliu/Downloads/GWASTutorial_Files&quot;</span><br><br>BiocManager::install(<span class="hljs-string">&quot;snpStats&quot;</span>) <span class="hljs-comment">#安装snpStats</span><br><span class="hljs-comment">#注意，R版本＞3.5，应使用BiocManager进行安装</span><br><span class="hljs-comment">#R版本＜3.5，则可使用bioconductor安装</span><br>BiocManager::install(<span class="hljs-string">&quot;SNPRelate&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;rtracklayer&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;biomaRt&quot;</span>)<br>install.packages(<span class="hljs-string">&quot;GenABEL&quot;</span>, <span class="hljs-string">&quot;LDheatmap&quot;</span>, <span class="hljs-string">&quot;doParallel&quot;</span>, <span class="hljs-string">&quot;coin&quot;</span>, <span class="hljs-string">&quot;igraph&quot;</span>) <span class="hljs-comment">#安装所需的R包</span><br>library(devtools)<br><br>data.dir &lt;- <span class="hljs-string">&quot;/Users/keqinliu/Downloads/GWAS&quot;</span><br>out.dir &lt;- data.dir <span class="hljs-comment">#设置不同的输出文件目录，以防与工作目录冲突</span><br><br><span class="hljs-comment">#以下代码用于设定输入文件</span><br>gwas.fn &lt;- lapply(<span class="hljs-built_in">c</span>(bed=<span class="hljs-string">&#x27;bed&#x27;</span>, bim=<span class="hljs-string">&quot;bim&quot;</span>, fam=<span class="hljs-string">&quot;fam&quot;</span>, gds=<span class="hljs-string">&quot;gds&quot;</span>),<span class="hljs-keyword">function</span>(n) sprintf(<span class="hljs-string">&quot;%s/GWASTutorial.%s&quot;</span>, data.dir, n))<br>clinical.fn &lt;- sprintf(<span class="hljs-string">&quot;%s/GWASTutorial_clinical.csv&quot;</span>, data.dir) <span class="hljs-comment">#sprintf函数用于把格式化的数据写入某个字符串缓冲区。</span><br>onethou.fn &lt;- lapply(<span class="hljs-built_in">c</span>(info=<span class="hljs-string">&quot;info&quot;</span>, ped=<span class="hljs-string">&quot;ped&quot;</span>), <span class="hljs-keyword">function</span>(n) sprintf(<span class="hljs-string">&quot;%s/chr16_1000g_CEU.%s&quot;</span>, data.dir, n))<br>protein.coding.coords.fnamo &lt;- sprintf(<span class="hljs-string">&quot;%s/ProCodgene_doords.csv&quot;</span>, out.dir)<br>                     <br><span class="hljs-comment">#以下代码用于设定输出文件</span><br>gwaa.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/GWAStutorialout.txt&quot;</span>, out.dir)<br>gwaa.unadj.fname &lt;- sprintf(<span class="hljs-string">&quot;%sGWAStutorialoutUnadj.txt&quot;</span>, out.dir)<br>input.out.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/GWAStutorial_inputationOut.csv&quot;</span>, out.dir)<br>CEPT.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/CEPT_GWASour.csv&quot;</span>, out.dir)    <br><span class="hljs-comment">#gwaa.fname等value都是文件目录（地址）                     </span><br>                    <br></code></pre></td></tr></table></figure><h4 id="在R中读取和格式化数据"><a href="#在R中读取和格式化数据" class="headerlink" title="在R中读取和格式化数据"></a>在R中读取和格式化数据</h4><p>为了阅读.fam .bim和.bed 文件，可以使用 Bioconductor snpStats 包中的 read.plink () 函数。</p><blockquote><p>结果列表的基因型位置包含一个 SnpMatrix 对象，它是基因型数据的矩阵，每个 SNP 有一列，每个研究参与者有一行。</p><p>临床数据(gwastufactorial clinical. csv)可以用我们熟悉的方式读取，即read.csv()。</p><p>最后，我们在这个阶段的数据子集只包括在基因型和表型文件中都有数据的个体。</p></blockquote><p>一旦我们读取了基因型和临床信息，我们就可以开始 GWA 数据预处理的下一步了。这涉及到两个过滤数据的阶段，分别在 SNP 和样本级别。</p><p>不过，在不同的情况中，分析的顺序可能会有所不同，这取决于是进行单一GWA分析(如本文所述) ，还是分析人员准备将结果纳入需要跨多项研究协调数据的更大的meta‐analysis。在后一种情况下，以下过滤步骤可能在分析之后被排除或集中执行，因为总结级数据是跨研究合并的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#reading data into r</span><br>library(snpStats)<br><span class="hljs-comment">#read in PLINK files to create list</span><br>geno &lt;- read.plink(gwas.fn$bed, gwas.fn$bim, gwas.fn$fam, na.strings = (<span class="hljs-string">&quot;-9&quot;</span>))<br><br><span class="hljs-comment">#-step1-</span><br><span class="hljs-comment">#reading data into r</span><br><br><span class="hljs-comment">#-step1a-</span><br>library(snpStats)<br><span class="hljs-comment">#read in PLINK files to create list</span><br>geno &lt;- read.plink(gwas.fn$bed, gwas.fn$bim, gwas.fn$fam, na.strings = (<span class="hljs-string">&quot;-9&quot;</span>))<br><br><span class="hljs-comment">#-step1b-</span><br><span class="hljs-comment">#obtain the genotype snpmatrix object from generated list</span><br>genotype &lt;- geno$genotypes<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  861473 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs10458597 ... rs5970564</span><br><span class="hljs-comment">#obtain teh snp info table from the list</span><br>genobim &lt;- geno$map<br>colnames(genobim) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;gen.dist&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;A1&quot;</span>, <span class="hljs-string">&quot;A2&quot;</span>)<br>print(head(genobim))<br><span class="hljs-comment">##            chr        SNP gen.dist position   A1 A2</span><br><span class="hljs-comment">## rs10458597   1 rs10458597        0   564621 &lt;NA&gt;  C</span><br><span class="hljs-comment">## rs12565286   1 rs12565286        0   721290    G  C</span><br><span class="hljs-comment">## rs12082473   1 rs12082473        0   740857    T  C</span><br><span class="hljs-comment">## rs3094315    1  rs3094315        0   752566    C  T</span><br><span class="hljs-comment">## rs2286139    1  rs2286139        0   761732    C  T</span><br><span class="hljs-comment">## rs11240776   1 rs11240776        0   765269    G  A</span><br><br><span class="hljs-comment">#remove raw file to open up memory</span><br>rm(geno)<br><br><span class="hljs-comment">#-step1c-</span><br><span class="hljs-comment">#read in clinical file</span><br>clinical &lt;- read.csv(clinical.fn, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>, <span class="hljs-string">&quot;factor&quot;</span>, <span class="hljs-string">&quot;factor&quot;</span>, <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br>rownames(clinical) &lt;- clinical$FamID<br>print(head(clinical))<br><span class="hljs-comment">##       FamID CAD sex age  tg hdl ldl</span><br><span class="hljs-comment">## 10002 10002   1   1  60  NA  NA  NA</span><br><span class="hljs-comment">## 10004 10004   1   2  50  55  23  75</span><br><span class="hljs-comment">## 10005 10005   1   1  55 105  37  69</span><br><span class="hljs-comment">## 10007 10007   1   1  52 314  54 108</span><br><span class="hljs-comment">## 10008 10008   1   1  58 161  40  94</span><br><span class="hljs-comment">## 10009 10009   1   1  59 171  46  92</span><br><br><span class="hljs-comment">#-step1d-</span><br><span class="hljs-comment">#subset genotype for individuals with clinical data</span><br>genotype &lt;- genotype[clinical$FamID, ]<br>print(genotypes)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  861473 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs10458597 ... rs5970564 </span><br><span class="hljs-comment">#在提供的数据示例中，基因型信息可用于n=1401个有可用表型数据的861473个类型SNPs</span><br></code></pre></td></tr></table></figure><h4 id="单核苷酸多态性级过滤-part1"><a href="#单核苷酸多态性级过滤-part1" class="headerlink" title="单核苷酸多态性级过滤(part1)"></a>单核苷酸多态性级过滤(part1)</h4><p>这一步涉及删除(也称为“过滤”)不包括分析的 SNPs。这种排除的原因包括大量的缺失数据、低变异性和基因分型错误。通常，首先执行基于大量缺失数据和较低可变性的 SNP 级过滤。然后是样本级过滤 ，最后是基于可能的基因分型错误的 SNP 级过滤</p><blockquote><p>这样做的理由是，样本级的关联性和亚结构都会影响用于根据基因分型错误过滤SNP的Hardy-Weinberg平衡（HWE）标准。重复SNP和样本级过滤的迭代程序也很常见，直到没有额外的样本被删除。</p><p>然而，在这个教程中，没有样本被过滤，认为这个循环是不必要的。</p></blockquote><h5 id="SNP‐level-filtering-call-rate"><a href="#SNP‐level-filtering-call-rate" class="headerlink" title="SNP‐level filtering: call rate"></a>SNP‐level filtering: call rate</h5><p>call rate被定义为研究中相应SNP信息没有缺失的个体比例。</p><blockquote><p>在本教程中，我们使用95%的调用率进行过滤，这意味着我们保留数据缺失少于5%的SNP。在较小的样本环境中，可以采用更严格的切点（例如，小于5%）。</p></blockquote><h5 id="SNP‐level-filtering-minor-allele-frequency-MAF"><a href="#SNP‐level-filtering-minor-allele-frequency-MAF" class="headerlink" title="SNP‐level filtering: minor allele frequency (MAF)"></a>SNP‐level filtering: minor allele frequency (MAF)</h5><p>在研究参与者中，如果某个SNP有很大程度的同质性，通常会导致推断该SNP与所研究性状之间的统计学意义的力量不足。当我们有一个非常小的MAF，使大多数个体有两个主要等位基因的拷贝时，就会发生这种情况。这里，我们删除了MAF小于1%的SNP（MAF &lt;0.01）。在某些情况下，特别是小样本环境下，采用5%的切割点。</p><blockquote><p>这是说，比如，99%以上的研究者都有一个相同的SNP，那么这个SNP就失去了统计学上的意义（即在参与者中，这个SNP有很大程度上的同质性）。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#使用以下脚本同时对call rate和MAF进行过滤</span><br><span class="hljs-comment">#-step2-</span><br><span class="hljs-comment">#snp-level filtering</span><br><br><span class="hljs-comment">#-step2a-</span><br><span class="hljs-comment">#create snp summary statistics (MAF, call rate, etc.)</span><br>snpsum.col &lt;- col.summary(genotype)<br>print(head(snpsum.col))<br><br><span class="hljs-comment">#-step2b-</span><br><span class="hljs-comment">#setting thresholds</span><br>call &lt;- 0.95<br>minor &lt;- 0.01<br><br><span class="hljs-comment">#filter on MAF and call rate</span><br>use &lt;- with(snpsum.col, (!<span class="hljs-built_in">is.na</span>(MAF) &amp; MAF &gt; minor) &amp; Call.rate &gt;= <span class="hljs-built_in">call</span>)<br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><br><span class="hljs-comment">#subset genotype and snp summary data for snps that pass call rate and MAF critoria</span><br>genotype &lt;- genotype[,use]<br><span class="hljs-comment">## 出现报错</span><br><span class="hljs-comment">## Error in .local(x, i, j, ..., drop) : </span><br><span class="hljs-comment">##   logical column selection vector is wrong length</span><br><span class="hljs-built_in">sum</span>(use)<br><span class="hljs-comment">## [1] 0</span><br>ncol(genotype)<br><span class="hljs-comment">## [1] 861473</span><br><span class="hljs-comment">#显然，设置的threshold根本没起作用，但不明白原因。</span><br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><span class="hljs-comment">## 861473 SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.</span><br><br><span class="hljs-comment">## 解决方案如下：it worked！</span><br><span class="hljs-comment">#filter on MAF and call rate</span><br>use &lt;- with(snpsum.col, (!<span class="hljs-built_in">is.na</span>(MAF) &amp; MAF &gt; <span class="hljs-number">0.01</span>) &amp; Call.rate &gt;= <span class="hljs-number">0.95</span>) <span class="hljs-comment">#直接把threshold改成了数值</span><br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br><br><span class="hljs-built_in">sum</span>(use)<br><span class="hljs-comment">## [1] 658186</span><br><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><span class="hljs-comment">## 203287 SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.</span><br><br><span class="hljs-comment">#subset genotype and snp summary data for snps that pass call rate and MAF critoria</span><br>genotype &lt;- genotype[,use]<br>snpsum.col &lt;- snpsum.col[use,]<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  658186 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs5970564    </span><br></code></pre></td></tr></table></figure><h4 id="样本级别过滤"><a href="#样本级别过滤" class="headerlink" title="样本级别过滤"></a>样本级别过滤</h4><p>数据预处理的第三阶段涉及过滤样本，也就是说，删除我们选择的被排除在分析之外的个体。样本级过滤的标准通常基于缺失数据、样本污染、相关性(用于基于人口的调查)以及种族、民族或性别的模糊性或不一致性。</p><h5 id="Sample‐level-filtering-call-rate"><a href="#Sample‐level-filtering-call-rate" class="headerlink" title="Sample‐level filtering: call rate"></a>Sample‐level filtering: call rate</h5><p>与基于call rate的SNP级过滤类似，我们排除那些在超过预先定义的百分比的分型SNP中缺失基因型数据的个体。这个跨SNP的缺失比例被称为sample call rate，我们采用95%的阈值。也就是说，缺失基因型数据超过5%的类型SNPs的个体将被删除。一个新的减维SnpMatrix基因型对象被创建，它包含了这个filter。</p><h5 id="Sample‐level-filtering-heterozygosity"><a href="#Sample‐level-filtering-heterozygosity" class="headerlink" title="Sample‐level filtering: heterozygosity"></a>Sample‐level filtering: heterozygosity</h5><p>杂合度是指在一个个体内，在一个给定的SNP上存在两个等位基因中的每一个。这在HWE下预计会以 $2<em>p</em>(1-p)$ 的概率出现，其中p是该SNP的显性等位基因频率（假设是双等位SNP）。一个人体内跨类型SNP的杂合度过高可能是样本质量差的表现，而杂合度不足则表明该人有近亲繁殖或其他亚结构。因此，近亲繁殖系数 $|F|=（1-O/E）&gt;0.10$ 的样本被剔除，其中O和E分别是个体内杂合SNP的观察数和预期数。请注意，我们是根据每个个体的观察到的SNP来计算该个体的预期计数的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3-</span><br><span class="hljs-comment">#sample-level filtering</span><br><br><span class="hljs-comment">#-step3a-</span><br>library(SNPRelate) <span class="hljs-comment">#estimating LD, relatedness, PCA</span><br>library(plyr)<br><br><span class="hljs-comment">#create sample statistic (call rate, heterozygosity)</span><br>snpsum.row &lt;- row.summary(genotype)<br><br><span class="hljs-comment">#add the f stat (inbreeding coefficient) to snpsum.row</span><br>MAF &lt;- snpsum.col$MAF<br>callmatrix &lt;- !<span class="hljs-built_in">is.na</span>(genotype)<br>hetExp &lt;- callmatrix %*% (<span class="hljs-number">2</span>*MAF*(<span class="hljs-number">1</span>-MAF))<br>hetObs &lt;- with(snpsum.row, Heterozygosity*(ncol(genotype))*Call.rate)<br>snpsum.row$hetF &lt;- 1-(hetObs/hetExp)<br><br>head(snpsum.row)<br><span class="hljs-comment">##       Call.rate Certain.calls Heterozygosity          hetF</span><br><span class="hljs-comment">## 10002 0.9826554             1      0.3289825 -0.0247708291</span><br><span class="hljs-comment">## 10004 0.9891581             1      0.3242931 -0.0103236529</span><br><span class="hljs-comment">## 10005 0.9918427             1      0.3231825 -0.0062550972</span><br><span class="hljs-comment">## 10007 0.9861027             1      0.3241469 -0.0098475016</span><br><span class="hljs-comment">## 10008 0.9823333             1      0.3228218 -0.0075941985</span><br><span class="hljs-comment">## 10009 0.9913034             1      0.3213658 -0.0002633189</span><br><br><span class="hljs-comment">#-step3b-</span><br><span class="hljs-comment">#setting thresholds</span><br>sampcall &lt;- 0.95 <span class="hljs-comment">#sample call rate cut-off</span><br>hetcutoff &lt;- 0.1 <span class="hljs-comment">#inbreeding coefficient cut-off</span><br><br>sampleuse &lt;- with(snpsum.row, !<span class="hljs-built_in">is.na</span>(Call.rate) &amp; Call.rate &gt; <span class="hljs-number">0.95</span> &amp; <span class="hljs-built_in">abs</span>(hetF) &lt;= <span class="hljs-number">0.1</span>)<br>sampleuse[<span class="hljs-built_in">is.na</span>(sampleuse)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(nrow(genotype)-<span class="hljs-built_in">sum</span>(sampleuse), <span class="hljs-string">&quot;subject will be removed due to low sample call rate or inbredding coefficient.\n&quot;</span>)<br><span class="hljs-comment">## 0 subject will be removed due to low sample call rate or inbredding coefficient.</span><br><br><span class="hljs-comment">#subset genotype and clinical data for subjects who pass call rate and heterozygosity crtieria</span><br>genotype &lt;- genotype[sampleuse, ]<br>clinical &lt;- clinical[rownames(genotype), ]<br></code></pre></td></tr></table></figure><p>由于提供的 PennCATH 数据是预过滤的，因此不会根据近亲繁殖系数 | f | &gt; 0.10来过滤额外的样本。</p><h5 id="Sample‐level-filtering-cryptic-relatedness-duplicates-and-gender-identity"><a href="#Sample‐level-filtering-cryptic-relatedness-duplicates-and-gender-identity" class="headerlink" title="Sample‐level filtering: cryptic relatedness, duplicates, and gender identity."></a>Sample‐level filtering: cryptic relatedness, duplicates, and gender identity.</h5><p>样本级过滤：隐性关联性、重复和性别确认。</p><p>基于人群的队列研究通常仅限于无亲缘关系的个体，而后面分型SNP的关联分析中描述的广义线性建模方法假定了个体间的独立性。但是，在复杂疾病的区域性队列研究（如基于医院的队列研究）中，来自同一家庭的个体可能会被无意中招募到。衡量一对样本之间的亲缘关系（或重复）的常用方法是基于血缘关系的认同（IBD）。IBD的亲缘关系系数大于0.10，可能表明有亲缘关系、重复或样本混合。通常情况下，具有较低基因型调用率的相关对的个体被移除。我们注意到，在这个阶段也可以检查性别确认，以确认自我报告的性别与观察到的X和Y染色体一致。</p><blockquote><p>但是，在本例所提供的数据例子中，性染色体不可用，因此，没有提供关于性别认同的过滤例子。</p></blockquote><p>我们首先应用linkage disequilibrium (LD)修剪，使用0.2的阈值，这消除了数据中很大程度的冗余，减少了染色体假象chromosomal artifacts的影响。这种降维步骤通常在IBD分析和PCA之前应用，在后面的文本中应用于ancestry filtering，并导致大量的计算节省。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3c-</span><br><span class="hljs-comment">#checking for relatedness</span><br>ld.thresh &lt;- 0.2 <span class="hljs-comment">#LD cut-off</span><br>kin.thresh &lt;- 0.1 <span class="hljs-comment">#kinship cut-off</span><br><span class="hljs-comment">#create gds file, required for SNPRelate functions</span><br>snpgdsBED2GDS(gwas.fn$bed, gwas.fn$fam, gwas.fn$bim, gwas.fn$gds)<br><span class="hljs-comment">## Start file conversion from PLINK BED to SNP GDS ...</span><br><span class="hljs-comment">##     BED file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.bed&#x27;</span><br><span class="hljs-comment">##         SNP-major mode (Sample X SNP), 288.4M</span><br><span class="hljs-comment">##     FAM file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.fam&#x27;</span><br><span class="hljs-comment">##     BIM file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.bim&#x27;</span><br><span class="hljs-comment">## Mon Sep 13 15:43:32 2021     (store sample id, snp id, position, and chromosome)</span><br><span class="hljs-comment">##     start writing: 1401 samples, 861473 SNPs ...</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 8s  </span><br><span class="hljs-comment">## Mon Sep 13 15:43:40 2021 Done.</span><br><span class="hljs-comment">## Optimize the access efficiency ...</span><br><span class="hljs-comment">## Clean up the fragments of GDS file:</span><br><span class="hljs-comment">##     open the file &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds&#x27; (292.4M)</span><br><span class="hljs-comment">##     # of fragments: 39</span><br><span class="hljs-comment">##     save to &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds.tmp&#x27;</span><br><span class="hljs-comment">##     rename &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds.tmp&#x27; (292.4M, reduced: 252B)</span><br><span class="hljs-comment">##     # of fragments: 18</span><br>genofile &lt;- openfn.gds(gwas.fn$gds, readonly = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#automatically added &quot;-1&quot; sample suffixes are removed</span><br>gds.ids &lt;- read.gdsn(index.gdsn(genofile, <span class="hljs-string">&quot;sample.id&quot;</span>))<br>gds.ids &lt;- sub(<span class="hljs-string">&quot;-1&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, gds.ids)<br>add.gdsn(genofile, <span class="hljs-string">&quot;sample.id&quot;</span>, gds.ids, replace = <span class="hljs-literal">TRUE</span>)<br><br><span class="hljs-comment">#prune SNPs for IBD analysis</span><br>set.seed(<span class="hljs-number">1000</span>)<br><br>geno.sample.ids &lt;- rownames(genotype)<br>snpSVB &lt;- snpgdsLDpruning(genofile, ld.threshold = <span class="hljs-number">0.2</span>, sample.id = geno.sample.ids, <span class="hljs-comment">#only analyze teh filtered samples</span><br>                          snp.id = colnames(genotype)) <span class="hljs-comment">#only analyze the filtered SNPs</span><br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## SNP pruning based on LD:</span><br><span class="hljs-comment">## Excluding 203,287 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 658,186</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     sliding window: 500,000 basepairs, Inf SNPs</span><br><span class="hljs-comment">##     |LD| threshold: 0.2</span><br><span class="hljs-comment">##     method: composite</span><br><span class="hljs-comment">## Chromosome 1: 8.24%, 5,856/71,038</span><br><span class="hljs-comment">## Chromosome 3: 8.16%, 4,943/60,565</span><br><span class="hljs-comment">## Chromosome 6: 8.05%, 4,362/54,176</span><br><span class="hljs-comment">## Chromosome 12: 8.60%, 3,621/42,124</span><br><span class="hljs-comment">## Chromosome 21: 9.44%, 1,176/12,463</span><br><span class="hljs-comment">## Chromosome 2: 7.69%, 5,669/73,717</span><br><span class="hljs-comment">## Chromosome 4: 8.27%, 4,603/55,675</span><br><span class="hljs-comment">## Chromosome 7: 8.47%, 3,928/46,391</span><br><span class="hljs-comment">## Chromosome 11: 7.89%, 3,490/44,213</span><br><span class="hljs-comment">## Chromosome 10: 8.01%, 3,838/47,930</span><br><span class="hljs-comment">## Chromosome 8: 7.69%, 3,716/48,299</span><br><span class="hljs-comment">## Chromosome 5: 8.10%, 4,549/56,178</span><br><span class="hljs-comment">## Chromosome 14: 8.80%, 2,470/28,054</span><br><span class="hljs-comment">## Chromosome 9: 8.23%, 3,385/41,110</span><br><span class="hljs-comment">## Chromosome 17: 11.13%, 2,220/19,939</span><br><span class="hljs-comment">## Chromosome 13: 8.40%, 2,878/34,262</span><br><span class="hljs-comment">## Chromosome 20: 9.39%, 2,137/22,753</span><br><span class="hljs-comment">## Chromosome 15: 9.23%, 2,391/25,900</span><br><span class="hljs-comment">## Chromosome 16: 9.17%, 2,529/27,591</span><br><span class="hljs-comment">## Chromosome 18: 9.00%, 2,361/26,231</span><br><span class="hljs-comment">## Chromosome 19: 12.99%, 1,492/11,482</span><br><span class="hljs-comment">## Chromosome 22: 11.21%, 1,276/11,382</span><br><span class="hljs-comment">## 72,890 markers are selected in total.</span><br>snpset.ibd &lt;- unlist(snpSVB, use.names = <span class="hljs-literal">FALSE</span>)<br>cat(<span class="hljs-built_in">length</span>(snpset.ibd), <span class="hljs-string">&quot;will be used in IBD analysis\n&quot;</span>)<br><span class="hljs-comment">## 72890 will be used in IBD analysis</span><br><span class="hljs-comment">#与tutorial中的 expect 72812 SNPs 相互冲突</span><br></code></pre></td></tr></table></figure><p>这使得SNP的数量从第2步结束时的658,186个减少到72890个。接下来，我们计算成对的IBD距离来搜索样本的关联性。采用的策略是迭代删除配对亲缘关系系数大于0.1的最高数量的主体。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3d-</span><br><span class="hljs-comment">#find IBD coefficients using method of moments procedure. include pairwise kinship</span><br>ibd &lt;- snpgdsIBDMoM(genofile, kinship = <span class="hljs-literal">TRUE</span>, sample.id = geno.sample.ids, snp.id = snpset.ibd, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## IBD analysis (PLINK method of moment) on genotypes:</span><br><span class="hljs-comment">## Excluding 788,583 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 72,890</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">## PLINK IBD:    the sum of all selected genotypes (0,1,2) = 32728566</span><br><span class="hljs-comment">## Mon Sep 13 16:05:05 2021    (internal increment: 8064)</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 7s  </span><br><span class="hljs-comment">## Mon Sep 13 16:05:13 2021    Done.</span><br>ibdcoeff &lt;- snpgdsIBDSelection(ibd) <span class="hljs-comment">#pairwise sample comparison</span><br>head(ibdcoeff)<br><span class="hljs-comment">##     ID1   ID2        k0         k1    kinship</span><br><span class="hljs-comment">## 1 10002 10004 0.9005063 0.09949372 0.02487343</span><br><span class="hljs-comment">## 2 10002 10005 0.9128056 0.08719439 0.02179860</span><br><span class="hljs-comment">## 3 10002 10007 0.9107539 0.08924614 0.02231153</span><br><span class="hljs-comment">## 4 10002 10008 0.9205765 0.07942348 0.01985587</span><br><span class="hljs-comment">## 5 10002 10009 0.9528404 0.04715958 0.01178989</span><br><span class="hljs-comment">## 6 10002 10010 0.8986051 0.10139486 0.02534872</span><br><br><span class="hljs-comment">#-step3e#</span><br><span class="hljs-comment">#check if there are any candidates for relatedness</span><br>ibdcoeff &lt;- ibdcoeff[ibdcoeff$kinship &gt;= <span class="hljs-number">0.1</span>]<br><br><span class="hljs-comment">#iteratively remove samples with high kinship </span><br>related.samples &lt;- <span class="hljs-literal">NULL</span><br><span class="hljs-keyword">while</span> (nrow(ibdcoeff)&gt;<span class="hljs-number">0</span>) &#123;<br>  <span class="hljs-comment">#count the number of occurrences of each and take the top one</span><br>  sample.counts &lt;- arrange(count(<span class="hljs-built_in">c</span>(ibdcoeff$ID1, ibdcoeff$ID2)), -freq)<br>  rm.sample &lt;- sample.counts[<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;x&#x27;</span>]<br>  cat(<span class="hljs-string">&quot;removeing sample&quot;</span>, <span class="hljs-built_in">as.character</span>(rm.sample), <span class="hljs-string">&#x27;too close related to&#x27;</span>, sample.counts[<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;freq&#x27;</span>],<span class="hljs-string">&#x27;other samples.\n&#x27;</span>)<br>  <span class="hljs-comment">#remove from ibdcoeff and add to list</span><br>  ibdcoeff &lt;- ibdcoeff[ibdcoeff$ID1 !=rm.sample &amp; ibdcoeff$ID2 != rm.sample,]<br>  related.samples &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-built_in">as.character</span>(rm.sample),related.samples)<br>&#125;<br><span class="hljs-comment">## removeing sample  too close related to NA other samples.</span><br><br><span class="hljs-comment">#filter genotype and clinical to include only unrelated samples</span><br>genotype &lt;- genotype[ !(rownames(genotype) %in% related.samples), ]<br>clinical &lt;- clinical[ !(clinical$FamID %in% related.samples), ]<br>geno.sample.ids &lt;- rownames(genotype)<br>cat(<span class="hljs-built_in">length</span>(related.samples), <span class="hljs-string">&quot;similar samples removed due to correlation coefficient &gt;= 0.1&quot;</span>, <span class="hljs-string">&quot;\n&quot;</span> )<br><span class="hljs-comment">## 0 similar samples removed due to correlation coefficient &gt;= 0.1 </span><br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  658186 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs5970564 </span><br></code></pre></td></tr></table></figure><p>在本示例中，没有任何样本是基于IBD亲属系数&gt;0.10而被过滤掉的。</p><h5 id="Sample‐level-filtering-ancestry"><a href="#Sample‐level-filtering-ancestry" class="headerlink" title="Sample‐level filtering: ancestry."></a>Sample‐level filtering: ancestry.</h5><p>PCA是一种根据观察到的基因构成将个体可视化并分类到祖先群体的方法。我们这样做有两个原因：</p><p>首先，自我报告的种族和民族可能与完全基于遗传信息的个体集群不同，</p><p>其次，出现一个似乎不属于种族/民族集群的个体可能暗示着样本级错误。</p><p>我们使用LD修剪后的72,812个SNPs子集（步骤3-c）作为PCA的输入。第一阶段LD剪枝的另一种策略是 “HapMap rooted “分析，它包括首先在一个reference panel上进行PCA，例如HapMap或1000 genome，然后将研究样本投射到所产生的空间。这种方法在此不作介绍，但可以用Kinship-based INference for Gwas（KING）软件的现有功能来实现。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3f-</span><br><span class="hljs-comment">#checking for ancestry</span><br><span class="hljs-comment">#find PCA matrix</span><br>pca &lt;- snpgdsPCA(genofile, sample.id = geno.sample.ids, snp.id = snpset.ibd, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">#creating data frame of first two principal components</span><br>pctab &lt;- data.frame(sample.id = pca$sample.id,<br>                    PC1 = pca$eigenvect[,<span class="hljs-number">1</span>], <span class="hljs-comment">#the first eigenvector</span><br>                    PC2 = pca$eigenvect[,<span class="hljs-number">2</span>], <span class="hljs-comment">#the second eigenvector</span><br>                    stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br><span class="hljs-comment">#plot the first two principle components</span><br>plot(pctab$PC2, pctab$PC1, xlab=<span class="hljs-string">&quot;principal component 2&quot;</span>, ylab=<span class="hljs-string">&quot;principal component 1&quot;</span>, main = <span class="hljs-string">&quot;ancestry plot&quot;</span>)<br><br></code></pre></td></tr></table></figure><p><img src="pcaplot.png" alt="pcaplot"></p><h4 id="单核苷酸多态性级过滤-part-2"><a href="#单核苷酸多态性级过滤-part-2" class="headerlink" title="单核苷酸多态性级过滤(part 2)"></a>单核苷酸多态性级过滤(part 2)</h4><h5 id="SNP‐level-filtering-HWE"><a href="#SNP‐level-filtering-HWE" class="headerlink" title="SNP‐level filtering: HWE."></a>SNP‐level filtering: HWE.</h5><p>违反HWE可以表明存在种群亚结构或发生基因分型错误。虽然它们并不总是可以区分的，但通常的做法是假设有基因分型错误，并删除违反HWE的SNP。如果有病例对照状态，我们将这种过滤限制在对对照组的分析上，因为病例中的违反可能是一种关联的迹象。在一个给定的SNP上，通常使用观察到的基因型和预期的基因型之间的 $X^2$ 拟合度测试来衡量对HWE的偏离。我们删除那些HWE测试统计量在对照组中的相应P值小于 $1×10^{-6}$ 的SNPs。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step4-</span><br><span class="hljs-comment">#hardy-weinberg snp filtering on cad controls</span><br>hardy &lt;- 10^-<span class="hljs-number">6</span> <span class="hljs-comment">#HWE cut-off</span><br>CADcontrols &lt;- clinical[ clinical$CAD==<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;FamID&#x27;</span> ]<br>snpsum.colCont &lt;- col.summary(genotype[CADcontrols,])<br>HWEuse &lt;- with(snpsum.colCont, !<span class="hljs-built_in">is.na</span>(z.HWE) &amp; (<span class="hljs-built_in">abs</span>(z.HWE) &lt; <span class="hljs-built_in">abs</span>(qnorm(<span class="hljs-number">0.5</span>*<span class="hljs-number">10</span>^-<span class="hljs-number">6</span>))))<br>rm(snpsum.colCont)<br><br>HWEuse[<span class="hljs-built_in">is.na</span>(HWEuse)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(HWEuse), <span class="hljs-string">&quot;SNP will be removed due to high HWE.\n&quot;</span>)<br><br><span class="hljs-comment">#subset genotype and SNP summary data for SNPs that pass HWE criteria</span><br>genotype &lt;- genotype[,HWEuse]<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  656890 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs28729663 </span><br></code></pre></td></tr></table></figure><p>在 CAD 控制中，我们根据 HWE $p &lt; 1 × 10^{-6}$ 筛选出额外的1,296个 SNPs。结果是656,890个单核苷酸多态性可以在关联分析中考虑。</p><h3 id="新数据生成"><a href="#新数据生成" class="headerlink" title="新数据生成"></a>新数据生成</h3><p>在完成SNP和样本级的过滤后，我们在进行统计分析之前产生两种新的数据：</p><p>第一种是PC，旨在捕捉潜在的人口亚结构的信息，这些信息通常在自我报告的种族和民族变量中是不存在的。</p><blockquote><p>这种数据用于进行主成分分析，创建捕获种群子结构的主要组成部分。</p></blockquote><p>第二种是未定型的SNP的基因型，可能与结果有功能关系，因此为识别关联提供额外的力量。</p><h4 id="主成分分析（PCA）principal-component-analysis-PCA"><a href="#主成分分析（PCA）principal-component-analysis-PCA" class="headerlink" title="主成分分析（PCA）principal component analysis (PCA)"></a>主成分分析（PCA）principal component analysis (PCA)</h4><p>Creating principal components for capturing population‐substructure 创建捕获种群子结构的主要组成部分</p><p>亚结构，也被称为种群混杂和种群分层，指的是在一个明显的同质种群中存在遗传多样性（如不同的等位基因频率），这是由于种群遗传历史（如迁移、选择和/或种族融合）造成的。基于观察到的基因型数据的PC可以捕捉到关于亚结构的信息，并且可以直接使用SNPRelate软件包中的snpgdsPCA()函数根据全基因型数据生成。</p><p>值得注意的是，我们在PCA之前再次应用LD修剪。通常情况下，前10个PC被认为是可能的混杂因素。这个数字是常规的，但也是任意的，一种选择是根据它们所解释的变异性的预设比例来选择PC的数量。λ统计量通常用于评估是否有必要纳入PC。这将在步骤10（量化-量化（Q-Q）图和λ-统计量）中进一步描述。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step5-</span><br><span class="hljs-comment">#generating principal components for modeling</span><br><br><span class="hljs-comment">#-step5a-</span><br><span class="hljs-comment">#set LD threshold to 0.2</span><br>ld.thresh &lt;- 0.2<br><br>set.seed(<span class="hljs-number">1000</span>)<br>geno.sample.ids &lt;- rownames(genotype)<br>snpSVB &lt;- snpgdsLDpruning(genofile, ld.threshold = <span class="hljs-number">0.2</span>,<br>                          sample.id = geno.sample.ids, <span class="hljs-comment">#only analyze the filtered samples</span><br>                          snp.id = colnames(genotype)) <span class="hljs-comment">#only analyze the filtered SNPs</span><br>snpset.pca &lt;- unlist(snpSVB, use.names = <span class="hljs-literal">FALSE</span>)<br>cat(<span class="hljs-built_in">length</span>(snpset.pca),<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## SNP pruning based on LD:</span><br><span class="hljs-comment">## Excluding 204,583 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 656,890</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     sliding window: 500,000 basepairs, Inf SNPs</span><br><span class="hljs-comment">##     |LD| threshold: 0.2</span><br><span class="hljs-comment">##     method: composite</span><br><span class="hljs-comment">## Chromosome 1: 8.21%, 5,834/71,038</span><br><span class="hljs-comment">## Chromosome 3: 8.14%, 4,933/60,565</span><br><span class="hljs-comment">## Chromosome 6: 8.03%, 4,350/54,176</span><br><span class="hljs-comment">## Chromosome 12: 8.57%, 3,609/42,124</span><br><span class="hljs-comment">## Chromosome 21: 9.44%, 1,177/12,463</span><br><span class="hljs-comment">## Chromosome 2: 7.68%, 5,658/73,717</span><br><span class="hljs-comment">## Chromosome 4: 8.24%, 4,590/55,675</span><br><span class="hljs-comment">## Chromosome 7: 8.45%, 3,922/46,391</span><br><span class="hljs-comment">## Chromosome 11: 7.88%, 3,485/44,213</span><br><span class="hljs-comment">## Chromosome 10: 7.96%, 3,817/47,930</span><br><span class="hljs-comment">## Chromosome 8: 7.67%, 3,704/48,299</span><br><span class="hljs-comment">## Chromosome 5: 8.06%, 4,526/56,178</span><br><span class="hljs-comment">## Chromosome 14: 8.78%, 2,464/28,054</span><br><span class="hljs-comment">## Chromosome 9: 8.20%, 3,370/41,110</span><br><span class="hljs-comment">## Chromosome 17: 11.12%, 2,217/19,939</span><br><span class="hljs-comment">## Chromosome 13: 8.34%, 2,857/34,262</span><br><span class="hljs-comment">## Chromosome 20: 9.38%, 2,135/22,753</span><br><span class="hljs-comment">## Chromosome 15: 9.20%, 2,384/25,900</span><br><span class="hljs-comment">## Chromosome 16: 9.13%, 2,519/27,591</span><br><span class="hljs-comment">## Chromosome 18: 8.97%, 2,353/26,231</span><br><span class="hljs-comment">## Chromosome 19: 12.97%, 1,489/11,482</span><br><span class="hljs-comment">## Chromosome 22: 11.18%, 1,272/11,382</span><br><span class="hljs-comment">## 72,665 markers are selected in total.</span><br>cat(<span class="hljs-built_in">length</span>(snpset.pca),<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">## 72665</span><br>pca &lt;- snpgdsPCA(genofile, sample.id = geno.sample.ids, snp.id = snpset.pca, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## Principal Component Analysis (PCA) on genotypes:</span><br><span class="hljs-comment">## Excluding 788,808 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 72,665</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     # of principal components: 32</span><br><span class="hljs-comment">## PCA:    the sum of all selected genotypes (0,1,2) = 32694833</span><br><span class="hljs-comment">## CPU capabilities: Double-Precision SSE2</span><br><span class="hljs-comment">## Tue Sep 14 13:32:27 2021    (internal increment: 252)</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 43s </span><br><span class="hljs-comment">## Tue Sep 14 13:33:10 2021    Begin (eigenvalues and eigenvectors)</span><br><span class="hljs-comment">## Tue Sep 14 13:33:11 2021    Done.</span><br><br><span class="hljs-comment"># find and record first 10 principal components</span><br><span class="hljs-comment"># pcs will be a N:10 matrix </span><br><span class="hljs-comment"># each column is a principal component</span><br>pcs &lt;- data.frame(FamID = pca$sample.id, pca$eigenvect[,<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],<br>                  stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br>colnames(pcs)[<span class="hljs-number">2</span>:<span class="hljs-number">11</span>] &lt;- paste(<span class="hljs-string">&quot;pc&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">10</span>,sep = <span class="hljs-string">&quot;&quot;</span>)<br>print(head(pcs))<br><span class="hljs-comment">##   FamID          pc1           pc2          pc3           pc4           pc5           pc6           pc7          pc8</span><br><span class="hljs-comment">## 1 10002  0.008136946  0.0102555005  0.004035296 -0.0067555328  0.0290486205 -0.0158332357 -0.0368010948  0.007497037</span><br><span class="hljs-comment">## 2 10004 -0.011771047 -0.0080186632  0.004526211  0.0137606581 -0.0005964856  0.0322921253 -0.0004926945 -0.001072583</span><br><span class="hljs-comment">## 3 10005 -0.016963522 -0.0051956716 -0.013847881  0.0112937916 -0.0330688171 -0.0326298549 -0.0113624994 -0.001566384</span><br><span class="hljs-comment">## 4 10007 -0.010673757  0.0037745524  0.004574423 -0.0015019307 -0.0127123211 -0.0007371223 -0.0048545424 -0.013640426</span><br><span class="hljs-comment">## 5 10008 -0.016487939  0.0012844871 -0.019463117 -0.0051653724  0.0074000952 -0.0024935274  0.0022416080  0.041584582</span><br><span class="hljs-comment">## 6 10009 -0.014734448  0.0007935566 -0.017633485 -0.0005575061 -0.0547999107 -0.0288053889 -0.0075189053  0.016484556</span><br><span class="hljs-comment">##            pc9          pc10</span><br><span class="hljs-comment">## 1 -0.006501613  0.0003016164</span><br><span class="hljs-comment">## 2  0.034174191 -0.0185128130</span><br><span class="hljs-comment">## 3  0.005833437 -0.0020015591</span><br><span class="hljs-comment">## 4 -0.015690254 -0.0190696938</span><br><span class="hljs-comment">## 5  0.027821854 -0.0104951963</span><br><span class="hljs-comment">## 6  0.028223932 -0.0144727186</span><br><br></code></pre></td></tr></table></figure><h4 id="非类型基因型的归因-imputation-of-non‐typed-genotypes"><a href="#非类型基因型的归因-imputation-of-non‐typed-genotypes" class="headerlink" title="非类型基因型的归因 imputation of non‐typed genotypes"></a>非类型基因型的归因 imputation of non‐typed genotypes</h4><p>Imputing non‐typed single nucleotide polymorphisms using 1000 Genomes data </p><p>使用芯片阵列技术测量的类型SNPs通常捕获了大约100万个多态性，这些多态性在一般人群中至少有1%的变化。更为普遍的是，由于功能（因果）变体可能没有被测量到，所以人们对分析非类型SNPs的基因型与疾病结果的关联感兴趣。利用广泛的关于参考单倍型及其LD结构的外部资源，如HapMap和1000基因组数据，我们可以估算出未测量的基因型数据。三个精心描述并推荐的用于SNP水平归因的独立软件包是IMPUTE2、MACH和BEAGLE。归入的基因型可以报告为 “最佳猜测 “的基因型，或报告为基因组上某一位置的每个基因型的后验概率。重要的是，这种估计过程中的不确定性需要在关联分析中加以考虑，因此，我们从此区分了基因型和估算的数据。后面的步骤8中描述了专门考虑归入的SNP数据的不确定性的方法。</p><p>在归纳之后，要进行质量控制步骤，以过滤具有高度不确定性的归纳数据。常见的不确定性的衡量标准是信息含量和$R^2$ 。我们将$R^2$ 的阈值定为0.7，以纳入关联分析，在这种情况下，$R^2$ 是将每个归入的SNP回归到区域类型的SNP的线性模型的关联值。这在snpStats软件包的文档中有进一步描述。此外，我们在这个阶段排除了MAF（分配最高后验概率基因型后）小于0.01的SNPs。为了说明问题，我们使用R软件包snpStats中的snp.imputation()和impute.snps()函数，对同一染色体（16号染色体）上的1000个基因组SNP的有限集合进行归因，这些SNP在GWA关联分析（步骤7）中被确定为全基因组显著的基因分型。在实践中，通常在所有的染色体上进行归因，从而产生多达1250万个分型和归因的SNPs，可以对其进行关联分析。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#-step6-</span><br><span class="hljs-comment">#genotype imputation</span><br><br><span class="hljs-comment">#-step6a-</span><br><span class="hljs-comment">#read in 1000g data for given chromosome 16</span><br>thougeno &lt;- read.pedfile(onethou.fn$ped, snps = onethou.fn$info, which = <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># obtain genotype data for given chromosome</span><br>genoMatrix &lt;- thougeno$genotypes<br><br><span class="hljs-comment"># obtain the chromosome position for each SNP</span><br>support &lt;- thougeno$map<br>colnames(support) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;A1&quot;</span>, <span class="hljs-string">&quot;A2&quot;</span>)<br>head(support)<br><span class="hljs-comment">##           SNP position A1 A2</span><br><span class="hljs-comment">## 1 rs140769322    60180  3  2</span><br><span class="hljs-comment">## 2 rs188810967    60288  2  1</span><br><span class="hljs-comment">## 3  rs76368850    60291  2  4</span><br><span class="hljs-comment">## 4 rs185537431    60778  3  1</span><br><span class="hljs-comment">## 5 rs542544747    60842  2  1</span><br><span class="hljs-comment">## 6   rs4021615    61349  1  3</span><br><br><span class="hljs-comment">#imputation of non-typed 1000g SNPs</span><br>presSnps &lt;- colnames(genotype)<br><br><span class="hljs-comment">#subset for SNPs on given chromosome</span><br>presDatChr &lt;- genobim[genobim$SNP %in% presSnps &amp; genobim$chr==<span class="hljs-number">16</span>, ]<br>targetSnps &lt;- presDatChr$SNP<br><br><span class="hljs-comment">#subset 1000g data for our SNPs</span><br><span class="hljs-comment">#&quot;missing&quot; and &quot;present&quot; are snpMatrix objects needed for imputation rules</span><br>is.present &lt;- colnames(genoMatrix) %in% targetSnps<br>missing &lt;- genoMatrix[,!is.present]<br>print(<span class="hljs-built_in">missing</span>)<br><span class="hljs-comment">## A SnpMatrix with  99 rows and  377819 columns</span><br><span class="hljs-comment">## Row names:  CEU_1 ... CEU_99 </span><br><span class="hljs-comment">## Col names:  rs140769322 ... rs111706106 </span><br><br>present &lt;- genoMatrix[,is.present]<br>print(present)<br><span class="hljs-comment">## A SnpMatrix with  99 rows and  20632 columns</span><br><span class="hljs-comment">## Row names:  CEU_1 ... CEU_99 </span><br><span class="hljs-comment">## Col names:  rs41340949 ... rs4785775</span><br><br><span class="hljs-comment">#obtain position of SNPs to be used for imputation rules</span><br>pos.pres &lt;- support$position[is.present]<br>pos.mis &lt;- support$position[!is.present]<br><br><span class="hljs-comment">#calculate and store imputation rules using snp.imputation()</span><br>rules &lt;- snp.imputation(present, <span class="hljs-built_in">missing</span>, pos.pres, pos.mis)<br><span class="hljs-comment">## SNPs tagged by a single SNP: 82119</span><br><span class="hljs-comment">## SNPs tagged by multiple tag haplotypes (saturated model): 115769</span><br></code></pre></td></tr></table></figure><p>然后去掉failed imputation，输入相关不确定度高的SNPs，并且输入低估计MAF的SNPs。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step6b-</span><br><span class="hljs-comment">#remove failed imputations</span><br>rules &lt;- rules[can.impute(rules)]<br>cat(<span class="hljs-string">&quot;imputation rules for&quot;</span>, <span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;SNPs were estimated\n&quot;</span>) <br><span class="hljs-comment">## imputation rules for 197888 SNPs were estimated</span><br><br><span class="hljs-comment">#quality control for imputation certainty and MAF</span><br><span class="hljs-comment">#set thresholds</span><br>r2threshold &lt;- 0.7<br>minor &lt;- 0.01<br><br><span class="hljs-comment">#filter on imputation certainty and MAF</span><br>rules &lt;- rules[imputation.r2(rules) &gt;= <span class="hljs-number">0.7</span>]<br>cat(<span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;imputation rules remain after uncertain imputation were removed\n&quot;</span>)<br><span class="hljs-comment">## 162565 imputation rules remain after uncertain imputation were removed</span><br><br>rules &lt;- rules[imputation.maf(rules) &gt;= <span class="hljs-number">0.01</span>]<br>cat(<span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;imputation rules remain after MAF filtering\n&quot;</span>)<br><span class="hljs-comment">## 162565 imputation rules remain after MAF filtering</span><br><br><span class="hljs-comment">#obtain posterior expectation of genotypes of imputed snps</span><br>target &lt;- genotype[,targetSnps]<br>imputed &lt;- impute.snps(rules, target, <span class="hljs-built_in">as.numeric</span> = <span class="hljs-literal">FALSE</span>)<br>print(imputed)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  162565 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs560777354;rs80001234 ... rs62053708 </span><br></code></pre></td></tr></table></figure><p>这一步的分析结果：在16号染色体上的162565个基因组设定的SNPs被带到步骤8中进行关联分析。</p><p>需要强调的是，在关联分析（association analysis）的背景下，需要考虑归属的不确定性（the uncertainty in imputation），因此这些SNPs与下一步中分析的类型SNPs是分开考虑的。</p><h3 id="全基因组关联分析-Genome-wide-association-analysis"><a href="#全基因组关联分析-Genome-wide-association-analysis" class="headerlink" title="全基因组关联分析 Genome-wide association analysis"></a>全基因组关联分析 Genome-wide association analysis</h3><h4 id="类型SNP的关联分析-association-analysis-of-typed-SNPs"><a href="#类型SNP的关联分析-association-analysis-of-typed-SNPs" class="headerlink" title="类型SNP的关联分析 association analysis of typed SNPs"></a>类型SNP的关联分析 association analysis of typed SNPs</h4><p>关联分析通常涉及将每个SNP单独回归到一个给定的性状上，并根据病人层面的临床、人口和环境因素进行调整。假设每个SNP的基础遗传模型（如显性、隐性或加性）将影响结果；然而，由于大量的SNP和与结果的关系通常不确定，通常会选择一个单一的加性模型。在这种情况下，如所提供的代码所示，每个SNP被表示为相应的小等位基因数（0、1或2）。</p><p>值得注意的是，基于替代模型（如显性或隐性）的SNP变量的编码是直接的，所描述的关联分析也是如此。在实践中，Bonferonni校正的全基因组显著性阈值为 $5×10^{-8}$，用于控制家族性的错误率。这个临界值是基于研究，表明整个基因组大约有100万个独立的SNPs，所以不管调查中实际的 typed 或 imputed 的SNPs数量如何，都要应用。</p><p>在我们的数据例子中，我们使用反正态转换的高密度脂蛋白胆固醇作为响应，调整了年龄、性别和前10个PC。高密度脂蛋白胆固醇是一个与心血管疾病相关的复杂特征，年龄和性别是其既定的风险因素。这两个协变量和任意选择的10个PC是心血管疾病性状关联研究的惯例。重要的是，在任何模型拟合过程中，必须评估模型假设的适当性，特别是所研究性状的正态性。对高密度脂蛋白胆固醇直方图的目视检查显示了一些极端值，因此，选择了反正态转换。其他转换，如对数转换，也可能是合理的，并具有保持观测值之间相对距离的优势。我们在本教程中不强调这一点，因为可以应用标准的统计建模实践。下面的代码为分析准备了表型数据。</p><blockquote><p>本教程需要GenABEL包，但该包已被从CRAN上移除，故只能使用下载压缩包然后本地安装的方法。</p><p>步骤如下：</p><ol><li><p>在terminal中</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -O https://cran.r-project.org/src/contrib/Archive/GenABEL/GenABEL_1.8-0.tar.gz<br>curl -O https://cran.r-project.org/src/contrib/Archive/GenABEL.data/GenABEL.data_1.0.0.tar.gz<br></code></pre></td></tr></table></figure></li><li><p>RStudio - Tools - Install Packages - Install from: Package Archive File</p></li></ol></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step7-</span><br><span class="hljs-comment">#association analysis of typed SNPs</span><br>library(GenABEL)<br><br><span class="hljs-comment">#-step7a-</span><br><span class="hljs-comment">#merge clinical data and principal components to create phenotype table</span><br>phenoSub &lt;- merge(clinical, pcs) <span class="hljs-comment"># data.frame =&gt; [FamID CAD sex age hdl pc1 pc2 ... pc10]</span><br><br><span class="hljs-comment">#we will do a rank-based inverse normal transformation of hdl</span><br>phenoSub$phenotype &lt;- rntransform(phenoSub$hdl, family = gaussian)<br><br><span class="hljs-comment">#show that the assumption of normality met after transformation</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))<br>hist(phenoSub$hdl, main=<span class="hljs-string">&quot;histogram of HDL&quot;</span>, xlab = <span class="hljs-string">&quot;HDL&quot;</span>)<br>hist(phenoSub$phenotype, main=<span class="hljs-string">&quot;histogram of tranformed HDL&quot;</span>, xlab = <span class="hljs-string">&quot;transformed HDL&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="hist.png" alt="hist"></p><blockquote><p>转换为了正态分布</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#remove unnecessary columns from table</span><br>phenoSub$hdl &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$ldl &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$tg &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$CAD &lt;- <span class="hljs-literal">NULL</span><br><br><span class="hljs-comment">#remove columns to match names necessary for GWAS() function</span><br>phenoSub &lt;- rename(phenoSub, replace = <span class="hljs-built_in">c</span>(FamID=<span class="hljs-string">&quot;id&quot;</span>))<br><br><span class="hljs-comment">#include only subjects with hdl data</span><br>phenoSub &lt;- phenoSub[!<span class="hljs-built_in">is.na</span>(phenoSub$phenotype),]<br><br>print(head(phenoSub))<br><span class="hljs-comment">##      id sex age         pc1           pc2          pc3           pc4           pc5           pc6           pc7</span><br><span class="hljs-comment">## 2 10004   2  50 -0.01177105 -0.0080186632  0.004526211  0.0137606581 -0.0005964856  0.0322921253 -0.0004926945</span><br><span class="hljs-comment">## 3 10005   1  55 -0.01696352 -0.0051956716 -0.013847881  0.0112937916 -0.0330688171 -0.0326298549 -0.0113624994</span><br><span class="hljs-comment">## 4 10007   1  52 -0.01067376  0.0037745524  0.004574423 -0.0015019307 -0.0127123211 -0.0007371223 -0.0048545424</span><br><span class="hljs-comment">## 5 10008   1  58 -0.01648794  0.0012844871 -0.019463117 -0.0051653724  0.0074000952 -0.0024935274  0.0022416080</span><br><span class="hljs-comment">## 6 10009   1  59 -0.01473445  0.0007935566 -0.017633485 -0.0005575061 -0.0547999107 -0.0288053889 -0.0075189053</span><br><span class="hljs-comment">## 7 10010   1  54 -0.01427468  0.0052373331 -0.014937383  0.0313489032  0.0104569709  0.0104441393 -0.0111072206</span><br><span class="hljs-comment">##            pc8          pc9         pc10  phenotype</span><br><span class="hljs-comment">## 2 -0.001072583  0.034174191 -0.018512813 -2.2877117</span><br><span class="hljs-comment">## 3 -0.001566384  0.005833437 -0.002001559 -0.4749316</span><br><span class="hljs-comment">## 4 -0.013640426 -0.015690254 -0.019069694  0.8855512</span><br><span class="hljs-comment">## 5  0.041584582  0.027821854 -0.010495196 -0.1644639</span><br><span class="hljs-comment">## 6  0.016484556  0.028223932 -0.014472719  0.3938940</span><br><span class="hljs-comment">## 7 -0.014092489 -0.020411854  0.017169084  1.7109552</span><br></code></pre></td></tr></table></figure><p>由于需要拟合的模型较多，建议并行运行GWA分析，即在几个核心中同时进行。每个核心对SNP的一个子集进行GWA分析，当所有核心的计算完成后，输出被返回到原来的顺序。</p><p>在接下来的文字中，我们描述了一种在MAC、Unix和Windows操作系统上并行运行分析的跨平台方法。detectCores()函数可以用来确定可用的工作者数量。为了并行地运行分析，我们使用doParallel包中的dopar()函数，表示工作器的数量。doPar()的输出是一个ascii文本文件。这些都包含在我们开发的GWAA()函数中，可在本稿件的补充信息B中找到。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step7b-</span><br><span class="hljs-comment">#run GWAS analysis (using parallel processing)</span><br>library(plyr)<br>source(<span class="hljs-string">&quot;GWAA.R&quot;</span>)<br></code></pre></td></tr></table></figure><p>出现报错，显示无法加载函数。</p><p>解决方案：使用全局自定义函数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ---- gwaa ----</span><br><br><span class="hljs-comment"># Genome-wide Association Analysis</span><br><span class="hljs-comment"># Parallel implementation of linear model fitting on each SNP</span><br><br>GWAA &lt;- <span class="hljs-keyword">function</span>(genodata=genotypes,  phenodata=phenotypes, family = gaussian, filename=<span class="hljs-literal">NULL</span>,<br>                 append=<span class="hljs-literal">FALSE</span>, workers=getOption(<span class="hljs-string">&quot;mc.cores&quot;</span>,<span class="hljs-number">2L</span>), flip=<span class="hljs-literal">TRUE</span>,<br>                 select.snps=<span class="hljs-literal">NULL</span>, hosts=<span class="hljs-literal">NULL</span>, nSplits=<span class="hljs-number">10</span>)<br>&#123;<br>    <span class="hljs-keyword">if</span> (!require(doParallel)) &#123; stop(<span class="hljs-string">&quot;Missing doParallel package&quot;</span>) &#125;<br>    <br>    <span class="hljs-comment">#Check that a filename was specified</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">is.null</span>(filename)) stop(<span class="hljs-string">&quot;Must specify a filename for output.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that the genotype data is of class &#x27;SnpMatrix&#x27;</span><br>    <span class="hljs-keyword">if</span>( <span class="hljs-built_in">class</span>(genodata)!=<span class="hljs-string">&quot;SnpMatrix&quot;</span>) stop(<span class="hljs-string">&quot;Genotype data must of class &#x27;SnpMatrix&#x27;.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that there is a variable named &#x27;phenotype&#x27; in phenodata table</span><br>    <span class="hljs-keyword">if</span>( !<span class="hljs-string">&quot;phenotype&quot;</span> %in% colnames(phenodata))  stop(<span class="hljs-string">&quot;Phenotype data must have column named &#x27;phenotype&#x27;&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that there is a variable named &#x27;id&#x27; in phenodata table</span><br>    <span class="hljs-keyword">if</span>( !<span class="hljs-string">&quot;id&quot;</span> %in% colnames(phenodata)) stop(<span class="hljs-string">&quot;Phenotype data must have column named &#x27;id&#x27;.&quot;</span>)<br>    <br>    <span class="hljs-comment">#If a vector of SNPs is given, subset genotype data for these SNPs</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">is.null</span>(select.snps)) genodata&lt;-genodata[,which(colnames(genodata)%in%select.snps)]<br>    <br>    <span class="hljs-comment">#Check that there are still SNPs in &#x27;SnpMatrix&#x27; object</span><br>    <span class="hljs-keyword">if</span>(ncol(genodata)==<span class="hljs-number">0</span>) stop(<span class="hljs-string">&quot;There are no SNPs in the &#x27;SnpMatrix&#x27; object.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Print the number of SNPs to be checked</span><br>    cat(paste(ncol(genodata), <span class="hljs-string">&quot; SNPs included in analysis.\n&quot;</span>))<br>    <br>    <span class="hljs-comment">#If append=FALSE than we will overwrite file with column names</span><br>    <span class="hljs-keyword">if</span>(!isTRUE(append)) &#123;<br>        columns&lt;-<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;Estimate&quot;</span>, <span class="hljs-string">&quot;Std.Error&quot;</span>, <span class="hljs-string">&quot;t-value&quot;</span>, <span class="hljs-string">&quot;p-value&quot;</span>)<br>        write.table(t(columns), filename, row.names=<span class="hljs-literal">FALSE</span>, col.names=<span class="hljs-literal">FALSE</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-literal">FALSE</span>)<br>    &#125;<br><br>    <span class="hljs-comment"># Check sample counts</span><br>    <span class="hljs-keyword">if</span> (nrow(phenodata) != nrow(genodata)) &#123;<br>        warning(<span class="hljs-string">&quot;Number of samples mismatch.  Using subset found in phenodata.&quot;</span>)<br>    &#125;<br><br>    <span class="hljs-comment"># Order genodata rows to be the same as phenodata</span><br>    genodata &lt;- genodata[phenodata$id,]<br><br>    cat(nrow(genodata), <span class="hljs-string">&quot;samples included in analysis.\n&quot;</span>)<br><br>    <span class="hljs-comment"># Change which allele is counted (major or minor)</span><br>    flip.matrix&lt;-<span class="hljs-keyword">function</span>(x) &#123;<br>        zero2 &lt;- which(x==<span class="hljs-number">0</span>)<br>        two0 &lt;- which(x==<span class="hljs-number">2</span>)<br>        x[zero2] &lt;- <span class="hljs-number">2</span><br>        x[two0] &lt;- <span class="hljs-number">0</span><br>        <span class="hljs-built_in">return</span>(x)<br>    &#125;<br><br>    nSNPs &lt;- ncol(genodata)<br>    genosplit &lt;- <span class="hljs-built_in">ceiling</span>(nSNPs/nSplits) <span class="hljs-comment"># number of SNPs in each subset</span><br><br>    snp.start &lt;- seq(<span class="hljs-number">1</span>, nSNPs, genosplit) <span class="hljs-comment"># index of first SNP in group</span><br>    snp.stop &lt;- pmin(snp.start+genosplit-<span class="hljs-number">1</span>, nSNPs) <span class="hljs-comment"># index of last SNP in group</span><br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is.null</span>(hosts)) &#123;<br>        <span class="hljs-comment"># On Unix this will use fork and mclapply.  On Windows it</span><br>        <span class="hljs-comment"># will create multiple processes on localhost.</span><br>        cl &lt;- makeCluster(workers)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment"># The listed hosts must be accessible by the current user using</span><br>        <span class="hljs-comment"># password-less ssh with R installed on all hosts, all </span><br>        <span class="hljs-comment"># packages installed, and &quot;rscript&quot; is in the default PATH.</span><br>        <span class="hljs-comment"># See docs for makeCluster() for more information.</span><br>        cl &lt;- makeCluster(hosts, <span class="hljs-string">&quot;PSOCK&quot;</span>)<br>    &#125;<br>    show(cl)                            <span class="hljs-comment"># report number of workers and type of parallel implementation</span><br>    registerDoParallel(cl)<br><br>    foreach (part=<span class="hljs-number">1</span>:nSplits) %do% &#123;<br>        <span class="hljs-comment"># Returns a standar matrix of the alleles encoded as 0, 1 or 2</span><br>        genoNum &lt;- as(genodata[,snp.start[part]:snp.stop[part]], <span class="hljs-string">&quot;numeric&quot;</span>)<br><br>        <span class="hljs-comment"># Flip the numeric values of genotypes to count minor allele</span><br>        <span class="hljs-keyword">if</span> (isTRUE(flip)) genoNum &lt;- flip.matrix(genoNum)<br><br>        <span class="hljs-comment"># For each SNP, concatenate the genotype column to the</span><br>        <span class="hljs-comment"># phenodata and fit a generalized linear model</span><br>        rsVec &lt;- colnames(genoNum)<br>        res &lt;- foreach(snp.name=rsVec, .combine=<span class="hljs-string">&#x27;rbind&#x27;</span>) %dopar% &#123;<br>            a &lt;- summary(glm(phenotype~ . - id, family=family, data=cbind(phenodata, snp=genoNum[,snp.name])))<br>            a$coefficients[<span class="hljs-string">&#x27;snp&#x27;</span>,]<br>        &#125;<br><br>        <span class="hljs-comment"># write results so far to a file</span><br>        write.table(cbind(rsVec,res), filename, append=<span class="hljs-literal">TRUE</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-literal">FALSE</span>, col.names=<span class="hljs-literal">FALSE</span>, row.names=<span class="hljs-literal">FALSE</span>)<br><br>        cat(sprintf(<span class="hljs-string">&quot;GWAS SNPs %s-%s (%s%% finished)\n&quot;</span>, snp.start[part], snp.stop[part], <span class="hljs-number">100</span>*part/nSplits))<br>    &#125;<br><br>    stopCluster(cl)<br>  <br>    <span class="hljs-built_in">return</span>(print(<span class="hljs-string">&quot;Done.&quot;</span>))<br>&#125;<br><span class="hljs-comment">#自定义GWAA函数</span><br><br><span class="hljs-comment">#note: this function writes a file, but does not produce a r project</span><br>start &lt;- Sys.time()<br>GWAA(genodata=genotype, phenodata=phenoSub, filename=gwaa.fname)<br><span class="hljs-comment">## [1] &quot;Done.&quot;</span><br><span class="hljs-comment">## Warning message:</span><br><span class="hljs-comment">## In GWAA(genodata = genotype, phenodata = phenoSub, filename = gwaa.fname) :</span><br><span class="hljs-comment">##   Number of samples mismatch.  Using subset found in phenodata.</span><br><br>end &lt;- Sys.time()<br>print(end-start)<br><span class="hljs-comment">## Time difference of 2.043743 hours</span><br></code></pre></td></tr></table></figure><h4 id="归因数据的关联分析-association-analysis-of-imputed-data"><a href="#归因数据的关联分析-association-analysis-of-imputed-data" class="headerlink" title="归因数据的关联分析 association analysis of imputed data"></a>归因数据的关联分析 association analysis of imputed data</h4><p>应用snpStats使用相应的后验概率进行估算 SNPs 的关联分析</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step8-</span><br><span class="hljs-comment">#association analysis of imputed SNPs</span><br><br><span class="hljs-comment">#-step8a-</span><br><span class="hljs-comment">#carry out associate testing for imputed SNPs using snp.rhs.tests()</span><br>rownames(phenoSub) &lt;- phenoSub$id<br>imp &lt;- snp.rhs.tests(phenotype ~ sex + age + pc1 + pc2 + pc3 + pc4 + pc5 + pc6 + pc7 + pc8 + pc9 + pc10,<br>                     family = <span class="hljs-string">&quot;Gaussian&quot;</span>,<br>                     data = phenoSub,<br>                     snp.data = target,<br>                     rules = rules)<br><br><span class="hljs-comment">#obtain p values for imputed SNPs by calling methods on the returned GlmTests object</span><br>results &lt;- data.frame(SNP = imp@snp.names, p.value = p.value(imp), stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br>results &lt;- results[!<span class="hljs-built_in">is.na</span>(results$p.value),]<br><br><span class="hljs-comment">#write a file containing the results</span><br>write.csv(results, input.out.fname, row.names = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#merge imputation testing results with support to obtain coordinates</span><br>imputeOut &lt;- merge(results, support[, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>)])<br>imputeOut$chr &lt;- 16<br>imputeOut$type &lt;- <span class="hljs-string">&quot;imputed&quot;</span><br><br><span class="hljs-comment">#find the -log_10 of the p-value</span><br>imputeOut$Neg_logP &lt;- -log10(imputeOut$p.value)<br><br><span class="hljs-comment">#order by p-value</span><br>imputeOut &lt;- arrange(imputeOut, p.value)<br>print(head(imputeOut))<br><span class="hljs-comment">##          SNP      p.value position chr    type Neg_logP</span><br><span class="hljs-comment">## 1  rs1532624 1.036455e-07 57005479  16 imputed 6.984449</span><br><span class="hljs-comment">## 2  rs7205804 1.036455e-07 57004889  16 imputed 6.984449</span><br><span class="hljs-comment">## 3 rs12446515 1.746000e-07 56987015  16 imputed 6.757956</span><br><span class="hljs-comment">## 4 rs17231506 1.746000e-07 56994528  16 imputed 6.757956</span><br><span class="hljs-comment">## 5   rs173539 1.746000e-07 56988044  16 imputed 6.757956</span><br><span class="hljs-comment">## 6   rs183130 1.746000e-07 56991363  16 imputed 6.757956</span><br></code></pre></td></tr></table></figure><p>现在，我们在16号染色体上总共确定了22个推算的SNPs，这些SNPs在 $5×10^{-6}$ 的暗示性关联阈值下是显著的。</p><p>接下来，我们只选择CETP区域内（±5Kb）的SNPs进行报告。在此，我们使用自开发的map2gene()函数，，它可以确定属于指定基因区域的SNPs集合。这个函数使用基于基因组参考联盟GRCh37（hg19）的基因坐标，在文件ProCodgene_coords.csv中提供。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step8b-</span><br><span class="hljs-comment"># ---- map2gene ----</span><br><span class="hljs-comment"># Returns the subset of SNPs that are within extend.boundary of gene</span><br><span class="hljs-comment"># using the coords table of gene locations.</span><br>map2gene &lt;- <span class="hljs-keyword">function</span>(gene, coords, SNPs, extend.boundary = <span class="hljs-number">5000</span>) &#123;<br>  coordsSub &lt;- coords[coords$gene == gene,] <span class="hljs-comment">#Subset coordinate file for spcified gene</span><br>  <br>  coordsSub$start &lt;- coordsSub$start - extend.boundary <span class="hljs-comment"># Extend gene boundaries</span><br>  coordsSub$stop &lt;- coordsSub$stop + extend.boundary<br>  <br>  SNPsub &lt;- SNPs[SNPs$position &gt;= coordsSub$start &amp; SNPs$position &lt;= coordsSub$stop &amp;<br>                   SNPs$chr == coordsSub$chr,] <span class="hljs-comment">#Subset for SNPs in gene</span><br>  <br>  <span class="hljs-built_in">return</span>(data.frame(SNPsub, gene = gene, stringsAsFactors = <span class="hljs-literal">FALSE</span>))<br>&#125;<br><br><span class="hljs-comment">#read in file containing protein coding genes coords</span><br>genes &lt;- read.csv(protein.coding.coords.fnamo, stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#subset for CETP SNPs</span><br>impCETP &lt;- map2gene(<span class="hljs-string">&quot;CETP&quot;</span>, coords = genes, SNPs = imputeOut)<br><br><span class="hljs-comment">#filter only the imputed CETP SNP genotypes</span><br>impCETPgeno &lt;- imputed[,impCETP$SNP]<br></code></pre></td></tr></table></figure><p>在这个阶段，我们将70个归纳的SNPs映射到CETP区域，其中16个在 $5×10^{-6}$ 的提示性关联阈值上是显著的。</p><h3 id="Post‐analytic-visualization-and-genomic-interrogation-后分析可视化和基因组审查"><a href="#Post‐analytic-visualization-and-genomic-interrogation-后分析可视化和基因组审查" class="headerlink" title="Post‐analytic visualization and genomic interrogation 后分析可视化和基因组审查"></a>Post‐analytic visualization and genomic interrogation 后分析可视化和基因组审查</h3><h4 id="归因和类型SNP结果的整合-integration-of-imputed-and-typed-SNP-results"><a href="#归因和类型SNP结果的整合-integration-of-imputed-and-typed-SNP-results" class="headerlink" title="归因和类型SNP结果的整合 integration of imputed and typed SNP results"></a>归因和类型SNP结果的整合 integration of imputed and typed SNP results</h4><p>在这个阶段，将SNPs归属到基因座上并报告染色体和碱基对的位置，也被称为坐标或位置，也是很常见的。</p><p>值得注意的是，SNP的坐标取决于基因组的构建，在我们的数据例子中，我们使用基因组参考联盟GRCh37（hg19）构建。典型的结果展示包括基因和基因座名称；SNP名称；染色体编号；碱基对位置，根据指定的构建；来自模型拟合程序的系数估计（或赔率）；相应的标准误差；和相关的P值。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#-step9-</span><br><span class="hljs-comment">#data integration</span><br><br><span class="hljs-comment">#-step9a-</span><br><span class="hljs-comment">#read in GWAS output that was produced by GWAA function</span><br>GWASout &lt;- read.table(gwaa.fname, header = <span class="hljs-literal">TRUE</span>, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>, <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br><br><span class="hljs-comment">#find the -log_10 of the p-value</span><br>GWASout$Neg_logP &lt;- -log10(GWASout$p.value)<br><br><span class="hljs-comment">#merge output with genobim by SNP name to add position and chromosome number</span><br>GWASout &lt;- merge(GWASout, genobim[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>,<span class="hljs-string">&quot;chr&quot;</span>,<span class="hljs-string">&quot;position&quot;</span>)])<br><br><span class="hljs-comment">#order SNPs by significance</span><br>GWASout &lt;- arrange(GWASout, -Neg_logP)<br>print(head(GWASout))<br><span class="hljs-comment">##          SNP   Estimate  Std.Error   t.value      p.value Neg_logP chr  position</span><br><span class="hljs-comment">## 1  rs1532625  0.2015758 0.03748045  5.378159 8.944627e-08 7.048438  16  57005301</span><br><span class="hljs-comment">## 2   rs247617  0.2100771 0.03979461  5.279034 1.524209e-07 6.816955  16  56990716</span><br><span class="hljs-comment">## 3 rs10945761  0.1868139 0.04087883  4.569942 5.344253e-06 5.272113   6 162065367</span><br><span class="hljs-comment">## 4  rs9647610  0.1840277 0.04066594  4.525353 6.586987e-06 5.181313   6 162066421</span><br><span class="hljs-comment">## 5  rs3803768 -0.3048526 0.06755966 -4.512346 6.993775e-06 5.155288  17  80872028</span><br><span class="hljs-comment">## 6  rs4821708 -0.1808045 0.04018791 -4.498978 7.456555e-06 5.127462  22  38164106</span><br></code></pre></td></tr></table></figure><p>现在还需要一个额外的步骤来结合估算的数据结果和类型的SNP结果。值得注意的是，基因型推算可以涉及推算所有的SNPs，包括未观察到的和已分型的SNPs。因此，分析者可以选择从归因结果中只选择未分型或未通过SNP级过滤的SNP。在我们的例子中（第6步），我们归集了未分型的SNP以及未通过SNP水平过滤的SNP（第2和第4步）。然后，这个组合中的GWA重要SNPs可以进一步可视化，并按照步骤10的描述进行询问。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step9b-</span><br><span class="hljs-comment">#combine typed and imputed</span><br>GWASout$type &lt;- <span class="hljs-string">&quot;typed&quot;</span><br><br>GWAScomb &lt;- rbind.fill(GWASout, imputeOut)<br>head(GWAScomb)<br><span class="hljs-comment">##          SNP   Estimate  Std.Error   t.value      p.value Neg_logP chr  position  type</span><br><span class="hljs-comment">## 1  rs1532625  0.2015758 0.03748045  5.378159 8.944627e-08 7.048438  16  57005301 typed</span><br><span class="hljs-comment">## 2   rs247617  0.2100771 0.03979461  5.279034 1.524209e-07 6.816955  16  56990716 typed</span><br><span class="hljs-comment">## 3 rs10945761  0.1868139 0.04087883  4.569942 5.344253e-06 5.272113   6 162065367 typed</span><br><span class="hljs-comment">## 4  rs9647610  0.1840277 0.04066594  4.525353 6.586987e-06 5.181313   6 162066421 typed</span><br><span class="hljs-comment">## 5  rs3803768 -0.3048526 0.06755966 -4.512346 6.993775e-06 5.155288  17  80872028 typed</span><br><span class="hljs-comment">## 6  rs4821708 -0.1808045 0.04018791 -4.498978 7.456555e-06 5.127462  22  38164106 typed</span><br><br>tail(GWAScomb)<br><span class="hljs-comment">##              SNP Estimate Std.Error t.value   p.value     Neg_logP chr position    type</span><br><span class="hljs-comment">## 818527 rs7201255       NA        NA      NA 0.9999695 1.325135e-05  16 53869223 imputed</span><br><span class="hljs-comment">## 818528 rs7203572       NA        NA      NA 0.9999695 1.325135e-05  16 53869366 imputed</span><br><span class="hljs-comment">## 818529  rs257500       NA        NA      NA 0.9999870 5.647027e-06  16 64971479 imputed</span><br><span class="hljs-comment">## 818530  rs369139       NA        NA      NA 0.9999870 5.647027e-06  16 64968347 imputed</span><br><span class="hljs-comment">## 818531   rs40327       NA        NA      NA 0.9999870 5.647027e-06  16 64978301 imputed</span><br><span class="hljs-comment">## 818532  rs466296       NA        NA      NA 0.9999870 5.647027e-06  16 64962442 imputed</span><br><br><span class="hljs-comment">#subset for CETP SNPs</span><br>typCETP &lt;- map2gene(<span class="hljs-string">&quot;CETP&quot;</span>, coords = genes, SNPs = GWASout)<br><br><span class="hljs-comment">#combine CETP SNPs from imputed and typed analysis</span><br>CETP &lt;- rbind.fill(typCETP, impCETP)[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;p.value&quot;</span>, <span class="hljs-string">&quot;Neg_logP&quot;</span>, <span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>, <span class="hljs-string">&quot;gene&quot;</span>)]<br>print(CETP)<br><span class="hljs-comment">##            SNP      p.value   Neg_logP chr position    type gene</span><br><span class="hljs-comment">## 1    rs1532625 8.944627e-08 7.04843778  16 57005301   typed CETP</span><br><span class="hljs-comment">## 2     rs289742 4.257667e-04 3.37082835  16 57017762   typed CETP</span><br><span class="hljs-comment">## 3     rs289715 4.740815e-03 2.32414700  16 57008508   typed CETP</span><br><span class="hljs-comment">## 4    rs6499863 1.394646e-02 1.85553612  16 56992017   typed CETP</span><br><span class="hljs-comment">## 5    rs4783962 1.011933e-01 0.99484809  16 56995038   typed CETP</span><br><span class="hljs-comment">## 6    rs1800777 1.083617e-01 0.96512430  16 57017319   typed CETP</span><br><span class="hljs-comment">## 7   rs12708980 6.331485e-01 0.19849440  16 57012379   typed CETP</span><br><span class="hljs-comment">## 8    rs1532624 1.036455e-07 6.98444942  16 57005479 imputed CETP</span><br><span class="hljs-comment">## 9    rs7205804 1.036455e-07 6.98444942  16 57004889 imputed CETP</span><br><span class="hljs-comment">## 10  rs17231506 1.746000e-07 6.75795566  16 56994528 imputed CETP</span><br><span class="hljs-comment">## 11    rs183130 1.746000e-07 6.75795566  16 56991363 imputed CETP</span><br><span class="hljs-comment">## 12   rs3764261 1.746000e-07 6.75795566  16 56993324 imputed CETP</span><br><span class="hljs-comment">## 13    rs821840 1.746000e-07 6.75795566  16 56993886 imputed CETP</span><br><span class="hljs-comment">## 14  rs11508026 1.174797e-06 5.93003733  16 56999328 imputed CETP</span><br><span class="hljs-comment">## 15  rs12444012 1.174797e-06 5.93003733  16 57001438 imputed CETP</span><br><span class="hljs-comment">## 16  rs12720926 1.174797e-06 5.93003733  16 56998918 imputed CETP</span><br><span class="hljs-comment">## 17   rs4784741 1.174797e-06 5.93003733  16 57001216 imputed CETP</span><br><span class="hljs-comment">## 18  rs34620476 1.177972e-06 5.92886509  16 56996649 imputed CETP</span><br><span class="hljs-comment">## 19    rs708272 1.177972e-06 5.92886509  16 56996288 imputed CETP</span><br><span class="hljs-comment">## 20    rs711752 1.177972e-06 5.92886509  16 56996211 imputed CETP</span><br><span class="hljs-comment">## 21  rs12720922 3.392213e-06 5.46951693  16 57000885 imputed CETP</span><br><span class="hljs-comment">## 22   rs8045855 3.392213e-06 5.46951693  16 57000696 imputed CETP</span><br><span class="hljs-comment">## 23  rs12149545 3.692106e-06 5.43272585  16 56993161 imputed CETP</span><br><span class="hljs-comment">## 24   rs1800775 1.423952e-05 4.84650452  16 56995236 imputed CETP</span><br><span class="hljs-comment">## 25   rs3816117 1.423952e-05 4.84650452  16 56996158 imputed CETP</span><br><span class="hljs-comment">## 26  rs11076175 1.431416e-05 4.84423402  16 57006378 imputed CETP</span><br><span class="hljs-comment">## 27   rs7499892 1.431416e-05 4.84423402  16 57006590 imputed CETP</span><br><span class="hljs-comment">## 28  rs11076176 1.100766e-04 3.95830512  16 57007446 imputed CETP</span><br><span class="hljs-comment">## 29    rs289714 1.123948e-04 3.94925380  16 57007451 imputed CETP</span><br><span class="hljs-comment">## 30    rs158478 1.958087e-04 3.70816791  16 57007734 imputed CETP</span><br><span class="hljs-comment">## 31   rs9939224 3.075278e-04 3.51211557  16 57002732 imputed CETP</span><br><span class="hljs-comment">## 32  rs12447620 4.344681e-04 3.36204212  16 57014319 imputed CETP</span><br><span class="hljs-comment">## 33    rs158480 4.344681e-04 3.36204212  16 57008227 imputed CETP</span><br><span class="hljs-comment">## 34    rs158617 4.344681e-04 3.36204212  16 57008287 imputed CETP</span><br><span class="hljs-comment">## 35  rs11076174 4.293928e-03 2.36714525  16 57003146 imputed CETP</span><br><span class="hljs-comment">## 36 rs112039804 4.742793e-03 2.32396582  16 57018856 imputed CETP</span><br><span class="hljs-comment">## 37  rs12708985 4.742793e-03 2.32396582  16 57014610 imputed CETP</span><br><span class="hljs-comment">## 38    rs736274 4.742793e-03 2.32396582  16 57009769 imputed CETP</span><br><span class="hljs-comment">## 39 rs201825234 1.403181e-02 1.85288617  16 56991948 imputed CETP</span><br><span class="hljs-comment">## 40   rs2115429 1.403181e-02 1.85288617  16 56992842 imputed CETP</span><br><span class="hljs-comment">## 41   rs6499861 1.403181e-02 1.85288617  16 56991495 imputed CETP</span><br><span class="hljs-comment">## 42   rs6499862 1.403181e-02 1.85288617  16 56991524 imputed CETP</span><br><span class="hljs-comment">## 43    rs158479 1.764815e-02 1.75330083  16 57008048 imputed CETP</span><br><span class="hljs-comment">## 44    rs289713 1.848673e-02 1.73313993  16 57006829 imputed CETP</span><br><span class="hljs-comment">## 45  rs12720918 2.690313e-02 1.57019722  16 56994212 imputed CETP</span><br><span class="hljs-comment">## 46  rs12920974 2.690313e-02 1.57019722  16 56993025 imputed CETP</span><br><span class="hljs-comment">## 47  rs36229787 3.284685e-02 1.48350624  16 56993897 imputed CETP</span><br><span class="hljs-comment">## 48    rs289712 4.630073e-02 1.33441214  16 57006305 imputed CETP</span><br><span class="hljs-comment">## 49    rs820299 5.313036e-02 1.27465724  16 57000284 imputed CETP</span><br><span class="hljs-comment">## 50  rs34946873 5.924969e-02 1.22731392  16 56991143 imputed CETP</span><br><span class="hljs-comment">## 51  rs12597002 6.482442e-02 1.18826138  16 57002404 imputed CETP</span><br><span class="hljs-comment">## 52  rs60545348 6.482442e-02 1.18826138  16 57001985 imputed CETP</span><br><span class="hljs-comment">## 53    rs708273 6.482442e-02 1.18826138  16 56999949 imputed CETP</span><br><span class="hljs-comment">## 54   rs4369653 6.674449e-02 1.17558455  16 56997551 imputed CETP</span><br><span class="hljs-comment">## 55   rs4587963 7.720580e-02 1.11235007  16 56997369 imputed CETP</span><br><span class="hljs-comment">## 56      rs5880 8.144506e-02 1.08913528  16 57015091 imputed CETP</span><br><span class="hljs-comment">## 57   rs1800776 9.403016e-02 1.02673283  16 56995234 imputed CETP</span><br><span class="hljs-comment">## 58    rs289746 9.558715e-02 1.01960051  16 57020205 imputed CETP</span><br><span class="hljs-comment">## 59  rs12447839 1.014589e-01 0.99370984  16 56993935 imputed CETP</span><br><span class="hljs-comment">## 60  rs12447924 1.014589e-01 0.99370984  16 56994192 imputed CETP</span><br><span class="hljs-comment">## 61    rs158477 1.602619e-01 0.79516962  16 57007610 imputed CETP</span><br><span class="hljs-comment">## 62  rs12708983 2.717574e-01 0.56581860  16 57014411 imputed CETP</span><br><span class="hljs-comment">## 63  rs66495554 2.827752e-01 0.54855862  16 57018636 imputed CETP</span><br><span class="hljs-comment">## 64  rs12720889 2.857284e-01 0.54404657  16 57012563 imputed CETP</span><br><span class="hljs-comment">## 65  rs12934552 3.188555e-01 0.49640603  16 57021433 imputed CETP</span><br><span class="hljs-comment">## 66  rs12708968 3.476125e-01 0.45890456  16 56994819 imputed CETP</span><br><span class="hljs-comment">## 67  rs17245715 3.476125e-01 0.45890456  16 56994990 imputed CETP</span><br><span class="hljs-comment">## 68   rs4783961 4.661962e-01 0.33143130  16 56994894 imputed CETP</span><br><span class="hljs-comment">## 69  rs12598522 4.853361e-01 0.31395741  16 57022352 imputed CETP</span><br><span class="hljs-comment">## 70  rs56315364 4.853361e-01 0.31395741  16 57021524 imputed CETP</span><br><span class="hljs-comment">## 71 rs117427818 5.101389e-01 0.29231153  16 57010486 imputed CETP</span><br><span class="hljs-comment">## 72  rs11860407 5.935059e-01 0.22657493  16 57010828 imputed CETP</span><br><span class="hljs-comment">## 73   rs2033254 5.935059e-01 0.22657493  16 57009985 imputed CETP</span><br><span class="hljs-comment">## 74   rs7405284 6.134481e-01 0.21222214  16 57001275 imputed CETP</span><br><span class="hljs-comment">## 75   rs1800774 6.200971e-01 0.20754027  16 57015545 imputed CETP</span><br><span class="hljs-comment">## 76  rs36229786 6.227677e-01 0.20567392  16 56993901 imputed CETP</span><br><span class="hljs-comment">## 77  rs12708974 8.568509e-01 0.06709476  16 57005550 imputed CETP</span><br></code></pre></td></tr></table></figure><h4 id="关联结果的可视化和质量控制-visualization-and-quality-control-of-association-findings"><a href="#关联结果的可视化和质量控制-visualization-and-quality-control-of-association-findings" class="headerlink" title="关联结果的可视化和质量控制 visualization and quality control of association findings"></a>关联结果的可视化和质量控制 visualization and quality control of association findings</h4><p>这里描述了三种可视化工具。除了这些可视化方法，使用其他基因模型进行关联分析也是一个有用的敏感度分析。</p><h5 id="Manhattan-plots-曼哈顿图"><a href="#Manhattan-plots-曼哈顿图" class="headerlink" title="Manhattan plots 曼哈顿图"></a>Manhattan plots 曼哈顿图</h5><p>曼哈顿图被用来按染色体位置直观地显示GWA的显著性水平。在曼哈顿图中，每个点对应于一个SNP。X轴代表基因坐标，显示的数字对应于染色体编号。y轴是对数p值的负值，所以大的值对应小的p值。实心横线表示Bonferonni校正的显著性阈值（$- log(5 × 10^{-8})$）。</p><p>虚线是一个不太严格的暗示性关联阈值（$- log(5 × 10^{-6})$），我们将其作为暗示性关联的指标，需要进一步验证。</p><p>通过对该图的目视检查，可以识别出P值相对较小的SNP，这些SNP位于P值相对较大且不显著的区域，表明有可能是虚假的发现。CETP区域的多个信号表明，这可能是一个真实的信号。该图是用我们开发的GWAS_Manhattan()生成的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10-</span><br><span class="hljs-comment">#visualizing and QC of GWA findings</span><br><span class="hljs-comment"># ---- manhattan ----</span><br><span class="hljs-comment"># Receives a data.frame of SNPs with Neg_logP, chr, position, and type.</span><br><span class="hljs-comment"># Plots Manhattan plot with significant SNPs highlighted.</span><br>GWAS_Manhattan &lt;- <span class="hljs-keyword">function</span>(GWAS, col.snps=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;black&quot;</span>,<span class="hljs-string">&quot;gray&quot;</span>),<br>                           col.detected=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;black&quot;</span>), col.imputed=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;blue&quot;</span>), col.text=<span class="hljs-string">&quot;black&quot;</span>,<br>                           title=<span class="hljs-string">&quot;GWAS Tutorial Manhattan Plot&quot;</span>, display.text=<span class="hljs-literal">TRUE</span>,<br>                           bonferroni.alpha=<span class="hljs-number">0.05</span>, bonferroni.adjustment=<span class="hljs-number">1000000</span>,<br>                           Lstringent.adjustment=<span class="hljs-number">10000</span>) &#123;<br>  <br>  bonferroni.thresh &lt;- -log10(bonferroni.alpha / bonferroni.adjustment)<br>  Lstringent.thresh &lt;- -log10(bonferroni.alpha / Lstringent.adjustment)<br>  xscale &lt;- 1000000<br>  <br>  manhat &lt;- GWAS[!grepl(<span class="hljs-string">&quot;[A-z]&quot;</span>,GWAS$chr),]<br>  <br>  <span class="hljs-comment">#sort the data by chromosome and then location</span><br>  manhat.ord &lt;- manhat[order(<span class="hljs-built_in">as.numeric</span>(manhat$chr),manhat$position),]<br>  manhat.ord &lt;- manhat.ord[!<span class="hljs-built_in">is.na</span>(manhat.ord$position),]<br>  <br>  <span class="hljs-comment">##Finding the maximum position for each chromosome</span><br>  max.pos &lt;- sapply(<span class="hljs-number">1</span>:<span class="hljs-number">21</span>, <span class="hljs-keyword">function</span>(i) &#123; <span class="hljs-built_in">max</span>(manhat.ord$position[manhat.ord$chr==i],<span class="hljs-number">0</span>) &#125;)<br>  max.pos2 &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">cumsum</span>(max.pos))                  <br>  <br>  <span class="hljs-comment">#Add spacing between chromosomes</span><br>  max.pos2 &lt;- max.pos2 + <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>:<span class="hljs-number">21</span>) * xscale * <span class="hljs-number">10</span><br>  <br>  <span class="hljs-comment">#defining the positions of each snp in the plot</span><br>  manhat.ord$pos &lt;- manhat.ord$position + max.pos2[<span class="hljs-built_in">as.numeric</span>(manhat.ord$chr)]<br>  <br>  <span class="hljs-comment"># alternate coloring of chromosomes</span><br>  manhat.ord$col &lt;- col.snps[<span class="hljs-number">1</span> + <span class="hljs-built_in">as.numeric</span>(manhat.ord$chr) %% <span class="hljs-number">2</span>]<br>  <br>  <span class="hljs-comment"># draw the chromosome label roughly in the middle of each chromosome band</span><br>  text.pos &lt;- sapply(<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>:<span class="hljs-number">22</span>), <span class="hljs-keyword">function</span>(i) &#123; mean(manhat.ord$pos[manhat.ord$chr==i]) &#125;)<br>  <br>  <span class="hljs-comment"># Plot the data</span><br>  plot(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>],<br>       pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.3</span>, col= manhat.ord$col[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>], xlab=<span class="hljs-literal">NA</span>,<br>       ylab=<span class="hljs-string">&quot;Negative Log P-value&quot;</span>, axes=<span class="hljs-built_in">F</span>, ylim=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">max</span>(manhat$Neg_logP)+<span class="hljs-number">1</span>))<br>  <span class="hljs-comment">#Add x-label so that it is close to axis</span><br>  mtext(side = <span class="hljs-number">1</span>, <span class="hljs-string">&quot;Chromosome&quot;</span>, line = <span class="hljs-number">1.25</span>)<br>  <br>  points(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;imputed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;imputed&quot;</span>],<br>         pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.4</span>, col = col.imputed)<br>  <br>  points(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>],<br>         pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.3</span>, col = manhat.ord$col[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>])<br>  <br>  axis(<span class="hljs-number">2</span>)<br>  abline(h=<span class="hljs-number">0</span>)<br>  <br>  SigNifSNPs &lt;- <span class="hljs-built_in">as.character</span>(GWAS[GWAS$Neg_logP &gt; Lstringent.thresh &amp; GWAS$type==<span class="hljs-string">&quot;typed&quot;</span>, <span class="hljs-string">&quot;SNP&quot;</span>])<br>  <br>  <span class="hljs-comment">#Add legend</span><br>  legend(<span class="hljs-string">&quot;topright&quot;</span>,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;Bonferroni corrected threshold (p = 5E-8)&quot;</span>, <span class="hljs-string">&quot;Candidate threshold (p = 5E-6)&quot;</span>),<br>         border=<span class="hljs-string">&quot;black&quot;</span>, col=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;gray60&quot;</span>, <span class="hljs-string">&quot;gray60&quot;</span>), pch=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), lwd=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<br>         lty=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>), pt.cex=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), bty=<span class="hljs-string">&quot;o&quot;</span>, cex=<span class="hljs-number">0.6</span>)<br>  <br>  <span class="hljs-comment">#Add chromosome number</span><br>  text(text.pos/xscale, -<span class="hljs-number">.3</span>, seq(<span class="hljs-number">1</span>,<span class="hljs-number">22</span>,by=<span class="hljs-number">1</span>), xpd=<span class="hljs-literal">TRUE</span>, cex=<span class="hljs-number">.8</span>)<br>  <br>  <span class="hljs-comment">#Add bonferroni line</span><br>  abline(h=bonferroni.thresh, untf = <span class="hljs-literal">FALSE</span>, col = <span class="hljs-string">&quot;gray60&quot;</span>)<br>  <br>  <span class="hljs-comment">#Add &quot;less stringent&quot; line</span><br>  abline(h=Lstringent.thresh, untf = <span class="hljs-literal">FALSE</span>, col = <span class="hljs-string">&quot;gray60&quot;</span>, lty = <span class="hljs-number">2</span> )<br>  <br>  <span class="hljs-comment">#Plotting detected genes</span><br>  <span class="hljs-comment">#Were any genes detected?</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">length</span>(SigNifSNPs)&gt;<span class="hljs-number">0</span>)&#123;<br>    <br>    sig.snps &lt;- manhat.ord[,<span class="hljs-string">&#x27;SNP&#x27;</span>] %in% SigNifSNPs<br>    <br>    points(manhat.ord$pos[sig.snps]/xscale,<br>           manhat.ord$Neg_logP[sig.snps],<br>           pch=<span class="hljs-number">20</span>,col=col.detected, bg=col.detected,cex=<span class="hljs-number">0.5</span>)<br>    <br>    text(manhat.ord$pos[sig.snps]/xscale,<br>         manhat.ord$Neg_logP[sig.snps],<br>         <span class="hljs-built_in">as.character</span>(manhat.ord[sig.snps,<span class="hljs-number">1</span>]), col=col.text, offset=<span class="hljs-number">1</span>, adj=-<span class="hljs-number">.1</span>, cex=<span class="hljs-number">.5</span>)<br>  &#125;<br>&#125;<br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<br><br><span class="hljs-comment">#-step10a-</span><br><span class="hljs-comment">#create manhattan plot</span><br>GWAS_Manhattan(GWAScomb)<br></code></pre></td></tr></table></figure><p><img src="manhattan_plot.png" alt="manhattan_plot"></p><h5 id="Q–Q-plots-and-the-λ‐statistic-QQ图和λ统计量"><a href="#Q–Q-plots-and-the-λ‐statistic-QQ图和λ统计量" class="headerlink" title="Q–Q plots and the λ‐statistic QQ图和λ统计量"></a>Q–Q plots and the <em>λ</em>‐statistic QQ图和λ统计量</h5><p>Q-Q图用于可视化SNP水平测试统计量的预期分布和观察分布之间的关系。在考虑了建模框架中人口亚结构的潜在混杂因素后，分布的尾部被拉近到y=x线。如果该图中的数据从y = x线上移或下移，那么我们将考虑可能的系统性偏差。最后，右上角尾部与y = x线的轻微偏差粗略地表明，数据中存在着某种形式的关联。</p><p>偏离这条路线的程度由λ统计量来正式衡量，其中接近1的数值表明对潜在的子结构进行了适当的调整。虽然在对PC进行调整后，λ得到了改善（从λ=1.014到λ=1.0032），但由于这个PennCATH样本来自一个相对同质的人群，所以没有观察到数值上的巨大差异。一般来说，目标是使λ值接近于1；λ&gt;1.2表明有分层，通常在这种情况下会包括额外的PC，在某些情况下，该研究会被排除在随后的荟萃分析中。计算一个考虑到样本量的标准化λ，在不同研究的数值对比中特别有用，以便纳入荟萃分析。我们应用以下代码为未调整和调整模型生成标准化的λ，结果是未调整和调整模型的λ分别为1.0108和1.000632。对于二元性状，可以应用标准化方法。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10b-</span><br><span class="hljs-comment">#return the GWAS using unadjusted model</span><br>phenoSub2 &lt;- phenoSub[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;phenotype&quot;</span>)] <span class="hljs-comment">#remove all extra fators, leave only phenotype</span><br><br>GWAA(genodata = genotype, phenodata = phenoSub2, filename = gwaa.unadj.fname)<br>GWASoutUnadj &lt;- read.table(gwaa.unadj.fname, head=<span class="hljs-literal">TRUE</span>, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>,<span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br><br><span class="hljs-comment">#create QQ plots for adjusted and unadjusted model outputs</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))<br>lambdaAdj &lt;- estlambda(GWASout$t.value^<span class="hljs-number">2</span>, plot = <span class="hljs-literal">TRUE</span>, method = <span class="hljs-string">&quot;median&quot;</span>)<br>lambdaUnadj &lt;- estlambda(GWASoutUnadj$t.value^<span class="hljs-number">2</span>, plot = <span class="hljs-literal">TRUE</span>, method = <span class="hljs-string">&quot;median&quot;</span>)<br>cat(sprintf(<span class="hljs-string">&quot;Unadjusted lambda: %s\nAdjusted lambda: %s\n&quot;</span>, lambdaUnadj$estimate, lambdaAdj$estimate))<br><span class="hljs-comment">## Unadjusted lambda: 1.01417377078806</span><br><span class="hljs-comment">## Adjusted lambda: 1.00056081659278</span><br><br><span class="hljs-comment">#-step10c-</span><br><span class="hljs-comment">#calculate standardized lambda</span><br>lambdaAdj_1000 &lt;- 1+(lambdaAdj$estimate-<span class="hljs-number">1</span>)/nrow(phenoSub)*<span class="hljs-number">1000</span><br>lambdaUnadj_1000 &lt;- 1+(lambdaUnadj$estimate-<span class="hljs-number">1</span>)/nrow(phenoSub)*<span class="hljs-number">1000</span><br>cat(sprintf(<span class="hljs-string">&quot;standardized unadjusted lambda: %s\nstandard adjusted lambda: %s\n&quot;</span>, lambdaUnadj_1000, lambdaAdj_1000))<br><span class="hljs-comment">## standardized unadjusted lambda: 1.0108279379588</span><br><span class="hljs-comment">## standard adjusted lambda: 1.0004284313161</span><br></code></pre></td></tr></table></figure><p><img src="qqplot.png" alt="qqplot"></p><h5 id="Heatmaps-and-regional-association-plots-热图和区域关联图"><a href="#Heatmaps-and-regional-association-plots-热图和区域关联图" class="headerlink" title="Heatmaps and regional association plots 热图和区域关联图"></a>Heatmaps and regional association plots 热图和区域关联图</h5><p>热图和区域关联图通常在GWA分析的背景下使用，以可视化GWA显著SNPs和附近区域SNPs之间的LD模式，LD通常用 $r^2$ 或 $D′$ 来衡量，它们都是标量D的转化，定义为两个主要等位基因的联合概率与两个边际概率的乘积之间的差异，其中调整是基于等位基因频率。</p><p>阴影的程度表示LD的数量，因此较深的方块表示较高的LD。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10d-</span><br>install.packages(<span class="hljs-string">&quot;LDheatmap&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;rtracklayer&quot;</span>)<br><br><span class="hljs-comment">#add &quot;rs247671&quot; to CETP</span><br>CETP &lt;- rbind.fill(GWASout[GWASout$SNP == <span class="hljs-string">&quot;rs247617&quot;</span>,],CETP)<br><br><span class="hljs-comment">#combine genotype and imputed genotypes for CETP region</span><br>subgen &lt;- cbind(genotype[,colnames(genotype) %in% CETP$SNP], impCETPgeno) <span class="hljs-comment">#CETP subsets from typed and imputed SNPs</span><br><br><span class="hljs-comment">#subset SNPs for only certain genptypes</span><br>certain &lt;- apply(as(subgen,<span class="hljs-string">&#x27;numeric&#x27;</span>), <span class="hljs-number">2</span>, <span class="hljs-keyword">function</span>(x) &#123;<span class="hljs-built_in">all</span>(x %in% <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-literal">NA</span>))&#125;)<br>subgen &lt;- subgen[,certain]<br><br><span class="hljs-comment">#subset and order CETP SNPs by position</span><br>CETP &lt;- CETP[CETP$SNP %in% colnames(subgen),]<br>CETP &lt;- arrange(CETP, position)<br>subgen &lt;- subgen[, order(match(colnames(subgen),CETP$SNP)) ]<br><br><span class="hljs-comment"># Create LDheatmap</span><br>ld &lt;- ld(subgen, subgen, stats=<span class="hljs-string">&quot;R.squared&quot;</span>) <span class="hljs-comment"># Find LD map of CETP SNPs</span><br><br>ll &lt;- LDheatmap(ld, CETP$position, flip=<span class="hljs-literal">TRUE</span>, name=<span class="hljs-string">&quot;myLDgrob&quot;</span>, title=<span class="hljs-literal">NULL</span>)<br><br><span class="hljs-comment"># Add genes, recombination</span><br>llplusgenes &lt;- LDheatmap.addGenes(ll, chr = <span class="hljs-string">&quot;chr16&quot;</span>, genome = <span class="hljs-string">&quot;hg19&quot;</span>, genesLocation = <span class="hljs-number">0.01</span>)<br><br><span class="hljs-comment"># Add plot of -log(p)</span><br>library(ggplot2)<br>library(grid)<br><br>plot.new()<br>llQplot2&lt;-LDheatmap.addGrob(llplusgenes, rectGrob(gp = gpar(col = <span class="hljs-string">&quot;white&quot;</span>)),height = <span class="hljs-number">.34</span>)<br>pushViewport(viewport(x = <span class="hljs-number">0.483</span>, y= <span class="hljs-number">0.76</span>, width = <span class="hljs-number">.91</span> ,height = <span class="hljs-number">.4</span>))<br></code></pre></td></tr></table></figure><p><img src="ldheatmap.png" alt="ldheatmap"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.draw(ggplotGrob(&#123;<br>  qplot(position, Neg_logP, data = CETP, xlab=<span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;Negative Log P-value&quot;</span>, xlim = <span class="hljs-built_in">range</span>(CETP$position),<br>        asp = <span class="hljs-number">1</span>/<span class="hljs-number">10</span>, color = factor(type), colour=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;#000000&quot;</span>, <span class="hljs-string">&quot;#D55E00&quot;</span>)) + <br>    theme(axis.text.x = element_blank(),<br>          axis.title.y = element_text(size = rel(<span class="hljs-number">0.75</span>)), legend.position = <span class="hljs-string">&quot;none&quot;</span>, <br>          panel.background = element_blank(), <br>          axis.line = element_line(colour = <span class="hljs-string">&quot;black&quot;</span>)) +<br>    scale_color_manual(values = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;red&quot;</span>, <span class="hljs-string">&quot;black&quot;</span>))<br>&#125;))<br></code></pre></td></tr></table></figure><p><img src="ldheatmap_new.png" alt="ldheatmap_new"></p><h5 id="使用外部资源的额外数据查询Additional-data-interrogation-using-external-resources"><a href="#使用外部资源的额外数据查询Additional-data-interrogation-using-external-resources" class="headerlink" title="使用外部资源的额外数据查询Additional data interrogation using external resources"></a>使用外部资源的额外数据查询Additional data interrogation using external resources</h5><p>如果能提供研究结果的背景，报告SNP级别的关联分析结果会更有意义。例如，研究者可能想知道一个有统计学意义的SNP是否在一个蛋白质编码基因内、基因间、或接近与被调查疾病相关的特定组织或细胞类型中的调控元素（如甲基化标记）。</p><p>可能相关的外部数据类型见下表。</p><p>这些数据分为八大类，大致按照代表从DNA信息到调节到表达的过程的顺序。</p><ol><li>SNP；</li><li>基因元件；</li><li>染色质状态；</li><li>表观遗传标记；</li><li>转录因子结合；</li><li>RNA表达；</li><li>SNP-mRNA关联；</li><li>其他组学数据。</li></ol><p>我们强调，这个表格并不全面，而是提供了一个可利用的大量外部数据资源的一瞥。与列出的每个类别相关的数据都有广泛的来源。UCSC基因组浏览器提供了一套精心设计的综合生物信息学工具和数据库，包括许多来自补充信息C，表1中所列的资源，可以进一步审视GWA的结果。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># -step10d-</span><br><span class="hljs-comment"># Create regional association plot</span><br><span class="hljs-comment"># Create data.frame of most significant SNP only</span><br>install.packages(<span class="hljs-string">&quot;coin&quot;</span>)<br>install.packages(<span class="hljs-string">&quot;~/postgwas_1.11.tar.gz&quot;</span>, repos = <span class="hljs-literal">NULL</span>, type = <span class="hljs-string">&quot;source&quot;</span>)<br>library(postgwas)<br><br>snps&lt;-data.frame(SNP=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>))<br><br><span class="hljs-comment"># Change column names necessary to run regionalplot function</span><br>GWAScomb &lt;- rename(GWAScomb, <span class="hljs-built_in">c</span>(p.value=<span class="hljs-string">&quot;P&quot;</span>, chr=<span class="hljs-string">&quot;CHR&quot;</span>, position=<span class="hljs-string">&quot;BP&quot;</span>))<br><br><br><span class="hljs-comment"># Edit biomartConfigs so regionalplot function</span><br><span class="hljs-comment"># pulls from human genome build 37/hg19</span><br><br>myconfig &lt;- biomartConfigs$hsapiens<br>myconfig$hsapiens$gene$host &lt;- <span class="hljs-string">&quot;grch37.ensembl.org&quot;</span><br>myconfig$hsapiens$gene$mart &lt;- <span class="hljs-string">&quot;ENSEMBL_MART_ENSEMBL&quot;</span><br>myconfig$hsapiens$snp$host &lt;- <span class="hljs-string">&quot;grch37.ensembl.org&quot;</span><br>myconfig$hsapiens$snp$mart &lt;- <span class="hljs-string">&quot;ENSEMBL_MART_SNP&quot;</span><br><br><br><span class="hljs-comment"># Run regionalplot using HAPMAP data (pop = CEU)</span><br>regionalplot(snps, GWAScomb, biomart.config = myconfig, window.size = <span class="hljs-number">400000</span>, draw.snpname = data.frame(<br>  snps = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>, <span class="hljs-string">&quot;rs247617&quot;</span>), <br>  text = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>, <span class="hljs-string">&quot;rs247617&quot;</span>),<br>  angle = <span class="hljs-built_in">c</span>(<span class="hljs-number">20</span>, <span class="hljs-number">160</span>),<br>  <span class="hljs-built_in">length</span> = <span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), <br>  cex = <span class="hljs-built_in">c</span>(<span class="hljs-number">0.8</span>)<br>),<br>ld.options = <span class="hljs-built_in">list</span>(<br>  gts.source = <span class="hljs-number">2</span>, <br>  max.snps.per.window = <span class="hljs-number">2000</span>, <br>  rsquare.min = <span class="hljs-number">0.8</span>, <br>  show.rsquare.text = <span class="hljs-literal">FALSE</span><br>),<br>out.format = <span class="hljs-built_in">list</span>(file = <span class="hljs-literal">NULL</span>, panels.per.page = <span class="hljs-number">2</span>))<br><span class="hljs-comment">## Reading GWAS datasets ...</span><br><span class="hljs-comment">## PLINK format detected</span><br><span class="hljs-comment">## Assembling regions...</span><br><span class="hljs-comment">## Initializing biomart connection (SNPs)...</span><br><span class="hljs-comment">## Error in bmRequest(request = request, verbose = verbose) : </span><br><span class="hljs-comment">##   Not Found (HTTP 404).</span><br><span class="hljs-comment"># 尚未解决</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>GWAS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2021/09/16/hello-world/"/>
    <url>/2021/09/16/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>2021.9.7-生信笔记-GWAS全基因组关联分析</title>
    <link href="/2021/09/07/20210907%E7%94%9F%E4%BF%A1%E7%AC%94%E8%AE%B0GWAS%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90/"/>
    <url>/2021/09/07/20210907%E7%94%9F%E4%BF%A1%E7%AC%94%E8%AE%B0GWAS%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210907%E7%94%9F%E4%BF%A1%E7%AC%94%E8%AE%B0GWAS%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h1 id="2021-9-7-生信笔记-GWAS全基因组关联分析"><a href="#2021-9-7-生信笔记-GWAS全基因组关联分析" class="headerlink" title="2021.9.7-生信笔记-GWAS全基因组关联分析"></a>2021.9.7-生信笔记-GWAS全基因组关联分析</h1><h2 id="全基因组关联分析-Genome-wide-association-study-GWAS"><a href="#全基因组关联分析-Genome-wide-association-study-GWAS" class="headerlink" title="全基因组关联分析/Genome-wide association study (GWAS)"></a>全基因组关联分析/Genome-wide association study (GWAS)</h2><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001694/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001694/</a></p><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>全基因组关联分析（Genome-wide association study）是指在人类全基因组范围内找出存在的序列变异，即单核苷酸多态性（single nucleotide polymorphisms, SNP），从中筛选出与疾病相关的SNPs。在全基因组范围内选择遗传变异进行基因分析，比较异常和对照组之间每个遗传变异及其频率的差异，统计分析每个变异与目标性状之间的关联性大小，选出最相关的遗传变异进行验证，并根据验证结果最终确认其与目标性状之间的相关性。</p><blockquote><p>总结来说，GWAS是为了确定单核苷酸多态性(SNPs)与表型性状之间的关联。</p></blockquote><h3 id="关键词及其解释"><a href="#关键词及其解释" class="headerlink" title="关键词及其解释"></a>关键词及其解释</h3><h4 id="single-nucleotide-polymorphism-SNP-单核苷酸多态性"><a href="#single-nucleotide-polymorphism-SNP-单核苷酸多态性" class="headerlink" title="single nucleotide polymorphism (SNP) 单核苷酸多态性"></a>single nucleotide polymorphism (SNP) 单核苷酸多态性</h4><p>这是发生在基因组中一个特定位置的单个核苷酸（即A、C、G或T）的变异。一个SNP通常以两种不同的形式存在（例如，A与T）。这些不同的形式被称为等位基因。一个有两个等位基因的SNP有三种不同的基因型（例如，AA、AT和TT）。</p><h4 id="SNP-heritability-单核苷酸多态性遗传力"><a href="#SNP-heritability-单核苷酸多态性遗传力" class="headerlink" title="SNP-heritability 单核苷酸多态性遗传力"></a>SNP-heritability 单核苷酸多态性遗传力</h4><p>这是一个性状变异表型的一部分，在分析中可以由所有的SNPs解释。</p><h4 id="SNP-level-missingness-单核苷酸多态性水平的丢失"><a href="#SNP-level-missingness-单核苷酸多态性水平的丢失" class="headerlink" title="SNP-level missingness 单核苷酸多态性水平的丢失"></a>SNP-level missingness 单核苷酸多态性水平的丢失</h4><p>这是样本中某个特定SNP信息缺失的个体数量。缺失程度高的SNP有可能导致偏差。</p><h4 id="summary-statistics-摘要统计学"><a href="#summary-statistics-摘要统计学" class="headerlink" title="summary statistics 摘要统计学"></a>summary statistics 摘要统计学</h4><p>这些是进行GWAS后得到的结果，包括染色体数目、SNP的位置、SNP(rs)‐identifier、MAF、effect size (odds ratio/beta)、标准误差和P值等信息。GWAS的汇总统计资料通常可以免费获取或在研究者之间共享。</p><h4 id="The-Hardy–Weinberg-dis-equilibrium-HWE-law-哈迪-温伯格遗传不平衡定律"><a href="#The-Hardy–Weinberg-dis-equilibrium-HWE-law-哈迪-温伯格遗传不平衡定律" class="headerlink" title="The Hardy–Weinberg (dis)equilibrium (HWE) law 哈迪-温伯格遗传不平衡定律"></a>The Hardy–Weinberg (dis)equilibrium (HWE) law 哈迪-温伯格遗传不平衡定律</h4><p>这涉及到等位基因和基因型频率之间的关系。它假定一个无限大的群体，没有选择、突变或迁移。该定律指出，基因型和等位基因频率在各代中是恒定的。违反HWE定律表明基因型频率与期望值有明显差异（例如，如果等位基因A的频率=0.20，等位基因T的频率=0.80；基因型AT的期望频率是2<em>0.2</em>0.8=0.32），观察到的频率不应该有明显差异。</p><p>在GWAS中，一般认为偏离HWE是基因分型错误的结果。病例中的HWE阈值往往没有对照组那么严格，因为病例中违反HWE法则可能表明与疾病风险有真正的遗传关系。</p><h4 id="clumping-分丛"><a href="#clumping-分丛" class="headerlink" title="clumping 分丛"></a>clumping 分丛</h4><p>在这一过程中，只有在每个LD block中最重要的SNPs（即具有最低的p值）才会被确定并选择，以供下一步分析。</p><p>这减少了剩余SNPs之间的相关性，同时保留了最有力的统计证据。</p><h4 id="co-heritability-共同遗传力"><a href="#co-heritability-共同遗传力" class="headerlink" title="co-heritability 共同遗传力"></a>co-heritability 共同遗传力</h4><p>一种用于衡量疾病之间遗传关系的度量单位。基于SNP的共遗传性是指疾病对（如精神分裂症和双相情感障碍）之间由SNP解释的协方差比例。</p><h4 id="heterozygosity-杂合性"><a href="#heterozygosity-杂合性" class="headerlink" title="heterozygosity 杂合性"></a>heterozygosity 杂合性</h4><p>这是指携带一个特定SNP的两个不同的等位基因。一个个体的杂合率是杂合基因型的比例。一个个体内高水平的杂合率可能是样本质量低的表现，而低水平的杂合率可能是由于近亲繁殖。</p><h4 id="individual-level-missingness-个体水平的丢失"><a href="#individual-level-missingness-个体水平的丢失" class="headerlink" title="individual-level missingness 个体水平的丢失"></a>individual-level missingness 个体水平的丢失</h4><p>这是特定个体丢失的SNPs的数量。高水平的丢失可能意味着糟糕的DNA质量或是技术问题。</p><h4 id="linkage-disequilibium-LD-连锁不平衡"><a href="#linkage-disequilibium-LD-连锁不平衡" class="headerlink" title="linkage disequilibium (LD) 连锁不平衡"></a>linkage disequilibium (LD) 连锁不平衡</h4><p>这是对特定人群中同一染色体上不同位点的等位基因之间非随机关联的衡量。当SNP的等位基因的关联频率高于随机分配下的预期时，SNP就处于LD。LD涉及SNPs之间的相关模式。</p><h4 id="minor-allele-frequency-MAF-小等位基因频率"><a href="#minor-allele-frequency-MAF-小等位基因频率" class="headerlink" title="minor allele frequency (MAF) 小等位基因频率"></a>minor allele frequency (MAF) 小等位基因频率</h4><p>这是在特定位置上最不常出现的等位基因的频率。大多数研究在检测与低MAF的SNP的关联方面力量不足，因此排除了这些SNP。</p><h4 id="population-stratification-人群分层"><a href="#population-stratification-人群分层" class="headerlink" title="population stratification 人群分层"></a>population stratification 人群分层</h4><p>这就是在一项研究中存在多个亚人群（如具有不同种族背景的个体）。由于等位基因频率在亚人群之间可能不同，人口分层可能导致假阳性关联和/或掩盖真正的关联。这方面的一个很好的例子是筷子基因，由于人口分层，一个SNP在用筷子吃饭的能力中占了近一半的变异。</p><h4 id="pruning-剪枝"><a href="#pruning-剪枝" class="headerlink" title="pruning 剪枝"></a>pruning 剪枝</h4><p>这是一种选择处于近似连锁平衡的标记子集的方法。在PLINK中，这种方法使用染色体特定窗口（区域）内SNP之间的LD强度，并根据用户指定的LD阈值，只选择近似不相关的SNP。与clumping相反，pruning不考虑SNP的p值。</p><h4 id="relatedness-相关性"><a href="#relatedness-相关性" class="headerlink" title="relatedness 相关性"></a>relatedness 相关性</h4><p>这表明一对个体的遗传关系有多强。传统的GWAS假设所有的受试者都没有关系（即没有一对个体的关系比二级亲属更密切）。如果没有适当的校正，纳入亲属可能会导致SNP效应大小的标准误差的估计出现偏差。</p><blockquote><p>请注意，分析家族数据的具体工具已经被开发出来。</p></blockquote><h4 id="sex-discrepancy-性别差异"><a href="#sex-discrepancy-性别差异" class="headerlink" title="sex discrepancy 性别差异"></a>sex discrepancy 性别差异</h4><p>这是分配的性别和根据基因型确定的性别之间的差异。差异可能是由于实验室中的样本混淆。注意，只有在评估了性染色体（X和Y）上的SNPs后才能进行这种测试。</p><h4 id="Polygenic-risk-score-PRS"><a href="#Polygenic-risk-score-PRS" class="headerlink" title="Polygenic risk score (PRS)"></a>Polygenic risk score (PRS)</h4><p>PRS 将多个 SNPs 的效应大小组合成一个单一的聚合评分，可用于预测疾病风险。 PRS 是一个个人层面的评分，计算基于一个人所携带的风险变量的数量，加权的 SNP 效应大小来自一个独立的大规模发现 GWAS。 </p><p>因此，评分是一个特定个体的特定性状的总遗传风险的指标，可用于临床预测或筛查（例如：乳腺癌）。</p><p>但是，PRS判断的准确性还不足以应用到临床。不过，通过其预测疾病状态的能力，PRS 为我们了解精神病特征的遗传结构做出了贡献。 它已经被进一步用来研究从一个特定表型的 GWAS 获得的遗传效应大小是否可以用来预测另一个表型的风险</p><h3 id="GWAS的输入数据"><a href="#GWAS的输入数据" class="headerlink" title="GWAS的输入数据"></a>GWAS的输入数据</h3><ol><li><p>全基因组WGS。可以检测全部的编码区和非编码区。但成本高。</p><blockquote><p>1000genome计划</p></blockquote></li><li><p>WES。可以检测得到所有编码区的SNP，成本较高。</p></li><li><p>DNA chip（即DNA芯片，或称为SNP array）。只包含常见的$10^6$个SNP。成本低。</p></li></ol><blockquote><p>总体来说，GWAS要求输入数据的sample size必须足够大。</p></blockquote><h3 id="GWAS的输出结果"><a href="#GWAS的输出结果" class="headerlink" title="GWAS的输出结果"></a>GWAS的输出结果</h3><p>曼哈顿图</p><p>QQ-plot</p><h3 id="GWAS的下游分析"><a href="#GWAS的下游分析" class="headerlink" title="GWAS的下游分析"></a>GWAS的下游分析</h3><p>Polygenic risk score (PRS) analyses</p><p>meta-analysis</p><h3 id="软件工具"><a href="#软件工具" class="headerlink" title="软件工具"></a>软件工具</h3><h4 id="PLINK"><a href="#PLINK" class="headerlink" title="PLINK"></a>PLINK</h4><p>plink的主要功能：数据处理，质量控制的基本统计，群体分层分析，单位点的基本关联分析，家系数据的传递不平衡检验，多点连锁分析，单倍体关联分析，拷贝数变异分析，Meta分析等等。</p><p>【PLINK version 1.07】可以从 <a href="http://zzz.bwh.harvard.edu/plink/">http://zzz.bwh.harvard.edu/plink/</a> 下载。</p><blockquote><p>除了 PLINK，还有许多其他可用于分析 SNP 数据的好选择：如 Genabel和 SNPTEST。 </p><p>另外，GWAS的一些分析流程，也可以用R语言实现。</p></blockquote><h5 id="PLINK读取文件格式说明"><a href="#PLINK读取文件格式说明" class="headerlink" title="PLINK读取文件格式说明"></a>PLINK读取文件格式说明</h5><p>PLINK可以读取文本格式的文件或二进制文件，但因为读取大型文本格式文件可能比较耗时，所以建议读取二进制文件。</p><p>文本格式的PLINK数据由两个文件组成：</p><blockquote><p>一个文件包含个体及其基因型（genotypes）的信息【ped格式】</p><blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-08 下午3.50.28.png" alt="截屏2021-09-08 下午3.50.28"></p></blockquote><p>一个文件装有遗传标记（genetic markers）的资料【map格式】。</p><blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-08 下午3.50.43.png" alt="截屏2021-09-08 下午3.50.43"></p></blockquote></blockquote><p>而二进制格式的PLINK数据则由三个文件组成：</p><blockquote><p>一个二进制文件包含个体标识符（individual identifiers (IDs) ）和基因型（genotypes）【bed格式】</p><blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-08 下午3.51.01.png" alt="截屏2021-09-08 下午3.51.01"></p><p>例如，在躁郁症的研究中，bed格式的文件应包含患者和健康人群（对照组）的基因分型结果（genotyping results）</p></blockquote><p>一个文本文件包含有个体信息（information on the individuals）【fam格式】</p><blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-08 下午3.51.10.png" alt="截屏2021-09-08 下午3.51.10"></p><p>例如，在躁郁症的研究中，fam格式的文件应当包含与研究对象有关的数据，如研究对象与其他参与者的家庭关系，性别和临床诊断结果</p></blockquote><p>一个文本文件装有遗传标记（genetic markers）【bim格式】</p><blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-08 下午3.51.20.png" alt="截屏2021-09-08 下午3.51.20"></p><p>而bim格式的文件应当有关SNPs物理位置的信息。</p></blockquote><p>如果要利用协变量（covariates）进行分析，则通常会需要第四个文件，这个文件包含每个个体的协变量的值。</p><blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-08 下午3.51.32.png" alt="截屏2021-09-08 下午3.51.32"></p><p>GWAS中的协变量（covariates）</p><p>一般定义：在实验的设计中，协变量是一个独立变量（解释变量），不为实验者所操纵，但仍影响实验结果。</p><p>但是在GWAS模型中，因子和变量最后都变为了协变量。</p></blockquote></blockquote><p>标识符说明：</p><blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-08 下午3.52.51.png" alt="截屏2021-09-08 下午3.52.51"></p></blockquote><h5 id="PLINK基本命令"><a href="#PLINK基本命令" class="headerlink" title="PLINK基本命令"></a>PLINK基本命令</h5><p>PLINK 是一个命令行程序。通常，PLINK会从工作目录中文件夹中加载数据文件，并将结果文件保存在这个目录中。</p><blockquote><p>注意：在提示符后，通过键入 PLINK 关键字来指示 PLINK 的使用。如果没有在标准目录中安装 PLINK，则必须在命令前输入安装 PLINK 的目录的路径，例如/usr/local/bin/PLINK。</p></blockquote><h4 id="PRSice"><a href="#PRSice" class="headerlink" title="PRSice"></a>PRSice</h4><p>用于进行PRS分析。</p><h4 id="R"><a href="#R" class="headerlink" title="R"></a>R</h4><h5 id="fusion包"><a href="#fusion包" class="headerlink" title="fusion包"></a>fusion包</h5><p>用于在R内进行GWAS流程。</p><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><h4 id="质量控制QC"><a href="#质量控制QC" class="headerlink" title="质量控制QC"></a>质量控制QC</h4><p>在进行GWAS之前对基因型数据应用严格的质量控制（QC）程序，包括使用适当的方法来考虑种族异质性。</p><blockquote><p>练习数据集：国际HapMap项目的一个具有二元结果测量的数据集（N = 207）</p><blockquote><p>只包括有北欧和西欧血统的犹他州居民（CEU）</p></blockquote><p>(<a href="http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/2010-05_phaseIII/plink_format/">http://hapmap.ncbi.nlm.nih.gov/downloads/genotypes/2010-05_phaseIII/plink_format/</a>; Gibbs et al., 2003)</p><p>由于HapMap数据的样本量相对较小，这些模拟中的遗传效应大小被设定为大于通常在复杂性状的遗传研究中观察到的值。值得注意的是，要检测复杂性状的遗传风险因素，需要更大的样本量（例如，至少在几千人的数量级，但可能甚至是几万或几十万）。带有模拟表型性状的HapMap数据可在<a href="https://github.com/MareesAT/GWA_tutorial/（1_QC_GWAS.zip）获得。">https://github.com/MareesAT/GWA_tutorial/（1_QC_GWAS.zip）获得。</a></p></blockquote><h5 id="质量控制步骤及简表"><a href="#质量控制步骤及简表" class="headerlink" title="质量控制步骤及简表"></a>质量控制步骤及简表</h5><p>这里提供了七个质量控制步骤的参考，但是QC中的阈值可能因研究的具体特点而不同。</p><p>这七个步骤包括根据以下情况过滤掉SNP和个体。</p><ol><li>个体和SNP缺失 individual and SNP missingness</li><li>受试者的分配和遗传性别不一致（见性别差异）inconsistencies in assigned and genetic sex of subjects (see sex discrepancy)</li><li>小等位基因频率（MAF）minor allele frequency (MAF)</li><li>偏离Hardy-Weinberg平衡（HWE）deviations from Hardy–Weinberg equilibrium (HWE)</li><li>杂合率 heterozygosity rate</li><li>相关性 relatedness</li><li>种族离群（见人口分层）ethnic outliers (see population stratification)</li></ol><div class="table-container"><table><thead><tr><th>步骤</th><th>命令与功能</th><th>阈值设置与详解</th></tr></thead><tbody><tr><td>【step1】Missingness of SNPs and individuals 个体和SNP缺失</td><td>【—geno】Excludes SNPs that are missing in a large proportion of the subjects. In this step, SNPs with low genotype calls are removed.排除在很大一部分受试者中缺失的SNPs。在这一步骤中，基因型调用量低的SNP被删除。                                                                                      【—mind】Excludes individuals who have high rates of genotype missingness. In this step, individual with low genotype calls are removed.排除那些基因型缺失率高的个体。在这一步骤中，基因型调用率低的个体被删除。</td><td>We recommend to first filter SNPs and individuals based on a relaxed threshold (0.2; &gt;20%), as this will filter out SNPs and individuals with very high levels of missingness. Then a filter with a more stringent threshold can be applied (0.02).我们建议首先根据一个宽松的阈值（0.2；&gt;20%）过滤SNP和个体，因为这将过滤掉具有非常高遗漏率的SNP和个体。然后，可以采用更严格的阈值（0.02）的过滤器。（注意，在进行个体筛选之前，应当先进行SNPs的筛选）</td></tr><tr><td>【step2】Sex discrepancy性别差异</td><td>【‐‐check‐sex】Checks for discrepancies between sex of the individuals recorded in the dataset and their sex based on X chromosome heterozygosity/homozygosity rates.检查数据集中记录的个体性别与基于X染色体杂合度/同源性率的性别之间的差异。</td><td>Can indicate sample mix‐ups. If many subjects have this discrepancy, the data should be checked carefully. Males should have an X chromosome homozygosity estimate &gt;0.8 and females should have a value &lt;0.2.这一步骤可能表明样本混淆。如果许多受试者有这种差异，应仔细检查数据。男性的X染色体同源性估计值应大于0.8，女性的值应小于0.2。</td></tr><tr><td>【step3】Minor allele frequency (MAF)小等位基因频率</td><td>【—maf】Includes only SNPs above the set MAF threshold. 只包括超过设定的 MAF 阈值的 SNPs</td><td>低MAF的SNP很罕见，因此缺乏检测SNP-表型关联的能力。这些SNP也更容易出现基因分型错误。MAF阈值应取决于你的样本大小，较大的样本可以使用较低的MAF阈值。分别来说，对于大样本（N = 100000）与中样本（N = 10000），通常使用0.01和0.05作为MAF阈值。</td></tr><tr><td>【step4】Hardy–Weinberg equilibrium (HWE)哈迪-温伯格平衡</td><td>【‐‐hwe】Excludes markers which deviate from Hardy–Weinberg equilibrium.不包括偏离Hardy-Weinberg平衡的标记。</td><td>是基因分型错误的常见指标，也可能表明进化的选择。对于二元性状，我们建议这样排除：HWE p值在病例中\&lt;1e-10，在对照中&lt;1e-6。不太严格的病例阈值可以避免在选择下丢弃疾病相关的SNPs（见在线教程 <a href="https://github.com/MareesAT/GWA_tutorial/对于定量性状，我们建议HWE">https://github.com/MareesAT/GWA_tutorial/对于定量性状，我们建议HWE</a> p值&lt;1e-6。</td></tr><tr><td>【step5】Heterozygosity杂合性</td><td>教程代码： <a href="https://github.com/MareesAT/GWA_tutorial/">https://github.com/MareesAT/GWA_tutorial/</a> 为了排除杂合率高或低的个体</td><td>偏差可能表明样本污染、近亲繁殖。我们建议删除那些偏离样本杂合率平均值±3SD的个体。</td></tr><tr><td>【step6】Relatedness相关性</td><td>【‐‐genome】Calculates identity by descent (IBD) of all sample pairs.计算所有样本对的血统特征（IBD）。【—min】设置阈值，并创建一个亲缘关系超过所选阈值的个体列表。意味着可以检测到例如pi-hat&gt;0.2（即二级亲属）的受试者的关系。</td><td>【‐‐genome】在这个分析中使用独立的SNPs（修剪），并且只限于常染色体的分析。                       【—min】隐性关联性会干扰关联分析。如果你有一个基于家庭的样本（如父母-后代），你不需要删除相关的配对，但统计分析应该考虑到家庭关联性。然而，对于基于人群的样本，我们建议使用0.2的pi-hat阈值。</td></tr><tr><td>【step7】Population stratification人口分层</td><td>【‐‐genome】计算所有样本对的血统特征（IBD）。【‐‐cluster ‐‐mds‐plot <em>k</em>】Produces a k‐dimensional representation of any substructure in the data, based on IBS.基于IBS，产生数据中任何子结构的k维表示。</td><td>【—genome】计算所有样本对的血统特征（IBD）。【‐‐cluster ‐‐mds‐plot <em>k</em>】K是维度的数量，需要定义（通常是10）。这是质量控制的一个重要步骤，包括多个程序，但为了完整起见，我们在表中简要地提到了这一步骤。这个步骤将在 “控制人口分层 “一节中详细描述。</td></tr></tbody></table></div><h5 id="质量控制教程"><a href="#质量控制教程" class="headerlink" title="质量控制教程"></a>质量控制教程</h5><p><a href="https://github.com/MareesAT/GWA_tutorial/">https://github.com/MareesAT/GWA_tutorial/</a></p><p>它提供了数据质量控制和可视化的潜在偏见来源的脚本。这些脚本在人类基因组单体型图(HapMap)数据的 CEU 组上执行 QC，可以应用于其他数据集，但基于家庭的数据集和涉及多个不同族裔群体的数据集除外。</p><p>一般来说，如果一个样本包括多个族群(例如，非洲人、亚洲人和欧洲人) ，建议分别对每个族群进行关联测试（tests of association in each of the ethnic groups separately ），并使用合适的方法，例如荟萃分析meta‐analysis，将结果结合起来。</p><h5 id="step7：控制人口分层"><a href="#step7：控制人口分层" class="headerlink" title="step7：控制人口分层"></a>step7：控制人口分层</h5><p>GWAS 系统性偏差的一个重要来源是人口分层。研究表明，在一个单一种族人口中，即使是微妙程度的人口分层也可能存在。因此，检测和控制人口分层的存在是一个必不可少的 QC 步骤。</p><p>有多种方法可以用来检测人口分层。在本教程中，仅展示一个在PLINK中被合并的方法：【多维缩放the multidimensional scaling (MDS) approach】</p><h6 id="多维缩放-MDS"><a href="#多维缩放-MDS" class="headerlink" title="多维缩放 MDS"></a>多维缩放 MDS</h6><p>这种方法计算整个基因组内任何一对个体之间共享的等位基因的平均比例，以产生每个个体的遗传变异的定量指数（成分）quantitative indices (components) 。可以将个体成分得分绘制出来，以探索是否有一些个体群体在遗传上比预期的更相似。</p><blockquote><p>例如，在一项包括来自亚洲和欧洲的受试者的遗传研究中，MDS分析将显示亚洲人在遗传上比欧洲人更相似。</p></blockquote><p>为了调查生成的成分分数（generated component scores）在哪些个体上偏离了样本的目标人群，绘制被调查样本的分数和已知种族结构的人群（如HapMap/1KG数据）是有帮助的。这个步骤被称为锚定。这使研究者能够获得其样本的民族信息并确定可能的民族异常值。</p><blockquote><p>在<a href="https://github.com/MareesAT/GWA_tutorial/（2_Population_stratification.zip）中提供了一个脚本，以1KG项目的数据为锚对自己的数据进行MDS（http://www.1000genomes.org/）。">https://github.com/MareesAT/GWA_tutorial/（2_Population_stratification.zip）中提供了一个脚本，以1KG项目的数据为锚对自己的数据进行MDS（http://www.1000genomes.org/）。</a></p></blockquote><p>注意，根据MDS分析，属于离群值的个体应从进一步的分析中剔除。排除这些个体后，必须进行新的MDS分析，其主要成分需要作为关联测试的协变量，以校正人群中任何剩余的人群分层。</p><blockquote><p>需要包括多少成分取决于人群结构和样本大小，但精神病遗传学界普遍接受包括多达10个成分。</p></blockquote><p>在完成 QC 和 MDS 之后，数据就可以进行后续的关联测试了。</p><h4 id="关联测试-tests-of-association"><a href="#关联测试-tests-of-association" class="headerlink" title="关联测试 tests of association"></a>关联测试 tests of association</h4><p>常用的SNPs和感兴趣的表型特征之间的关联测试，同时控制潜在的混杂因素。</p><blockquote><p>或者称之为【二元性状与数量性状相关性的统计学检验】STATISTICAL TESTS OF ASSOCIATION FOR BINARY AND QUANTITATIVE TRAITS</p></blockquote><p>根据感兴趣的性状或疾病的预期遗传模型和所研究的表型性状的性质，可以选择适当的统计测试。</p><blockquote><p>在附带的教程中，提供了适合二元性状（如酒精依赖患者与健康对照）或定量性状（如每周饮用的酒精饮料数量）的各种关联类型的脚本。<a href="https://github.com/MareesAT/GWA_tutorial/">https://github.com/MareesAT/GWA_tutorial/</a>  (3_Association_GWAS.zip)</p><p>PLINK提供一个自由度（1 df）的等位基因测试，其中性状值，或二元性状的对数，作为风险等位基因（小等位基因[a]与大等位基因[A]）数量的函数而线性增加或减少。此外，还有非加性试验，例如，基因型关联试验（2 df：aa vs. Aa vs AA），显性基因作用试验（1 df：[aa &amp; Aa] vs AA），以及隐性基因作用试验，（1 df：aa vs [Aa &amp; AA]）。然而，非加性检验non‐additive tests没有得到广泛的应用，因为在实践中检测非加性的统计能力很低</p><p>更复杂的分析（如Cox回归分析和治愈模型）可以通过使用PLINK中基于R的 “插件 “功能进行。</p></blockquote><h5 id="二元结果测量-Binary-outcome-measure"><a href="#二元结果测量-Binary-outcome-measure" class="headerlink" title="二元结果测量 Binary outcome measure"></a>二元结果测量 Binary outcome measure</h5><blockquote><p>在PLINK中，SNP和二元结果（值1=未受影响，值2=受影响；0和-9代表缺失；前面代表PLINK中的默认选项，可以改变）之间的关联可以用选项【—assoc】或【—logistic】来测试。</p><p>PLINK中的【—assoc】选项执行的是X2的关联测试，不允许包含协变量。</p><p>使用【—logistic】选项，将进行Logistic回归分析，允许包含协变量。</p><p>【—logistic】选项比【—assoc】选项更灵活，但是它的代价是增加了计算时间（包含协变量的检测似乎都会增加计算时间）。</p></blockquote><h5 id="量化的结果衡量Quantitative-outcome-measure"><a href="#量化的结果衡量Quantitative-outcome-measure" class="headerlink" title="量化的结果衡量Quantitative outcome measure"></a>量化的结果衡量Quantitative outcome measure</h5><blockquote><p>在PLINK中，可以用选项【—assoc】和【—linear】来测试SNPs和定量结果指标之间的关联。</p><p>当PLINK检测到定量结果指标（即除1、2、0或缺失以外的值）时，【—assoc】选项会自动将其视为定量结果指标，执行通常的学生t检验的渐进版本来比较两个平均值。这个选项不允许使用协变量。</p><p>PLINK中的【—linear】以每个单独的SNP作为预测因子进行线性回归分析。与【—logistic】选项类似，【—linear】选项可以使用协变量，而且比【—assoc】选项要慢一些。</p></blockquote><h5 id="多重检验校正-Correction-for-multiple-testing"><a href="#多重检验校正-Correction-for-multiple-testing" class="headerlink" title="多重检验校正 Correction for multiple testing"></a>多重检验校正 Correction for multiple testing</h5><p>现代基因分型阵列可以同时对400万个标记进行基因分型，这就产生了大量的测试，从而产生了相当大的多重测试负担。SNP的归因可能会进一步增加测试的关联数量。各种模拟表明，对于欧洲人群的研究，广泛使用的全基因组意义阈值为$5×10^{-8}$，充分控制了整个基因组中独立SNP的数量，而不考虑研究的实际SNP密度。当测试非洲人群时，由于这些个体的遗传多样性更大，需要更严格的阈值（可能接近$1.0×10^{-8}$）。</p><blockquote><p>广泛应用的多重检验校正方法有：</p><p>Bonferroni correction</p><blockquote><p>The Bonferroni correction用0.05/n 公式计算调整后的 p 值阈值，n 是测试的 SNPs 数量。</p><p>但是，由于连锁不平衡LD，许多 SNPs 是相关的，因此根据定义，这些SNPs不是独立的。因此，这种校正方法往往过于保守，导致假阴性结果的比例增加。</p></blockquote><p>Benjamini–Hochberg false discovery rate (FDR)</p><blockquote><p>假设SNP是独立的，FDR控制所有信号中假阳性的预期比例，其FDR值低于固定的阈值。</p><p>这比Bonferroni校正要保守得多。应该注意的是，控制FDR并不意味着任何统计学意义的概念；它只是一种将假阳性的预期比例最小化的方法，例如用于后续分析。此外，这种方法也有其局限性，因为SNP和P值不是独立的，而这是FDR方法的一个假设。</p></blockquote><p>permutation testing</p></blockquote><p>因此，PLINK提供了一个选项【—adjust】，生成的输出中显示了未经调整的p值，以及用各种多重检验校正方法校正的p值。</p><p>最后，可以用互换法（permutation methods）来处理多重检验的负担。</p><blockquote><p>为了计算基于互换的P值，结果测量标签被随机互换多次（如1,000-1,000,000），这就有效地消除了结果测量和基因型之间的任何真实关联。然后对所有被处理过的数据集进行统计测试。这就提供了测试统计量的经验分布和在无关联的零假设下的P值。</p><p>随后，将从观察数据中得到的原始检验统计量或P值与P值的经验分布进行比较，以确定经验调整的P值。</p><p>为了使用这种方法，可以将两个PLINK选项【—assoc】和【—mperm】结合起来，生成两个p值：</p><blockquote><p>EMP1是经验P值（未校正），EMP2是为多重检验校正的经验P值。</p><p>这个过程是计算密集型的，尤其是在需要许多次排列组合的情况下，这对于准确计算非常小的p值是必要的。</p></blockquote></blockquote><h4 id="PRS分析"><a href="#PRS分析" class="headerlink" title="PRS分析"></a>PRS分析</h4><p>PRS分析的目的不是识别单个SNP，而是将整个基因组的遗传风险聚集在一个感兴趣的性状的单个多基因分数中。</p><blockquote><p>而GWAS一般侧重于Single variant association analysis，但需要非常大的样本量来检测许多复杂性状的少数SNPs。</p></blockquote><p>在这种方法中，需要大量的 discovery sample 来可靠地确定每个SNP对一个特定性状的多基因评分（”权重”）的贡献程度。</p><p>不过，在一个独立的target sample中，其样本规模可以更小，多基因分数可以根据遗传DNA图谱和这些权重来计算（关于计算的细节见下文）。作为一个经验法则，2000个左右的target sample可以提供足够的力量来检测出相当比例的变异解释。此外，discovery sample和target sample应该有相同数量的受试者，直到target sample包括2000名受试者。如果有更多的样本，应该在discovery sample中包括更多的受试者，以最大限度地提高效应大小估计的准确性。</p><p>目前认为，PRS还不足以预测个人层面的疾病风险，但它已被成功用于显示性状内部和跨性状的重要关联。</p><h5 id="计算PRS"><a href="#计算PRS" class="headerlink" title="计算PRS"></a>计算PRS</h5><p>【discovery GWAS实例】</p><p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001694/bin/MPR-27-e1608-g004.jpg" alt="An external file that holds a picture, illustration, etc. Object name is MPR-27-e1608-g004.jpg"></p><blockquote><p>三个单核苷酸多态性(SNPs)聚集成单个个体多基因风险评分(PRS)的工作实例。</p><p>*weight（权重）是beta（贝塔系数）或the log of the odds‐ratio（比值比的对数），这取决于分析的是连续性特征还是二元性状。</p><blockquote><p>beta用于衡量连续型特征；</p><p>the log of teh odds-ratio用于衡量二元性状。</p></blockquote></blockquote><p>总的来说，为了进行PRS分析，从discovery GWAS中获得特异性状的权重（连续性性状的β值和二元性状的比值比对数）。</p><p>然后，在target sample中，根据每个人携带的风险等位基因的数量乘以特定性状的权重，用以计算每个人的PRS。</p><blockquote><p>对于许多复杂的性状，其SNP效应大小是公开可用的。<a href="https://www.med.unc.edu/pgc/downloads">https://www.med.unc.edu/pgc/downloads</a></p></blockquote><p>虽然原则上，所有常见SNPs都可用于PRS分析，但在计算风险分数（risk score）之前，通常会对GWAS的结果进行clumping。p值阈值通常用于去除显示出很少或没有统计学证据的SNPs（例如，只保留p值&lt;0.5或&lt;0.1的SNPs）。通常情况下，将进行多个PRS分析，P值的阈值也不同。</p><h5 id="进行多基因风险预测分析-Conducting-polygenic-risk-prediction-analyses"><a href="#进行多基因风险预测分析-Conducting-polygenic-risk-prediction-analyses" class="headerlink" title="进行多基因风险预测分析 Conducting polygenic risk prediction analyses"></a>进行多基因风险预测分析 Conducting polygenic risk prediction analyses</h5><p>一旦计算出目标样本中所有受试者的PRS，这些分数可用于（逻辑）回归分析，以预测任何预计与感兴趣的性状有遗传重叠的性状。</p><p>预测的准确性可以用回归分析的 $pseudo-R^2$ 指标来表示。重要的是在回归分析中至少包括几个MDS成分作为协变量，以控制种群分层的情况。</p><p>为了估计PRS能解释多少变化，将比较只包括协变量（如MDS成分）的模型的$R^2$和包括协变量+PRS的模型的$R^2$。由于PRS导致的$R^2$的增加表明遗传风险因素所解释的预测准确性的增加。</p><p>PRS的预测精度主要取决于所分析性状的（共）遗传性、SNP的数量和发现样本的大小。目标样本的大小只影响$R^2$的可靠性，如果感兴趣的性状的（共）遗传性和所使用的发现样本的样本量足够大，通常目标样本中的几千个受试者就足以达到显著的$R^2$。</p><blockquote><p>关于为自己的PRS分析进行功率计算的R脚本，可以参考 <a href="https://sites.google.com/site/fdudbridge/software上的POLYGENE脚本。">https://sites.google.com/site/fdudbridge/software上的POLYGENE脚本。</a></p></blockquote><p>用于进行PRS分析的程序是PRSice（<a href="http://prsice.info/），可以进行clumping、p值阈值、MDS成分等功能。">http://prsice.info/），可以进行clumping、p值阈值、MDS成分等功能。</a></p><blockquote><p>教程见：<a href="https://github.com/MareesAT/GWA_tutorial/（4_PRS.doc）">https://github.com/MareesAT/GWA_tutorial/（4_PRS.doc）</a></p></blockquote><h3 id="参考数据库"><a href="#参考数据库" class="headerlink" title="参考数据库"></a>参考数据库</h3><p>GTEx</p><blockquote><p>提供了关于 SNPs 和基因表达之间关联的信息</p></blockquote><p>FUMA</p><blockquote><p>是功能注释常用的工具</p></blockquote><p>GCTA</p><h3 id="相关教程"><a href="#相关教程" class="headerlink" title="相关教程"></a>相关教程</h3><p><a href="https://zhuanlan.zhihu.com/p/356927396">教程合集</a></p><p><a href="https://www.cnblogs.com/leezx/p/9013615.html">入门讲解</a></p>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序-V3-step2&amp;3</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV3step2&amp;3/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV3step2&amp;3/</url>
    
    <content type="html"><![CDATA[<p><em>整理人：王明慧</em></p><p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV3step2&amp;3.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序-V5-step2:Post GEM-RT Cleanup</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2/</url>
    
    <content type="html"><![CDATA[<h1 id="10×单细胞测序-V5-step2-Post-GEM-RT-Cleanup"><a href="#10×单细胞测序-V5-step2-Post-GEM-RT-Cleanup" class="headerlink" title="10×单细胞测序    V5-step2: Post GEM-RT Cleanup"></a>10×单细胞测序    V5-step2: Post GEM-RT Cleanup</h1><p><em>整理人：刘可钦</em></p><p><strong>pdf版</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h2 id="2-0-Post-GEM-RT-Cleanup"><a href="#2-0-Post-GEM-RT-Cleanup" class="headerlink" title="2.0 Post GEM-RT Cleanup"></a>2.0 Post GEM-RT Cleanup</h2><p>【试剂准备】</p><div class="table-container"><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>Additive A</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220074</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Dynabeads MyOne SILANE</td><td>实验台冰箱上层</td><td>室温放置</td><td>2000048</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>4℃存储</td></tr><tr><td>Buffer Sample Clean Up 1</td><td>-20℃冰箱下部中层试剂盒内</td><td>水浴加热至65℃</td><td>220020</td><td>在65℃水浴锅上温浴十分钟，确认无肉眼可见的结晶物，冷却至室温。</td><td>-20℃存储</td></tr><tr><td>Recovery Agent</td><td>实验台</td><td>室温放置</td><td>220016</td><td>/</td><td>室温存储</td></tr><tr><td>Qiagen Bugger EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>Bio-Rad 10% Tween 20</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配。</td><td>室温存储</td></tr></tbody></table></div><h2 id="2-1-Post-GEM-RT-Cleanup-Dynabeads"><a href="#2-1-Post-GEM-RT-Cleanup-Dynabeads" class="headerlink" title="2.1 Post GEM-RT Cleanup-Dynabeads"></a>2.1 Post GEM-RT Cleanup-Dynabeads</h2><ol><li><p>在室温下向每个样本中加入 125μl Recovery Agent，然后静置等待 2min。 </p><blockquote><p><strong>需要</strong>：用移液枪头沿管壁旋转并缓慢滴加。</p><p><strong>避免</strong>：震荡混匀或吹打混匀。</p><p><strong>正确操作后的样品外观</strong>：<img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午12.56.24.png" alt="截屏2021-09-01 下午12.56.24"></p><p><em>此时中可开始制备Dynabeads Cleanup Mix。</em></p></blockquote></li><li><p>用移液枪从底部缓慢吸除 125μl Recovery Agent。</p><blockquote><p><strong>注意</strong>：出现分层现象，上层为水状液体，下层为油状液体。</p><p><strong>需要</strong>：将移液枪枪头伸入PCR管底部。</p><p><strong>避免</strong>：吸入上层水状液体；使样品从PCR管内溢出。</p><p><strong>正确操作后的样品外观</strong>：<img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午1.09.52.png" alt="截屏2021-09-01 下午1.09.52"></p></blockquote></li><li><p>配置 Dynabeads Cleanup Mix</p><blockquote><p>|          | Nuclease-free water | Buffer Sample Clean Up 1 | Dynabeads MyOne SILANE | Additive A | 总体积 |<br>| ———— | —————————- | ———————————— | ——————————— | ————— | ——— |<br>| 试剂编号 | /                   | 220020                   | 2000048                | 220074     | /      |<br>| 1x(μl)   | 5                   | 182                      | 8                      | 5          | 200    |<br>| 2x(μl)   | 11                  | 400.4                    | 17.6                   | 11         | 440    |<br>| 3x(μl)   | 16.5                | 600.6                    | 16.4                   | 16.5       | 660    |<br>| 4x(μl)   | 22                  | 801                      | 35                     | 22         | 880    |<br>| 5x(μl)   | 27.5                | 1001                     | 44                     | 27.5       | 1100   |<br>| 6x(μl)   | 33                  | 1201.2                   | 52.8                   | 33         | 1320   |<br>| 7x(μl)   | 38.5                | 1401.4                   | 61.6                   | 38.5       | 1540   |<br>| 8x(μl)   | 44                  | 1602                     | 70                     | 44         | 1760   |<br>| 9x(μl)   | 49.5                | 1801.8                   | 79.2                   | 49.5       | 1980   |<br>| 10x(μl)  | 55                  | 2002                     | 88                     | 55         | 2200   |<br>| 11x(μl)  | 60.5                | 2                        | 96.8                   | 60.5       | 1420   |<br>| 12x(μl)  | 66                  | 2402.4                   | 105.6                  | 66         | 1640   |</p></blockquote></li><li><p>将 Dynabeads Cleanup Mix 涡旋震荡，向每管样品中加入 200μl，用 200μl 移液枪吹打混匀 5 次。</p></li><li><p>在室温下静置 10min。</p><blockquote><p><strong>正确操作后的样品外观</strong>：<img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午2.37.35.png" alt="截屏2021-09-01 下午2.37.35"></p><p><em>此时可以开始制备Elution Solution I，并准备 80% 乙醇加样槽。可将适量 80% 乙醇倒入加样槽中，暂时不用时应将加样槽放在塑料袋中防止污染。</em></p></blockquote></li><li><p>配置 Elution Solution I。</p><blockquote><p>|          | Buffer EB | 10% Tween 20 | Additive A | 总体积 |<br>| ———— | ————- | —————— | ————— | ——— |<br>| 试剂编号 | /         | /            | 220074     | /      |<br>| 1x(μl)   | 98        | 1            | 1          | 100    |<br>| 2x(μl)   | 196       | 2            | 2          | 200    |<br>| 3x(μl)   | 294       | 3            | 3          | 300    |<br>| 4x(μl)   | 392       | 4            | 4          | 400    |<br>| 5x(μl)   | 490       | 5            | 5          | 500    |<br>| 6x(μl)   | 588       | 6            | 6          | 600    |<br>| 7x(μl)   | 686       | 7            | 7          | 700    |<br>| 8x(μl)   | 784       | 8            | 8          | 800    |<br>| 9x(μl)   | 882       | 9            | 9          | 900    |<br>| 10x(μl)  | 980       | 10           | 10         | 1000   |<br>| 11x(μl)  | 1078      | 11           | 11         | 1100   |<br>| 12x(μl)  | 1176      | 12           | 12         | 1200   |</p></blockquote></li><li><p>样品静置结束后，放置于 10× Magnetic Separator high 上，直到样本澄清。</p><blockquote><p><strong>需要</strong>：在 10× Magnetic Separator 上放置 2min，使 beads 充分吸附在管壁上。</p><p><strong>注意</strong>：PCR管内的水油分层是正常现象。</p></blockquote></li><li><p>将PCR管内的液体移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 300μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，然后敞开管盖，在空气中晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Elution Solution I，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl Elution Solution I。</p></li><li><p>移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>室温下静置 1min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 35μl 澄清液体，转移至新管。</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序	V5-step3:DNA Amplification &amp; QC</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3/</url>
    
    <content type="html"><![CDATA[<h1 id="10×单细胞测序-V5-step3-DNA-Amplification-amp-QC"><a href="#10×单细胞测序-V5-step3-DNA-Amplification-amp-QC" class="headerlink" title="10×单细胞测序    V5-step3:DNA Amplification &amp; QC"></a>10×单细胞测序    V5-step3:DNA Amplification &amp; QC</h1><p><em>整理人：刘可钦</em></p><p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h2 id="3-0-cDNA-Amplification-amp-QC"><a href="#3-0-cDNA-Amplification-amp-QC" class="headerlink" title="3.0 cDNA Amplification &amp; QC"></a>3.0 cDNA Amplification &amp; QC</h2><p>【试剂准备】</p><div class="table-container"><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>cDNA Additive</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220067</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>cDNA Primer Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td></td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Beckman Coulter SPRIselect Reagent</td><td>实验台</td><td>室温放置</td><td>/</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>室温存储</td></tr><tr><td>Amplification Master Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220125</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Equalbit dsDNA HS Assay Kit</td><td>实验台冰箱上层</td><td>室温放置</td><td>/</td><td>现用现配</td><td>4℃存储</td></tr><tr><td>Qiagen Bugger EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配。</td><td>室温存储</td></tr></tbody></table></div><p><strong>注意，标注测量浓度的试剂盒</strong></p><h2 id="3-1-cDNA-Amplification"><a href="#3-1-cDNA-Amplification" class="headerlink" title="3.1 cDNA Amplification"></a>3.1 cDNA Amplification</h2><ol><li><p>在冰上配置 cDNA Amplification mix，将 mix 涡旋震荡并快速离心。</p><blockquote><p>|          | Nuclease-free water | Amplification Master Mix | cDNA Additive | cDNA Primer Mix | 总体积 |<br>| ———— | —————————- | ———————————— | ——————- | ———————- | ——— |<br>| 试剂编号 | /                   | 220125                   | 220067        | 220106          | /      |<br>| 1x(μl)   | 8                   | 50                       | 5             | 2               | 65     |<br>| 2x(μl)   | 17.6                | 110                      | 11            | 4.4             | 143    |<br>| 3x(μl)   | 26.4                | 165                      | 16.5          | 6.6             | 214.5  |<br>| 4x(μl)   | 35                  | 220                      | 22            | 9               | 286    |<br>| 5x(μl)   | 44                  | 275                      | 27.5          | 11              | 357.5  |<br>| 6x(μl)   | 52.8                | 330                      | 33            | 13.2            | 429    |<br>| 7x(μl)   | 58.8                | 385                      | 38.5          | 14.7            | 497    |<br>| 8x(μl)   | 70                  | 440                      | 44            | 18              | 572    |<br>| 9x(μl)   | 75.6                | 495                      | 49.5          | 18.9            | 643.5  |<br>| 10x(μl)  | 88                  | 550                      | 55            | 22              | 715    |<br>| 11x(μl)  | 96.8                | 605                      | 60.5          | 24.2            | 786.5  |<br>| 12x(μl)  | 105.6               | 660                      | 66            | 26.4            | 858    |</p></blockquote></li><li><p>向每管样品（35μl）中加入 65μl 的 cDNA Amplification mix。</p></li><li><p>将移液枪量程调至 90μl，吹打混匀 5 次；然后快速离心。</p></li><li><p>在 PCR仪 上选择【10x5amp】程序，将样品放入 PCR仪，然后开始程序。</p><blockquote><p>| 热盖温度 | 反应容量                                           | 反应时间 |<br>| ———— | ————————————————————————— | ———— |<br>| 105℃     | 100μl                                              | 25-50min |<br>| 步骤     | 温度                                               | 时间     |<br>| 1        | 98℃                                                | 00:00:40 |<br>| 2        | 98℃                                                | 00:00:20 |<br>| 3        | 67℃                                                | 00:00:30 |<br>| 4        | 72℃                                                | 00:01:00 |<br>| 5        | go to step2, see table below for total # of cycles | /        |<br>| 6        | 72℃                                                | 00:01:00 |<br>| 7        | 4℃                                                 | hold     |</p><p><strong>附注</strong>：【cycle数的选择】</p><p>| Targeted Cell Recovery | Primary Cells Total Cycles | Cell Lines Total Cycles |<br>| ——————————— | ————————————— | ———————————- |<br>| 100-500                | 18                         | 16                      |<br>| 501-2000               | 16                         | 14                      |<br>| 2001-6000              | 14                         | 12                      |<br>| 6001-10000             | 13                         | 11                      |</p><blockquote><p><strong>注意</strong>：tageted cell 一般为 PBMC，故 cycle 数一般设置为 14 ，即总 PCR 反应时长约为 34min。</p></blockquote><p>本步骤结束后可将样本储存于 4℃ 冰箱中，保存 72h，以待进行下一步实验。</p></blockquote></li></ol><h2 id="3-2-cDNA-Cleanup-SPRIselect"><a href="#3-2-cDNA-Cleanup-SPRIselect" class="headerlink" title="3.2 cDNA Cleanup-SPRIselect"></a>3.2 cDNA Cleanup-SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent &gt; 30s，使管内无块状沉淀，然后吸取 60μl SPRIselect Reagent(0.6x)，加入样本。再将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>样本在室温下静置 5min。</p><blockquote><p><em>此时可以开始准备 80% 乙醇加样槽。可将适量 80% 乙醇倒入加样槽中，暂时不用时应将加样槽放在塑料袋中防止污染。</em></p></blockquote></li><li><p>放在 10× Magnetic Separator high 上，直到样本澄清。</p><blockquote><p><strong>需要</strong>：在 10× Magnetic Separator high 上放置 2min，使 beads 充分吸附在管壁上。</p></blockquote></li><li><p>移除上清。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，然后敞开管盖，在空气中晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Elution Solution I，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 45.5μl Buffer EB。</p></li><li><p>移液枪量程调制 45μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>室温下静置 2min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品PCR管放在 10× Magnetic Separator high 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 45μl 澄清液体，转移至新管。</p></li><li><p>此后可将样本在 4℃ 冰箱中储存 72h，或在 -20℃ 冰箱中储存 7d，然后进行下一步操作。</p></li></ol><h2 id="3-3-cDNA-QC-amp-Quantification"><a href="#3-3-cDNA-QC-amp-Quantification" class="headerlink" title="3.3 cDNA QC &amp; Quantification"></a>3.3 cDNA QC &amp; Quantification</h2><p>【使用 Equalbit dsDNA HS Assay Kit 对样品进行浓度测定】</p><ol><li><p>按照 Equalbit Reagent 和 Equalbit Buffer 1:200 的比例配置工作液。</p></li><li><p>配置标准品：准备好标有“1”和“2”的 0.6ml EP 管，每管加入 190μl 工作液，然后分别吸取 10μl Equalbit Standard # 1 和 Equalbit Standard # 2，加入管中。</p></li><li><p>配置样品：准备好标有样品标签的 0.6ml EP 管，每管加入 199μl 工作液，然后分别吸取 1μl 样品溶液，加入管中。</p></li><li><p>将按照以上步骤配置的标准品和样品涡旋震荡，然后避光反应 2min。</p></li><li><p>通过 Qubit 荧光仪检测浓度。</p><blockquote><p><em>将每个样品的浓度记录在试验台的实验记录本上，作为 V5 step 6 的参考。</em> </p></blockquote></li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序-V5-step4&amp;5</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step4&amp;5/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step4&amp;5/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step4&amp;5.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序 V5-step6:5‘ Gene Expression（GEX）Library Construction</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h1 id="10×单细胞测序-V5-step6-5‘-Gene-Expression（GEX）Library-Construction"><a href="#10×单细胞测序-V5-step6-5‘-Gene-Expression（GEX）Library-Construction" class="headerlink" title="10×单细胞测序    V5-step6:5‘ Gene Expression（GEX）Library Construction"></a>10×单细胞测序    V5-step6:5‘ Gene Expression（GEX）Library Construction</h1><p><em>整理人：刘可钦</em></p><h2 id="6-0-5‘-Gene-Expression（GEX）Library-Construction"><a href="#6-0-5‘-Gene-Expression（GEX）Library-Construction" class="headerlink" title="6.0 5‘ Gene Expression（GEX）Library Construction"></a>6.0 5‘ Gene Expression（GEX）Library Construction</h2><p>【试剂准备】</p><div class="table-container"><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>Fragmentation Bufffer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220108</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Adaptor Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220026</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Ligation Buffer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220109</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>SI-PCR Primer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220111</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Chromium i7 Sample Index Plate</td><td>实验台冰箱下层</td><td>室温放置</td><td>220103</td><td>解冻</td><td>-20℃存储</td></tr><tr><td>Equalbit dsDNA HS Assay Kit</td><td>实验台冰箱上层</td><td>室温放置</td><td>/</td><td>现用现配</td><td>4℃存储</td></tr><tr><td>Beckman Coulter SPRIselect Reagent</td><td>实验台</td><td>室温放置</td><td>/</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>室温存储</td></tr><tr><td>Fragmentation Enzyme Blend</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220107 /220130</td><td>快速离心</td><td>-20℃存储</td></tr><tr><td>DNA Ligase</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220110 /220131</td><td>快速离心</td><td>-20℃存储</td></tr><tr><td>Amplification Master Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220125</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Qiagen Buffer EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配</td><td>室温存储</td></tr></tbody></table></div><h2 id="6-1-GEX-Fragmentation-End-Repair-amp-A-tailing"><a href="#6-1-GEX-Fragmentation-End-Repair-amp-A-tailing" class="headerlink" title="6.1 GEX Fragmentation, End Repair &amp; A-tailing"></a>6.1 GEX Fragmentation, End Repair &amp; A-tailing</h2><ol><li><p>将样品和写好标签的新PCR管放置在冰上。根据【3.3】测量得到的样品浓度，计算相应样品体积，使吸取的样品达到 50ng，然后将吸取的样品转移到新管内，并用 nuclease-free water 将其补足至 20μl。</p><p> 如果样品不足 50ng，则吸取 20μl 样品用于 library construction。</p><blockquote><p>此时可将 PCR仪 开始预冷。</p></blockquote></li><li><p>按照如下程序设置 PCR仪。</p><p> | 热盖温度               | 反应容量 | 反应时间 |<br> | ——————————— | ———— | ———— |<br> | 65℃                    | 50μl     | ~35min   |<br> | 步骤                   | 温度     | 时间     |<br> | Pre-cool block         | 4℃       | Hold     |<br> | Fragmentation          | 32℃      | 00:05:00 |<br> | End Repair &amp; A-tailing | 65℃      | 00:30:00 |<br> | Hold                   | 4℃       | Hold     |</p><blockquote><p>此程序名为【10xPRA】</p></blockquote></li><li><p>涡旋震荡 Fragmentation Bufffer，确认无沉淀。</p></li><li><p>在冰上配置 Fragmentation Mix，用移液枪吹打混匀，并快速离心。</p><p> |          | Nuclease-free Water | Fragmentation Bufffer | Fragmentation Enzyme Blend | 总体积 |<br> | ———— | —————————- | ——————————- | ————————————— | ——— |<br> | 试剂编号 | /                   | 220108                | 220107 / 220130            | /      |<br> | 1x(μl)   | 15                  | 5                     | 10                         | 30     |<br> | 2x(μl)   | 33                  | 11                    | 22                         | 66     |<br> | 3x(μl)   | 49.5                | 16.5                  | 33                         | 99     |<br> | 4x(μl)   | 66                  | 22                    | 44                         | 132    |<br> | 5x(μl)   | 82.5                | 27.5                  | 55                         | 165    |<br> | 6x(μl)   | 99                  | 33                    | 66                         | 198    |<br> | 7x(μl)   | 110.25              | 36.75                 | 73.5                       | 231    |<br> | 8x(μl)   | 126                 | 42                    | 84                         | 264    |<br> | 9x(μl)   | 141.75              | 47.25                 | 94.5                       | 297    |<br> | 10x(μl)  | 165                 | 55                    | 110                        | 330    |<br> | 11x(μl)  | 181.5               | 60.5                  | 121                        | 363    |<br> | 12x(μl)  | 198                 | 66                    | 132                        | 396    |</p></li><li><p>向每个 20μl 的样本中加入 30μl Fragmentation Mix。</p></li><li><p>将移液枪的量程调至 30μl，然后吹打混匀 15 次，快速离心。</p></li><li><p>将样本放入预冷的 PCR仪 中（4℃），然后按下“skip”开始 PCR 程序。</p></li></ol><h2 id="6-2-GEX-Post-Fragmentation-End-Repair-amp-A-tailing-Double-Sided-Size-Selection-SPRIselect"><a href="#6-2-GEX-Post-Fragmentation-End-Repair-amp-A-tailing-Double-Sided-Size-Selection-SPRIselect" class="headerlink" title="6.2 GEX Post Fragmentation, End Repair &amp; A-tailing Double Sided Size Selection - SPRIselect"></a>6.2 GEX Post Fragmentation, End Repair &amp; A-tailing Double Sided Size Selection - SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 30μl 0.6x SPRIselect Reagent，然后将移液枪量程调至 75μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>从每管中吸取 75μl 澄清液体，转移至新管。</p></li><li><p>向每管样品加入 10μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 75μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 125μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 125μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，但不要使 beads 过干。</p><blockquote><p><strong>需要</strong>：（若样品量较多）应立刻加入50.5μl Buffer EB，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 50.5μl Buffer EB。移液枪量程调制 50μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator high 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 50μl 澄清液体，转移至新管。</p></li></ol><h2 id="6-3-GEX-Adaptor-Ligation"><a href="#6-3-GEX-Adaptor-Ligation" class="headerlink" title="6.3 GEX Adaptor Ligation"></a>6.3 GEX Adaptor Ligation</h2><ol><li><p>配置 Adaptor Ligation Mix，用移液枪吹打混匀，并快速离心。</p><p> |          | Nuclease-free Water | Ligation Buffer | DNA ligase      | Adaptor Mix | 总体积 |<br> | ———— | —————————- | ———————- | ———————- | —————- | ——— |<br> | 试剂编号 | /                   | 220109          | 220110 / 220131 | 220026      | /      |<br> | 1x(μl)   | 17.5                | 20              | 10              | 2.5         | 50     |<br> | 2x(μl)   | 38.5                | 44              | 22              | 5.5         | 110    |<br> | 3x(μl)   | 58                  | 66              | 33              | 8           | 165    |<br> | 4x(μl)   | 77                  | 88              | 44              | 11          | 220    |<br> | 5x(μl)   | 96.25               | 110             | 55              | 13.75       | 275    |<br> | 6x(μl)   | 116                 | 132             | 66              | 16          | 330    |<br> | 7x(μl)   | 134.75              | 154             | 77              | 19.25       | 385    |<br> | 8x(μl)   | 154                 | 176             | 88              | 22          | 440    |<br> | 9x(μl)   | 173.25              | 198             | 99              | 24.75       | 495    |<br> | 10x(μl)  | 192.5               | 220             | 110             | 27.5        | 550    |<br> | 11x(μl)  | 211.75              | 242             | 121             | 30.25       | 605    |<br> | 12x(μl)  | 224.4               | 264             | 132             | 33          | 660    |</p><ol><li><p>向每个 50μl 的样本中加入 50μl Adaptor Ligation Mix，将移液枪量程调至 90μl，然后吹打混匀 15次，快速离心。</p></li><li><p>按照如下程序设置 PCR仪。</p><p> | 热盖温度 | 反应容量 | 反应时间 |<br> | ———— | ———— | ———— |<br> | 30℃      | 100μl    | 15min    |<br> | 步骤     | 温度     | 时间     |<br> | 1        | 20℃      | 00:15:00 |<br> | 2        | 4℃       | Hold     |</p><blockquote><p>此程序名为【ada】</p></blockquote></li></ol></li></ol><h2 id="6-4-GEX-Post-Ligation-Cleanup-SPRIselect"><a href="#6-4-GEX-Post-Ligation-Cleanup-SPRIselect" class="headerlink" title="6.4 GEX Post Ligation Cleanup -SPRIselect"></a>6.4 GEX Post Ligation Cleanup -SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 80μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Buffer EB，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl Buffer EB。移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 30μl 澄清液体，转移至新管。</p></li></ol><h2 id="6-5-GEX-Sample-Index-PCR"><a href="#6-5-GEX-Sample-Index-PCR" class="headerlink" title="6.5 GEX Sample Index PCR"></a>6.5 GEX Sample Index PCR</h2><ol><li><p>为每个样本选择唯一一个确定的 sample index，不能出现同一个样本加入了两个不同的 sample index 的情况。</p></li><li><p>记录样本与 sample index 之间的对应情况。</p><blockquote><p><em>记录在实验台的实验记录本上，同时将样本与sample index之间的对应记录抄写在纸上，之后随样本一起放在塑封袋中。</em></p></blockquote></li><li><p>制备 Sample Index PCR Mix，吹打混匀并快速离心。</p><p> |          | Nuclear-free Water | Amplification Master Mix | SI-PCR Primer | 总体积 |<br> | ———— | ————————— | ———————————— | ——————- | ——— |<br> | 试剂编号 | /                  | 220125                   | 220111        | /      |<br> | 1x(μl)   | 8                  | 50                       | 2             | 60     |<br> | 2x(μl)   | 17.6               | 110                      | 9             | 264    |<br> | 3x(μl)   | 26.4               | 165                      | 6.6           | 198    |<br> | 4x(μl)   | 35                 | 220                      | 9             | 264    |<br> | 5x(μl)   | 44                 | 275                      | 11            | 330    |<br> | 6x(μl)   | 52.8               | 330                      | 13.2          | 396    |<br> | 7x(μl)   | 61.6               | 385                      | 15.4          | 462    |<br> | 8x(μl)   | 70                 | 440                      | 18            | 528    |<br> | 9x(μl)   | 79.2               | 495                      | 19.8          | 594    |<br> | 10x(μl)  | 88                 | 550                      | 22            | 660    |<br> | 11x(μl)  | 96.8               | 605                      | 24.2          | 726    |<br> | 12x(μl)  | 105.6              | 660                      | 26.4          | 792    |</p></li><li><p>向每个 60μl 的样本中加入 30μl Sample Index PCR Mix。</p></li><li><p>向每个样本中加入 10μl 确定且唯一的 Chromium i7 Sample Index，将移液枪量程调至 90μl，然后吹打混匀 5次，快速离心。</p></li><li><p>按照如下程序设置 PCR仪。</p><p> | 热盖温度 | 反应容量                                   | 反应时间 |<br> | ———— | ————————————————————— | ———— |<br> | 105℃     | 100μl                                      | ~40min   |<br> | 步骤     | 温度                                       | 时间     |<br> | 1        | 98℃                                        | 00:00:45 |<br> | 2        | 98℃                                        | 00:00:20 |<br> | 3        | 54℃                                        | 00:00:30 |<br> | 4        | 72℃                                        | 00:00:20 |<br> | 5        | Go to step 2, see table below for # cycles | /        |<br> | 6        | 72℃                                        | 00:01:00 |<br> | 7        | 4℃                                         | Hold     |</p><blockquote><p><em>cycle数可按每管样品中含量计算</em></p><p>| Input into Library Construction | Total Sample Index Cycles |<br>| ———————————————- | ————————————- |<br>| 1-25 ng                         | 16                        |<br>| 26-50 ng                        | 14                        |</p></blockquote></li><li><p>PCR 完成后，样本可储存在 4℃ 冰箱内 72h，然后进行下一步。</p></li></ol><h2 id="6-6-GEX-Post-Sample-Index-Double-Sided-Size-Selection-SPRIselect"><a href="#6-6-GEX-Post-Sample-Index-Double-Sided-Size-Selection-SPRIselect" class="headerlink" title="6.6 GEX Post Sample Index Double Sided Size Selection - SPRIselect"></a>6.6 GEX Post Sample Index Double Sided Size Selection - SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 60μl 0.6x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的 PCR 管和新的 0.6ml EP 管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>从每管中吸取 150μl 澄清液体，转移至新管。</p></li><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 20μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，但不要使 beads 过干。</p></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl EB。移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 35μl 澄清液体，转移至写好标签的 0.6ml EP 管。</p></li><li><p>样本可在 4℃ 冰箱里储存 72h，或放在 -20℃ 冰箱中长期储存。</p><blockquote><p>若要送测序，则放在实验台冰箱下层 -20℃ 暂存。</p></blockquote></li></ol><h2 id="6-7-GEX-Post-Library-Construction-QC"><a href="#6-7-GEX-Post-Library-Construction-QC" class="headerlink" title="6.7 GEX Post Library Construction QC"></a>6.7 GEX Post Library Construction QC</h2><p>【使用 Equalbit dsDNA HS Assay Kit 对样品进行浓度测定】</p><ol><li>按照 Equalbit Reagent 和 Equalbit Buffer 1:200 的比例配置工作液。</li><li>配置标准品：准备好标有“1”和“2”的 0.6ml EP 管，每管加入 190μl 工作液，然后分别吸取 10μl Equalbit Standard # 1 和 Equalbit Standard # 2，加入管中。</li><li>配置样品：准备好标有样品标签的 0.6ml EP 管，每管加入 199μl 工作液，然后分别吸取 1μl 样品溶液，加入管中。</li><li>将按照以上步骤配置的标准品和样品涡旋震荡，然后避光反应 2min。</li><li>通过 Qubit 荧光仪检测浓度。</li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes</title>
    <link href="/2021/09/03/20210903%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95Transcriptome-wide%20association%20study%20of%20coronary%20artery%20disease%20identifies%20novel%20susceptibility%20genes/"/>
    <url>/2021/09/03/20210903%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95Transcriptome-wide%20association%20study%20of%20coronary%20artery%20disease%20identifies%20novel%20susceptibility%20genes/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-9-3-文献阅读记录：Transcriptome-wide-association-study-of-coronary-artery-disease-identifies-novel-susceptibility-genes"><a href="#2021-9-3-文献阅读记录：Transcriptome-wide-association-study-of-coronary-artery-disease-identifies-novel-susceptibility-genes" class="headerlink" title="2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes"></a>2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes</h1><p>EpiXcan</p><p>Stockholm-Tartu Atherosclerosis Reverse Network Engineering Task (STARNET) </p><p>Genotype-Tissue Expression (GTEx)</p><p>Transcriptome-wide association studies (TWAS) </p><blockquote><p>【转录组全关联研究】</p><p>用于鉴定CAD（coronary artery disease）风险基因座</p><p>GWAS 已经有力地将成千上万个基因座与复杂性状联系起来。尽管取得了这样的成功，GWAS 基因座却常常难以解释: 连锁不平衡通常模糊了驱动这种联系的因果变异，而且从 GWAS 的数据中很难确定对性状起作用的因果基因。</p><p>而TWAS可以解决上述问题。它利用expression reference panels（具有表达和基因型数据的eQTL队列）从GWAS数据集中发现基因-性状关联。首先，通过使用基因附近（通常在500千字节或1兆字节内）的等位基因变异数，表达参考板被用来学习每个基因的表达变化预测模型。这些模型被用来预测GWAS队列中每个人的基因表达。最后，对预测的基因表达和性状之间的统计关联进行估计。表达预测和关联可与个体水平的GWAS数据（PrediXcan）或与汇总水平的GWAS数据（Fusion和S-PrediXcan）同时进行。密切相关的方法包括SMR/HEIDI，它执行从基因表达到性状的孟德尔随机化（MR），以及GWAS-eQTL colocalization方法，如Sherlock、coloc、QTLMatch、eCaviar、 enloc和RTC，这些方法发现其表达受支撑GWAS命中的相同因果变异所调节的基因。</p></blockquote><p>TWAS的主要流程</p><blockquote><p>以Gong, Weiming, et al. “Integrative Analysis of Transcriptome-Wide Association Study and mRNA Expression Profiles Identifies Candidate Genes Associated With Idiopathic Pulmonary Fibrosis.” <em>Frontiers in genetics</em> 11 (2020).为例，疾病为Idiopathic pulmonary fibrosis (IPF) 。</p><p>需要：不同组织中的基因表达权重（gene expression weights of three tissues）和GWAS数据集（a large-scale genome-wide association study (GWAS) dataset）；涉及2668个IPF病例和8591个control组</p><p>【主要用于鉴定疾病的候选基因】</p><p>使用3个组织的基因表达权重和一个大规模的数据集(GWAS)进行 IPF 的转录组范围关联研究(TWAS) ，共涉及2,668个 IPF 病例和8,591个对照组。然后对 TWAS 鉴定的重要基因进行基因本体(GO)和通路富集分析。在 IPF 全基因组 mRNA 表达谱中，TWAS 重要基因的富集分析和差异表达基因(DEGs)之间的 GO 项和通路也有重叠。对 TWAS 重要基因进行蛋白质-蛋白质相互作用(PPI)网络和聚类模块分析。总的来说，TWAS 在 Bonferroni 校正 p 值阈值(0.05/14929 = 3.35 × 10-6)下鉴定了一组 IPF 候选基因，如 DSP (肺组织 PTWAS = 1.35 × 10-29)、 MUC5B (肺组织 PTWAS = 1.09 × 10-28)和 TOLLIP (全血 PTWAS = 1.41 × 10-15)。通</p><p>【通路富集分析确定多个候选通路】</p><p>通路富集分析确定了多个候选通路，如单纯疱疹病毒感染(p 值为7.93 × 10-5)和抗原加工提呈(p 值为6.55 × 10-5)。通过对 TWAS 显著基因和 DEGs 的富集分析，鉴定出38个共有的 GO 基因和8个 KEGG 通路。在 PPI 网络中，14个基因(DYNLL1、 DYNC1LI1、 DYNLL2、 HLA-DRB5、 HLA-DPB1、 HLA-DQB2、 HLA-DQA2、 HLA-DQB1、 HLA-DQB1、 HLA-DRB1、 POLR2L、 CENPP、 CENPK、 NUP133和 NUP107)同时被 hub 基因和模块分析检测到。</p></blockquote><p>Expression quantitative traits loci (eQTLs) </p><blockquote><p>用于解释GWAS信号</p></blockquote><p>studied tissues：</p><p>mammary artery (MAM)</p><p>liver (LIV)</p><p>blood (BLD)</p><p>subcutaneous fat (SF)</p><p>visceral abdominal fat (VAF)</p><p>skeletal muscle (SKLM)</p><p>coronary (COR)</p><p>tibial (TIB) arteries</p><h2 id="研究步骤"><a href="#研究步骤" class="headerlink" title="研究步骤"></a>研究步骤</h2><p>从CAD relevant tissue中获得predicted model</p><p>cross-validated prediction R2 &gt; 0.01的基因被保留</p><p>基于STARNET建立的模型允许将12995个独特的基因表达信号归咎于7种组织</p><p>基于GTEx建立的模型允许将12964个独特的基因表达信号归咎于8种组织</p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.31-B16F1给药配置表(150只小鼠)</title>
    <link href="/2021/08/31/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8/"/>
    <url>/2021/08/31/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-31-B16F1给药配置表-150只小鼠"><a href="#2021-8-31-B16F1给药配置表-150只小鼠" class="headerlink" title="2021.8.31-B16F1给药配置表(150只小鼠)"></a>2021.8.31-B16F1给药配置表(150只小鼠)</h1><p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h2 id="1-实验设计方案"><a href="#1-实验设计方案" class="headerlink" title="1.实验设计方案"></a>1.实验设计方案</h2><p>多肽混合NH组含有编号为1，3，25的肽段，共3条肽。分为低、中、高三个剂量组，低剂量组5.8ug/肽，中剂量组29ug/肽，高剂量组58ug/肽。</p><p>多肽混合TH组含有编号为1，3，25的肽段，共3条肽。分为低、中、高三个剂量组，低剂量组5.8ug/肽，中剂量组29ug/肽，高剂量组58ug/肽。</p><h2 id="2-多肽和佐剂选择"><a href="#2-多肽和佐剂选择" class="headerlink" title="2.多肽和佐剂选择"></a>2.多肽和佐剂选择</h2><p>多肽：每瓶300ug，300uL生理盐水溶解，母液浓度1ug/uL。 </p><p>佐剂：PolyICLC，每瓶250uL，佐剂浓度2ug/uL。 </p><p>用量：计划每组10只小鼠，每只100uL注射液，每次注射1000ul, 注射7次。 </p><p>按每组照150只小鼠量来配制，即15000 uL </p><h2 id="3-抗原肽配置表"><a href="#3-抗原肽配置表" class="headerlink" title="3.抗原肽配置表"></a>3.抗原肽配置表</h2><p>【多肽用量取整前】</p><div class="table-container"><table><thead><tr><th>组别</th><th>多肽用量</th><th>佐剂用量</th><th>生理盐水</th><th>总量</th></tr></thead><tbody><tr><td>对照组</td><td>/</td><td>/</td><td>15000 uL</td><td>15000 uL</td></tr><tr><td>溶媒组</td><td>/</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液14.5瓶，共需43.5瓶多肽母液，总计13050 uL</td><td>150ug， 75uL</td><td>1875 uL</td><td>15000 uL</td></tr><tr><td>TH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液2.9瓶， 共需8.7瓶多肽母液，总计2610 uL</td><td>150ug， 75uL</td><td>12315 uL</td><td>15000 uL</td></tr><tr><td>NH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>NH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液14.5瓶，共需43.5瓶多肽母液，总计13050 uL</td><td>150ug， 75uL</td><td>1875 uL</td><td>15000 uL</td></tr><tr><td>NH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液2.9瓶， 共需8.7瓶多肽母液，总计2610 uL</td><td>150ug， 75uL</td><td>12315 uL</td><td>15000 uL</td></tr></tbody></table></div><p>【多肽用量取整后】</p><div class="table-container"><table><thead><tr><th>组别</th><th>多肽用量</th><th>佐剂用量</th><th>生理盐水</th><th>总量</th></tr></thead><tbody><tr><td>对照组</td><td>/</td><td>/</td><td>15000 uL</td><td>15000 uL</td></tr><tr><td>溶媒组</td><td>/</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液15(14.5)瓶，共需45瓶多肽母液，总计13500 uL</td><td>155.17ug， 77.59uL</td><td>1939.65 uL</td><td>15517.24 uL</td></tr><tr><td>TH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液3(2.9)瓶， 共需9瓶多肽母液，总计2700 uL</td><td>155.17ug， 77.59uL</td><td>12739.65 uL</td><td>15517.24 uL</td></tr><tr><td>NH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>NH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液15(14.5)瓶，共需45瓶多肽母液，总计13500 uL</td><td>155.17ug， 77.59uL</td><td>1939.65 uL</td><td>15517.24 uL</td></tr><tr><td>NH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液3(2.9)瓶， 共需9瓶多肽母液，总计2700 uL</td><td>155.17ug， 77.59uL</td><td>12739.65 uL</td><td>15517.24 uL</td></tr></tbody></table></div>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>polypeptide vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析</title>
    <link href="/2021/08/31/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90/"/>
    <url>/2021/08/31/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h1 id="2021-8-31-学习记录：仁科生物dCODE-Dextramer助力10×Genomics进行T-B细胞抗原特异性分析"><a href="#2021-8-31-学习记录：仁科生物dCODE-Dextramer助力10×Genomics进行T-B细胞抗原特异性分析" class="headerlink" title="2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析"></a>2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析</h1><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.05.55 (2" alt="截屏2021-08-31 下午2.05.55 (2)">.png)</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.06.24.png" alt="截屏2021-08-31 下午2.06.24"></p><blockquote><p>MHC I</p><p>结合沟两端闭合，只能结合肽段长度&lt;10个氨基酸</p><p>呈递给CD8+T细胞</p><p>MHC II</p><p>结合沟两端开放，结合肽段长度平均约15个氨基酸</p><p>呈递给CD4+T细胞</p></blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.08.06.png" alt="截屏2021-08-31 下午2.08.06"></p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.08.37.png" alt="截屏2021-08-31 下午2.08.37"></p><blockquote><p>TCR和MHC-肽段复合物结合时间很短，因此可以通过增加MHC-肽段复合物数量来提升结合时间</p></blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.09.11.png" alt="截屏2021-08-31 下午2.09.11"></p><blockquote><p>(左上角) 骨架上带有荧光基团，MHC分子-肽段复合物</p><p>因结合位点较多（10个以上的结合位点），优势：亲和力更大，灵敏度更高。有利于研究低亲和力TCR</p><p>也可进行NGS或流式进行分选。</p></blockquote><p>dextramer上连接bar code序列，从而与10x单细胞技术结合</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.13.42.png" alt="截屏2021-08-31 下午2.13.42"></p><blockquote><p>PCR handle：</p><p>feature barcode：用于确定连接的肽段</p><p>capture sequence：用于筛选结合了抗原的细胞</p></blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.15.28.png" alt="截屏2021-08-31 下午2.15.28"></p><blockquote><p>增加孵育——清洗步骤，筛选出结合的细胞。</p><p>（上清和磁珠可以用于构建出两种文库信息）</p></blockquote><p>【实例】</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.17.31.png" alt="截屏2021-08-31 下午2.17.31"></p><blockquote><p>样品：CMV病毒血清学反应为阳性和阴性的PBMC</p><blockquote><p>阳性可与CMV结合，阴性不可与CMV结合</p></blockquote><p>能够在CMV病毒血清学反应为阳性的PBMC中筛选出对CMV病毒有特异性的T细胞，并能看出T细胞的亚群与克隆型。</p><p>但在CMV病毒血清学反应为阴性的PBMC中无法筛选出CMV病毒有特异性的T细胞，但能找到对其他病毒有特异性的T细胞。（提示患者以前感染过相应病毒）</p></blockquote><p>可以获得4种结果：</p><p>4-表面蛋白——获得细胞表面蛋白表达情况</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.21.49.png" alt="截屏2021-08-31 下午2.21.49"></p><blockquote><p>与10x转录组结果一起分析，也可以获得中间灰色细胞群（未经注释的细胞）的具体信息。</p></blockquote><p>【要知道哪些信息，才能进行操作？】</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.24.39.png" alt="截屏2021-08-31 下午2.24.39"></p><blockquote><p>需要知道样本HLA的分型与病毒肽段的信息</p><p>可购买或定制</p></blockquote><p>【想要保密肽段该怎么办？】</p><blockquote><p>可以自己diy组装，只需要购买相应分型的MHC分子和骨架，然后和肽段一起进行装载</p></blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.27.23.png" alt="截屏2021-08-31 下午2.27.23"></p><blockquote><p>要和10x产品一起使用，必须选用带有barcode信息的骨架。</p><p>只进行流式分选，则可以使用带有荧光基团的骨架。</p><p>肽段要求：95%以上的纯度</p></blockquote><p>【如果不知道MHC分子的分型，怎么办？】</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.29.22.png" alt="截屏2021-08-31 下午2.29.22"></p><blockquote><p>骨架上换成了生物素受体，可以将目标小分子进行生物素化，即可与骨架结合。</p></blockquote><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.30.35.png" alt="截屏2021-08-31 下午2.30.35"></p><blockquote><p>然后通过barcode检测，可以确定与小分子结合的细胞有哪些。</p></blockquote><p>应用：【LIBRA-seq】用于大规模的抗体发现</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.31.52.png" alt="截屏2021-08-31 下午2.31.52"></p><p>应用：【Genentech】可以用于较大规模的抗体筛选</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.32.47.png" alt="截屏2021-08-31 下午2.32.47"></p><p>【总结】用途：</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.33.41.png" alt="截屏2021-08-31 下午2.33.41"></p>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Antigen specificity analysis</tag>
      
      <tag>dCODE Dextramer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ppp1r15A 临床试验开展情况</title>
    <link href="/2021/08/30/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5/"/>
    <url>/2021/08/30/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h1 id="2-ppp1r15A-临床试验开展情况"><a href="#2-ppp1r15A-临床试验开展情况" class="headerlink" title="2.ppp1r15A 临床试验开展情况"></a>2.ppp1r15A 临床试验开展情况</h1><p>PPP1R15A (蛋白磷酸酶1调控亚基15A)是一种蛋白质编码基因。与 PPP1R15A 相关的疾病包括恶性胸膜间皮瘤和骨骺发育不良，多发性，早发性糖尿病。其相关途径包括 β- 肾上腺素能信号转导和 SMAD2/SMAD3-SMAD4异三聚体的转录活性。与该基因相关的基因本体(GO)注释包括蛋白激酶结合。该基因的一个重要旁系是 PPP1R15B。</p><p>PPP1R15A招募丝氨酸/苏氨酸蛋白磷酸酶PP1，形成PPP1R15A-PP1复合物，该复合物使翻译起始因子eIF-2A/EIF2S1去磷酸化，从而逆转由应激诱导激酶启动的蛋白质合成的关闭，促进细胞从应激中恢复。另外，PPP1R15A通过促进PP1对TGFB1的去磷酸化而下调TGF-beta信号通路，可能通过诱导TP53在 “Ser-15 “上的磷酸化而促进细胞凋亡。</p><p>目前，处于临床研究阶段的PPP1R15A相关药物主要与以上通路相关。Tsaytler等人报道，此前由美国FDC批准的抗高血压药物Guanabenz可通过 GADD34-PP1c 介导的 p-eif2α 的去磷酸化作用，增强综合应激反应(ISR)。ISR是一种细胞保护反应，由各种细胞毒性损伤激活，如活性氮氧化物、谷氨酸兴奋性和内质网压力，所有这些都与多发性硬化的发病机制有关。Way等人报告，用guanabenz治疗小鼠的EAE延迟了疾病的发生并抑制了临床症状：这些效果与少突胶质细胞中p-eIF2α水平的增加和少突胶质细胞的保护有关。这些有希望的结果已成为美国国立卫生研究院进行多发性硬化症临床试验的基础（ClinicalTrials.Gov: NCT02423083）。</p><p>不过，Guanabenz同时具有α2肾上腺素激动剂的功能，这导致Guanabenz可能导致嗜睡、嗜睡等副作用。一种名为 Sephin1的 Guanabenz 衍生物，最近被证明能够保留 GADD34-PP1c 特异性抑制活性，而不会在细胞或体内产生可测量的 α2肾上腺素副作用。Chen等人报告说，Sephin1对慢性自身免疫性脑脊髓炎(EAE)小鼠的治疗显著延迟了疾病的发生，这与少突胶质细胞减少、轴突和髓鞘丢失以及 ISR 延长有关。此外，Sephin 1可以减少炎症性 CD3+t 细胞的数量和中枢神经系统内炎症性细胞因子的产生，而不影响外周免疫反应。</p><p>以上提及的两种药物中，仅有Guanabenz已在开展临床试验，Guanabenz的衍生物Sephin1仍处于动物实验阶段。</p><blockquote><p>Tsaytler, Pavel, et al. “Selective inhibition of a regulatory subunit of protein phosphatase 1 restores proteostasis.” <em>Science</em> 332.6025 (2011): 91-94.</p><p>Mháille, Aoife Ní, et al. “Increased expression of endoplasmic reticulum stress-related signaling pathway molecules in multiple sclerosis lesions.” <em>Journal of Neuropathology &amp; Experimental Neurology</em> 67.3 (2008): 200-211.</p><p>Cunnea, Paula, et al. “Expression profiles of endoplasmic reticulum stress-related molecules in demyelinating lesions and multiple sclerosis.” <em>Multiple Sclerosis Journal</em> 17.7 (2011): 808-818.</p><p>Way, Sharon W., and Brian Popko. “Harnessing the integrated stress response for the treatment of multiple sclerosis.” <em>The Lancet Neurology</em> 15.4 (2016): 434-443.</p><p>Das, Indrajit, et al. “Preventing proteostasis diseases by selective inhibition of a phosphatase regulatory subunit.” <em>Science</em> 348.6231 (2015): 239-242.</p><p>Chen, Yanan, et al. “Sephin1, which prolongs the integrated stress response, is a promising therapeutic for multiple sclerosis.” <em>Brain</em> 142.2 (2019): 344-361.</p></blockquote><p>【简表】</p><div class="table-container"><table><thead><tr><th>药物</th><th>临床试验编号</th><th>临床试验适应症</th><th>临床试验开展年份</th><th>临床试验开展国家/地区</th><th>临床试验申办机构</th><th>临床试验阶段</th><th>副反应提及</th><th>参考文献</th></tr></thead><tbody><tr><td>Guanabenz</td><td>ClinicalTrials.gov Identifier: NCT02423083</td><td>multiple sclerosis (MS)</td><td>2015.4-2017.10</td><td>美国</td><td>National Institutes of Health Clinical Center (CC) ( National Institute of Neurological Disorders and Stroke (NINDS) )</td><td>Phase 1</td><td>因该药物同时具有作为 α2肾上腺素激动剂的功能，可导致嗜睡，口干，头晕，可能导致患者在服药过量时昏迷。较不常见的副作用包括：虚弱，胸痛，水肿，心悸，焦虑，失去协调性，抑郁，瘙痒，皮疹，男性乳房发育，腹痛，便秘，腹泻，恶心，呕吐，肌肉疼痛，视力模糊，呼吸困难，鼻腔充血</td><td>Tsaytler P, Harding HP, Ron D, Bertolotti A. Selective inhibition of a regulatory subunit of protein phosphatase 1 restores proteostasis. Science 2011; 332: 91–4.                                                                                Holmes B, Brogden RN, Heel RC, Speight TM, Avery GS. Guanabenz. A review of its pharmacodynamic properties and therapeutic efficacy in hypertension. Drugs 1983; 26: 212–29.</td></tr><tr><td>Guanabenz</td><td>ClinicalTrials.gov Identifier: NCT02443103</td><td>Bone Cancer Metastasis</td><td>2015.5-2016.2</td><td>美国</td><td>Kathy Miller, Indiana University School of Medicine</td><td>Not Applicable</td><td>/</td><td>/</td></tr></tbody></table></div><h2 id="2-1-临床试验年度趋势"><a href="#2-1-临床试验年度趋势" class="headerlink" title="2.1.临床试验年度趋势"></a>2.1.临床试验年度趋势</h2><p>2015.4-2017.10期间，Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02423083）主要探究药物Guanabenz对多发性硬化症患者是否安全和耐受性良好。</p><p>2015.5-2016.2期间，Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02443103）主要探究药物Guanabenz在减少有骨转移的实体瘤患者的骨质翻转方面的生物活性。</p><h2 id="2-2-临床试验国家与地区分布"><a href="#2-2-临床试验国家与地区分布" class="headerlink" title="2.2.临床试验国家与地区分布"></a>2.2.临床试验国家与地区分布</h2><p>Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02423083，ClinicalTrials.Gov: NCT02443103）仅在美国本土开展。</p><h2 id="2-3-临床试验申办机构分析"><a href="#2-3-临床试验申办机构分析" class="headerlink" title="2.3.临床试验申办机构分析"></a>2.3.临床试验申办机构分析</h2><p>登记号为ClinicalTrials.Gov: NCT02423083的临床试验由美国国立卫生研究院临床中心（CC）（国家神经疾病和中风研究所（NINDS））主持研究；</p><p>登记号为ClinicalTrials.Gov: NCT02443103的临床试验由印第安纳大学医学院主持研究。</p><h2 id="2-4-临床试验临床阶段及列表"><a href="#2-4-临床试验临床阶段及列表" class="headerlink" title="2.4.临床试验临床阶段及列表"></a>2.4.临床试验临床阶段及列表</h2><p>ClinicalTrials.Gov: NCT02423083处于临床试验Phase 1。</p><p>ClinicalTrials.Gov: NCT02443103临床试验阶段标记为不适用（ Not Applicable）。</p><h2 id="2-5-临床试验适应症分布"><a href="#2-5-临床试验适应症分布" class="headerlink" title="2.5.临床试验适应症分布"></a>2.5.临床试验适应症分布</h2><p>Guanabenz此前由美国FDC批准作为抗高血压药物使用，在登记号为NCT02423083的临床试验中被作为美国国立卫生研究院实验性治疗多发性硬化症临床试验的参考药物；在登记号为NCT02443103的临床试验中被印第安纳大学医学院用于作为减少患者骨癌转移的药物，并进行生物活性评估。</p>]]></content>
    
    
    <categories>
      
      <category>DATA COLLECTION</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ppp1r15A</tag>
      
      <tag>ClinicalTrials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210827与导师talk</title>
    <link href="/2021/08/27/20210827%E4%B8%8E%E5%AF%BC%E5%B8%88talk/"/>
    <url>/2021/08/27/20210827%E4%B8%8E%E5%AF%BC%E5%B8%88talk/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210827%E4%B8%8E%E5%AF%BC%E5%B8%88talk.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>talk&amp;meeting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210826实验记录分离小鼠骨髓中的DC细胞和脾脏中的T细胞裂红和计数和混合培养</title>
    <link href="/2021/08/26/20210826%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E5%B0%8F%E9%BC%A0%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84T%E7%BB%86%E8%83%9E%E8%A3%82%E7%BA%A2%E5%92%8C%E8%AE%A1%E6%95%B0%E5%92%8C%E6%B7%B7%E5%90%88%E5%9F%B9%E5%85%BB/"/>
    <url>/2021/08/26/20210826%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E5%B0%8F%E9%BC%A0%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84T%E7%BB%86%E8%83%9E%E8%A3%82%E7%BA%A2%E5%92%8C%E8%AE%A1%E6%95%B0%E5%92%8C%E6%B7%B7%E5%90%88%E5%9F%B9%E5%85%BB/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210826%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E5%B0%8F%E9%BC%A0%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84T%E7%BB%86%E8%83%9E%E8%A3%82%E7%BA%A2%E5%92%8C%E8%AE%A1%E6%95%B0%E5%92%8C%E6%B7%B7%E5%90%88%E5%9F%B9%E5%85%BB.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210812文献阅读新冠病毒的复制周期</title>
    <link href="/2021/08/12/20210812%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%96%B0%E5%86%A0%E7%97%85%E6%AF%92%E7%9A%84%E5%A4%8D%E5%88%B6%E5%91%A8%E6%9C%9F/"/>
    <url>/2021/08/12/20210812%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%96%B0%E5%86%A0%E7%97%85%E6%AF%92%E7%9A%84%E5%A4%8D%E5%88%B6%E5%91%A8%E6%9C%9F/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210812%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%96%B0%E5%86%A0%E7%97%85%E6%AF%92%E7%9A%84%E5%A4%8D%E5%88%B6%E5%91%A8%E6%9C%9F.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SARS-CoV-2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.11-实验记录：CD4、CD8T细胞流式染色</title>
    <link href="/2021/08/11/20210811%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95CD4CD8T%E7%BB%86%E8%83%9E%E6%B5%81%E5%BC%8F%E6%9F%93%E8%89%B2/"/>
    <url>/2021/08/11/20210811%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95CD4CD8T%E7%BB%86%E8%83%9E%E6%B5%81%E5%BC%8F%E6%9F%93%E8%89%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-11-实验记录：CD4、CD8T细胞流式染色"><a href="#2021-8-11-实验记录：CD4、CD8T细胞流式染色" class="headerlink" title="2021.8.11-实验记录：CD4、CD8T细胞流式染色"></a>2021.8.11-实验记录：CD4、CD8T细胞流式染色</h1><blockquote><p>注意：每个样本应留下一个空白样本不做染色，用于校准基线。</p><p>在超净台操作时，应尽量避免开灯，防止荧光淬灭。</p></blockquote><p>配置染色工作液</p><p>染色CD4+ 1:200</p><blockquote><p>APC-eFluer 780</p></blockquote><p>染色CD8+ 1:200</p><blockquote><p>APC-FL6</p></blockquote><p>染色活细胞 1:500</p><blockquote><p>VD-FL9</p></blockquote><p>U型板每孔加入 50μl 染色工作液，暗处孵育 30min。</p><blockquote><p>这里用到的抗体自带荧光基团（是一抗），因此只需要孵育一次。</p></blockquote><p>然后 1500rpm 离心 10min，去上清。</p><p>染色胞内抗原需要进行破膜处理，然后再进行染色。</p><blockquote><p>正常情况下，荧光标记的流式抗体无法通过完整的细胞膜进入细胞内，用流式细胞仪测定细胞内抗原，需先利用破膜剂破坏细胞膜的完整性，产生可供抗体通过的小孔。破膜效果的好坏将直接影响荧光染色和结果分析。</p><p>若检测的胞内抗原带有自发荧光，这种情况下可以直接用流式细胞仪进行检测和分析，若检测需要荧光素偶联的抗体特异性结合细胞内抗原，此时需要用到破膜剂。</p></blockquote><p>U型板每孔加入 50μl 破膜液，暗处孵育 30min。</p><p>然后 1500rpm 离心 10min，去上清。</p><p>U型板每孔加入 100μl 破膜buffer，然后 1500rpm 离心 10min，去上清。</p><blockquote><p>破膜buffer原液为10x，需要稀释至1x。</p></blockquote><p>U型板每孔加入 50μl 胞内抗原染色工作液，暗处孵育 30min。</p><blockquote><p>CFFN </p><p>G2AM </p><p>MIX1</p></blockquote><p>然后 1500rpm 离心 10min，去上清，U型板每孔加入 100μl 加入破膜buffer。</p><blockquote><p>细胞多的时候可以洗一遍，少的时候可以不洗。</p></blockquote><p>然后 1500rpm 离心 10min，去上清，U型板每孔加入 100μl 破膜buffer配置的空白液。</p><blockquote><p>可以在-4℃冰箱里存放一天。</p></blockquote><p>流式细胞仪上样。</p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
      <tag>flow cytometry</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞</title>
    <link href="/2021/08/10/20210810%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84%E6%B7%8B%E5%B7%B4%E7%BB%86%E8%83%9E/"/>
    <url>/2021/08/10/20210810%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84%E6%B7%8B%E5%B7%B4%E7%BB%86%E8%83%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞"><a href="#2021-8-10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞" class="headerlink" title="2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞"></a>2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞</h1><p>（本次操作未进行裂红）</p><h2 id="分离骨髓中的DC细胞"><a href="#分离骨髓中的DC细胞" class="headerlink" title="分离骨髓中的DC细胞"></a>分离骨髓中的DC细胞</h2><p>准备：高温灭菌过的镊子、剪刀、一次性无菌注射器、1.5ml EP 管、15ml 离心管。</p><p>将新鲜小鼠后腿骨依次在 75%-80% 乙醇（EP管内）和 PBS （EP管内）中清洗。</p><p>将清洗过后的后腿骨置于细胞培养皿内，吸取适量 PBS 使后腿骨保持湿润。</p><p>用镊子夹取后腿骨中部，用剪刀剪去后腿骨两头。</p><p>用一次性无菌注射器吸取适量 PBS，然后插进大腿骨骨腔里，将骨髓冲洗出来。一根大腿骨的两头都需要冲洗，每头冲洗两次。</p><p>将 70μm 滤网放置在离心管上，将冲洗出来的骨髓悬液过滤。</p><p>用 PBS 将骨髓悬液补足至 15ml。</p><p>2000rps 离心 10min，获得沉淀在离心管底部的细胞。</p><blockquote><p>因未进行裂红，因此外观呈红色。</p></blockquote><h2 id="分离脾脏中的淋巴细胞"><a href="#分离脾脏中的淋巴细胞" class="headerlink" title="分离脾脏中的淋巴细胞"></a>分离脾脏中的淋巴细胞</h2><p>准备：高温灭菌过的镊子、剪刀、一次性无菌注射器、1.5ml EP 管、15ml 离心管。</p><p>将新鲜小鼠脾脏依次在 75%-80% 乙醇（EP管内）和 PBS （EP管内）中清洗。由于脾脏较为脆弱，用镊子夹取时需要特别注意。</p><p>将清洗过后的脾脏置于细胞培养皿内，吸取适量 PBS 使脾脏保持湿润，然后用一次性无菌注射器推注棒碾磨。</p><p>将 200μm 滤网放置在离心管上，将混有磨碎脾脏的 PBS 过滤。</p><p>用 PBS 将脾脏碾磨液补足至 10ml。</p><p>2000rps 离心 10min，获得沉淀在离心管底部的细胞。</p><blockquote><p>因未进行裂红，因此外观呈红色。</p></blockquote><h2 id="细胞培养"><a href="#细胞培养" class="headerlink" title="细胞培养"></a>细胞培养</h2><p>(培养DC细胞)</p><p>将离心管上清全部吸出，保留沉淀在离心管底部的细胞。</p><p>吸取 2ml 培养液，在离心管中吹打细胞进行重悬。</p><blockquote><p>培养液类型？</p></blockquote><p>将重悬后的细胞悬液分装到两个细胞培养皿中，每个培养皿分装 1ml。</p><p>在每个培养皿中再加入 10ml 培养液和集落刺激因子，混匀，在显微镜下镜检观察，然后放入细胞培养箱。</p><blockquote><p>集落刺激因子配置/浓度？</p></blockquote><h2 id="细胞冻存"><a href="#细胞冻存" class="headerlink" title="细胞冻存"></a>细胞冻存</h2><p>（冻存淋巴细胞）</p><p>胎牛血清与冻存液体按照 9:1 配置，细胞冻存管每管 1.5ml</p><p>一般将冻存管直接存入 -80℃ 液氮中，如果液氮罐已满，也可先放入 -20℃ 冰箱中过夜，第二天转移至液氮罐中。</p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210809实验记录人源化小鼠全血DNA抽提</title>
    <link href="/2021/08/09/20210809%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E4%BA%BA%E6%BA%90%E5%8C%96%E5%B0%8F%E9%BC%A0%E5%85%A8%E8%A1%80DNA%E6%8A%BD%E6%8F%90/"/>
    <url>/2021/08/09/20210809%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E4%BA%BA%E6%BA%90%E5%8C%96%E5%B0%8F%E9%BC%A0%E5%85%A8%E8%A1%80DNA%E6%8A%BD%E6%8F%90/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210809%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E4%BA%BA%E6%BA%90%E5%8C%96%E5%B0%8F%E9%BC%A0%E5%85%A8%E8%A1%80DNA%E6%8A%BD%E6%8F%90.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210728 R practice</title>
    <link href="/2021/07/28/20210728Rpractice/"/>
    <url>/2021/07/28/20210728Rpractice/</url>
    
    <content type="html"><![CDATA[<h1 id="R-practice"><a href="#R-practice" class="headerlink" title="R practice"></a>R practice</h1><p>R version 4.0.2 (2020-06-22)</p><h2 id="tibble"><a href="#tibble" class="headerlink" title="tibble"></a>tibble</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs R">library(tidyverse)<br>as_tibble(iris)<br><br>tibble(<br>  x = <span class="hljs-number">1</span>:<span class="hljs-number">5</span>,<br>  y = <span class="hljs-number">1</span>,<br>  z = x^<span class="hljs-number">2</span><br>)<br><br>tibble(<br>  col_1 = <span class="hljs-string">&#x27;feature1&#x27;</span>,<br>  col_2 = <span class="hljs-string">&#x27;feature2&#x27;</span>,<br>  col_3 = <span class="hljs-string">&#x27;feature3&#x27;</span><br>)<br><br>tribble(<br>  ~feature_1, ~feature_2, ~feature_3,<br>  <span class="hljs-comment">#---------|-----------|-----------|</span><br>  <span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<br>  <span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;e&#x27;</span>,<span class="hljs-string">&#x27;f&#x27;</span><br>)<br><br>tibble(<br>  a = lubridate::now() + runif(<span class="hljs-number">1e3</span>) * <span class="hljs-number">86400</span>,<br>  b = lubridate::today() + runif(<span class="hljs-number">1e3</span>) * <span class="hljs-number">30</span>,<br>  <span class="hljs-built_in">c</span> = <span class="hljs-number">1</span>:<span class="hljs-number">1e3</span>,<br>  d = runif(<span class="hljs-number">1e3</span>),<br>  e = sample(<span class="hljs-built_in">letters</span>, <span class="hljs-number">1e3</span>, replace = <span class="hljs-literal">TRUE</span>)<br>)%&gt;%<br>print(n = <span class="hljs-number">20</span>, width = <span class="hljs-literal">Inf</span>)<br><br>tibble(<br>  a = lubridate::now() + runif(<span class="hljs-number">1e3</span>) * <span class="hljs-number">86400</span>,<br>  b = lubridate::today() + runif(<span class="hljs-number">1e3</span>) * <span class="hljs-number">30</span>,<br>  <span class="hljs-built_in">c</span> = <span class="hljs-number">1</span>:<span class="hljs-number">1e3</span>,<br>  d = runif(<span class="hljs-number">1e3</span>),<br>  e = sample(<span class="hljs-built_in">letters</span>, <span class="hljs-number">1e3</span>, replace = <span class="hljs-literal">TRUE</span>)<br>)%&gt;%<br>  View()<br><br><br>options(tibble.print_max = <span class="hljs-number">20</span>, tibble.print_min = <span class="hljs-number">8</span>)<br>tibble(<br>  a = lubridate::now() + runif(<span class="hljs-number">1e3</span>) * <span class="hljs-number">86400</span>,<br>  b = lubridate::today() + runif(<span class="hljs-number">1e3</span>) * <span class="hljs-number">30</span>,<br>  <span class="hljs-built_in">c</span> = <span class="hljs-number">1</span>:<span class="hljs-number">1e3</span>,<br>  d = runif(<span class="hljs-number">1e3</span>),<br>  e = sample(<span class="hljs-built_in">letters</span>, <span class="hljs-number">1e3</span>, replace = <span class="hljs-literal">TRUE</span>)<br>)<br><br>df = tibble(<br>  x = runif(<span class="hljs-number">5</span>),<br>  y = rnorm(<span class="hljs-number">5</span>)<br>)<br>df$x  <br>df$y<br>df[[<span class="hljs-number">1</span>]]<br>df %&gt;% .$x<br>df %&gt;% .[[<span class="hljs-number">1</span>]]<br><br><span class="hljs-built_in">class</span>(as.data.frame(df))<br><br>as_tibble(mtcars)%&gt;%<br>  View()<br>mtcars$cyl<br>mtcars$wt<br>mtcars[[<span class="hljs-number">1</span>]]<br><br>test = tibble(mtcars)<br>cars = tibble(mpg = mtcars$mpg, qsec = mtcars$qsec) <br>ggplot(cars, aes(x = mpg, y = qsec))+<br>  geom_point()<br><br>test1 = tibble(mtcars)<br>test2 = tibble(col1 = test1[[<span class="hljs-number">1</span>]], col2 = test1[[<span class="hljs-number">2</span>]], col3 = test1[[<span class="hljs-number">1</span>]]/test[[<span class="hljs-number">2</span>]]) %&gt;%<br>  View()<br></code></pre></td></tr></table></figure><h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs R">library(tidyverse)<br>library(stringr)<br><br>x &lt;- <span class="hljs-string">&quot;this is a sentence&quot;</span> <br>str_view_all(x, boundary(<span class="hljs-string">&quot;word&quot;</span>))<br><br>str_split(x, <span class="hljs-string">&quot; &quot;</span>, simplify = <span class="hljs-literal">TRUE</span>)<br><br>str_view_all(<span class="hljs-string">&quot;ababab&quot;</span>, <span class="hljs-string">&quot;ab&quot;</span>)<br><br>str_locate(<span class="hljs-string">&quot;abababa&quot;</span>, <span class="hljs-string">&quot;ab&quot;</span>)<br><br>month_levels &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;Jan&quot;</span>, <span class="hljs-string">&quot;Feb&quot;</span>, <span class="hljs-string">&quot;Mar&quot;</span>, <span class="hljs-string">&quot;Apr&quot;</span>, <span class="hljs-string">&quot;May&quot;</span>, <span class="hljs-string">&quot;Jun&quot;</span>, <br>                  <span class="hljs-string">&quot;Jul&quot;</span>, <span class="hljs-string">&quot;Aug&quot;</span>, <span class="hljs-string">&quot;Sep&quot;</span>, <span class="hljs-string">&quot;Oct&quot;</span>, <span class="hljs-string">&quot;Nov&quot;</span>, <span class="hljs-string">&quot;Dec&quot;</span>)<br>x1 &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;Dec&quot;</span>, <span class="hljs-string">&quot;Feb&quot;</span>, <span class="hljs-string">&quot;Jan&quot;</span>, <span class="hljs-string">&quot;Oct&quot;</span>)<br>y1 &lt;- factor(x1, levels = month_levels)<br>y1<br>sort(y1)<br><br>View(flights)<br>library(ggplot2)<br>flights1 &lt;- flights<br>  ggplot(flights1)+<br>  geom_point(mapping = aes(air_time,distance))<br></code></pre></td></tr></table></figure><h2 id="read-r"><a href="#read-r" class="headerlink" title="read r"></a>read r</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs R">library(tidyverse)<br>diamonds_tibble &lt;- read_csv(<span class="hljs-string">&quot;diamonds.csv&quot;</span>)<br>View(diamonds_tibble)<br><br>read_csv(<br>  <span class="hljs-string">&quot;a,b,c</span><br><span class="hljs-string">  1,2,3</span><br><span class="hljs-string">  4,5,6&quot;</span><br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;the first line of metadata</span><br><span class="hljs-string">  the second line of metadata</span><br><span class="hljs-string">  x,y,z</span><br><span class="hljs-string">  1,2,3&quot;</span>,<br>  skip=<span class="hljs-number">2</span><br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;#a comment i want to skip</span><br><span class="hljs-string">  x,y,z</span><br><span class="hljs-string">  1,2,3&quot;</span>,<br>  comment=<span class="hljs-string">&#x27;#&#x27;</span><br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;1,2,3</span><br><span class="hljs-string">  4,5,6&quot;</span>,<br>  col_names = <span class="hljs-literal">FALSE</span><br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;1,2,3</span><br><span class="hljs-string">  4,5,6&quot;</span>,<br>  col_names = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;x&quot;</span>,<span class="hljs-string">&quot;y&quot;</span>,<span class="hljs-string">&quot;z&quot;</span>)<br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;1,2,3\n4,5,6\n7,8,9&quot;</span>,<br>  col_names = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;test1&quot;</span>,<span class="hljs-string">&quot;test2&quot;</span>,<span class="hljs-string">&quot;test3&quot;</span>)<br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;1,2,3\n4,5,.&quot;</span>,<br>  na = <span class="hljs-string">&quot;.&quot;</span><br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;a,b\n1,2,3&quot;</span><br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;a,b,c\n1,2&quot;</span><br>)<br><br>read_csv(<br>  <span class="hljs-string">&quot;a,b\n\1,2,3&quot;</span><br>)<br></code></pre></td></tr></table></figure><h2 id="parse"><a href="#parse" class="headerlink" title="parse"></a>parse</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs R">library(tidyverse)<br>str(parse_logical(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;TRUE&quot;</span>,<span class="hljs-string">&quot;FALSE&quot;</span>,<span class="hljs-string">&quot;NA&quot;</span>)))<br><br>str(parse_integer(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>)))<br><br>str(parse_date(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;2020-01-01&quot;</span>,<span class="hljs-string">&quot;1999-02-23&quot;</span>)))<br><br>parse_integer(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>), na=<span class="hljs-string">&quot;.&quot;</span>)<br><br>x &lt;- parse_integer(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;q&quot;</span>))<br>problems(x)<br><br>parse_double(<span class="hljs-string">&quot;1.23&quot;</span>)<br>parse_double(<span class="hljs-string">&quot;1,23&quot;</span>, locale = locale(decimal_mark = <span class="hljs-string">&quot;,&quot;</span>))<br><br>parse_number(<span class="hljs-string">&quot;$20&quot;</span>)<br>parse_number(<span class="hljs-string">&quot;56%&quot;</span>)<br>parse_number(<span class="hljs-string">&quot;it costs $618347&quot;</span>)<br>parse_number(<span class="hljs-string">&quot;111.234.566&quot;</span>, locale = locale(grouping_mark = <span class="hljs-string">&quot;.&quot;</span>))<br>parse_number(<span class="hljs-string">&quot;111&#x27;678&#x27;980&quot;</span>, locale = locale(grouping_mark = <span class="hljs-string">&quot;&#x27;&quot;</span>))<br><br>charToRaw(<span class="hljs-string">&quot;Hadley&quot;</span>)<br><br>x1 &lt;- <span class="hljs-string">&quot;EL Ni\xf1o was particularly bad this year&quot;</span><br>parse_character(x1, locale = locale(encoding = <span class="hljs-string">&quot;Latin1&quot;</span>))<br><br>guess_encoding(charToRaw(x1))<br><br>fruit &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;apple&quot;</span>, <span class="hljs-string">&quot;banana&quot;</span>)<br>parse_factor(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;apple&quot;</span>,<span class="hljs-string">&quot;banana&quot;</span>), levels = fruit)<br><br>fruit &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;apple&quot;</span>, <span class="hljs-string">&quot;banana&quot;</span>)<br>parse_factor(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;apple&quot;</span>,<span class="hljs-string">&quot;banana&quot;</span>,<span class="hljs-string">&quot;lemon&quot;</span>), levels = fruit)<br><br>parse_datetime(<span class="hljs-string">&quot;2010-10-02T2010&quot;</span>)<br><br>parse_datetime(<span class="hljs-string">&quot;20201010&quot;</span>)<br><br>parse_date(<span class="hljs-string">&quot;2020-10-20&quot;</span>)<br><br>library(hms)<br>parse_time(<span class="hljs-string">&quot;01:10:00 am&quot;</span>)<br>parse_time(<span class="hljs-string">&quot;10:20:01&quot;</span>)<br><br>parse_date(<span class="hljs-string">&quot;19/09/10&quot;</span>,<span class="hljs-string">&quot;%y/%m/%d&quot;</span>)<br>parse_date(<span class="hljs-string">&quot;99/08/03&quot;</span>,<span class="hljs-string">&quot;%y/%d/%m&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="guess-parse"><a href="#guess-parse" class="headerlink" title="guess parse"></a>guess parse</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs R">library(readr)<br>guess_parser(<span class="hljs-built_in">c</span>(<span class="hljs-number">2020</span>-<span class="hljs-number">12</span>-<span class="hljs-number">23</span>))<br>guess_parser(<span class="hljs-string">&quot;2020-12-23&quot;</span>)<br>str(parse_guess(<span class="hljs-string">&quot;2020-12-23&quot;</span>))<br>guess_parser(<span class="hljs-string">&quot;15:02&quot;</span>)<br>guess_parser(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;3&quot;</span>))<br>guess_parser(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;1214,214,1234&quot;</span>))<br><br><br>challenge &lt;- read_csv(readr_example(<span class="hljs-string">&quot;challenge.csv&quot;</span>),<br>col_types = cols(x = col_date(),y = col_logical()))<br>challenge &lt;- read_csv(readr_example(<span class="hljs-string">&quot;challenge.csv&quot;</span>),<br>col_types = cols(x = col_double(),y = col_date()))<br>tail(challenge)<br><br><br>challenge1 &lt;- read_csv(readr_example(<span class="hljs-string">&quot;challenge.csv&quot;</span>),<br>                       guess_max = <span class="hljs-number">1001</span>)<br><br>library(tidyverse)<br>df = tribble(<br>  ~x, ~y,<br>  <span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;1.234&quot;</span>,<br>  <span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&quot;2.344&quot;</span>,<br>  <span class="hljs-string">&quot;3&quot;</span>,<span class="hljs-string">&quot;3.455&quot;</span><br>)<br>type_convert(df)<br><br>write_csv(challenge, <span class="hljs-string">&quot;challenge.csv&quot;</span>) <span class="hljs-comment">#unreliable</span><br>write_excel_csv(challenge, <span class="hljs-string">&quot;challlenge.xlsx&quot;</span>) <span class="hljs-comment">#can not open</span><br>write_excel_csv(challenge, <span class="hljs-string">&quot;challenge.xls&quot;</span>) <span class="hljs-comment">#can be open but damaged</span><br><br>read_csv(<span class="hljs-string">&quot;challenge.csv&quot;</span>)<br><br>write_rds(challenge, <span class="hljs-string">&quot;challenge.rds&quot;</span>)<br>read_rds(<span class="hljs-string">&quot;challenge.rds&quot;</span>)<br><br>library(feather)<br>write_feather(challenge, <span class="hljs-string">&quot;challenge.feather&quot;</span>)<br>read_feather(<span class="hljs-string">&quot;challenge.feather&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="gene-expression-analysis-example"><a href="#gene-expression-analysis-example" class="headerlink" title="gene expression analysis example"></a>gene expression analysis example</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs R">gene_data = read.csv(<span class="hljs-string">&quot;gene_exp_exampple/gene_expression_data.csv&quot;</span>) <span class="hljs-comment">#get gene data from csv file</span><br>View(gene_data) <span class="hljs-comment"># see the data in tibble frame</span><br><span class="hljs-built_in">dim</span>(gene_data) <span class="hljs-comment"># see the dimensions of the table</span><br>head(gene_data) <span class="hljs-comment"># show the first 6 rows of the table </span><br>summary(gene_data) <span class="hljs-comment"># show the information about the different columns of the table</span><br><br>count_cell_types = table(gene_data[,<span class="hljs-string">&quot;cell_type&quot;</span>])<br><span class="hljs-comment"># We can use the command “table” on the column “cell_type” of the data we loaded </span><br><span class="hljs-comment"># to obtain a count of each of the different cell types present in this data in an easy to read form.</span><br><span class="hljs-comment"># in this case we want to abtain a count of cell_types</span><br>count_cell_types<br><br><span class="hljs-comment"># what do we know about the data?</span><br><span class="hljs-comment"># this table list 305 samples of 3 type of cells</span><br><span class="hljs-comment"># and 2 kinds of genes(A and B)</span><br><span class="hljs-comment"># and there are 184 blood.cells, 108 fibroblasts and 13 IPSCs</span><br><br><span class="hljs-comment"># draw the pie plot to show the ratio of each type of cells</span><br>pie(count_cell_types)<br><span class="hljs-comment"># draw the bar plot to show the counts of each type of cells</span><br>barplot(count_cell_types)<br><br><span class="hljs-comment"># how to change the defaut colors of plots?</span><br>cell_colors = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;gray&quot;</span>, <span class="hljs-string">&quot;purple&quot;</span>, <span class="hljs-string">&quot;orange&quot;</span>)<br>pie(count_cell_types, col=cell_colors)<br>barplot(count_cell_types, col=cell_colors)<br><br><span class="hljs-comment"># draw a point plot of there types of cells&#x27; different expression</span><br>plot(<br>  x=gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>], <span class="hljs-comment"># data in the x axis</span><br>  y=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>]  <span class="hljs-comment"># data in the y axis</span><br>)<br><br><span class="hljs-comment"># change the default colors of pointplot (1)</span><br>cell_type_data = as.factor(gene_data[,<span class="hljs-string">&quot;cell_type&quot;</span>]) <br><span class="hljs-comment"># save this column to a variable and subsequently transform it to a factor.</span><br>plot(<br>  x=gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>], <span class="hljs-comment"># data in the x axis</span><br>  y=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>], <span class="hljs-comment"># data in the y axis</span><br>  col=cell_type_data<br>)<br><br><span class="hljs-comment"># change the default colors of pointplot (2)</span><br>plot(<br>  x=gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>], <span class="hljs-comment"># data in the x axis</span><br>  y=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>], <span class="hljs-comment"># data in the y axis</span><br>  col=cell_colors[cell_type_data] <span class="hljs-comment"># Because of how factors work </span><br>  <span class="hljs-comment"># we can use them to subset the colour vector we created (cell_colours) </span><br>  <span class="hljs-comment"># with the categories of the factor itself (the different cell types). </span><br>  <span class="hljs-comment"># This makes it so that each of the cell types has the colour we want for it.</span><br>)<br><br><span class="hljs-comment"># change the default shape of point</span><br>plot(<br>  x=gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>],<br>  y=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>],<br>  col=cell_colors[cell_type_data],<br>  pch=<span class="hljs-number">19</span><br>)<br><br><span class="hljs-comment"># add a title for the pointplot</span><br>plot(<br>  x=gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>],<br>  y=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>],<br>  col=cell_colors[cell_type_data],<br>  pch=<span class="hljs-number">19</span>,<br>  main=<span class="hljs-string">&quot;Gene A vs Gene B sactterplot&quot;</span>,<br>  ylab=<span class="hljs-string">&quot;Gene B expression&quot;</span>,<br>  xlab=<span class="hljs-string">&quot;Gene A expression&quot;</span><br>)<br><br><span class="hljs-comment"># add a legend at the topright for the pointplot</span><br>plot(<br>  x=gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>],<br>  y=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>],<br>  col=cell_colors[cell_type_data],<br>  pch=<span class="hljs-number">19</span>,<br>  main=<span class="hljs-string">&quot;Gene A vs Gene B sactterplot&quot;</span>,<br>  ylab=<span class="hljs-string">&quot;Gene B expression&quot;</span>,<br>  xlab=<span class="hljs-string">&quot;Gene A expression&quot;</span><br>)<br>legend(<br>  x=<span class="hljs-string">&quot;topright&quot;</span>,<br>  legend=levels(cell_type_data),<br>  col=cell_colors,<br>  pch=<span class="hljs-number">19</span><br>)<br><br><span class="hljs-comment"># draw a boxplot to describe geneA and geneB expresison across all the cells</span><br>boxplot(<br>  x=<span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;geneA&quot;</span>=gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>], <span class="hljs-string">&quot;geneB&quot;</span>=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>]),<br>  col=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;purple&quot;</span>,<span class="hljs-string">&quot;orange&quot;</span>),<br>  main=<span class="hljs-string">&quot;GeneA and GeneB expression across all samples&quot;</span>,<br>  ylab=<span class="hljs-string">&quot;Gene Expression&quot;</span>,<br>  xlab=<span class="hljs-string">&quot;Genes&quot;</span>,<br>  pch=<span class="hljs-number">19</span><br>)<br><br><span class="hljs-comment"># draw a boxplot to describe gene B expression of 3 types cell </span><br>boxplot(<br>  formula=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>]~gene_data[,<span class="hljs-string">&quot;cell_type&quot;</span>],<br>  col=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;cyan&quot;</span>,<span class="hljs-string">&quot;purple&quot;</span>,<span class="hljs-string">&quot;orange&quot;</span>),<br>  main=<span class="hljs-string">&quot;Gene B expression by cell type&quot;</span>,<br>  ylab=<span class="hljs-string">&quot;Gene B Expression&quot;</span>,<br>  xlab=<span class="hljs-string">&quot;cell type&quot;</span>,<br>  pch=<span class="hljs-number">20</span><br>)<br><br><span class="hljs-comment"># draw a boxplot to describe gene A expression of 3 types cell </span><br>boxplot(<br>  formula=gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>]~gene_data[,<span class="hljs-string">&quot;cell_type&quot;</span>],<br>  col=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;cyan&quot;</span>,<span class="hljs-string">&quot;purple&quot;</span>,<span class="hljs-string">&quot;orange&quot;</span>),<br>  main=<span class="hljs-string">&quot;Gene A expression by cell type&quot;</span>,<br>  ylab=<span class="hljs-string">&quot;Gene A Expression&quot;</span>,<br>  xlab=<span class="hljs-string">&quot;cell type&quot;</span>,<br>  pch=<span class="hljs-number">20</span><br>)<br></code></pre></td></tr></table></figure><h2 id="ggplot-save"><a href="#ggplot-save" class="headerlink" title="ggplot save"></a>ggplot save</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs R">library(nycflights13)<br>library(tidyverse)<br>flights<br>filter(flights, month==<span class="hljs-number">1</span>, day==<span class="hljs-number">1</span>)<br><br>(dec25 &lt;- filter(flights, month==<span class="hljs-number">12</span>, day==<span class="hljs-number">25</span>))<br><br>nycflights &lt;- flights %&gt;%<br>  group_by(dest) %&gt;%<br>  summarise(count=n(),<br>            dist = mean(flights,na.rm=<span class="hljs-literal">TRUE</span>),<br>            delay = mean(arr_delay, na.rm=<span class="hljs-literal">TRUE</span>)<br>            ) %&gt;%<br>  filter(count&gt;<span class="hljs-number">20</span>, dest!=<span class="hljs-string">&#x27;HNL&#x27;</span>)not_cancelled &lt;- flights %&gt;%<br>  filter(!<span class="hljs-built_in">is.na</span>(dep_delay), !<span class="hljs-built_in">is.na</span>(arr_delay))<br><br>not_cancelled %&gt;%<br>  group_by(year, month, day) %&gt;%<br>  summarize(mean = mean(dep_delay))<br><br>ggplot(data = diamonds)+<br>  geom_histogram(mapping = aes(x = carat),binwidth = <span class="hljs-number">0.5</span>)<br>ggplot(data = diamonds)+<br>  geom_boxplot(mapping = aes(x = cut, y = price))<br><br>ggplot(data = mpg)+<br>  geom_boxplot(mapp = aes(x = <span class="hljs-built_in">class</span>, y = hwy))<br><br>ggplot(data = mpg)+<br>  geom_boxplot(mapping = aes(x = reorder(<span class="hljs-built_in">class</span>, hwy, FUN = median), y = hwy))<br><br>ggplot(data = mpg)+<br>  geom_boxplot(mapping = aes(x = reorder(<span class="hljs-built_in">class</span>, hwy, FUN = median), y = hwy))+<br>  coord_flip()<br><br>ggplot(data = diamonds)+<br>  geom_count(mapping = aes(x = cut, y = color))<br><br>diamonds%&gt;%<br>  count(cut, color)%&gt;%<br>  ggplot(mapping = aes(x = color, y = cut))+<br>  geom_tile(mapping = aes(fill = n))<br><br>ggplot(data = diamonds)+<br>  geom_point(mapping = aes(x = carat, y = price))<br><br>diamonds%&gt;%<br>  ggplot(mapping = aes(x = carat, y = price))+<br>  geom_point()<br><br>diamonds%&gt;%<br>  ggplot(mapping = aes(x = carat, y = price))+<br>  geom_point(alpha = <span class="hljs-number">1</span>/<span class="hljs-number">100</span>)<br>  <br>ggplot(data = diamonds)+<br>  geom_bin2d(mapping = aes(x = carat, y = price))<br><br>ggplot(data = diamonds)+<br>  geom_hex(mapping = aes(x = carat, y = price))<br><br>ggplot(data = diamonds, mapping = aes(x = carat, y = price))+<br>  geom_boxplot(mapping = aes(group = cut_width(carat, <span class="hljs-number">0.5</span>)))<br><br>ggplot(data = diamonds,mapping = aes(x = carat, y = price))+<br>  geom_boxplot(mapping = aes(group = cut_number(carat, <span class="hljs-number">20</span>)))<br><br>ggplot(data = faithful)+<br>  geom_point(mapping = aes(x = eruptions, y = waiting))<br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs R">library(tidyverse)<br>ggplot(diamonds, aes(carat, price))+<br>  geom_boxplot(aes(group=cut_number(carat,<span class="hljs-number">20</span>)))<br>ggsave(<span class="hljs-string">&quot;diamonds.pdf&quot;</span>)<br>write.csv(diamonds, <span class="hljs-string">&quot;diamonds.csv&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="dplyr"><a href="#dplyr" class="headerlink" title="dplyr"></a>dplyr</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><code class="hljs R">library(tidyverse)<br>library(nycflights13)<br>View(flights)<br>View(airlines)<br>View(airports)<br>View(planes)<br>View(weather)<br><br>planes %&gt;%<br>  count(tailnum)%&gt;%<br>  filter(n&gt;<span class="hljs-number">1</span>)<br><br>weather%&gt;%<br>  count(year, month, day, hour, origin)%&gt;%<br>  filter(n&gt;<span class="hljs-number">1</span>)<br><br><span class="hljs-comment">#add a agent key to flights</span><br>flights %&gt;%<br>  arrange(year, month, day, sched_dep_time, carrier, flight) %&gt;%<br>  mutate(flight_id = row_number()) %&gt;%<br>  glimpse()<br><br><br><span class="hljs-comment">#drawing amc map</span><br>airports %&gt;%<br>  semi_join(flights, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;faa&quot;</span> = <span class="hljs-string">&quot;dest&quot;</span>)) %&gt;%<br>  ggplot(aes(lon, lat)) +<br>  borders(<span class="hljs-string">&quot;state&quot;</span>) +<br>  geom_point() +<br>  coord_quickmap()<br><br>avg_dest_delays &lt;-<br>  flights %&gt;%<br>  group_by(dest) %&gt;%<br>  <span class="hljs-comment"># arrival delay NA&#x27;s are cancelled flights</span><br>  summarise(delay = mean(arr_delay, na.rm = <span class="hljs-literal">TRUE</span>)) %&gt;%<br>  inner_join(airports, by = <span class="hljs-built_in">c</span>(dest = <span class="hljs-string">&quot;faa&quot;</span>))<br><br>avg_dest_delays %&gt;%<br>  ggplot(aes(lon, lat, colour = delay)) +<br>  borders(<span class="hljs-string">&quot;state&quot;</span>) +<br>  geom_point() +<br>  coord_quickmap()<br><br>library(tidyverse)<br>flights1 &lt;- flights%&gt;%<br>  select(year:day, hour, origin, dest, tailnum, carrier)<br>View(flights1)<br><br>library(tidyverse)<br>flights2 &lt;- flights%&gt;%<br>  select(-origin, -dest)%&gt;%<br>  left_join(airlines, by=<span class="hljs-string">&quot;carrier&quot;</span>)<br>View(flights2)<br><br><span class="hljs-comment">#inner_join</span><br>x &lt;- tribble(<br>  ~key, ~val_x,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;x1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;x2&quot;</span>,<br>  <span class="hljs-number">3</span>, <span class="hljs-string">&quot;x3&quot;</span><br>)<br>y &lt;- tribble(<br>  ~key, ~val_y,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;y1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;y2&quot;</span>,<br>  <span class="hljs-number">3</span>, <span class="hljs-string">&quot;y3&quot;</span><br>)<br>x%&gt;%<br>  inner_join(y, by = <span class="hljs-string">&quot;key&quot;</span>)<br><br><span class="hljs-comment">#full_join</span><br>x &lt;- tribble(<br>  ~key, ~val_x,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;x1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;x2&quot;</span>,<br>  <span class="hljs-number">3</span>, <span class="hljs-string">&quot;x3&quot;</span><br>)<br>y &lt;- tribble(<br>  ~key, ~val_y,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;y1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;y2&quot;</span>,<br>  <span class="hljs-number">4</span>, <span class="hljs-string">&quot;y3&quot;</span><br>)<br>x%&gt;%<br>  full_join(y, by = <span class="hljs-string">&quot;key&quot;</span>)<br><br><span class="hljs-comment">#left_join</span><br>x &lt;- tribble(<br>  ~key, ~val_x,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;x1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;x2&quot;</span>,<br>  <span class="hljs-number">3</span>, <span class="hljs-string">&quot;x3&quot;</span><br>)<br>y &lt;- tribble(<br>  ~key, ~val_y,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;y1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;y2&quot;</span>,<br>  <span class="hljs-number">4</span>, <span class="hljs-string">&quot;y3&quot;</span><br>)<br>x%&gt;%<br>  left_join(y, by = <span class="hljs-string">&quot;key&quot;</span>)<br><br><span class="hljs-comment">#right_join</span><br>x &lt;- tribble(<br>  ~key, ~val_x,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;x1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;x2&quot;</span>,<br>  <span class="hljs-number">3</span>, <span class="hljs-string">&quot;x3&quot;</span><br>)<br>y &lt;- tribble(<br>  ~key, ~val_y,<br>  <span class="hljs-number">1</span>, <span class="hljs-string">&quot;y1&quot;</span>,<br>  <span class="hljs-number">2</span>, <span class="hljs-string">&quot;y2&quot;</span>,<br>  <span class="hljs-number">4</span>, <span class="hljs-string">&quot;y3&quot;</span><br>)<br>x%&gt;%<br>  right_join(y, by = <span class="hljs-string">&quot;key&quot;</span>)<br><br>flights2%&gt;%<br>  left_join(weather)<br><br>flights2%&gt;%<br>  left_join(planes, by = <span class="hljs-string">&quot;tailnum&quot;</span>)<br><br>library(tidyverse)<br>library(nycflights13)<br>flights2 &lt;- flights<br>flights2 %&gt;%<br>  left_join(airports, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;dest&quot;</span> = <span class="hljs-string">&quot;faa&quot;</span>))<br><br>flights2%&gt;%<br>  left_join(airports,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;origin&quot;</span> = <span class="hljs-string">&quot;faa&quot;</span>))<br><br>top_dest &lt;- flights2%&gt;%<br>  count(dest, sort = <span class="hljs-literal">TRUE</span>)%&gt;%<br>  head(<span class="hljs-number">10</span>)<br>top_dest<br><br>flights%&gt;%<br>  semi_join(top_dest)<br><br>flights%&gt;%<br>  anti_join(planes, by = <span class="hljs-string">&quot;tailnum&quot;</span>)%&gt;%<br>  count(tailnum, sort = <span class="hljs-literal">TRUE</span>)<br><br>top_flight &lt;- subset(flights2, flight&gt;=<span class="hljs-number">100</span>)<br>top_flight<br><br><span class="hljs-comment">#</span><br>str(planes)<br>plane_ages &lt;-<br>  planes %&gt;%<br>  mutate(age = <span class="hljs-number">2018</span> - year) %&gt;%<br>  select(tailnum, age)<br><br>flights %&gt;%<br>  inner_join(plane_ages, by = <span class="hljs-string">&quot;tailnum&quot;</span>) %&gt;%<br>  group_by(age) %&gt;%<br>  filter(!<span class="hljs-built_in">is.na</span>(dep_delay)) %&gt;%<br>  summarise(delay = mean(dep_delay)) %&gt;%<br>  ggplot(aes(x = age, y = delay)) +<br>  geom_point() +<br>  geom_line()<br><br><span class="hljs-comment">#</span><br>str(weather)<br>flight_weather &lt;-<br>  flights %&gt;%<br>  inner_join(weather, by = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;origin&quot;</span> = <span class="hljs-string">&quot;origin&quot;</span>,<br>                             <span class="hljs-string">&quot;year&quot;</span> = <span class="hljs-string">&quot;year&quot;</span>,<br>                             <span class="hljs-string">&quot;month&quot;</span> = <span class="hljs-string">&quot;month&quot;</span>,<br>                             <span class="hljs-string">&quot;day&quot;</span> = <span class="hljs-string">&quot;day&quot;</span>,<br>                             <span class="hljs-string">&quot;hour&quot;</span> = <span class="hljs-string">&quot;hour&quot;</span>))<br><br>flight_weather %&gt;%<br>  group_by(precip) %&gt;%<br>  summarise(delay = mean(dep_delay, na.rm = <span class="hljs-literal">TRUE</span>)) %&gt;%<br>  ggplot(aes(x = precip, y = delay)) +<br>  geom_line() + geom_point()<br><br><span class="hljs-comment">#</span><br>flights %&gt;%<br>  group_by(year, month, day) %&gt;%<br>  summarise(total_24 = <span class="hljs-built_in">sum</span>(dep_delay, na.rm = <span class="hljs-literal">TRUE</span>) + <span class="hljs-built_in">sum</span>(arr_delay, na.rm = <span class="hljs-literal">TRUE</span>)) %&gt;%<br>  mutate(total_48 = total_24 + lag(total_24)) %&gt;%<br>  arrange(desc(total_48))<br></code></pre></td></tr></table></figure><h2 id="Bio-Computational-course"><a href="#Bio-Computational-course" class="headerlink" title="Bio-Computational course"></a>Bio-Computational course</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># boxplot </span><br>boxplot(count ~ spray, data = InsectSprays, col = <span class="hljs-string">&quot;bisque&quot;</span>)<br><br><span class="hljs-comment"># 扰动图</span><br>library(ggplot2)<br>ggplot(data = ToothGrowth,aes(x = dose, y = len, fill = supp)) +<br>  geom_boxplot() +<br>  geom_point(position = position_jitterdodge())<br><br><span class="hljs-comment"># 无重复样本：MAplot</span><br><span class="hljs-comment"># define ma_plot function</span><br>ma_plot &lt;- <span class="hljs-keyword">function</span>(dat)&#123;<br>  df &lt;- data.frame(a=dat[,<span class="hljs-number">1</span>],b=dat[,<span class="hljs-number">1</span>],<span class="hljs-built_in">c</span>=dat[,<span class="hljs-number">1</span>])<br>  <span class="hljs-comment"># transform data and add the pvalue</span><br>  log_condition1 &lt;- <span class="hljs-built_in">log</span>(dat[,<span class="hljs-number">1</span>]);<br>  log_condition2 &lt;- <span class="hljs-built_in">log</span>(dat[,<span class="hljs-number">2</span>])<br>  df[,<span class="hljs-number">1</span>] &lt;- (log_condition1 + log_condition2)/<span class="hljs-number">2</span><br>  df[,<span class="hljs-number">2</span>] &lt;- (log_condition1 - log_condition2)<br>  df[,<span class="hljs-number">3</span>] &lt;- (log_condition1 - log_condition2)<br>  <br>  colnames(df) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;AveExpr&quot;</span>,<span class="hljs-string">&quot;logFC&quot;</span>,<span class="hljs-string">&quot;pvalue&quot;</span>)<br>  <span class="hljs-comment">#p &lt;- ggplot(data = df,aes(x=AveExpr, y=logFC))</span><br>  p &lt;- ggplot(data = df,aes(x=AveExpr, y=logFC, colour=pvalue))<br>  p &lt;- p + geom_point(alpha = <span class="hljs-number">0.4</span>, size = <span class="hljs-number">1</span>) + theme_classic() + theme(aspect.ratio = <span class="hljs-number">1</span>) +<br>    geom_hline(aes(yintercept = <span class="hljs-number">0</span>),color = <span class="hljs-string">&quot;black&quot;</span>,size = <span class="hljs-number">0.3</span> ,alpha = <span class="hljs-number">0.6</span>) +<br>    geom_hline(aes(yintercept = -<span class="hljs-number">1</span>),color = <span class="hljs-string">&quot;greenyellow&quot;</span>,size = <span class="hljs-number">0.5</span> ,alpha = <span class="hljs-number">0.8</span>) +<br>    geom_hline(aes(yintercept = <span class="hljs-number">1</span>),color = <span class="hljs-string">&quot;greenyellow&quot;</span>,size = <span class="hljs-number">0.5</span> ,alpha = <span class="hljs-number">0.8</span>) +<br>    labs(x = <span class="hljs-string">&quot;Mean expression&quot;</span>, y = <span class="hljs-string">&quot;Log2 Fold Change&quot;</span>) +<br>    scale_colour_gradientn(colors = rev(<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;darkblue&quot;</span>,<span class="hljs-string">&quot;dodgerblue&quot;</span>,<span class="hljs-string">&quot;white&quot;</span>,<span class="hljs-string">&quot;orange&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>)))<br>  print(p)<br>  <span class="hljs-built_in">return</span>(df)<br>&#125;<br><span class="hljs-comment"># 读入数据</span><br>ori_dat &lt;- read.delim(<span class="hljs-string">&quot;/Users/keqinliu/MAP_testing.tsv&quot;</span>); <span class="hljs-comment">#read.delim()</span><br><span class="hljs-comment"># R最基本的数据结构是data.frame</span><br>dat &lt;- data.frame(condition1 = ori_dat[,<span class="hljs-number">2</span>],condition2 = ori_dat[,<span class="hljs-number">3</span>])<br>rownames(dat) &lt;- ori_dat[,<span class="hljs-number">1</span>]<br>res &lt;- ma_plot(dat)<br><span class="hljs-comment"># finding the most signaficant genes</span><br>rownames(res) &lt;- rownames(dat)<br>head( res[order(<span class="hljs-built_in">abs</span>( res$logFC) ,decreasing = <span class="hljs-built_in">T</span>),] )<br><br><span class="hljs-comment"># 1st kind: fold-change </span><br>e &lt;- <span class="hljs-built_in">log</span>(dat[,<span class="hljs-number">1</span>]);b &lt;- <span class="hljs-built_in">log</span>(dat[,<span class="hljs-number">2</span>]);<br>dat[,<span class="hljs-number">3</span>] &lt;- (e - b) / <span class="hljs-built_in">min</span>(e,b)<br>colnames(dat)[<span class="hljs-number">3</span>] &lt;- <span class="hljs-string">&quot;FC&quot;</span><br>head( dat[order(<span class="hljs-built_in">abs</span>( dat$FC) ,decreasing = <span class="hljs-built_in">T</span>),] )<br><span class="hljs-comment"># calculate p-value and draw hist plot</span><br>value &lt;- dat$FC<br>summary(value) <span class="hljs-comment">#基于当前假设，得到比当前统计量更极端的值的概率</span><br>hist(value[<span class="hljs-number">1</span>:<span class="hljs-number">100</span>])<br><br><span class="hljs-comment"># </span><br>ori_dat &lt;- read.delim(<span class="hljs-string">&quot;/Users/keqinliu/GDS2676.rnaExp&quot;</span>);<br>sampleInfor &lt;- read.delim(<span class="hljs-string">&quot;/Users/keqinliu/sampleInfor.txt&quot;</span>,header = <span class="hljs-built_in">F</span>);<br>condition1 &lt;- sampleInfor[,<span class="hljs-number">1</span>]<br>condition2 &lt;- setdiff(colnames(ori_dat),condition1)<br>condition2 &lt;- setdiff(condition2,<span class="hljs-string">&quot;GENE&quot;</span>)<br>ori_dat$logFC &lt;- 1<br>ori_dat$Pvalue &lt;- 1<br><span class="hljs-comment">#这里用for循环，没有用apply</span><br><span class="hljs-comment">#增加可读性，实际使用的时候用apply</span><br><span class="hljs-comment">#i &lt;- 1</span><br><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(ori_dat)) &#123;<br>  v1 &lt;- <span class="hljs-built_in">as.numeric</span>(ori_dat[i,condition1])<br>  v2 &lt;- <span class="hljs-built_in">as.numeric</span>(ori_dat[i,condition2])<br>  tmp_log1 &lt;- <span class="hljs-built_in">log</span>( mean(v1) );<br>  tmp_log2 &lt;- <span class="hljs-built_in">log</span>( mean(v2) )<br>  ori_dat[i,<span class="hljs-string">&quot;logFC&quot;</span>] &lt;- (tmp_log1 - tmp_log2) / <span class="hljs-built_in">min</span>(tmp_log1,tmp_log2)<br>  ori_dat[i,<span class="hljs-string">&quot;Pvalue&quot;</span>] &lt;- wilcox.test(v1,v2)$p.value;<br>&#125;<br><span class="hljs-comment"># y is -log_pvalue</span><br><span class="hljs-comment"># x is logFC</span><br>plot(ori_dat$logFC,-log10( ori_dat$Pvalue ))<br><span class="hljs-comment">#删除异常值</span><br>toRemove &lt;- which(ori_dat$logFC &lt; -<span class="hljs-number">1000</span>)<br>ori_dat &lt;- ori_dat[-toRemove,]<br>plot(ori_dat$logFC,-log10( ori_dat$Pvalue ))<br></code></pre></td></tr></table></figure><h2 id="compare-distrubition-by-t-test"><a href="#compare-distrubition-by-t-test" class="headerlink" title="compare distrubition by t test"></a>compare distrubition by t test</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># use t_test to compare distribution</span><br>gene_data=read.csv(<span class="hljs-string">&quot;gene_exp_exampple/gene_expression_data.csv&quot;</span>)<br><span class="hljs-built_in">dim</span>(gene_data)<br>summary(gene_data)<br>head(gene_data)<br>count_cell_type=table(gene_data[,<span class="hljs-string">&quot;cell_type&quot;</span>])<br>count_cell_type<br><span class="hljs-comment"># check the data</span><br><br>geneB_data &lt;- gene_data[,<span class="hljs-string">&quot;geneB&quot;</span>] <span class="hljs-comment"># substting geneB</span><br>geneA_data &lt;- gene_data[,<span class="hljs-string">&quot;geneA&quot;</span>] <span class="hljs-comment"># substting geneA</span><br>cell_type_data &lt;- gene_data[,<span class="hljs-string">&quot;cell_type&quot;</span>] <span class="hljs-comment"># substting cell_type_data</span><br><br><span class="hljs-comment"># substting geneA with different cells</span><br>bloodcells_geneA_data &lt;- geneA_data[cell_type_data==<span class="hljs-string">&quot;BLOOD.CELLS&quot;</span>]<br>fibroblasts_geneA_data &lt;- geneA_data[cell_type_data==<span class="hljs-string">&quot;FIBROBLASTS&quot;</span>]<br>ipsc_geneA_data &lt;- geneA_data[cell_type_data==<span class="hljs-string">&#x27;IPSC&#x27;</span>]<br><br><span class="hljs-comment"># substting geneB with different cells</span><br>bloodcells_geneB_data &lt;- geneB_data[cell_type_data==<span class="hljs-string">&quot;BLOOD.CELLS&quot;</span>]<br>fibroblasts_geneB_data &lt;- geneB_data[cell_type_data==<span class="hljs-string">&quot;FIBROBLASTS&quot;</span>]<br>ipsc_geneB_data &lt;- geneB_data[cell_type_data==<span class="hljs-string">&#x27;IPSC&#x27;</span>]<br><br><span class="hljs-comment"># run the t-test (geneA)</span><br>res_bloodcells_fibroblasts_geneA &lt;- t.test(bloodcells_geneA_data, fibroblasts_geneA_data)<br>res_bloodcells_ipsc_geneA &lt;- t.test(bloodcells_geneA_data, ipsc_geneA_data)<br>res_fibroblasts_ipsc_geneA &lt;- t.test(fibroblasts_geneB_data, ipsc_geneB_data)<br>res_bloodcells_fibroblasts_geneA<br>res_bloodcells_ipsc_geneA<br>res_bloodcells_fibroblasts_geneA<br><br><span class="hljs-comment"># show the important statistic factors in the t-test(in this case we use res_bloodcells_fibroblasts_geneA as example)</span><br>res_bloodcells_fibroblasts_geneA[<span class="hljs-string">&quot;statistic&quot;</span>] <span class="hljs-comment"># show t value</span><br>res_bloodcells_fibroblasts_geneA[<span class="hljs-string">&quot;p.value&quot;</span>] <span class="hljs-comment"># show p value</span><br><span class="hljs-comment"># how to analyze the result?</span><br><span class="hljs-comment"># the larger the t value is, the more different the 2 groups are</span><br><span class="hljs-comment"># For the p-value, given an interval of confidence of 95% and an alternative hypothesis </span><br><span class="hljs-comment"># that the 2 groups have different mean distributions, </span><br><span class="hljs-comment"># a p-value &lt; 0.05 tells us that this difference did not occur by chance and that, therefore, this difference is significant.</span><br></code></pre></td></tr></table></figure><h2 id="RNA-Seq"><a href="#RNA-Seq" class="headerlink" title="RNA-Seq"></a>RNA-Seq</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># Weil Cornell Medical School</span><br><span class="hljs-comment"># RNA-seq Analysis Workshop Course Materials</span><br><span class="hljs-comment"># Normalizing and Transforming read counts </span><br>read.counts &lt;- read.table(<span class="hljs-string">&quot;/Users/keqinliu/studying_document/bioinfo/R_project/RNA_SEQ/featureCounts_result.txt&quot;</span>, header=<span class="hljs-literal">TRUE</span>)<br><span class="hljs-comment"># get the table of read counts by indicating the path to the file</span><br>row.names(read.counts) &lt;- read.counts$Geneid<br><span class="hljs-comment"># correspond to the gene ID and the col.names to the sample names</span><br>read.counts &lt;- read.counts[ , -<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>)]<br><span class="hljs-comment"># exclude all the columns that do not contain read counts</span><br>orig_names &lt;- <span class="hljs-built_in">names</span>(read.counts)<br><span class="hljs-comment"># assign the sample names</span><br><span class="hljs-built_in">names</span>(read.counts) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNF2_1&quot;</span>, <span class="hljs-string">&quot;SNF2_2&quot;</span>, <span class="hljs-string">&quot;WT_1&quot;</span>, <span class="hljs-string">&quot;WT_2&quot;</span>)<br><span class="hljs-built_in">names</span>(read.counts) &lt;- gsub(<span class="hljs-string">&quot;.*(WT|SNF2)(_[0-2]+).*&quot;</span>,<span class="hljs-string">&quot;\\1\\2&quot;</span>,orig_names)<br><span class="hljs-comment"># check data</span><br>str(read.counts)<br>head(read.counts)<br><br><span class="hljs-comment"># make a data.frame with meta-data where row.names should match the individual sample names</span><br>sample_info &lt;- data.frame(condition = gsub(<span class="hljs-string">&quot;_[0-2]+&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-built_in">names</span>(read.counts)), row.names=<span class="hljs-built_in">names</span>(read.counts))<br>sample_info<br><br>library(DESeq2)<br>DESeq.ds &lt;- DESeqDataSetFromMatrix(countData = read.counts, colData = sample_info, design = ~ condition)<br><span class="hljs-comment"># generate the DESeqDataSet</span><br><br><span class="hljs-comment"># check the result by using the accessors described above (these 3 comand will return 3 table result)</span><br>colData(DESeq.ds) %&gt;% head<br>assay(DESeq.ds, <span class="hljs-string">&quot;counts&quot;</span>) %&gt;% head<br>rowData(DESeq.ds) %&gt;% head<br><br>counts(DESeq.ds) %&gt;% str <span class="hljs-comment">#test what counts returns</span><br><br>DESeq.ds &lt;- DESeq.ds[ rowSums(counts(DESeq.ds)) &gt; <span class="hljs-number">0</span>, ] <span class="hljs-comment"># remove genes without any counts</span><br>colSums(counts(DESeq.ds)) <span class="hljs-comment"># investigate different library sizes</span><br><span class="hljs-comment"># should be as same as colSums(read.counts)</span><br>colSums(read.counts)<br><br><span class="hljs-comment"># DESeq2&#x27;s default method can normalize read counts </span><br><span class="hljs-comment"># to account for differences in sequencing depths  is implementeds in estimateSizeFactors() </span><br><span class="hljs-comment"># calculate the size factor and add it to the data set</span><br>DESeq.ds &lt;- estimateSizeFactors(DESeq.ds)<br>sizeFactors(DESeq.ds)<br>colData(DESeq.ds) <span class="hljs-comment"># check colData(DESeq.ds) and find that this now contain the sizeFactors</span><br><br><span class="hljs-comment"># use counts to retrieve the normalized_read_counts</span><br>counts.sf_normalized &lt;- counts(DESeq.ds, normalized = <span class="hljs-literal">TRUE</span>)<br><br>counts(DESeq.ds)[<span class="hljs-number">1</span>,] <span class="hljs-comment"># use counts to check DESeq.ds </span><br><br><span class="hljs-comment"># transformation of sequencing-depth-normalized read counts</span><br><span class="hljs-comment"># if the read counts are transformed to the log scale following normalization</span><br><span class="hljs-comment"># many down-stream analyses(including clustering) will work much better</span><br><span class="hljs-comment"># because the relatively large dynamic range of expression values that RNA-Seq data can cover</span><br><span class="hljs-comment"># compared to log10, log2 are more commonly used</span><br><br><span class="hljs-comment"># log2 transformation of read counts</span><br>log.norm.counts &lt;- log2(counts.sf_normalized + <span class="hljs-number">1</span>)<br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>), cex.axis=<span class="hljs-number">0.75</span>) <span class="hljs-comment"># draw the following 2 images</span><br>boxplot(counts.sf_normalized, norch=<span class="hljs-literal">TRUE</span>, <br>        main=<span class="hljs-string">&quot;untransformed read counts&quot;</span>,<br>        ylab = <span class="hljs-string">&quot;read counts&quot;</span>)<br>boxplot(log.norm.counts, norch=<span class="hljs-literal">TRUE</span>,<br>        main=<span class="hljs-string">&quot;transformed read counts&quot;</span>,<br>        ylab = <span class="hljs-string">&quot;log2 read counts&quot;</span>)<br><span class="hljs-comment"># if don&#x27;t decrease font size, SNF2_2 won&#x27;t show out</span><br><br><span class="hljs-comment"># Visually exploring normalized read counts</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>), cex.axis=<span class="hljs-number">0.75</span>)<br>plot(log.norm.counts[,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>], cex=<span class="hljs-number">.1</span>, main=<span class="hljs-string">&quot;Normalized log2(read counts)&quot;</span>)<br>plot(log.norm.counts[,<span class="hljs-number">3</span>:<span class="hljs-number">4</span>], cex=<span class="hljs-number">.1</span>, main=<span class="hljs-string">&quot;Normalized log2(read counts)&quot;</span>)<br><br><span class="hljs-comment"># Visually check for heteroskedasticity: </span><br><span class="hljs-comment"># to plot the mean vs the standard deviation</span><br>library(vsn)<br>library(ggplot2)<br>msd_plot &lt;- meanSdPlot(log.norm.counts, ranks = <span class="hljs-literal">FALSE</span>, plot = <span class="hljs-literal">FALSE</span>)<br>msd_plot$gg +<br>  ggtitle(<span class="hljs-string">&quot;sequencing depth normalized log2(read counts)&quot;</span>) +<br>  ylab(<span class="hljs-string">&quot;standard deviation&quot;</span>)<br><br><span class="hljs-comment"># transformation of read counts including variance shrinkage</span><br><span class="hljs-comment"># obtain regularized log-transformed values</span><br>DESeq.rlog &lt;- rlog(DESeq.ds, blind=<span class="hljs-literal">TRUE</span>)<br>rlog.norm.counts &lt;- assay(DESeq.rlog)<br><br><span class="hljs-comment"># mean-sd plot for rlog-transformed data</span><br>msd_plot &lt;- meanSdPlot(rlog.norm.counts,<br>                       ranks = <span class="hljs-literal">FALSE</span>,<br>                       plot = <span class="hljs-literal">FALSE</span>)<br>msd_plot$gg + <br>  ggtitle(<span class="hljs-string">&quot;rlog-transformed read counts&quot;</span>) +<br>  ylab(<span class="hljs-string">&quot;standard deviation&quot;</span>)<br><br><span class="hljs-comment"># use cor() to calculate the correlation between columns of a matrix</span><br>distance.m_rlog &lt;- as.dist(<span class="hljs-number">1</span> - cor(rlog.norm.counts, method = <span class="hljs-string">&quot;pearson&quot;</span>))<br><br><span class="hljs-comment"># use plot() to interprete the output of the hclust</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>), cex.axis=<span class="hljs-number">0.75</span>)<br>plot( hclust(distance.m_rlog))<br>labels = colnames(rlog.norm.counts),<br>main = <span class="hljs-string">&quot;rlog transformed read counts/ndistance: Pearson Correlation&quot;</span><br><br><span class="hljs-comment"># PCA by prcomp and plot</span><br>pc &lt;- prcomp(t(rlog.norm.counts))<br>plot(pc$x[,<span class="hljs-number">1</span>], pc$x[,<span class="hljs-number">2</span>],<br>     col = colData(DESeq.ds)[,<span class="hljs-number">1</span>],<br>     main = <span class="hljs-string">&quot;PCA of seq.depth normalized/n and rlog-transformed read counts&quot;</span><br>     )<br><br><span class="hljs-comment"># PCA by DESeq2</span><br><span class="hljs-comment"># use plotPCA</span><br>library(DESeq2)<br>library(ggplot2)<br>p &lt;- plotPCA(DESeq.rlog)<br>P &lt;- P + theme_bw() + ggtitle(<span class="hljs-string">&quot;Rlog transformed counts&quot;</span>)<br>print(p)<br><br><span class="hljs-comment"># DGE</span><br><span class="hljs-comment"># if duplication &lt; 12, we suggest edgeR</span><br><span class="hljs-comment"># if duplication &gt; 12, we suggest DESeq and Limma-voom, they tend to be more conservative than edgeR</span><br><span class="hljs-comment"># in this case we use DESeq2(because I don&#x27;t know how to use edgeR)</span><br>library(DESeq2)<br><span class="hljs-comment"># DESeq2 uses the levels of condition to determine the order of the comparison</span><br>str(colData(DESeq.ds)$condition)<br>colData(DESeq.ds)$condition &lt;- relevel(colData(DESeq.ds)$condition, <span class="hljs-string">&quot;WT&quot;</span>) <span class="hljs-comment"># set WT as the first level condition</span><br>DESeq.ds &lt;- DESeq(DESeq.ds)  <span class="hljs-comment"># run DESeq</span><br><br><span class="hljs-comment"># check DGE result</span><br>DGE_results &lt;- results(DESeq.ds, independentFiltering = <span class="hljs-literal">TRUE</span>, alpha = <span class="hljs-number">0.05</span>)<br>summary(DGE_results)<br>head(DGE_results)<br>table(DGE_results$padj &lt; <span class="hljs-number">0.05</span>)<br>rownames(subset(DGE_results, padj &lt; <span class="hljs-number">0.05</span>))<br><br><span class="hljs-comment"># exploring plots following DGE analysis</span><br><span class="hljs-comment"># Histogram </span><br><span class="hljs-comment"># use hist function</span><br>hist(DGE_results$pvalue,<br>     col = <span class="hljs-string">&quot;purple&quot;</span>, border = <span class="hljs-string">&quot;white&quot;</span>, xlab = <span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;&quot;</span>,<br>     main = <span class="hljs-string">&quot;Frequencies of p-values&quot;</span>)<br><br><span class="hljs-comment"># MA plot</span><br><span class="hljs-comment"># use plotMA function</span><br>plotMA(DGE_results, alpha = <span class="hljs-number">0.05</span>, main = <span class="hljs-string">&quot;WT vs SNF2 mutants&quot;</span>,<br>       ylim = <span class="hljs-built_in">c</span>(-<span class="hljs-number">4</span>,<span class="hljs-number">4</span>))<br>       <br><span class="hljs-comment"># Heatmap</span><br><span class="hljs-comment"># use aheatmap function in NMF package </span><br>library(NMF)<br>DGE.results.sorted &lt;- DGE_results[order(DGE_results$padj), ] <span class="hljs-comment"># sort the results by p-value</span><br>DGEgenes &lt;- rownames(subset(DGE.results.sorted, padj &lt; <span class="hljs-number">0.05</span>)) <span class="hljs-comment"># identify genes with the desired adjusted p-value cut-off</span><br>hm.mat_DGEgenes &lt;- log.norm.counts[DGEgenes, ] <span class="hljs-comment"># extract normalized read counts for DE genes into a matrix</span><br><span class="hljs-comment"># found porblems: if you try to draw these 3 plot together</span><br><span class="hljs-comment"># you will get an error:</span><br><span class="hljs-comment"># Error in gridPLT() : Figure region too small and/or viewport too large</span><br><span class="hljs-comment"># solusion: save each one as pdf or png(pdf will be more clear than png)</span><br>pdf(<span class="hljs-string">&quot;heatmap1.pdf&quot;</span>)<br>aheatmap(hm.mat_DGEgenes, Rowv = <span class="hljs-literal">NA</span>, Colv = <span class="hljs-literal">NA</span>) <span class="hljs-comment"># plot normalized read counts of DE genes sorted by the adjusted p-value</span><br>dev.off()<br><br>png(<span class="hljs-string">&quot;heatmap2.png&quot;</span>)<br>aheatmap(hm.mat_DGEgenes, <br>         Rowv = <span class="hljs-literal">TRUE</span>, Colv = <span class="hljs-literal">TRUE</span>,<br>         distfun = <span class="hljs-string">&quot;euclidean&quot;</span>, hclustfun = <span class="hljs-string">&quot;average&quot;</span>) <span class="hljs-comment"># combine the heatmap with hierarchichal clustering</span><br>dev.off()<br><br>pdf(<span class="hljs-string">&quot;heatmap3.pdf&quot;</span>)<br>aheatmap(hm.mat_DGEgenes,<br>         Rowv = <span class="hljs-literal">TRUE</span>, Colv = <span class="hljs-literal">TRUE</span>,<br>         distfun = <span class="hljs-string">&quot;euclidean&quot;</span>, hclustfun = <span class="hljs-string">&quot;average&quot;</span>, <span class="hljs-comment"># scale the read counts per gene to emphasize the sample-type-specific difference</span><br>         scale = <span class="hljs-string">&quot;row&quot;</span>)<br>dev.off()<br><br><br><span class="hljs-comment"># read counts of single gene</span><br>library(org.Sc.sgd.db)<br>keytypes(org.Sc.sgd.db) <span class="hljs-comment"># list all the types of keywords that are avilable to query the annotation database</span><br>columns(org.Sc.sgd.db) <span class="hljs-comment"># list columns that can be retrieved from the annotation database</span><br>anno &lt;- select(org.Sc.sgd.db, <span class="hljs-comment"># make a batch retriveval for all gene</span><br>               keys = DGEgenes,<br>               keytype = <span class="hljs-string">&quot;ORF&quot;</span>,<br>               columns = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SGD&quot;</span>, <span class="hljs-string">&quot;GENENAME&quot;</span>, <span class="hljs-string">&quot;CHR&quot;</span>))<br>DGE.results.sorted_logFC &lt;- DGE_results[order(DGE_results$log2FoldChange), ] <span class="hljs-comment"># check </span><br><span class="hljs-comment"># whether SNF2 pops up among the top downregulated genes(in this case SNF2 is the goal gene)</span><br>DGEgenes_logFC &lt;- rownames(subset(DGE.results.sorted_logFC, padj &lt; <span class="hljs-number">0.05</span>))<br>head(anno[match(DGEgenes_logFC, anno$ORF), ])<br><br><span class="hljs-comment"># find the corresponding to SNF2</span><br>subset(anno, GENENAME == <span class="hljs-string">&quot;SNF2&quot;</span>)<br><br><span class="hljs-comment"># DESeq2 offers a wrapper function to plot read counts for single genes</span><br>library(grDevices)<br>plotCounts(dds = DESeq.ds,<br>           gene = <span class="hljs-string">&quot;YOR290C&quot;</span>,<br>           normalized = <span class="hljs-literal">TRUE</span>, transform = <span class="hljs-literal">FALSE</span>,<br>           main = <span class="hljs-built_in">expression</span>( atop(<span class="hljs-string">&quot;Expression of &quot;</span>*italic(<span class="hljs-string">&quot;snf2&quot;</span>), <span class="hljs-string">&quot;(YOR290C)&quot;</span>)))<br>out.df &lt;- merge(as.data.frame(DGE_results), anno,<br>                by.x = <span class="hljs-string">&quot;row.names&quot;</span>, by,y = <span class="hljs-string">&quot;ORF&quot;</span>) <span class="hljs-comment"># get an error:</span><br><span class="hljs-comment"># Error in as.vector(x, mode) : cannot coerce type &#x27;closure&#x27; to vector of type &#x27;any&#x27;</span><br><br><span class="hljs-comment"># use degeR to get DGE results</span><br>library(edgeR)<br>sample_info.edger &lt;- factor(<span class="hljs-built_in">c</span>( <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;SNF2&quot;</span>, <span class="hljs-number">2</span>), <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;WT&quot;</span>, <span class="hljs-number">2</span>)))<br>sample_info.edger &lt;- relevel(sample_info.edger, ref = <span class="hljs-string">&quot;WT&quot;</span>)<br>edgeR.DGElist &lt;- DGEList(counts = read.counts, group = sample_info.edger)<br>head(edgeR.DGElist$counts) <span class="hljs-comment"># check edgeR.DGElist</span><br>edgeR.DGElist$samples<br><span class="hljs-comment"># keep &lt;- rowSums( cpm(edgeR.DGElist) &gt;= 1) &gt;= 5 </span><br><span class="hljs-comment"># remove genes that do not have one count per million in at least 5 samples </span><br><span class="hljs-comment"># edgeR.DGElist &lt;- edgeR.DGElist[keep, ]</span><br><br><span class="hljs-comment"># recompute library sizes after filtering （error: lib turns to be 0)</span><br><span class="hljs-comment"># edgeR.DGElist$samples$lib.size &lt;- colSums(edgeR.DGElist$counts)</span><br><span class="hljs-comment"># head(edgeR.DGElist$samples)</span><br><br>edgeR.DGElist &lt;- calcNormFactors(edgeR.DGElist, method = <span class="hljs-string">&quot;TMM&quot;</span>) <span class="hljs-comment">#calculate normalizztion factor for the library size</span><br>edgeR.DGElist$samples<br><br>design &lt;- model.matrix(~sample_info.edger)<br>edgeR.DGElist &lt;- estimateDisp(edgeR.DGElist, design) <span class="hljs-comment">#估计所有样本中所有读取计数的离散度</span><br>edger_fit &lt;- glmFit(edgeR.DGElist, design) <span class="hljs-comment">#拟合负二项模型</span><br>edger_lrt &lt;- glmLRT(edger_fit) <span class="hljs-comment">#使用负数对每个基因进行测试，二项式模型</span><br>DGE_results_edgeR &lt;- topTags(edger_lrt, n=<span class="hljs-literal">Inf</span>, <br>                             sort.by = <span class="hljs-string">&quot;PValue&quot;</span>, adjust.method = <span class="hljs-string">&quot;BH&quot;</span>) <span class="hljs-comment">#从edger_lrt表中提取结果和过滤后的p-values</span><br><br><br><span class="hljs-comment"># use Limma to get DGE results</span><br>library(limma)<br>design &lt;- model.matrix(~sample_info.edger) <br>rownames(design) &lt;- colnames(edgeR.DGElist)<br>voomTransformed &lt;- voom(edgeR.DGElist, design, plot = <span class="hljs-literal">FALSE</span>)<br>voomed.fitted &lt;- lmFit(voomTransformed, design = design) <span class="hljs-comment">#为每个基因拟合线性模型</span><br>voomed.fitted &lt;- eBayes(voomed.fitted) <span class="hljs-comment">#计算t和F，</span><br>colnames(design) <span class="hljs-comment">#通过logFC和统计学特征量提取基因列表</span><br>DGE_results_limma &lt;- topTable(voomed.fitted, coef = <span class="hljs-string">&quot;sample_info.edgerSNF2&quot;</span>,<br>                              number = <span class="hljs-literal">Inf</span>, adjust.method = <span class="hljs-string">&quot;BH&quot;</span>,<br>                              sort.by = <span class="hljs-string">&quot;logFC&quot;</span>)<br><br><span class="hljs-comment"># check your DGE result</span><br><span class="hljs-comment"># 3 method: DESeq2, edgeR and limma all need to be compare to each other</span><br>pdf(<span class="hljs-string">&quot;venn.pdf&quot;</span>)<br>DE_list &lt;- <span class="hljs-built_in">list</span>(deseq2 = rownames(subset(DGE_results, padj &lt;= <span class="hljs-number">0.05</span> )),<br>                edger = rownames(subset(DGE_results_edgeR$table, FDR &lt;= <span class="hljs-number">0.05</span>)),<br>                limma = rownames(subset(DGE_results_limma, adj.P.Val &lt;= <span class="hljs-number">0.05</span>)))<br>gplots::venn(DE_list)<br>dev.off()  <span class="hljs-comment">#画出DESeq2，edgeR和limma的韦恩图</span><br><br><span class="hljs-comment"># 当有3个以上的列表时，需要用比韦恩图更复杂的表示方法</span><br>DE_gns &lt;- UpSetR::fromList(DE_list)<br>UpSetR::upset(DE_gns, order.by = <span class="hljs-string">&quot;freq&quot;</span>)<br><br><span class="hljs-comment"># 在3个方法中寻找logFC的相关性</span><br>DE_gns_all &lt;- row.names(DE_gns[rowSums(DE_gns) == <span class="hljs-number">3</span>,])<br>DE_fc &lt;- data.frame(edger = DGE_results_edgeR[DE_gns_all,]$table$logFC,<br>                    limma = DGE_results_limma[DE_gns_all,]$logFC,<br>                    deseq2 = DGE_results[DE_gns_all,]$log2FoldChange,<br>                    row.names = DE_gns_all)<br>pairs(DE_fc)<br>pheatmap::pheatmap( as.matrix(DE_fc) )<br><span class="hljs-comment"># report error: Error in plot.window(...) : &#x27;xlim&#x27;值不能是无限的</span><br><span class="hljs-comment"># reprot error: Error in hclust(d, method = method) : 外接函数调用时不能有NA/NaN/Inf(arg10)</span><br><br><br><br><span class="hljs-comment"># Example downstream analyses</span><br><span class="hljs-comment"># use KEGG or GO</span><br></code></pre></td></tr></table></figure><h2 id="basic-analysis-of-gene-expression"><a href="#basic-analysis-of-gene-expression" class="headerlink" title="basic analysis of gene expression"></a>basic analysis of gene expression</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br></pre></td><td class="code"><pre><code class="hljs R">library(Biobase)<br>library(GEOquery)<br>library(limma)<br>library(mogene10sttranscriptcluster.db)<br>library(RColorBrewer)<br>library(gProfileR)<br>library(genefilter)<br>library(openxlsx)<br>library(piano)<br>library(gplots)<br>library(sva)<br>library(msigdbr)<br><br><span class="hljs-comment"># 1 download GEO data</span><br>GEO_List &lt;- getGEO(GEO = <span class="hljs-string">&#x27;GSE76999&#x27;</span>) <span class="hljs-comment">#get GEO data</span><br><span class="hljs-built_in">class</span>(GEO_List) <span class="hljs-comment">#get GEO_List type</span><br>View(GEO_List) <span class="hljs-comment">#see GEO_List</span><br><span class="hljs-built_in">length</span>(GEO_List) <span class="hljs-comment">#see GEO_List length</span><br><span class="hljs-built_in">names</span>(GEO_List)<br><br><span class="hljs-comment"># 1.1 see the data kind and labels</span><br>eset &lt;- GEO_List[[<span class="hljs-number">1</span>]] <span class="hljs-comment">#assign GEO_List into another variable</span><br>eset<br>varLabels(eset) <span class="hljs-comment">#to see labels kind of GEO_List</span><br>eset$title <span class="hljs-comment">#to see the names of experiment</span><br>eset$organism_ch1 <span class="hljs-comment">#to see the organism of experiment</span><br><br><span class="hljs-comment">#2 process the expression table for analysis</span><br>sel &lt;- 1:<span class="hljs-number">12</span> <span class="hljs-comment">#select the samples we need(the first 12)</span><br>eset &lt;- eset[ , sel]  <br>exprs(eset) &lt;- exprs(eset)[ ,sel] <span class="hljs-comment">#These generic functions access the expression and error measurements </span><br><span class="hljs-comment">#of assay data stored in an object derived from the eset class</span><br>labels &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;BM_MOs&quot;</span>, <span class="hljs-string">&quot;FL_MOs&quot;</span>, <span class="hljs-string">&quot;YS_Macs&quot;</span>) <span class="hljs-comment">#set labels</span><br>sel_groups &lt;- factor(<span class="hljs-built_in">rep</span>(labels, each=<span class="hljs-number">4</span>)) <span class="hljs-comment">#factor function uses for stroing class</span><br>palette(rainbow(<span class="hljs-number">12</span>)) <span class="hljs-comment">#palette default has 8 colors &quot;black&quot;   &quot;red&quot;     &quot;green3&quot;  &quot;blue&quot;    &quot;cyan&quot;    &quot;magenta&quot; &quot;yellow&quot; </span><br><span class="hljs-comment"># and  &quot;gray&quot; we can use number to get access to these colors. For example: palette(rainbow(12)) or palette(gray(c(0.1, 0.2, 0.3)))</span><br>boxplot(exprs(eset), col = sel_groups)<br>boxplot(exprs(eset), col = sel_groups, las=<span class="hljs-number">2</span>) <span class="hljs-comment"># las=2:rotate the labels of the boxplot</span><br>boxplot(exprs(eset), col = sel_groups, las=<span class="hljs-number">2</span>, cex.axis=<span class="hljs-number">0.7</span>) <span class="hljs-comment"># ces.axis:make labels smaller</span><br>boxplot(exprs(eset), col = sel_groups, las=<span class="hljs-number">2</span>, cex.axis=<span class="hljs-number">0.7</span>, boxwex=<span class="hljs-number">0.6</span>, outline=<span class="hljs-literal">FALSE</span>) <span class="hljs-comment"># boxwex=0.6, outline=FALSE:make bar thiner</span><br><span class="hljs-comment"># The boxplot indicates all samples have the similar distribution and are normalized.</span><br><br><span class="hljs-comment"># 2.1 get barplot more orderly(to make sure the data get normalized)</span><br><span class="hljs-comment"># normalize the data (if you need) </span><br>exprs_matrix.norm &lt;- normalizeBetweenArrays(exprs(eset)) <span class="hljs-comment"># normalizeBetweenArrays is a function in Limma</span><br>boxplot(exprs_matrix.norm, col=sel_groups, las=<span class="hljs-number">2</span>, cex.axis=<span class="hljs-number">0.7</span>, boxwex=<span class="hljs-number">0.6</span>, outline=<span class="hljs-literal">FALSE</span>)<br><span class="hljs-comment"># now you can get the barplot more orderly</span><br><br><span class="hljs-comment"># 3 differential expression analysis by Limma </span><br>ex &lt;- exprs(eset)<br>exprs(eset) &lt;- log2(ex) <span class="hljs-comment">#transform into log2 scale</span><br>eset$description &lt;- sel_groups <span class="hljs-comment"># replace the long description by short labels</span><br>design &lt;- model.matrix(~ description + <span class="hljs-number">0</span>, eset) <span class="hljs-comment"># model.matrix uses to create a matrix， </span><br><span class="hljs-comment"># Construct design matrices by model.matrix</span><br><span class="hljs-comment"># 0 defines the way we compare the samples</span><br>colnames(design) &lt;- levels(sel_groups)<br>eset$description <span class="hljs-comment"># to see the short new description of eset</span><br>design <span class="hljs-comment"># to see the design list</span><br><br><span class="hljs-comment"># 3.1 fit a liner model, perform differential analysis and estimate p-values</span><br>fit &lt;- lmFit(eset, design) <span class="hljs-comment"># fit a linear model for each gene given a series of arrays</span><br><span class="hljs-comment"># lmFit is the basic computing engines called by lm used to fit linear models</span><br>cont.matrix &lt;- makeContrasts(BM_MOs-FL_MOs, BM_MOs-YS_Macs, FL_MOs-YS_Macs, levels=design)<br><span class="hljs-comment"># build comparision and compute the statistics</span><br><span class="hljs-comment"># makeContrasts：Construct the contrast matrix corresponding to specified contrasts of a set of parameters.</span><br>fit2 &lt;- contrasts.fit(fit, cont.matrix)<br><span class="hljs-comment"># contrast.fit ：Compute Contrasts From Linear Model Fit</span><br>fit2 &lt;- eBayes(fit2, <span class="hljs-number">0.05</span>)<br><span class="hljs-comment"># eBayes ：Empirical Bayes Statistics For Differential Expression， </span><br><span class="hljs-comment"># Given a microarray linear model fit, compute moderated t-statistics, moderated F-statistic, and log-odds </span><br><span class="hljs-comment"># of differential expression by empirical Bayes moderation of the standard errors towards a common value.</span><br><br><span class="hljs-comment"># 3.2 Extract the sig. DE genes, coef number represents the order of column in cont.matrix:</span><br>de_genes_BM_MOs_FL_MOs &lt;- topTable(fit2, coef=<span class="hljs-number">1</span>, adjust=<span class="hljs-string">&quot;fdr&quot;</span>, p.value=<span class="hljs-number">0.05</span>, number=<span class="hljs-literal">Inf</span>)<br><span class="hljs-comment"># coef=1  BM_MOs-FL_MOs</span><br>de_genes_BM_MOs_YS_Macs &lt;- topTable(fit2, coef=<span class="hljs-number">2</span>, adjust=<span class="hljs-string">&quot;fdr&quot;</span>, p.value=<span class="hljs-number">0.05</span>, number=<span class="hljs-literal">Inf</span>)<br><span class="hljs-comment"># coef=2  BM_MOs-YS_Macs</span><br>de_genes_FL_MOs_YS_Macs &lt;- topTable(fit2, coef=<span class="hljs-number">3</span>, adjust=<span class="hljs-string">&quot;fdr&quot;</span>, p.value=<span class="hljs-number">0.05</span>, number=<span class="hljs-literal">Inf</span>)<br><span class="hljs-comment"># coef=3  FL_MOs-YS_Macs</span><br><span class="hljs-comment"># topTable: is the Table Of Top Genes From Linear Model Fit, </span><br><span class="hljs-comment"># it can Extract a table of the top-ranked genes from a linear model fit.</span><br>head(de_genes_BM_MOs_FL_MOs) <span class="hljs-comment"># show top de genes in BM_MOs vs FL_MOs comparirson</span><br>all_de_genes &lt;- topTable(fit2, adjust=<span class="hljs-string">&quot;fdr&quot;</span>, p.value=<span class="hljs-number">0.05</span>, number=<span class="hljs-literal">Inf</span>)<br>all_genes_BM_FOs_FL_MOs &lt;- topTable(fit2, coef=<span class="hljs-number">1</span>, adjust=<span class="hljs-string">&quot;fdr&quot;</span>, p.value=<span class="hljs-number">1</span>, number=<span class="hljs-literal">Inf</span>)<br><br><span class="hljs-comment"># 3.3 output de_genes list to excel list (and csv file)</span><br>wb &lt;- createWorkbook()<br><span class="hljs-comment"># create each sheet</span><br>addWorksheet(wb, <span class="hljs-string">&quot;de_genes_BM_MOs_FL_MOs&quot;</span>)<br>addWorksheet(wb, <span class="hljs-string">&quot;de_genes_BM_MOs_YS_Macs&quot;</span>)<br>addWorksheet(wb, <span class="hljs-string">&quot;de_genes_FL_MOs_YS_Macs&quot;</span>)<br><span class="hljs-comment"># write the data into each sheet</span><br>writeData(wb, <span class="hljs-string">&quot;de_genes_BM_MOs_FL_MOs&quot;</span>, de_genes_BM_MOs_FL_MOs, rowNames = <span class="hljs-literal">FALSE</span>)<br>writeData(wb, <span class="hljs-string">&quot;de_genes_BM_MOs_YS_Macs&quot;</span>, de_genes_BM_MOs_YS_Macs, rowNames = <span class="hljs-literal">FALSE</span>)<br>writeData(wb, <span class="hljs-string">&quot;de_genes_FL_MOs_YS_Macs&quot;</span>, de_genes_FL_MOs_YS_Macs, rowNames = <span class="hljs-literal">FALSE</span>)<br>saveWorkbook(wb, <span class="hljs-string">&quot;DE_genes_GSE76999.xlsx&quot;</span>, overwrite = <span class="hljs-literal">TRUE</span>)<br><span class="hljs-comment"># to save csv file</span><br>write.table(de_genes_BM_MOs_FL_MOs, file=<span class="hljs-string">&quot;de_genes_BM_MOs_FL_MOs.csv&quot;</span>, row.names=<span class="hljs-built_in">F</span>, sep=<span class="hljs-string">&quot;\t&quot;</span>)<br>write.table(de_genes_BM_MOs_YS_Macs, file=<span class="hljs-string">&quot;de_genes_BM_MOs_YS_Macs.csv&quot;</span>, row.names=<span class="hljs-built_in">F</span>, sep=<span class="hljs-string">&quot;\t&quot;</span>)<br>write.table(de_genes_FL_MOs_YS_Macs, file=<span class="hljs-string">&quot;de_genes_FL_MOs_YS_Macs.csv&quot;</span>, row.names=<span class="hljs-built_in">F</span>, sep=<span class="hljs-string">&quot;\t&quot;</span>)<br><br><span class="hljs-comment"># 3.4 get gene annotation(turn gene ID into gene name)</span><br><span class="hljs-comment"># you can get a particular R package to for this mapping task </span><br><span class="hljs-comment"># here we use pakcage mogene10sttranscriptcluster.db which corresponds the Affymetrix mouse genes 10 described in GSE76999</span><br>columns(mogene10sttranscriptcluster.db)<br><span class="hljs-comment"># mogene10sttranscriptcluster.db package contains the annotaion of Affymetrix mouse genes 10</span><br>ID &lt;- featureNames(eset) <span class="hljs-comment"># get all the probe ID in our ExpressionSet</span><br>tmp &lt;- select(mogene10sttranscriptcluster.db, ID, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SYMBOL&quot;</span>, <span class="hljs-string">&quot;ENTREZID&quot;</span>))<br><span class="hljs-comment"># insert a column for symbols which match the ID for each row</span><br>all_genes_BM_MOs_FL_MOs$ENTREZID &lt;- tmp$ENTREZID[match(all_genes_BM_MOs_FL_MOs$ID, tmp$PROBEID)]<br>all_de_genes$symbol &lt;- tmp$SYMBOL[match(all_de_genes$ID, tmp$PROBEID)]<br>de_genes_BM_MOs_FL_MOs$ENTREZID &lt;- tmp$ENTREZID[match(de_genes_BM_MOs_FL_MOs$ID, tmp$PROBEID)]<br>de_genes_BM_MOs_YS_Macs$ENTREZID &lt;- tmp$ENTREZID[match(de_genes_BM_MOs_YS_Macs$ID, tmp$PROBEID)]<br>de_genes_FL_MOs_YS_Macs$ENTREZID &lt;- tmp$ENTREZID[match(de_genes_FL_MOs_YS_Macs$ID, tmp$PROBEID)]<br><br><span class="hljs-comment"># 3.5 drawing MA plot and volcano plot</span><br><span class="hljs-comment"># drawing MA plot(BM_MOs - FL_MOs) By Limma build-in function</span><br>ma &lt;- fit2[,<span class="hljs-string">&quot;BM_MOs - FL_MOs&quot;</span>]<br>plotMA(ma)<br><span class="hljs-comment"># drawing volcano plot(BM_MOs-FL_MOs)</span><br>volcanoplot(fit2, coeff=<span class="hljs-number">1</span>, xlim=<span class="hljs-built_in">c</span>(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), col=<span class="hljs-string">&quot;gray&quot;</span>)<br>title(<span class="hljs-string">&quot;BM_MOs - FL_MOs&quot;</span>)<br><br><span class="hljs-comment"># drawing MA plot(BM_MOs-YS_Macs)</span><br>ma &lt;- fit2[,<span class="hljs-string">&quot;BM_MOs-YS_Macs&quot;</span>]<br>plotMA(ma)<br><span class="hljs-comment"># drawing volcano plot(BM_MOs-FL_MOs)</span><br>volcanoplot(fit2, coeff=<span class="hljs-number">2</span>, xlim=<span class="hljs-built_in">c</span>(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), col=<span class="hljs-string">&quot;gray&quot;</span>)<br>title(<span class="hljs-string">&quot;BM_MOs - FL_MOs&quot;</span>)<br><br><span class="hljs-comment"># drawing MA plot(FL_MOs-YS_Macs)</span><br>ma &lt;- fit2[,<span class="hljs-string">&quot;FL_MOs-YS_Macs&quot;</span>]<br>plotMA(ma)<br><span class="hljs-comment"># drawing volcano plot(FL_MOs-YS_Macs)</span><br>volcanoplot(fit2, coeff=<span class="hljs-number">3</span>, xlim=<span class="hljs-built_in">c</span>(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), col=<span class="hljs-string">&quot;gray&quot;</span>)<br>title(<span class="hljs-string">&quot;FL_MOs-YS_Macs&quot;</span>)<br><br><span class="hljs-comment"># how to read a MA plot?</span><br><span class="hljs-comment"># log-fold-change can be realized as expression difference. </span><br><span class="hljs-comment"># For example, BM_MOs - FL_MOs means (BM_MOs expression)/(FL_MOs expression), the ratio=0 means expression is equal,</span><br><span class="hljs-comment"># the ratio&gt;0 means (BM_MOs expression) is higher than (FL_MOs expression)</span><br><span class="hljs-comment"># the ratio&lt;0 meand (BM_MOs expression) is lower than (FL_MOs expression)</span><br><span class="hljs-comment"># average expression is the average expression of 2 cell types</span><br><span class="hljs-comment"># how to read a volcanoplot?</span><br><span class="hljs-comment"># -log10(P-value) can be realized as significance, the higher the significance is, the higher the -log10(P-value) is</span><br><span class="hljs-comment"># the log2-fold-change is as same as above </span><br><br><span class="hljs-comment"># 4 PCA Principle component analysis</span><br><span class="hljs-comment"># what is PCA</span><br><span class="hljs-comment"># Principal component analysis (PCA) is a mathematical algorithm </span><br><span class="hljs-comment"># that reduces the dimensionality of the data while retaining most of the variation in the data set1. </span><br><span class="hljs-comment"># It accomplishes this reduction by identifying directions, called principal components, </span><br><span class="hljs-comment"># along which the variation in the data is maximal. By using a few components, </span><br><span class="hljs-comment"># each sample can be represented by relatively few numbers instead of by values for thousands of variables. </span><br><span class="hljs-comment"># Samples can then be plotted, making it possible to visually assess similarities and differences </span><br><span class="hljs-comment"># between samples and determine whether samples can be grouped </span><br><span class="hljs-comment"># (see Nature Biotechnology 26, 303 - 304 (2008) “What is principal component analysis?”).</span><br>pca &lt;- prcomp(t(ex))<br><span class="hljs-comment"># Performs a principalcomponents analysis on the givendata matrix and returns the results as anobject of class prcomp.</span><br>plot(pca$x[, <span class="hljs-number">1</span>:<span class="hljs-number">2</span>], col=sel_groups, pch=<span class="hljs-number">19</span>)<br><span class="hljs-comment"># take pc1 and pc2 for the plot</span><br>legend(<span class="hljs-string">&#x27;topright&#x27;</span>, inset=<span class="hljs-number">.05</span>, labels, pch=<span class="hljs-number">19</span>, col=<span class="hljs-number">1</span>:<span class="hljs-number">3</span>, horiz=<span class="hljs-literal">TRUE</span>)<br><span class="hljs-comment"># include a legend for points</span><br><br><span class="hljs-comment"># 5 clustering by heatmap</span><br><span class="hljs-comment"># 5.1 filter ex by the list in all_de_genes</span><br>sel &lt;- match(all_de_genes$ID, rownames(ex))<br><span class="hljs-comment"># ex is the matrix for all the expression values</span><br><span class="hljs-comment"># all_de_genes is all the DE genes</span><br><span class="hljs-comment"># Get the index of DE genes in ex</span><br>sel_ex &lt;- ex[sel,]<br><span class="hljs-comment"># Select those rows only</span><br><br><span class="hljs-comment"># 5.2 create a few functions defining the use of Pearson correlation as a distance matrix and complete linkage for cluster</span><br>clust &lt;- <span class="hljs-keyword">function</span>(x) hclust(x, method=<span class="hljs-string">&quot;complete&quot;</span>)<br><span class="hljs-comment"># perfirm complete linkage clustering</span><br>dist &lt;- <span class="hljs-keyword">function</span>(x) as.dist((<span class="hljs-number">1</span>-cor(t(x)))/<span class="hljs-number">2</span>)<br><span class="hljs-comment"># use the inverse of correlation as distance</span><br>hmcol &lt;- rev(brewer.pal(<span class="hljs-number">11</span>, <span class="hljs-string">&quot;RdBu&quot;</span>))<br><br><span class="hljs-comment"># 5.3 drawing heatmap</span><br>View(sel_ex) <span class="hljs-comment">#find out that sel_ex has NA gene ID row title and 0 gene expression row </span><br>sel_ex_filter &lt;- sel_ex <span class="hljs-comment"># assign sel_ex to sel_ex_filter</span><br>sel_ex_no0 &lt;- sel_ex_filter[which(rowSums(sel_ex_filter==<span class="hljs-number">0</span>)==<span class="hljs-number">0</span>),] <br><span class="hljs-comment"># delete NA gene ID row title and 0 gene expression row from sel_ex_filter and assign to sel_ex_no0</span><br>sel_ex_no0 <span class="hljs-comment"># check sel_ex_no0</span><br>type(sel_ex_no0) <span class="hljs-comment"># check sel_ex_no0 type</span><br>hp &lt;- heatmap.2(sel_ex_no0, <span class="hljs-comment"># input matrix(sel_ex_no0), heatmap.2 only accept numeric matrix without NA/NaN/Inf(arg10)</span><br>                col=hmcol, <span class="hljs-comment"># define the customized colormap</span><br>                scale=<span class="hljs-string">&quot;row&quot;</span>, <span class="hljs-comment"># scale the values for each gene (row)</span><br>                labRow=<span class="hljs-built_in">F</span>, <span class="hljs-comment"># Not showing row labels</span><br>                density.info=<span class="hljs-string">&quot;none&quot;</span>, <span class="hljs-comment"># Not showing density info</span><br>                trace=<span class="hljs-string">&quot;none&quot;</span>, <span class="hljs-comment"># Not showing trace line</span><br>                margins = <span class="hljs-built_in">c</span>(<span class="hljs-number">8</span>,<span class="hljs-number">3</span>), <span class="hljs-comment"># modify the margin to fit the labels</span><br>                labCol = <span class="hljs-built_in">rep</span>(labels,each=<span class="hljs-number">4</span>), <span class="hljs-comment"># add the column labels</span><br>                <span class="hljs-comment"># define hierarchical clustering method</span><br>                hclust = clust,<br>                <span class="hljs-comment"># Using correlation coefficient for distance function</span><br>                distfun = dist<br>)<br><span class="hljs-comment"># what does z-score mean?</span><br><span class="hljs-comment"># z-score = 0 :equal to average expression</span><br><span class="hljs-comment"># z-score &gt; 0 :higher than average expression</span><br><span class="hljs-comment"># z-score &lt; 0: lower than average expression</span><br><br><br><span class="hljs-comment"># 5.4 get genes from clustering</span><br><span class="hljs-comment"># get the clusters from the dendrogram</span><br>hc &lt;- as.hclust(hp$rowDendrogram)<br><span class="hljs-comment"># Extract the hierarchical cluster from heatmap to class &quot;hclust&quot;</span><br>clusters &lt;- cutree(hc, k=<span class="hljs-number">5</span>) <span class="hljs-comment"># k is the argument used to cut a dendrogram tree into several groups</span><br><span class="hljs-comment"># in this case, we use k=5 because we want 5 groups</span><br><span class="hljs-comment"># Cut the tree by the dedired number of groups</span><br>clustered_genes &lt;- <span class="hljs-built_in">list</span>(all_de_genes$symbol[match(<span class="hljs-built_in">names</span>(clusters)[clusters==<span class="hljs-number">1</span>],all_de_genes$ID)],<br>                        all_de_genes$symbol[match(<span class="hljs-built_in">names</span>(clusters)[clusters==<span class="hljs-number">2</span>],all_de_genes$ID)],<br>                        all_de_genes$symbol[match(<span class="hljs-built_in">names</span>(clusters)[clusters==<span class="hljs-number">3</span>],all_de_genes$ID)],<br>                        all_de_genes$symbol[match(<span class="hljs-built_in">names</span>(clusters)[clusters==<span class="hljs-number">4</span>],all_de_genes$ID)],<br>                        all_de_genes$symbol[match(<span class="hljs-built_in">names</span>(clusters)[clusters==<span class="hljs-number">5</span>],all_de_genes$ID)])<br><span class="hljs-comment"># converting the ID into gene symbol into a list.</span><br>clustered_genes &lt;- <span class="hljs-built_in">list</span>(all_de_genes[<span class="hljs-built_in">names</span>(clusters[clusters==<span class="hljs-number">1</span>]),]$symbol,<br>                        all_de_genes[<span class="hljs-built_in">names</span>(clusters[clusters==<span class="hljs-number">2</span>]),]$symbol,<br>                        all_de_genes[<span class="hljs-built_in">names</span>(clusters[clusters==<span class="hljs-number">3</span>]),]$symbol,<br>                        all_de_genes[<span class="hljs-built_in">names</span>(clusters[clusters==<span class="hljs-number">4</span>]),]$symbol,<br>                        all_de_genes[<span class="hljs-built_in">names</span>(clusters[clusters==<span class="hljs-number">5</span>]),]$symbol)<br>wb &lt;- createWorkbook()<br>addWorksheet(wb, <span class="hljs-string">&quot;cluster 1&quot;</span>)<br>addWorksheet(wb, <span class="hljs-string">&quot;cluster 2&quot;</span>)<br>addWorksheet(wb, <span class="hljs-string">&quot;cluster 3&quot;</span>)<br>addWorksheet(wb, <span class="hljs-string">&quot;cluster 4&quot;</span>)<br>addWorksheet(wb, <span class="hljs-string">&quot;cluster 5&quot;</span>)<br>writeData(wb, <span class="hljs-string">&quot;cluster 1&quot;</span>, clustered_genes[[<span class="hljs-number">1</span>]], rowNames = <span class="hljs-literal">FALSE</span>)<br>writeData(wb, <span class="hljs-string">&quot;cluster 2&quot;</span>, clustered_genes[[<span class="hljs-number">2</span>]], rowNames = <span class="hljs-literal">FALSE</span>)<br>writeData(wb, <span class="hljs-string">&quot;cluster 3&quot;</span>, clustered_genes[[<span class="hljs-number">3</span>]], rowNames = <span class="hljs-literal">FALSE</span>)<br>writeData(wb, <span class="hljs-string">&quot;cluster 4&quot;</span>, clustered_genes[[<span class="hljs-number">4</span>]], rowNames = <span class="hljs-literal">FALSE</span>)<br>writeData(wb, <span class="hljs-string">&quot;cluster 5&quot;</span>, clustered_genes[[<span class="hljs-number">5</span>]], rowNames = <span class="hljs-literal">FALSE</span>)<br>saveWorkbook(wb, <span class="hljs-string">&quot;gene_clusters.xlsx&quot;</span>, overwrite = <span class="hljs-literal">TRUE</span>)<br><br><span class="hljs-comment"># 6 GO (Gene Ontology) Enrichment Analysis</span><br><span class="hljs-comment"># 6.1 we will look at genes up-regulated or down-regulated in the comparirsosn BM-MOs (G0) v.s. YS-Macs (G2).</span><br>go_enrich_up &lt;- gprofiler(as.vector(all_de_genes$symbol[all_de_genes$BM_MOs...YS_Macs &gt; <span class="hljs-number">0</span>]),<br>                          organism=<span class="hljs-string">&quot;mmusculus&quot;</span>)  <span class="hljs-comment">#up_regulated</span><br>go_enrich_down &lt;- gprofiler(as.vector(all_de_genes$symbol[all_de_genes$BM_MOs...YS_Macs &lt; <span class="hljs-number">0</span>]), <br>                          organism=<span class="hljs-string">&quot;mmusculus&quot;</span>)  <span class="hljs-comment">#down_regulated</span><br>View(go_enrich_up)<br>View(go_enrich_down)<br><span class="hljs-comment"># save result to excel file</span><br>wb &lt;- createWorkbook()<br>addWorksheet(wb, <span class="hljs-string">&quot;GO_BM_MOs_YS_Macs_UP&quot;</span>)<br>addWorksheet(wb, <span class="hljs-string">&quot;GO_BM_MOs_YS_Macs_DOWN&quot;</span>)<br>writeData(wb, <span class="hljs-string">&quot;GO_BM_MOs_YS_Macs_UP&quot;</span>, go_enrich_up, rowNames = <span class="hljs-literal">FALSE</span>)<br>writeData(wb, <span class="hljs-string">&quot;GO_BM_MOs_YS_Macs_DOWN&quot;</span>, go_enrich_down, rowNames = <span class="hljs-literal">FALSE</span>)<br>saveWorkbook(wb, <span class="hljs-string">&quot;GO_analysis.xlsx&quot;</span>, overwrite = <span class="hljs-literal">TRUE</span>)<br><br><span class="hljs-comment"># 7 GSEA</span><br><span class="hljs-comment"># test a specific (maybe self-defined) gene set to see </span><br><span class="hljs-comment"># whether they are up-regulated or down-regulated compared to other genes in terms of differential expression</span><br><span class="hljs-comment"># assume the set of first 50 genes is the interested gene set</span><br>interested_gene_set &lt;- rownames(exprs(eset))[<span class="hljs-number">1</span>:<span class="hljs-number">50</span>]<br>res.gsea &lt;- camera(exprs(eset), <span class="hljs-built_in">list</span>(set1 = interested_gene_set), design)<br>res.gsea <span class="hljs-comment">#print res.gsea</span><br><br><span class="hljs-comment"># 8 combing other dataset for PCA and clustering  (but there is no cluster point in the polt)</span><br><span class="hljs-comment"># 8.1 combine Imun_gen.ex.Rdump and ex</span><br>ex_imun_gen &lt;- dget(<span class="hljs-string">&quot;material/Imun_gen.ex.Rdump&quot;</span>) <span class="hljs-comment"># get Imun_gen.ex.Rdump from material </span><br>phenoData_table &lt;- read.table(file=<span class="hljs-string">&quot;material/pheno.table.csv&quot;</span>, header=<span class="hljs-built_in">T</span>, sep=<span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-comment"># get pheno.table.csv from material</span><br>ex_imun_gen <span class="hljs-comment"># check content of the ex_imun_gen</span><br>phenoData_table <span class="hljs-comment"># check content of the phenoData_table</span><br>ex_combine.raw &lt;- merge(ex_imun_gen, ex, by=<span class="hljs-string">&#x27;row.names&#x27;</span>) <span class="hljs-comment">#combine ex_imun_gen and ex</span><br>rownames(ex_combine.raw) &lt;- ex_combine.raw$<span class="hljs-string">&quot;Row.names&quot;</span><br>ex_combine.raw$<span class="hljs-string">&quot;Row.names&quot;</span>&lt;- <span class="hljs-literal">NULL</span> <span class="hljs-comment"># now ex_combine.raw is data.frame</span><br>ex_combine.raw &lt;- as.matrix(ex_combine.raw) <span class="hljs-comment"># turn ex_combine.raw from data.frame into matrix</span><br><br><span class="hljs-comment"># 8.2 Do PCA on merged data and draw merged PCA plot</span><br>pca_im &lt;- prcomp(t(ex_combine.raw))  <span class="hljs-comment"># perform PCA</span><br>exp_names &lt;- paste0(phenoData_table$cell, <span class="hljs-string">&quot;_&quot;</span>, phenoData_table$Tissue) <span class="hljs-comment"># combine cell and tissue data. </span><br><span class="hljs-comment"># Take PC1 and PC2 for the plot</span><br><span class="hljs-comment">#par(mai = c(1,  1, .25, 2)) </span><br>plot(pca_im$x[,<span class="hljs-number">1</span>:<span class="hljs-number">2</span>], <br>     pch = <span class="hljs-built_in">c</span>(<span class="hljs-number">16</span>, <span class="hljs-number">17</span>)[<span class="hljs-built_in">as.numeric</span>(phenoData_table$cell)],  <span class="hljs-comment"># cell type with distinct symbols</span><br>     col=brewer.pal(<span class="hljs-number">10</span>,<span class="hljs-string">&quot;Set1&quot;</span>)[<span class="hljs-built_in">as.numeric</span>(phenoData_table$Tissue)])  <span class="hljs-comment"># cell tissue with distinct colors</span><br><span class="hljs-comment"># Legend outside the plot on right</span><br>legend(<span class="hljs-string">&quot;top&quot;</span>,             <span class="hljs-comment"># Location of legend </span><br>       xpd = <span class="hljs-literal">TRUE</span>,                       <span class="hljs-comment"># Allow drawing outside plot area</span><br>       xjust = <span class="hljs-number">0</span>,                        <span class="hljs-comment"># Left justify legend box on x</span><br>       yjust = <span class="hljs-number">1</span>,                        <span class="hljs-comment"># Center legend box on y</span><br>       legend = unique(phenoData_table$Tissue),<br>       col = brewer.pal(<span class="hljs-number">10</span>,<span class="hljs-string">&quot;Set1&quot;</span>),      <span class="hljs-comment"># Legend Element Colors</span><br>       pch = <span class="hljs-built_in">c</span>(<span class="hljs-number">16</span>),                      <span class="hljs-comment"># Legend Element Styles</span><br>       title = <span class="hljs-string">&quot;Tissue&quot;</span>)                 <span class="hljs-comment"># Legend Title</span><br><br><span class="hljs-comment"># Legend outside the plot on bottom</span><br>legend(<span class="hljs-string">&quot;bottom&quot;</span>,            <span class="hljs-comment"># Location of legend</span><br>       xpd = <span class="hljs-literal">TRUE</span>,                       <span class="hljs-comment"># Allow drawing outside plot area</span><br>       xjust = <span class="hljs-number">0</span>,                        <span class="hljs-comment"># Left justify legend box on x</span><br>       yjust = <span class="hljs-number">0</span>,                        <span class="hljs-comment"># Center legend box on y</span><br>       legend = unique(phenoData_table$cell),<br>       col = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;black&quot;</span>, gray(<span class="hljs-number">.2</span>)),       <span class="hljs-comment"># Legend Element Colors</span><br>       pch = <span class="hljs-built_in">c</span>(<span class="hljs-number">16</span>, <span class="hljs-number">17</span>),                  <span class="hljs-comment"># Symbol styles for legend elements</span><br>       title = <span class="hljs-string">&quot;Cell&quot;</span>)                   <span class="hljs-comment"># Legend Title</span><br><br>phenoData_table$Tissue<br>phenoData_table$cell<br><br>modcombat = model.matrix(~<span class="hljs-number">1</span>, data=phenoData_table)<br>ex_combined.batch_removed = ComBat(dat=ex_combine.raw, <br>                                   batch=phenoData_table$batch, mod=modcombat, par.prior=<span class="hljs-literal">TRUE</span>)<br><br><br><span class="hljs-comment"># Select the de genes from the expression matrix after batch effect removal</span><br>sel &lt;- match(all_de_genes$ID, rownames(ex_combined.batch_removed))<br>sel &lt;- sel[!<span class="hljs-built_in">is.na</span>(sel)] <span class="hljs-comment"># remove the NAs</span><br><br>clust &lt;- <span class="hljs-keyword">function</span>(x) hclust(x, method=<span class="hljs-string">&quot;complete&quot;</span>) <span class="hljs-comment"># perfrom complete linkage clustering</span><br>dist &lt;- <span class="hljs-keyword">function</span>(x) as.dist((<span class="hljs-number">1</span>-cor(t(x)))/<span class="hljs-number">2</span>)  <span class="hljs-comment"># use the inverse of correlation as distance. </span><br>hmcol &lt;- rev(brewer.pal(<span class="hljs-number">11</span>, <span class="hljs-string">&quot;RdBu&quot;</span>))<br><br><span class="hljs-comment"># heatmap.2 is a powerful and complicated function, please read its help message</span><br>hp &lt;- heatmap.2(ex_combined.batch_removed[sel,], <span class="hljs-comment"># input matrix </span><br>                col=hmcol, <span class="hljs-comment"># define the customized colormap</span><br>                scale=<span class="hljs-string">&quot;row&quot;</span>, <span class="hljs-comment"># scale the values for each gene (row)</span><br>                labRow=<span class="hljs-built_in">F</span>, <span class="hljs-comment"># Not showing row labels</span><br>                density.info=<span class="hljs-string">&quot;none&quot;</span>, <span class="hljs-comment"># Not showing density info</span><br>                trace=<span class="hljs-string">&quot;none&quot;</span>, <span class="hljs-comment"># Not showing trace line</span><br>                margins = <span class="hljs-built_in">c</span>(<span class="hljs-number">11</span>,<span class="hljs-number">3</span>), <span class="hljs-comment"># modify the margin to fit the labels</span><br>                labCol=paste0(phenoData_table$cell, <span class="hljs-string">&quot; / &quot;</span>, phenoData_table$Tissue), <span class="hljs-comment"># add the column labels</span><br>                <span class="hljs-comment"># define hierarchical clustering method</span><br>                hclust = clust,<br>                <span class="hljs-comment"># Using correlation coefficient for distance function</span><br>                distfun = dist<br>)<br></code></pre></td></tr></table></figure><h2 id="Analysis-of-cancer-genome-atlas-in-r"><a href="#Analysis-of-cancer-genome-atlas-in-r" class="headerlink" title="Analysis of cancer genome atlas in r"></a>Analysis of cancer genome atlas in r</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#Analysis of cancer genome atlas in r</span><br><br><span class="hljs-comment"># 1. loading libraries</span><br>library(TCGAbiolinks)<br>library(limma)<br>library(edgeR)<br>library(glmnet)<br>library(FactoMineR)<br>library(caret)<br>library(SummarizedExperiment)<br>library(gplots)<br>library(survival)<br>library(survminer)<br>library(RColorBrewer)<br>library(gProfileR)<br>library(genefilter)<br><br><span class="hljs-comment"># get TCGA project</span><br>GDCprojects =  getGDCprojects()<br><span class="hljs-comment"># use head check data</span><br>head(GDCprojects[<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;project_id&quot;</span>, <span class="hljs-string">&quot;name&quot;</span>)])<br><span class="hljs-comment"># use TCGAbiolinks:::getProjectSummary to get information from id:TCGA-LIHC</span><br>TCGAbiolinks:::getProjectSummary(<span class="hljs-string">&quot;TCGA-LIHC&quot;</span>)<br><span class="hljs-comment"># query:TCGA-LIHC</span><br>query_TCGA = GDCquery(<br>  project = <span class="hljs-string">&quot;TCGA-LIHC&quot;</span>,<br>  data.category = <span class="hljs-string">&quot;Transcriptome Profiling&quot;</span>, <span class="hljs-comment"># parameter enforced by GDCquery</span><br>  experimental.strategy = <span class="hljs-string">&quot;RNA-Seq&quot;</span>,<br>  workflow.type = <span class="hljs-string">&quot;HTSeq - Counts&quot;</span>)<br><span class="hljs-comment"># use getResult to visualize the query results in a more readable way</span><br>lihc_result &lt;- getResults(query_TCGA)<br>colnames(lihc_result) <span class="hljs-comment"># try sample_type</span><br>head(lihc_result$sample_type) <span class="hljs-comment"># find &quot;Primary Tumor&quot;</span><br><span class="hljs-comment"># download this sample type data</span><br>query_TCGA = GDCquery(<br>  project = <span class="hljs-string">&quot;TCGA-LIHC&quot;</span>,<br>  data.category = <span class="hljs-string">&quot;Transcriptome Profiling&quot;</span>, <span class="hljs-comment"># parameter enforced by GDCquery</span><br>  experimental.strategy = <span class="hljs-string">&quot;RNA-Seq&quot;</span>,<br>  workflow.type = <span class="hljs-string">&quot;HTSeq - Counts&quot;</span>,<br>  sample.type = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;Primary Tumor&quot;</span>, <span class="hljs-string">&quot;Solid Tissue Normal&quot;</span>))<br>new_lihc_result &lt;- getResults(query_TCGA)<br>head(new_lihc_result)<br>GDCdownload(query_TCGA) <span class="hljs-comment"># download TCGA data</span><br><br>tcga_data = GDCprepare(query_TCGA) <span class="hljs-comment"># load rna-seq into r</span><br><span class="hljs-built_in">dim</span>(tcga_data) <span class="hljs-comment"># check the size of data</span><br><br><span class="hljs-comment"># There are 3 functions that allow us to access to most important data present in this object, these are: </span><br><span class="hljs-comment"># colData () ，rowData () ，assays ()</span><br>colnames(colData(tcga_data))<br>View(tcga_data)<br><span class="hljs-comment"># The table() function (in this context) produces a small summary with the sum of each of the factors present in a given column.</span><br>table(tcga_data@colData$vital_status) <span class="hljs-comment"># the sum umber of alive and dead patient </span><br>table(tcga_data@colData$tumor_stage) <span class="hljs-comment"># the stage of tumor</span><br>table(tcga_data@colData$definition) <span class="hljs-comment"># the sample number of tumor and normal tissue</span><br>table(tcga_data@colData$tissue_or_organ_of_origin) <span class="hljs-comment"># check the number of tissue and organ</span><br>table(tcga_data@colData$race) <span class="hljs-comment"># race report</span><br><br><span class="hljs-comment"># Is there a particular column (feature) that allows you to distinguish tumor tissue from normal tissue?</span><br><span class="hljs-built_in">dim</span>(assay(tcga_data)) <span class="hljs-comment"># get gene expression matrix</span><br>head(assay(tcga_data)[<span class="hljs-number">1</span>:<span class="hljs-number">5</span>,<span class="hljs-number">1</span>:<span class="hljs-number">10</span>]) <span class="hljs-comment"># 查看前10个样本的前5个基因</span><br>head(rowData(tcga_data)) <span class="hljs-comment"># check 前6个基因的ensembl id and gene id </span><br><br><span class="hljs-comment"># save tcga data as rds</span><br>saveRDS(object = tcga_data,<br>        file = <span class="hljs-string">&quot;tcga_data.RDS&quot;</span>,<br>        compress = <span class="hljs-literal">FALSE</span>)<br>        <br><br><span class="hljs-comment"># 2. Normalize RNA data</span><br><span class="hljs-comment"># uncompleted</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210719实验记录B16多肽溶液配置方法</title>
    <link href="/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95B16%E5%A4%9A%E8%82%BD%E6%BA%B6%E6%B6%B2%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95/"/>
    <url>/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95B16%E5%A4%9A%E8%82%BD%E6%BA%B6%E6%B6%B2%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95B16%E5%A4%9A%E8%82%BD%E6%BA%B6%E6%B6%B2%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>polypeptide vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210719实验记录geo2r</title>
    <link href="/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95geo2r/"/>
    <url>/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95geo2r/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95geo2r.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>GEO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210719生物信息学研究方法记录</title>
    <link href="/2021/07/19/20210719%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/07/19/20210719%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="hhttps://jinsyliu.github.io/pdf/20210719%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bioiofo methods</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.7.16 GEO2R EXPERIMENT &amp; RESULTS</title>
    <link href="/2021/07/16/20210716GEO2REXPERIMENT&amp;RESULTS/"/>
    <url>/2021/07/16/20210716GEO2REXPERIMENT&amp;RESULTS/</url>
    
    <content type="html"><![CDATA[<p><strong>实验过程记录pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210716geo2r.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><p><strong>实验结果记录pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210716Results.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>GEO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生</title>
    <link href="/2021/07/08/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/07/08/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-7-8-文献阅读：mRNA-接种促进-SARS-CoV-2感染诱导的交叉变异中和抗体的产生"><a href="#2021-7-8-文献阅读：mRNA-接种促进-SARS-CoV-2感染诱导的交叉变异中和抗体的产生" class="headerlink" title="2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生"></a>2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生</h1><p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><blockquote><p>Stamatatos, L., Czartoski, J., Wan, Y.H., Homad, L.J., Rubin, V., Glantz, H., Neradilek, M., Seydoux, E., Jennewein, M.F., MacCamy, A.J. and Feng, J., 2021. mRNA vaccination boosts cross-variant neutralizing antibodies elicited by SARS-CoV-2 infection.</p><p>(mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生)</p></blockquote><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>新型冠状病毒即严重急性呼吸系统综合症冠状病毒-2（SARS-CoV-2）betacoronavirus于2019年底在中国湖北省首次出现，此后在192个国家感染了超过1.15亿人，造成超过250万人死亡。感染是由病毒的spike protein（S）介导的，该蛋白的S1结构域包含N端结构域（NTD）、C端结构域（CTD）和受体结合结构域（RBD），负责介导与进入受体血管紧张素转换酶2（ACE2）的附着。</p><blockquote><p>S蛋白</p><p>大量的糖基化 S 蛋白覆盖在 SARS-CoV-2的表面，与宿主细胞受体血管紧张素转化酶2结合，介导病毒细胞进入。当 S 蛋白与受体结合时，位于宿主细胞膜上的 TM 蛋白酶2(TM protease serine 2，TMPRSS2)通过激活 S 蛋白促进病毒进入细胞。一旦病毒进入细胞，病毒 RNA 被释放，RNA 基因组中的多聚蛋白被翻译，病毒 RNA 基因组的复制和转录通过蛋白质切割和复制酶-转录酶复合体的组装进行。病毒 RNA 被复制，结构蛋白被合成、组装和包装在宿主细胞中，之后病毒颗粒被释放。</p><p><img src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41401-020-0485-4/MediaObjects/41401_2020_485_Fig1_HTML.png" alt="figure1"></p><p>这些蛋白质对病毒的生命周期至关重要，并为药物治疗提供了潜在的靶点。</p><p>S蛋白的大小为180-200kDa，由一个细胞外N端、一个固定在病毒膜上的跨膜（TM）结构域和一个短的细胞内C端部分组成。S通常以一种可转移的、融合前的构象存在；一旦病毒与宿主细胞相互作用，S蛋白就会发生广泛的结构重排，使病毒与宿主细胞膜融合。S蛋白上有多糖分子以进行伪装，在进入时可逃避宿主免疫系统的监视。</p><p>SARS-CoV-2 S的总长度为1273 aa，由位于N端的信号肽（1-13个氨基酸）、S1亚单位（14-685残基）和S2亚单位（686-1273残基）组成；后两个区域分别负责受体结合和膜融合。在S1亚单位中，有一个N端结构域（14-305残基）和一个受体结合结构域（RBD，319-541残基）；融合肽（FP）（788-806残基）、七肽重复序列1（HR1）（912-984残基）、HR2（1163-1213残基）、TM结构域（1213-1237残基）和细胞质结构域（1237-1273残基）组成了S2亚单位。</p><p>Huang, Y., Yang, C., Xu, X.F., Xu, W. and Liu, S.W., 2020. Structural and functional properties of SARS-CoV-2 spike protein: potential antivirus drug development for COVID-19. <em>Acta Pharmacologica Sinica</em>, <em>41</em>(9), pp.1141-1149.</p></blockquote><p>在人类与非灵长动物中，已经确定对SARS-CoV-2已有的免疫力与对再感染的保护有关，产生的中和抗体（nAbs）可能是机体对SARS-CoV-2的保护性免疫反应的重要组成部分，而且nAbs可能有助于保护人类免受再次感染。在此前已经发现，SARS-CoV-2感染迅速引起nAbs产生，并在几个月内下降，但仍可检测到。</p><blockquote><p>中和抗体 neutralizing antibody，NAb</p><p>是一种用于防止细胞被某种抗原或感染原侵害而具有保护力的抗体；其原理是通过抑制乃至中和它们的某种生化作用。</p><p>中和抗体可以导致对某些传染病的终身免疫力，并且可以用来观察一个人在从感染中恢复后是否对感染产生了免疫力。</p><p>中和抗体通过中和细胞在生物学上产生的任何效应，保护细胞免受病原体或传染性微粒的侵袭。中和使微粒不再具有传染性或致病性。中和抗体是后天免疫系统对病毒、细胞内细菌和微生物毒素的体液反应的一部分。中和抗体通过与传染性微粒表面结构(抗原)特异结合，防止微粒与宿主细胞相互作用，从而感染并破坏宿主细胞。由中和抗体引起的免疫也被称为杀菌免疫，因为免疫系统在任何感染发生之前就消除了感染性微粒。</p><p>为了进入细胞，病毒颗粒和细胞内的细菌利用其表面的分子与其目标细胞的细胞表面受体相互作用，使它们能够进入细胞并开始复制周期。中和抗体可以通过与病原体结合来抑制传染性，并阻断细胞进入所需的分子。这可能是由于抗体静态干扰附着在宿主细胞受体上的病原体或毒素。在病毒感染的情况下，单克隆抗体可以结合包膜病毒的糖蛋白或无包膜病毒的衣壳蛋白。此外，中和抗体可以通过阻止微粒经历细胞成功进入所需的结构变化来发挥作用。例如，中和抗体可以阻止病毒蛋白的构象变化，这些蛋白介导进入宿主细胞所需的膜融合。在某些情况下，即使抗体解离，病毒也无法感染。病原抗体复合物最终被巨噬细胞吸收和降解。</p><p>如新冠病毒靠刺突蛋白上的受体结合域（RBD）与人体细胞ACE2受体结合以进入细胞，若某抗体具有与此受体结合域正确位点结合，且使病毒无法进入细胞而失去感染力，则此抗体称为中和抗体，意味能中和病毒的毒力。</p><blockquote><p>中和抗体和结合抗体的区别：</p><p>并非所有结合病原微粒的抗体都是中和的。非中和性抗体（或结合性抗体），专门结合病原体，但不干扰其传染性。这可能是因为它们没有绑定到正确的区域。非中和性抗体对于标记免疫细胞的粒子非常重要，表明它已经成为目标，之后粒子被处理，因此被招募的免疫细胞破坏。</p><p>另一方面，中和抗体可以中和抗原的生物效应，而不需要免疫细胞。在某些情况下，一些病毒物种可利用非中和性抗体或与病毒颗粒结合的中和性抗体数量不足来促进其吸收进入宿主细胞。这种机制被称为抗体依赖性增强作用。已观察到登革热病毒和寨卡病毒。</p></blockquote></blockquote><p>病毒自然感染期间引起的大多数血清中和抗体反应是针对受体结合结构域RBD的。许多中和性抗RBD的单克隆抗体（mAbs）已经被确定，其中最有效的是阻断RBD-ACE2的相互作用。还发现了与病毒spike protein区域结合的中和mAbs。现在，两种基于mRNA的疫苗（Pfizer-BioNTech BNT162b2和Moderna mRNA-1273）已在几个国家开始紧急接种。这两种疫苗都编码了从2019年12月分离出的武汉-Hu-1变体中提取的稳定的S蛋白胞外域部分，在预防COVID-19方面显示出&gt;94%的效力，能够在人体中引起nAbs中和抗体的产生。</p><blockquote><p>单克隆抗体：仅识别一个抗原上的单一表位，仅由一种抗体亚型组成（例如IgG1，IgG2，IgG3）</p><p>多克隆抗体：识别任一抗原上的多个表位，主要由IgG亚类组成</p><p><strong>BNT162b2 vaccine</strong></p><p>BNT162b2是一种脂质纳米粒配方的核苷修饰 RNA 疫苗，编码一种预融合稳定的、膜锚定的 SARS-CoV-2全长spike protein，通过两个脯氨酸突变来锁定其前融合构象。</p><p><strong>mRNA-1273 vaccine</strong></p><p>mRNA-1273疫苗是一种脂质纳米粒包裹的 mrna 基疫苗，编码严重急性唿吸综合症冠状病毒2(SARS-CoV-2)的预融合稳定的全长spike protein</p></blockquote><p>但是，研究者们也在世界各地发现了新冠病毒进化后的变体。在英国、南非和巴西分别发现了新冠变种（B.1.1.7）、（B.1.351）和（P.1）。这些突变几乎都会增加病毒对ACE2受体的亲和力。这些突变降低了单克隆抗体、恢复期血浆和免疫者血清对中和的敏感性。因此，人们担心这些和其他新出现的病毒变异体可以逃避在感染期间产生的变异体 nAb 反应，而这些变异体在大流行早期流行，也可以逃避基于武汉 -hu-1变异体的 s 蛋白的疫苗引起的 nAb 反应。更令人担心的是，这些突变可能是在南非正在进行的 SARS-CoV-2疫苗试验中观察到的效力下降的原因。</p><p>而且，目前，研究者们对新冠病毒再感染的感染后免疫保护尚不清楚。如果一波又一波的新变种病毒不断出现，破坏人体的自然免疫保护，疫情将会变得难以控制。</p><p>因此，Stamatatos等研究者在这篇文章中调查了以前感染过新冠病毒的人在接种为新冠病毒原始武汉变体开发的基于信使RNA的疫苗4至8个月后的免疫反应性。这篇文章主要评估了受试者血清对病毒的中和敏感性，一共收集了15例 SARS-CoV-2感染者（previously infected donors ，PIDs）和13例未感染者（naïve donors ，NDs）的血清，前者在一次或两次接种前后分别接种 SARS-CoV-2疫苗，后者分别接种了两剂 SARS-CoV-2疫苗。</p><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>ELISA</p><p>抗体中和试验 Antibody neutralization experiments</p><blockquote><p>中和试验(neutralizationtest)是在体外适当条件下孵育病毒与特异性抗体的混合物，使病毒与抗体相互反应，再将混合物接种到敏感的宿主体内，然后测定残存的病毒感染力的一种方法。</p></blockquote><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><h3 id="fig-1"><a href="#fig-1" class="headerlink" title="fig.1"></a>fig.1</h3><p>用表达全长的wuhan-Hu-1 S或两个版本的B.1.351系S的假病毒进行抗体中和实验，其中一个版本在此称为B.1.351，包含定义S系的突变D80A、D215G、K417N、E484K、N501Y和D614G以及在该系中高度流行的A701V突变；第二个变体也包括一个Δ242-243缺失（B.1.351-Δ242-243）。</p><p><img src="/Users/keqinliu/Downloads/F1.large (2" alt="F1.large (2)">.jpg)</p><blockquote><p><strong>Fig. 1</strong>  <strong>B.1.351变异表明中和单克隆抗体的敏感性降低</strong></p><p>图中测量了所述的mAbs在293T-hACE2细胞中中和武汉-1、B.1.351和B.1.351-Δ242-243假病毒感染性的能力。括号内为每种mAb的表位特异性。EBV, Epstein-Barr病毒。数据点代表两个技术复制的平均值。数据是两个独立实验的代表。</p><p>横坐标轴是mAb的浓度（这里分为100，10，1，0.1和0.01一共五个滴度，纵坐标轴是中和效果，一般看50%血清中和终点）</p><p>A：mAb对B.1.351变体的中和效力要弱10倍左右。</p><p>B：非VH3-53 mAb CV3-1对B.1.351变体的效力降低了三到四倍。</p><p>C：CV2-75的效力略低。</p><p>D：相比之下，抗NTD的CV1 mAb无法中和B.1.351变体。</p><p>E：正如预期的那样，对照的anti–Epstein-Barr virus mAb AMMO1没有中和作用。</p><p>总之，这些数据表明，这里测试的B.1.351变体对从大流行早期的病毒变体感染者身上分离出来的mAb的中和作用更具抵抗力。</p><p>因此，研究者们继续调查了B.1.351变体是否对辉瑞-生物技术公司或Moderna mRNA疫苗在PID和NDS中引起的nAb反应有抵抗力。</p></blockquote><h3 id="fig-2"><a href="#fig-2" class="headerlink" title="fig.2"></a>fig.2</h3><p><img src="/Users/keqinliu/Downloads/F2.large.jpg" alt="F2.large"></p><blockquote><p>fig.2 <strong>单剂量的</strong>spike-derived mRNA<strong>疫苗会引起强烈的recall response</strong></p><p>A-C：通过ELISA方法，在辉瑞-生物技术公司或Moderna mRNA疫苗免疫前和免疫两次后收集的PID血清中测量特异于武汉-Hu-1变体RBD的IgG（A）、IgA（B）和IgM（C）终点抗体滴度，如所示。两次疫苗接种后在非传染性疾病患者血清中测得的终点滴度用于比较（灰色圆点）。</p><p><strong>A：三名PID经历了无症状的SARS-CoV-2感染（供体D、L和M），其中两人（L和M）在免疫前没有检测到抗RBD IgG抗体，而第三人（D）的血清抗RBD IgG抗体滴度低但可检测到。在接种前有RBD特异性IgG抗体的13个PID中，单剂量的任何一种疫苗都能使这些滴度提高~500倍。</strong></p><p><strong>B：在所有PID中，接种疫苗后RBD特异性IgA滴度的中位数增加了200倍。</strong></p><p><strong>C：总的来说，在PID中，与NDS的两次接种相比，单次接种的IgG和IgA滴度分别高出4.5倍和7.7倍。在PIDs中，RBD特异性IgM滴度通常较低，对疫苗接种的反应没有明显提高。</strong></p><p>D：在一次或两次免疫之前和之后，测量PIDs的外周血单核细胞（PBMCs）中武汉-Hu-1 RBD特异性IgG+记忆B细胞（活体、IgD-、CD19+、CD20+、CD3-、CD14、CD56-、单细胞和淋巴细胞）的频率。E和F）在一次或两次免疫之前和之后，测量PIDs的PBMCs中S6P特异性IgG+</p><p><strong>在PIDs中，接种疫苗后，RBD-（图2D）和S特异性IgG+（图2E）记忆B细胞的频率同时增加。免疫前缺乏RBD特异性IgG滴度的两个PID（供体L和M）也缺乏RBD特异性IgG+记忆B细胞（图2D），接种后S特异性IgG+记忆B细胞的频率较低。与血清学数据一致，观察到IgA+（图2F）而不是IgM+尖峰特异性记忆B细胞的频率增加（图S3）。疫苗接种还诱发了S特异性CD4+T细胞反应（图2G）。</strong></p><p>E-F：在一次或两次免疫之前和之后，测量PIDs的PBMCs中S6P特异性IgG+（E）和IgA+（F）记忆B细胞的频率。在(D)至(F)中显示了两剂疫苗后NDS的记忆B细胞的频率进行比较（灰色点）。</p><p>G：在一次或两次免疫之前和之后，测量PIDs的PBMCs中表达干扰素-γ（IFN-γ）和/或白细胞介素-2（IL-2）和/或CD40L的S特异性CD4+T细胞的频率。两次疫苗接种后，未感染供体的PBMC中S特异性CD4+T细胞的频率被显示出来进行比较（灰色圆点）。</p></blockquote><h3 id="fig-3"><a href="#fig-3" class="headerlink" title="fig.3"></a>fig.3</h3><p><img src="/Users/keqinliu/Downloads/F3.large.jpg" alt="F3.large"></p><blockquote><p>fig.3 <strong>早先存在的 SARS-CoV-2 nAb 反应是通过单剂量spike-derived mRNA疫苗加强的</strong></p><p>A至D：在使用辉瑞-生物技术公司或Moderna疫苗进行一次或两次免疫之前和之后的PID中，以及在使用两次疫苗之后的NDS中，测量导致50%中和的血清稀释度（ID50），如图所示。在（A）至（D）中，有症状和无症状的PID之间的数据点分别用实线和虚线连接。</p><p>E：辉瑞生物技术公司或Moderna公司针对wuhan-hu-1、B.1.351、B.1.351-Δ242-243和SARS-CoV-1假病毒的疫苗单次免疫之前（方块）和之后（圆圈）的PID的血清稀释导致50%的中和率（ID50），如所示。疫苗接种前无症状且抗IgG RBD抗体和RBD特异性IgG+记忆B细胞阴性的PID显示为开放圆圈。</p><p>F：用辉瑞-生物技术公司或Moderna公司的疫苗对指定的假病毒进行两次免疫后，NDS的血清的中和效力（ID50）。每个数据点代表一个不同的捐赠者，横线代表（E）和（F）中的中位数。虚线划定的是测试的最低血清稀释度。</p><p>在接种疫苗前取样的15名PID中，有12人的血清中和了武汉-Hu-1 SARS-CoV-2变体。不中和的血清来自三个无症状的PID，他们的抗RBD IgG滴度较低或无法检测，来自NDS的Pre-accine血清也没有中和作用。</p><p><strong>A：与预先存在RBD特异性IgG滴度的PID单次免疫后观察到的结合抗体的增加相一致，第一剂量后半最大中和滴度[半最大抑制稀释度（ID50）]被提高了约1000倍，而第二剂量没有影响。在接种前缺乏RBD特异性IgG滴度的两个PID中，第一剂疫苗引起了较低的中和滴度（捐赠者L的ID50=30 ，捐赠者M的ID50=200）。在NDS中，两剂疫苗引起的ID50滴度分别比PID中的一剂或两剂引起的滴度低10倍和5倍。总之，这些数据表明，在对RBD产生足够免疫记忆的PID中，单剂疫苗引起的无名反应导致RBD结合和nAb反应，优于未感染供体的两剂方案。在最近的两项研究中，在接受单一mRNA疫苗剂量的PID中也观察到了类似的结合和/或疫苗匹配的中和滴度的提高。</strong></p><p>接下来研究者评估了NDS和PID在免疫前后收集的血清中和更具抗性的B.1.351和B.1.351-Δ242-243假病毒的能力。这些变体与武汉-Hu-1变体之间有0.5和0.7%的区别。研究者还将 SARS-CoV-1假病毒作为一个与疫苗更不同的代表性变异包括在这项分析中。SARS-CoV-1和 SARS-CoV-2在总 S 蛋白、 RBD 和 RBM 中的区别分别为24%、26%和50% 。因此，一些单克隆抗体无法与 SARS-CoV-1结合而中和 SARS-CoV-2。</p><p>B.E. 接种疫苗前，15份PID的血清中有5份中和了B.1.351，只有3份的ID50滴度超过了100</p><p>C.E. 15份中有7份中和了B.1.351-Δ242-243，只有一份的滴度超过了100</p><p>E 前期疫苗血清对武汉-胡1变体的ID50中值明显高于对B.1.351或B.1.351-Δ242-243的ID50</p><p>D.E. 与高度的序列差异相一致的是，只有一个PID的血清在接种疫苗前对SARS-CoV-1表现出非常弱的中和活性</p><p>A.D.  在15名PID中的13名中，单次免疫可提高针对所有三种SARS-CoV-2变体和SARS-CoV-1的nAb滴度</p><p>E 然而，针对B.1.351的ID50滴度中值要比针对Wuhan-Hu-1的低3倍，针对B.1.351-Δ242-243的低10倍，针对SARS-CoV-1的低100倍</p><p>A-D.E 在两个缺乏RBD特异性IgG记忆的无症状供体（供体L和M）中，单次免疫并没有引起针对B.1.351变体或SARS-CoV-1的nAbs。</p><p>PID单次免疫引起的中和滴度明显高于NDS两次免疫引起的对所有测试的假病毒的中和滴度—对Wuhan-Hu-1高10倍（图3A），对B.1.351高20倍（图3B），对B.1.351-Δ242-243高30倍（图3C），而对SARS-CoV-1高7倍（图3D）。</p><p>13个接种的NDS中只有8个能达到对B.1.351-Δ242-243的80%中和，没有一个能达到对SARS-CoV-1的80%中和（图S7B）。</p></blockquote><p>B.1.351和B.1.351-Δ242-243变体包含三个RBD突变，影响了抗RBD mAbs的中和效力（fig.1）。</p><p>此外，预先存在的抗RBD IgG记忆似乎对疫苗接种的强烈回忆反应很重要。为了确定抗RBD抗体对血清中和的相对贡献，研究者在一次疫苗接种后从10个PID的血清中，以及在两次疫苗接种后从9个NDS的血清中，耗尽了RBD特异抗体。</p><h3 id="fig-4"><a href="#fig-4" class="headerlink" title="fig.4"></a>fig.4</h3><p><img src="/Users/keqinliu/Downloads/F4.large.jpg" alt="F4.large"></p><blockquote><p>fig.4 <strong>疫苗诱导的 nAbs 靶向 RBD</strong></p><p>使用固定在磁珠上的wuhan-Hu-1 RBD，从接受单一疫苗剂量后的PIDs血清或接受两个疫苗剂量后的NDS血清中吸附RBD结合的抗体。</p><p>A.B. 如图所示，通过ELISA法测量PIDs的未去除或已去除RBD的血清与1：500稀释度的RBD（A）和1：4500稀释度的S2P（B）的抗体结合。A450，450nM时的吸光度。</p><p>C 在(A)和(B)中的PIDs的未去除或RBD去除的血清中，测量导致武汉-Hu-1伪病毒50%中和的血清稀释度（ID50）</p><p>D.E. 通过ELISA法，测量未去除和RBD去除的NDS血清中与1：500稀释度的RBD（D）和1：500稀释度的S2P（E）的抗体结合。</p><p>(F)测量(D)和(E)中供体的未去除或RBD去除血清的1:120稀释度对武汉-hu-1假病毒的中和率。</p><p>通过酶联免疫吸附试验（ELISA），这种方法有效地从血清中去除RBD特异性抗体（图4，A和C），而不是抗S2P特异性抗体（图4，B和D）。这种耗竭削弱了wuhan-Hu-1病毒的血清中和作用（图4，C和F），这表明大多数由疫苗接种引起或增强的nAbs都是针对这个亚域的。</p></blockquote><p>上述结果表明，在NDS中，无论是辉瑞生物技术公司还是Moderna公司的两剂疫苗都能引起针对疫苗匹配的武汉-Hu-1的nAb滴度，针对B.1.351的滴度较低，而针对B.1.351-Δ242-243的滴度甚至更低。其他B.1.351变体对疫苗诱导的nAbs的敏感性降低也有报道。</p><p>同样，来自经历过SARS-CoV-2感染的PID的血清，在接种疫苗前有可检测到的抗RBD IgG滴度，在感染后1至9个月，对Wuhan-Hu-1的nAb滴度普遍较弱，对B.1.351变体的滴度较低或不存在，与另一项研究一致。</p><p>然而，只要在感染期间产生了RBD特异性IgG+记忆B细胞和抗体反应，用任一mRNA疫苗进行单次免疫就会引起强烈的回忆反应，使自体中和滴度提高约1000倍，这些抗体反应可交叉中和B.1.351变体，但滴度较低。在大多数先前感染的疫苗接种者中，抗B.1.351-Δ242-243的中和滴度与未感染的疫苗接种者中抗疫苗匹配的Wuhan-Hu-1的滴度相当。这是值得注意的，因为在3期试验中，这些滴度与COVID-19的95%保护率有关。此外，疫苗激发的抗体反应也能中和SARS-CoV-1，但其效力要低得多。总之，我们的数据表明，基于wuhan-hu-1变体的两种mRNA疫苗可以引起和/或增强nAb反应，但它们对不同变体的效力会降低。</p><p>研究者发现，以前感染的受试者在免疫后产生的交叉nAb反应是抗RBD抗体的结果。结合观察，疫苗引起的nAb反应对NTD有Δ242-243缺失的B.1.351变体的效力较低，这表明NTD变异可以调节新出现的变体对抗RBD nAbs的敏感性。相比之下，NTD区域本身似乎可以容忍SARS-CoV-2和其他冠状病毒的抗原性变异，它似乎不是感染或疫苗接种引起的交叉nAbs的目标。我们注意到，还有其他与这一品系相关的不太常见的突变，如L18F、Δ244、L244H和R246I，这些突变在这里没有被研究，它们可能会进一步增加对疫苗激发的抗体的抵抗力。在这项研究中，使用了一种假病毒检测方法来测量nAbs。现在有几项研究表明，真病毒和假病毒的中和作用有相当好的相关性。尽管真实病毒和假病毒检测的绝对敏感性可能不同，但我们预计我们在此报告的相对差异不会在两者之间发生变化。</p><p>尽管SARS-CoV-2疫苗的保护作用尚未确定，但在非人灵长类动物中的研究表明，即使是低滴度的nAbs也足以预防实验性SARS-CoV-2感染，特别是如果CD8+T细胞反应被启动的话。研究者们发现，大多数先前感染的受试者将从辉瑞生物技术公司或Moderna疫苗的单次免疫中受益，因为它将导致针对疫苗匹配和新出现的变体的血清nAb反应的显著增加。</p><p>观察到在第一剂疫苗接种后3至4周再接种第二剂疫苗并不能进一步提高PID的中和滴度，这些PID在接种前有明显的RBD导向的免疫记忆证据，这表明对于一些以前感染过SARS-CoV-2的人，可以推迟第二剂mRNA疫苗的接种。对第一剂疫苗前后的nAb滴度的纵向监测应被用来确定在以前感染的情况下第二剂疫苗的必要性或最佳时机。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>在接种疫苗之前，感染后的血清对病毒变体的抗体中和反应是可变的和弱的。疫苗接种使感染后血清对武汉-Hu-1和其他毒株的中和能力提高了约1000倍，对变种B.1.351的血清中和能力也有所提高。虽然对变异株的反应相对较弱，但仍显示出特有的记忆反应。</p><p>因此，接种武汉-湖北1号变种疫苗可能会对机体以后感染变种病毒所产生的的保护性反应提供促进作用。</p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SARS-CoV-2</tag>
      
      <tag>vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210625生物信息学考试</title>
    <link href="/2021/06/25/20210625%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E8%80%83%E8%AF%95/"/>
    <url>/2021/06/25/20210625%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E8%80%83%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210625%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E8%80%83%E8%AF%95.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>SIBS STUDY MATERIAL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>BIOINFO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210623细胞生物学期末整理</title>
    <link href="/2021/06/23/20210623%E7%BB%86%E8%83%9E%E7%94%9F%E7%89%A9%E5%AD%A6%E6%9C%9F%E6%9C%AB%E6%95%B4%E7%90%86/"/>
    <url>/2021/06/23/20210623%E7%BB%86%E8%83%9E%E7%94%9F%E7%89%A9%E5%AD%A6%E6%9C%9F%E6%9C%AB%E6%95%B4%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210623%E7%BB%86%E8%83%9E%E7%94%9F%E7%89%A9%E5%AD%A6%E6%9C%9F%E6%9C%AB%E6%95%B4%E7%90%86.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>SIBS STUDY MATERIAL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CYTOBIOLOGY</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210617生物统计学猜题</title>
    <link href="/2021/06/17/20210617%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1%E5%AD%A6%E7%8C%9C%E9%A2%98/"/>
    <url>/2021/06/17/20210617%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1%E5%AD%A6%E7%8C%9C%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210617%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1%E5%AD%A6%E6%9C%9F%E6%9C%AB%E6%95%B4%E7%90%86.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>SIBS STUDY MATERIAL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>BIOSTATISTICS</tag>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.1.20 human RME</title>
    <link href="/2021/01/20/20210120humanRME/"/>
    <url>/2021/01/20/20210120humanRME/</url>
    
    <content type="html"><![CDATA[<h1 id="How-to-analyze-human-RME"><a href="#How-to-analyze-human-RME" class="headerlink" title="How to analyze human RME"></a>How to analyze human RME</h1><p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210119humanRME.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h2 id="1-Background"><a href="#1-Background" class="headerlink" title="1. Background"></a>1. Background</h2><p>区分印记基因和单等位基因</p><h3 id="1-1-RME"><a href="#1-1-RME" class="headerlink" title="1.1 RME"></a>1.1 RME</h3><p>在二倍体生物体中，一般认为每个基因的两个等位基因都会在相似的时间和水平上表达。然而，一些基因可以优先表达或严格从一个单一的等位基因，这一过程被称为单等位基因表达。单等位基因表达可能是由于等位基因之间的 DNA 序列多态性，例如在增强子或启动子序列中的多态性可能影响基因转录的效率，或基因组大部分的拷贝数变异(copy-number variations，CNVs)。在没有DNA序列多态性的情况下，也会出现单等位基因表达，最为典型的例子是雌性哺乳动物的X染色体失活（XCI）过程，它保证了XX雌性和XY雄性之间的X连锁基因剂量补偿\citep{wutz2011gene}。另一个典型的单等位基因调控的程序化例子则是印记基因。</p><p>印记基因是一种亲本起源特异性的单等位基因表达。印迹基因的单等位基因表达受生殖系等位基因特异性甲基化(allele-specific methylation，ASM，传统上称为差异甲基化区域(differentially methylated region，DMR))控制\citep{tycko2010allele, lo2003allelic}。在这些生殖系遗传系(gASMs)中 ，一个亲本等位基因的印迹控制区的 CpGs 是甲基化的，而另一个等位基因的 CpGs 是非甲基化的。当用亚硫酸氢盐Sanger测序检测时，这些区域的 PCR 克隆有一半是高甲基化的，另一半是低甲基化的，因此呈现出双峰式甲基化模式。重要的是，这些 gASMs/DMR 在胚胎发育早期的整体去甲基化和再甲基化周期中被认为是稳定的\citep{bartolomei25mammalian}。一旦由于精子和/或卵母细胞的暴露，这些遗传性组织被改变，这种改变可以作为“表观遗传记忆”进入体细胞。这种表观遗传改变的水平或许能在个体中维持数十年。此前，在一项针对跨代表观遗传的研究中，研究者们发现，出生前即暴露于荷兰饥荒的个体在出生60年后，印记的 IGF2基因的 DNA 甲基化水平仍然低于未暴露的同性兄弟姐妹\citep{heijmans2008persistent}。目前发现，大约超过100个基因座受父母起源依赖性表达的影响。许多印迹基因在出生前和出生后的新陈代谢中都起着重要作用，它们的双等位基因表达可以导致严重的表型\citep{barlow2011genomic}。不过，在某些组织比如大脑中，处于胎儿出生后神经发育的需要，神经干细胞会发生印记基因的沉默释放（release from silencing）\citep{ferron2011postnatal}。</p><p>除了亲本起源特异性单等位基因表达（parent-of-origin-specific monoallelic expression），哺乳动物基因组有大量的基因显示随机单等位基因表达(random monoallelic expression，RME)\citep{lo2003allelic, deng2014single, gendrel2014developmental}。旧观点认为，常染色体上的非印迹基因要么双细胞表达，要么双等位基因抑制。单等位基因表达被认为只发生在位于印记位点或女性 X 染色体的基因（其中一个来自父系或母系的X染色体在女性中被随机灭活）\citep{tycko2010allele}。但是，最近的研究发现，非印迹的常染色体基因的单等位基因的表达似乎不是一个偶发现象，而是在人类和小鼠基因组中的一个保守特征\citep{lo2003allelic, deng2014single, gendrel2014developmental}。虽然RME现象似乎经常发生，但表观遗传学机制好像无法对其发生进行解释\citep{gendrel2014developmental}。</p><p>这些随机单等位基因表达一般发生在常染色体基因座上\citep{chess2012mechanisms}，包括大基因家族的重要成员。这些随机单等位基因以高度组织特异性的方式表达，一般参与感觉或免疫系统功能(如人类白细胞抗原HLA)，如淋巴细胞中的免疫球蛋白（immunoglobulin）和T细胞受体基因（T cell receptor genes）、嗅觉神经元中的气味剂受体（odorant receptor ，OR）基因、浦肯野神经元（Purkinje neurons）中的原珠蛋白（protocadherins，Pcdhs）等\citep{chess2012mechanisms}。这种单基因和单配位表达（monogenic and monoallelic expression）的现象（也称为等位基因排异（allelic exclusion））被认为对明确细胞身份和保证细胞多样性至关重要。事实上，研究者认为，等位基因排斥保证了每个 b 细胞或 t 细胞只产生一个单一的抗原受体，这种方式有助于免疫多样性\citep{cedar2008choreography}。等位基因排斥似乎代表了一种普遍的表观遗传现象。重要的是，单等位基因的表达在细胞谱系和个体之间存在差异。因此，RME 可能产生多样性的基因表达模式，对细胞的命运和生理有重要影响\citep{ohlsson2007widespread}。</p><p>单等位基因表达状态可以稳定地保持在几代细胞中。</p><p>单等位表达基因在发育过程中起着重要作用。此前的研究发现，许多常染色体基因的单等位基因表达发生在体内，在正常发育过程中，并趋向于高度组织特异性\citep{gendrel2014developmental}。</p><p>RME导致的表观遗传改变与许多人类疾病的发生密切相关。例如，表观遗传学研究表明，癌细胞具有全基因组低甲基化和区域特异性低甲基化的特点，而等位基因失衡(allelic imbalance，AI)与癌症发生风险上升相关。乳腺癌和卵巢癌散发病例中，由于启动子过度甲基化导致的 BRCA1表达缺失与两种癌症的发病相关\citep{esteller2000promoter, thrall2006brca1}。先前的一项研究报道，13个人类基因中有6个，包括 BRCA1和 p53，在两个等位基因中表达有显著差异，并且这种差异是通过孟德尔定律遗传的\citep{yan2002allelic}。</p><p>此外，人类常染色体显性遗传性疾病涉及单等位基因表达。</p><h2 id="How-to-analyze-ASE-in-RNA-seq"><a href="#How-to-analyze-ASE-in-RNA-seq" class="headerlink" title="How to analyze ASE in RNA-seq?"></a>How to analyze ASE in RNA-seq?</h2><p>\citep{borel2015biased}</p><blockquote><p>To investigate the extent of allele-specific transcription of autosomal human protein-coding genes, we used single-cell RNA sequencing (RNA-seq) technology to study 203 single cells from two different human primary fibroblast cell lines. </p><p>By analyzing informative single-nucleotide variants (SNVs), we determined the relative mRNA abundance of each of the two alleles. For most of the actively transcribed genes, our results revealed that one allele was predominantly detected in a single cell at a particular point in time, whereas the second allele was at low levels or undetectable. </p><p>We observed a stochastic process given that equal numbers of single cells expressed one or the other allele and a minority of single cells expressed both alleles. Interestingly, we detected only a few genes with an equal mRNA level from both alleles in all single cells. Detailed genomic characterization of these “single-cell biallelic” genes revealed that they express high levels of mRNA in a large number of cells. </p></blockquote><p>method</p><blockquote><ol><li><p>Single-Cell Capture</p></li><li><p>cDNA Synthesis and Pre-amplification of Single Cells</p></li><li><p>Total RNA Extraction from Bulk Cell Samples</p></li><li><p>mRNA-Seq Library Preparation</p></li><li><p>Whole-Genome Sequencing</p></li><li><p>Spike-In Experiment</p><p> 由于不同文库测序深度不同，比较前当然要进行均一化！用总reads进行均一化可能最简单，其基于以下两个基本假设：</p><ul><li>绝大多数的gene表达量不变；</li><li><p>高表达量的gene表达量不发生改变；</p><p>但在转录组中，通常一小部分极高丰度基因往往会贡献很多reads，如果这些“位高权重”的基因还是差异表达的，则会影响所有其它基因分配到的reads数，而且，两个样本总mRNA量完全相同的前提假设也过于理想了。那如何比较呢，各个方家使出浑身解数，有用中位数的，有用75分位数的，有用几何平均数的，有用TMM(trimmed mean of Mvalues)的等等，总之要<strong>找一个更稳定的参考</strong>值。</p><p><em>House-keeping gene(s)</em></p><p>矫正的思路很简单，就是在变化的样本中寻找不变的量</p><p>那么在不同RNA-seq样本中，那些是不变的量呢？一个很容易想到的就是<strong>管家基因</strong> (House-keeping gene(s))</p><p>使用Housekeeping gene的办法来进行相对定量，这种办法在一定程度上能够解决我们遇到的问题。但其实这种办法有一个<strong>非常强的先验假设</strong>：housekeeping gene的表达量不怎么发生变化。其实housekeeping gene list有几千个，这几千个基因有一定程度上的变化是有可能的。</p><p>An RNA spike-in is an RNA transcript of known sequence and quantity used to calibrate measurements in RNA hybridization assays, such as DNA microarray experiments, RT-qPCR, and RNA-Seq.</p><p>A spike-in is designed to bind to a DNA molecule with a matching sequence, known as a control probe. This process of specific binding is called hybridization. A known quantity of RNA spike-in is mixed with the experiment sample during preparation. The degree of hybridization between the spike-ins and the control probes is used to normalize the hybridization measurements of the sample RNA.</p><p>在RNA-Seq建库的过程中掺入一些预先知道序列信息以及序列绝对数量的内参。这样在进行RNA-Seq测序的时候就可以通过不同样本之间内参（spike-in）的量来做一条标准曲线，就可以非常准确地对不同样本之间的表达量进行矫正。在这种操作下，可以一定程度上认为是一种绝对定量。（类似于housekeeping gene）</p><p>举例说明：</p><p>通过在样品制备过程中，混入指定数量的spike-in，我们就可以知道不同样本中的基因绝对比表达值。如等细胞数的样本A和样本B，在每个样本中，我加入了等量的spike-in。最后分析发现，spike-in占样本A的1%，但是占样本B的5%。这表明样本A的RNA表达量也许普遍比样本B的表达量高五倍左右。</p></li></ul></li></ol><pre><code>**ERCC control RNA**ERCC = External RNA Controls ConsortiumERCC就是一个专门为了定制一套spike-in RNA而成立的组织，这个组织早在2003年的时候就已经宣告成立。主要的工作就是设计了一套非常好用的spike-in RNA，方便microarray，以及RNA-Seq进行内参定量。在RNA-Seq中增加ERCC的绝对量是可以获得FPKM的绝对量的增加，并且两者成非常好的线性关系。这也是我们能够对RNA-Seq样本进行掺入内参的一个基本前提。R中用来处理带有ERCC spike-in的RNA-Seq数据的包：RUVSeq \citep&#123;risso2014normalization&#125;</code></pre><ol><li><p>RPSM Calculation</p><p> RPSM stands for reads at a single-nucleotide position per sequencing read length (in kb) and per million mapped reads. The formula for RPSM is (10^6 × A) / (B × C), where A is the number of mappable reads at a nucleotide position, B is the total number of mappable reads of the sample, and C is the sequencing read length (in kb; C = 0.199).</p></li><li><p>Read Mapping for RNA-Seq Samples</p></li></ol><ol><li><p>ASE analysis</p><p> ASE analysis was performed as in \citep{lappalainen2013transcriptome} In brief, we considered heterozygous sites obtained from whole-genome sequencing with DNA reads supporting both alleles. We used a minimum site quality call of 200. We excluded sites susceptible to allelic mapping bias, namely (1) sites with 50 bp mappability &lt; 1 according to the UCSC mappability track (implying that the 50 bp flanking region of the site is not unique in the genome), and (2) sites where overlapping simulated RNA-seq reads showed a &gt;5% mapping difference between those that carried the reference allele and those that carried the non-reference allele (see the methods in \citep{lappalainen2013transcriptome}).</p><p> In all analyses, we only used uniquely mapped RNA-seq reads (GEM mapping quality &gt; 150) and sites with base quality &gt; 20 and support from at least 16 reads. Using information from SAMtools (v.0.1.19) mpileup\citep{li2009sequence}, we obtained for each site and each sample the number of reads mapping in the reference, the number of alternative alleles, and the sum of both. Each site was then annotated with the overlapped genomic feature in GENCODE annotation v.15 or the novel exons from the de novo assemblies of each sample. For each site, the number of single cells (and non-single cells) where the site was assessed was also counted. The distribution of allelic ratios for all samples is reported in Figure S9.</p><p> 等位基因特异性表达不平衡（Allelic Expression Imbalance，AEI）可以作为表型用于寻找功能顺式作用多态性，同时可以作为转录区的分子标记来观察同一个体中不同等位基因的特异性表达差异。在杂合子个体中，分别来自父亲与母亲的等位基因，它们在同一细胞中，处于相同的外部环境中，在没有顺式作用多态性（或特定基因表观遗传修饰）的情况下，他们的表达量应该是一样的。与此相反，个体的顺式作用多态性会影响基因的表达及mRNA的加工，导致等位基因有不同的mRNA表达量水平，即AEI(等位基因表达不平衡)。它可以作为一个综合所有顺式作用因子的定量测量。另外，当目的SNP位点位于转录区时，可以直接在总RNA反转录cDNA中观察到SNP 不同等位基因的特异性表达差异，也就是用这个SNP作为Marker对两条不同allele分别进行表达定量。从而观察在同一杂合子个体中两种不同的等位基因型是否对表达水平造成了影响，也就是说排除了个体差异和环境影响之后是否存在由该位点不同基因型所造成的表达差异。该实验需要此SNP位点分型为杂合子的个体的基因组DNA和目的组织细胞抽提得到的总RNA（或者已经反转录好的cDNA）。实验中我们将用基因组DNA的两条allele作为1:1的校正内参，观察目的组织细胞中的RNA中两条allele的比例是否偏离1:1，最终判断是否存在AEI现象，进一步确定该位点与表达水平的关系。</p><p> （需要检测的对象：杂合子的个体的基因组DNA和目的组织细胞抽提得到的总RNA）</p></li><li><p>Gene Quantification and De Novo Assembly</p><p>We used the software Cufflinks (v.2.1.1)\citep{trapnell2012differential, trapnell2010transcript} with default parameters and GENCODE v.12 as a reference annotation\citep{harrow2012gencode}. On the basis of Cufflinks transcript (170,086) quantifications, we selected for further analysis single cells that passed the arbitrary threshold of 12,000 transcripts expressed at FPKM (fragments per kilobase of exon per million reads mapped) &gt; 0.3. We retained 163 UCF1014 single-cell samples expressing an average of 15,807 transcripts (the remaining samples expressed an average of 4,998 transcripts). Additionally, for each sample we performed de novo assembly to identify novel transcripts (Figure S4) without using the reference annotation. We then used the program cuffcompare to compare the assembled transcripts with the GENCODE reference annotation (v.15). Finally, for the four bulk RNA samples, we merged the four assemblies into a merged bulk RNA assembly. We compared each single-cell de novo assembly against the merged bulk RNA assembly to identify novel single-cell-specific transcripts. The program intersectBed from bedtools28 was used for this last comparison.</p></li></ol></blockquote><p>softwares（主要针对ASE分析）</p><blockquote><ol><li><p>SAMtools (v.0.1.19)</p></li><li><p>GENCODE annotation v.15</p></li><li><p>GENCODE v.12</p></li><li><p>Cufflinks(v. 2.1.1)</p></li><li><p>cuffcompare</p></li><li><p>GENCODE reference annotation (v.15).</p></li><li><p>intersectBed （from bedtools）</p></li><li><p>gemtools v. 1.6.2</p></li><li><p>RUVSeq(R) (处理spike-in内参) \citep{borel2015biased}</p></li><li><p>GATK ASEReadCounter \citep{mckenna2010genome}</p><p>如何利用SNP信息构建伪亲代基因组，然后把子代的测序信息mapping上去(用STAR）？</p><p>输入：BAM files (with proper headers) to be analyzed for ASE；A VCF file with specific sites to process</p><p>输出：A table of allele counts at the given sites. By default, it is formatted as a tab-delimited text file that is readable by R and compatible with <a href="http://www.well.ox.ac.uk/~rivas/mamba/">Mamba</a>, a downstream tool developed for allele-specific expression analysis.</p></li><li><p>Bedtools</p></li><li><p>STAR</p></li><li><p>Mamba</p><p>a tool for further analysis data by GATK</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>t.code.sf.net<span class="hljs-regexp">/p/m</span>ambas/mambas mambas-mambas <span class="hljs-comment">#install</span><br></code></pre></td></tr></table></figure></li><li><p>MBASED(利用RNA-seq数据进行ASE检测，将多个单核苷酸变异位点的信息聚合在一起，以获得ASE的基因水平测量，即使在事先没有相位信息的情况下也可以进行) \citep{mayba2014mbased}</p></li><li><p>GeneiASE(仅使用 RNA-seq 数据，不需要已知或估计的单倍型，并且可以作为可下载的软件包使用。问题是，不能确定真正的单倍型，不能确定基因究竟是来自于父系等位基因还是母系等位基因的表达。) \citep{edsgard2016geneiase}</p></li><li><p>QuASAR(R包，当基因型数据无法获取时，可以用此方法。 i)从下一代测序读取基因分型，ii)对杂合子位点的等位基因不平衡进行推断。测序数据可以是 RNA-seq、 DNase-seq、 ATAC-seq 或任何其他类型的高通量测序数据。) \citep{harvey2015quasar}</p></li><li><p>ASEP（只用RNA-seq数据检测ASE）\citep{fan2020asep}</p></li><li><p>SCALE（需要提前确定来自父母系的等位基因，R中的输入数据是矩阵格式，分为母系基因的read count matrix和父系基因的read count matrix，输出是某个基因的父系与母系等位基因表达量/频率）\citep{borel2015biased}</p></li><li><p>phASER \citep{castel2016rare}</p><p>输入：VCF文件（VCF，或 Variant Call Format，它是一种标准化的文本文件格式，用于表示 SNP、 indel 和结构变化调用。VCF 规范过去由千人基因组计划卫生组织维护，但其管理和进一步开发已被基因组学与健康全球联盟的基因组数据工具包团队接管。）tabix index for the VCF，BAM format file containing RNA-seq reads，index for the BAM file。</p></li></ol></blockquote><p>eQTL analysis</p><blockquote><p>Expression quantitative trait loci (eQTL) 基因表达数量性状基因座</p><p>eQTL 研究成本高昂，需要大样本量和对每个样本进行全基因组分型</p><p>To date, most eQTL studies have considered the effects of genetic variation on expression within a single tissue (typically blood). </p><p>分析软件/程序：</p><p>MT-eQTL</p></blockquote><p>ASE analysis</p><blockquote><p>analysis of allele-specific expression (ASE) 分析等位基因特异性表达</p><p>通常是通过计算与杂合位点上每个等位基因相匹配的 RNA-seq 读数和检验1:1等位基因比率的零假设来实现的</p><p>原则上，当基因型信息不容易获得时，可以从 RNA-seq 读数直接推断。然而，在考虑基因型调用的不确定性的情况下，目前还没有联合推断基因型和进行 ASE 推断的方法。</p></blockquote><p>利用SNP来定位不同来源的等位基因 \citep{xie2019modeling}    BLMRM方法（R包）</p><blockquote><p>公牛的 DNA 经过了下一代测序(DNA-seq) ，以确定他的基因组和母牛的参考基因组之间的所有 SNPs。</p><p>然后应用基因组分析工具包(Genome Analysis Toolkit，GATK)\citep{mckenna2010genome}和 SAMtools \citep{li2011statistical}来调用 SNP，只使用两个管道所识别的 SNPs 来生成伪 基因组。</p><p>最后，利用 HISAT2 \citep{kim2015hisat}和 BWA \citep{li2009fast}将来自母牛 × 公牛 F1代的 RNA-seq 片段定位到二倍体基因组，并保留两种方法鉴定的变异体，以减少假阳性的可能影响。</p></blockquote><p>利用亲本特异性 SNPs 分析等位基因特异表达基因。\citep{ahn2019analysis}</p><blockquote><p>Method: 进行了父母基因组和后代转录组测序使用下一代测序。</p><p>随后，利用单核苷酸多态性(single nucleotide polymorphism，SNPs)的个体基因组定位和用于正反杂交的同一品种亲本的联合基因组定位，采用两种不同的方法对 snp 进行了基因组尺度识别。</p><p>利用亲本特异性 SNPs 分析等位基因特异表达基因。</p><p>Result: 由于测序结果的基因组覆盖率较低(约4 ×) ，大多数 SNPs 对于亲本谱系鉴定后代表达的等位基因没有信息价值，因此被排除在我们的分析之外。因此，包含336个基因的436个单核苷酸多态性可用于检测父系等位基因在后代中的不平衡表达。通过计算双亲等位基因在后代中的阅读比例，我们鉴定了7个表现等位基因偏向表达的基因(p &lt; 0.05) ，其中包括以前报道的3个基因和本研究中新发现的4个基因。</p><p>Read mapping: 下载该物种的参考基因组。使用 BWA MEM 包(版本0.7.17-r1188) \citep{li2009fast}将序列读取与引用对齐。SAM 文件使用 samtools 索引转换为 BAM 格式，并使用 samtools sort \citep{li2009sequence}进行排序。RNA-seq 读取到参考基因组的映射是使用带有默认选项和2-pass 模式的 STAR 包(版本2.5.3 a)进行的。</p><p>Variant calling and filtration： 使用 Picard 工具中的 markduplices (2.15.0版， <a href="https://broadinstitute.github.io/Picard/)删除了映射读取的副本。对于">https://broadinstitute.github.io/Picard/)删除了映射读取的副本。对于</a> RNA-seq 读操作，read 组使用 GATK AddOrReplaceReadGroups 添加到映射读操作中，而使用 GATK Split NCigarReads \citep{poplin2017scaling}删除内含区域中映射的溢出读操作。基本质量的阅读是重新校准使用 GATK BaseRecalibrator (版本3.8)的全基因组测序和 RNA-seq 的结果，质量调整的阅读是使用 GATK PrintReads。父母基因组和后代转录组的变异体分别用 GATK 和 HaplotypeCaller 命名，而所谓的变异体用 GATK GenotypeGVCFs \citep{poplin2017scaling}进行联合基因分型。基因型变体用 NCBI dbSNP 150 \citep{sherry2001dbsnp}和 ENSEMBL 注释(发行版92)注释，使用 GATK VariantAnnotator 和 snpEff \citep{cingolani2012program}。随后，使用 GATK variantfilling 和 selectvariant 去除强链偏倚变异(Fisher strand &gt; 30)、低质量深度变异(&lt; 2)和35bp 窗口内3个或3个以上单核苷酸多单核苷酸多态性(SNP)变异体。我们还过滤了低深度变异(个体映射读深度[ DP ] &lt; 3，同一品种联合映射读深度 &lt; 6)。最后，利用 gatkselectvariant 和 snpSift \citep{ruden2012using}筛选出外显 snp。</p><p>Workflow:</p><p><img src="/Users/keqinliu/studying_document/bioinfo/human_RME/images/workflow.jpg" alt="workflow"></p><p>母体读数的比例计算为1 - 父体读数的比例。在该研究中，采用的任意判断等位基因表达偏倚的标准对于任何给定的等位基因都是 &lt; 0.3或 &gt; 0.7。当比值在0.3和0.7之间时，则认为它是双等位基因表达。</p></blockquote><p>利用千人基因组计划鉴别等位基因表达\citep{jadhav2019rna}</p><blockquote><p>数据来源：65 trios from the HapMap / 1000 genomes projects with RNA-Seq data from lymphoblastoid cell lines (LCLs)，and 131 trios from the Genome-of-the-Netherlands （查资料发现好像是血液样本的WGS测序？）</p><p>目前思路：</p><p>先选用4个CHS家庭（一共8位父母的基因组测序数据low coverage，4个孩子的RNA-seq数据，其中两个男孩，两个女孩）试着分析</p></blockquote><p>family trio 1(SH007)</p><p><strong>Collection UUID:</strong>qr1hi-4zz18-hxa1at658d85c1r（用于在run program时使用）</p><p><em>Content address:</em>d41d8cd98f00b204e9800998ecf8427e+0</p><div class="table-container"><table><thead><tr><th>HG00421(father)  <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1606795">https://www.ebi.ac.uk/ena/browser/view/SRR1606795</a> (downloaded) (fastq-dump ing) 59520 (bam downloaded)</th></tr></thead><tbody><tr><td>HG00422(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1606537">https://www.ebi.ac.uk/ena/browser/view/SRR1606537</a> (downloaded)(fastq-dump ing) 59419 (bam downloaded)</td></tr><tr><td>HG00423(female child, Lymphoblastoid cell total RNA)  <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432923">https://www.ebi.ac.uk/ena/browser/view/SRX2432923</a> （downloaded）(bam)</td></tr></tbody></table></div><p>Family trio 2(SH002)</p><div class="table-container"><table><thead><tr><th>HG00406(father) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1602073">https://www.ebi.ac.uk/ena/browser/view/SRR1602073</a> (fastq-dump ing) 58908 (bam downloaded)</th></tr></thead><tbody><tr><td>HG00407(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1602075">https://www.ebi.ac.uk/ena/browser/view/SRR1602075</a>  (downloading) 42363 (bam downloaded)</td></tr><tr><td>HG00408(female child, Lymphoblastoid cell total RNA) <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432921">https://www.ebi.ac.uk/ena/browser/view/SRX2432921</a> (bam)</td></tr></tbody></table></div><p>Family trio3(SH014)</p><div class="table-container"><table><thead><tr><th>HG00442(father) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1607190">https://www.ebi.ac.uk/ena/browser/view/SRR1607190</a> (fastq-dump ing)18181  (downloaded)</th></tr></thead><tbody><tr><td>HG00443(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1606504">https://www.ebi.ac.uk/ena/browser/view/SRR1606504</a> (fastq-dump ing)65250 (downloading bam) 11075</td></tr><tr><td>HG00444(male child, Lymphoblastoid cell total RNA) <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432926">https://www.ebi.ac.uk/ena/browser/view/SRX2432926</a> (bam)</td></tr></tbody></table></div><p>family trio 4(SH021)</p><div class="table-container"><table><thead><tr><th>HG00463(father) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1596842">https://www.ebi.ac.uk/ena/browser/view/SRR1596842</a> (mapping) 49012 (downloaded)</th></tr></thead><tbody><tr><td>HG00464(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1596844">https://www.ebi.ac.uk/ena/browser/view/SRR1596844</a> (prefetching) 13266 (downloaded)</td></tr><tr><td>HG00465(male child, Lymphoblastoid cell total RNA) <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432931">https://www.ebi.ac.uk/ena/browser/view/SRX2432931</a> (bam)</td></tr></tbody></table></div><p>QC by fastqc</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">fastqc /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR5117458/SRR5117458.fastq.gz --extract -o /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/fastqc_report <br><br>fastqc /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR5117459/SRR5117459.fastq.gz --extract -o /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/fastqc_report #failed<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">in</span> SH007/fastqc_report</span><br></code></pre></td></tr></table></figure><p>GATK preprocess</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools faidx new_hg19.fa #generate .fai<br>samtools dict new_hg19.fa -o new_hg19.dict # generate .dict<br></code></pre></td></tr></table></figure><p>mapping by STAR/hisat2</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta"> #</span><span class="bash">generate index</span><br> /Users/keqinliu/STAR-2.7.6a/bin/MacOSX_x86_64/STAR --runThreadN 6 --runMode genomeGenerate \<br> --genomeDir /Users/keqinliu/studying_document/bioinfo/human_RME/STAR/SH007 \<br> --genomeFastaFiles /Users/keqinliu/Downloads/hg38.fa \ <br> --sjdbGTFfile /Users/keqinliu/Downloads/human.gtf \<br> --sjdbOverhang 100<br><span class="hljs-meta"> </span><br><span class="hljs-meta"> #</span><span class="bash"> <span class="hljs-keyword">do</span> mapping</span><br> STAR --runThreadN 20 --genomeDir ~/reference/index/STAR/mm10/ \<br> --readFilesIn SRR3589959_1.fastq SRR3589959_2.fastq \<br> --outSAMtype BAM SortedByCoordinate \<br> --outFileNamePrefix ./SRR3589959<br> <br><span class="hljs-meta"> </span><br><span class="hljs-meta">#</span><span class="bash"> the problem is the processing seems never end!</span><br><span class="hljs-meta">#</span><span class="bash"> and STAR took too much storage</span><br><span class="hljs-meta">#</span><span class="bash"> change to hisat2</span><br><span class="hljs-meta">#</span><span class="bash"> ref genome</span><br><br>hisat2 -x /Users/keqinliu/Downloads/hg38/genome \<br>-1 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.fastq.gz \<br>-S /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.sam <br><span class="hljs-meta">#</span><span class="bash"> report error</span><br><span class="hljs-meta">#</span><span class="bash"> Error: Must specify at least one <span class="hljs-built_in">read</span> input with -U/-1/-2</span><br><span class="hljs-meta">#</span><span class="bash"> Overall time: 00:00:00</span><br><span class="hljs-meta">#</span><span class="bash"> (ERR): hisat2-align exited with value 1</span><br><br>hisat2 -x /Users/keqinliu/Downloads/hg38/genome \<br>-U /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.fastq.gz \<br>-S /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.sam # it works<br><br><br></code></pre></td></tr></table></figure><p>Mac turn off/on </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo pmset -b sleep 0; sudo pmset -b disablesleep 1 # sleep function off<br><br>sudo pmset -b sleep 5; sudo pmset -b disablesleep 0 # sleep function on<br></code></pre></td></tr></table></figure><p>report</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># SRR2432923.sam(child)</span><br><span class="hljs-attribute">2599467</span> reads; of these:<br>  <span class="hljs-attribute">2599467</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">149548</span> (<span class="hljs-number">5</span>.<span class="hljs-number">75</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">1933123</span> (<span class="hljs-number">74</span>.<span class="hljs-number">37</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">516796</span> (<span class="hljs-number">19</span>.<span class="hljs-number">88</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">94</span>.<span class="hljs-number">25</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR1606795.sam(mother)</span><br><span class="hljs-attribute">3638957</span> reads; of these:<br>  <span class="hljs-attribute">3638957</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">727664</span> (<span class="hljs-number">20</span>.<span class="hljs-number">00</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">2715042</span> (<span class="hljs-number">74</span>.<span class="hljs-number">61</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">196251</span> (<span class="hljs-number">5</span>.<span class="hljs-number">39</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">80</span>.<span class="hljs-number">00</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR1606537.sam(father)</span><br><br><span class="hljs-comment"># SRR1602073.sam (father)</span><br><span class="hljs-attribute">2507162</span> reads; of these:<br>  <span class="hljs-attribute">2507162</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">302285</span> (<span class="hljs-number">12</span>.<span class="hljs-number">06</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">2065134</span> (<span class="hljs-number">82</span>.<span class="hljs-number">37</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">139743</span> (<span class="hljs-number">5</span>.<span class="hljs-number">57</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">87</span>.<span class="hljs-number">94</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR1602075.sam (mother)</span><br><span class="hljs-attribute">gzip</span>: /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH<span class="hljs-number">002</span>/SRR<span class="hljs-number">1602075</span>/SRR<span class="hljs-number">1602075</span>.fastq.gz: unexpected end of file<br><span class="hljs-attribute">gzip</span>: /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH<span class="hljs-number">002</span>/SRR<span class="hljs-number">1602075</span>/SRR<span class="hljs-number">1602075</span>.fastq.gz: uncompress failed<br><span class="hljs-attribute">6341028</span> reads; of these:<br>  <span class="hljs-attribute">6341028</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">290072</span> (<span class="hljs-number">4</span>.<span class="hljs-number">57</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">5817396</span> (<span class="hljs-number">91</span>.<span class="hljs-number">74</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">233560</span> (<span class="hljs-number">3</span>.<span class="hljs-number">68</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">95</span>.<span class="hljs-number">43</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR5117454.sam(child)</span><br><br></code></pre></td></tr></table></figure><p>sam to bam</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> SH007</span><br>samtools view -S SRR2432923.sam -b &gt; SRR2432923.bam #child<br>samtools view -S SRR1606795.sam -b &gt; SRR1606795.bam #mother<br>samtools view -S SRR1606537.sam -b &gt; SRR1606537.bam #father<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> SH002</span><br>samtools view -S SRR1602073.sam -b &gt; SRR1602073.bam #father<br>samtools view -S SRR1602075.sam -b &gt; SRR1602075.bam #mother<br>samtools view -S SRR5117454.sam -b &gt; SRR5117454.bam<br></code></pre></td></tr></table></figure><p>GATK hyplotypeCaller</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">/Users/keqinliu/Downloads/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>   -R /Users/keqinliu/Downloads/resources_broad_hg38_v0_Homo_sapiens_assembly38.fasta \<br>   -I /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR2432923.bam \ # child<br>   -O /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR2432923.g.vcf.gz \<br>   -ERC GVCF <br>   -G Standard \<br>   -G AS_Standard<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> report error!</span><br><span class="hljs-meta">#</span><span class="bash"> </span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">then</span> try to check whether bam file is damaged</span><br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR2432923.bam<br><span class="hljs-meta">#</span><span class="bash"> ruturn 0</span><br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH002/SRR1602073.bam <br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH002/SRR5117454.bam <br><span class="hljs-meta">#</span><span class="bash"> all <span class="hljs-built_in">return</span> 0</span><br><span class="hljs-meta">#</span><span class="bash"> so bam file is damaged</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> check whether sam file is damaged</span><br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH002/SRR1602073.sam<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">return</span> 0</span><br><span class="hljs-meta">#</span><span class="bash"> so sam file is dameged</span><br></code></pre></td></tr></table></figure><p>GATK GenotypeGVCFs</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">ascp -k <span class="hljs-number">1</span> -QT -l <span class="hljs-number">300</span>m -P33001 -i ~<span class="hljs-regexp">/.aspera/</span>connect<span class="hljs-regexp">/etc/</span>asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:<span class="hljs-variable">$SRR1606795</span>.<br><br>ascp -i asperaweb_id_dsa.openssh -Tr -Q -l <span class="hljs-number">6</span>M -P33001 -L- -k1 era-fasp@fasp.sra.ebi.ac.uk:<span class="hljs-regexp">/vol1/</span>fastq<span class="hljs-regexp">/SRR160/</span><span class="hljs-number">007</span><span class="hljs-regexp">/SRR1606537/</span>SRR1606537.fastq.gz<br><br>ascp -k <span class="hljs-number">1</span> -QT -l <span class="hljs-number">300</span>m -P33001 -i ~<span class="hljs-regexp">/.aspera/</span>connect<span class="hljs-regexp">/etc/</span>asperaweb_id_dsa.openssh anonftp@ftp-private.ncbi.nlm.nih.gov:<span class="hljs-regexp">//</span>sra<span class="hljs-regexp">/sra-instant/</span>reads<span class="hljs-regexp">/ByExp/</span>sra<span class="hljs-regexp">/SRX/</span>SRX727<span class="hljs-regexp">/SRX727828/</span>SRR1606795/SRR1606795.sra.<br><br>ascp -v -QT -l <span class="hljs-number">400</span>m -P33001 -k1 -i ~<span class="hljs-regexp">/.aspera/</span>connect<span class="hljs-regexp">/etc/</span>asperaweb_id_dsa.openssh anonftp@ftp.ncbi.nlm.nih.gov:<span class="hljs-regexp">/sra/</span>sra-instant<span class="hljs-regexp">/reads/</span>ByRun<span class="hljs-regexp">/sra/</span>SRR<span class="hljs-regexp">/SRR160/</span>SRR1606795/SRR1606795.sra. <br><br>ftp.sra.ebi.ac.uk<span class="hljs-regexp">/vol1/</span>fastq<span class="hljs-regexp">/SRR160/</span><span class="hljs-number">007</span><span class="hljs-regexp">/SRR1606537/</span>SRR1606537.fastq.gz<br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>sratoolkit.<span class="hljs-number">2.10</span>.<span class="hljs-number">8</span>-ubuntu64<span class="hljs-regexp">/bin/</span>fastq-<span class="hljs-keyword">dump</span> -I --split-files<br><br><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>sratoolkit.<span class="hljs-number">2.10</span>.<span class="hljs-number">8</span>-ubuntu64<span class="hljs-regexp">/bin/</span>prefetch SRR1602075<br></code></pre></td></tr></table></figure><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">STAR <span class="hljs-params">--genomeDir</span> <span class="hljs-string">/data/mouse/human_rme/genome_index</span> \<br>    <span class="hljs-params">--runThreadN</span> 20 \<br>    <span class="hljs-params">--readFilesIn</span> sample_r1.fq.gz sample_r2.fq.gz \<br>    <span class="hljs-comment"># --readFilesCommand zcat \</span><br>    <span class="hljs-params">--outFileNamePrefix</span> sample \<br>    <span class="hljs-params">--outSAMtype</span> BAM SortedByCoordinate \<br>    <span class="hljs-params">--outBAMsortingThreadN</span> 10<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index<span class="hljs-regexp">/gatk-4.1.9.0/g</span>atk --java-options <span class="hljs-string">&quot;-Xmx4g&quot;</span> HaplotypeCaller  \<br>   -R <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index/hg19.fa \<br>   -I <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>SH007/SRR5117458.<span class="hljs-number">1</span>.bam \ <span class="hljs-comment"># child</span><br>   -O <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>SH007/SRR5117458.<span class="hljs-number">1</span>.g.vcf.gz \<br>   -ERC GVCF <br>   -G Standard \<br>   -G AS_Standard<br><br>https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/samtools/</span>samtools<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/1.11/</span>samtools-<span class="hljs-number">1.11</span>.tar.bz2<br></code></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@RG</span> <span class="hljs-attribute">ID</span>:HG00423  <span class="hljs-attribute">PL</span>:illumina <span class="hljs-attribute">PU</span>:H0164ALXX140820.<span class="hljs-number">2</span>    <span class="hljs-attribute">LB</span>:Solexa-<span class="hljs-number">272222</span>    <span class="hljs-attribute">PI</span>:<span class="hljs-number">0</span>    <span class="hljs-attribute">DT</span>:<span class="hljs-number">2014</span><span class="hljs-attribute">-08-20T00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>-<span class="hljs-number">0400</span> <span class="hljs-attribute">SM</span>:NA12878  <span class="hljs-attribute">CN</span>:BI<br></code></pre></td></tr></table></figure><p>use GATK to do with 1000genome bam file </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/hg19.fa \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam \<br>-O /data/mouse/human_rme/SH007/HG00421.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>error report:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-keyword">A</span> USER ERROR has occurred: Input files reference and reads have incompatible contigs: No overlapping contigs found.<br>  reference contigs = [chr1, chr2, chr3, chr4, chr5, chr6, chr7, chrX, chr8, chr9, chr10, chr11]<br>  reads contigs = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, X, Y, MT, GL<span class="hljs-number">000207.1</span>, GL<span class="hljs-number">000226.1</span>, GL<span class="hljs-number">000229.1</span>, GL<span class="hljs-number">000231.1</span>, GL<span class="hljs-number">000210.1</span>, GL<span class="hljs-number">000239.1</span>, GL<span class="hljs-number">000235.1</span>, GL<span class="hljs-number">000201.1</span>, GL<span class="hljs-number">000247.1</span>, GL<span class="hljs-number">000245.1</span>, GL<span class="hljs-number">000197.1</span>, GL<span class="hljs-number">000203.1</span>, GL<span class="hljs-number">000246.1</span>, GL<span class="hljs-number">000249.1</span>, GL<span class="hljs-number">000196.1</span>, GL<span class="hljs-number">000248.1</span>, GL<span class="hljs-number">000244.1</span>, GL<span class="hljs-number">000238.1</span>, GL<span class="hljs-number">000202.1</span>, GL<span class="hljs-number">000234.1</span>, GL<span class="hljs-number">000232.1</span>, GL<span class="hljs-number">000206.1</span>, GL<span class="hljs-number">000240.1</span>, GL<span class="hljs-number">000236.1</span>, GL<span class="hljs-number">000241.1</span>, GL<span class="hljs-number">000243.1</span>, GL<span class="hljs-number">000242.1</span>, GL<span class="hljs-number">000230.1</span>, GL<span class="hljs-number">000237.1</span>, GL<span class="hljs-number">000233.1</span>, GL<span class="hljs-number">000204.1</span>, GL<span class="hljs-number">000198.1</span>, GL<span class="hljs-number">000208.1</span>, GL<span class="hljs-number">000191.1</span>, GL<span class="hljs-number">000227.1</span>, GL<span class="hljs-number">000228.1</span>, GL<span class="hljs-number">000214.1</span>, GL<span class="hljs-number">000221.1</span>, GL<span class="hljs-number">000209.1</span>, GL<span class="hljs-number">000218.1</span>, GL<span class="hljs-number">000220.1</span>, GL<span class="hljs-number">000213.1</span>, GL<span class="hljs-number">000211.1</span>, GL<span class="hljs-number">000199.1</span>, GL<span class="hljs-number">000217.1</span>, GL<span class="hljs-number">000216.1</span>, GL<span class="hljs-number">000215.1</span>, GL<span class="hljs-number">000205.1</span>, GL<span class="hljs-number">000219.1</span>, GL<span class="hljs-number">000224.1</span>, GL<span class="hljs-number">000223.1</span>, GL<span class="hljs-number">000195.1</span>, GL<span class="hljs-number">000212.1</span>, GL<span class="hljs-number">000222.1</span>, GL<span class="hljs-number">000200.1</span>, GL<span class="hljs-number">000193.1</span>, GL<span class="hljs-number">000194.1</span>, GL<span class="hljs-number">000225.1</span>, GL<span class="hljs-number">000192.1</span>, NC_007605, hs37d5]<br></code></pre></td></tr></table></figure><p>Use hg19 ref genome</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/hg19.fa \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam \<br>-O /data/mouse/human_rme/SH007/HG00421.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>error report:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-keyword">A</span> USER ERROR has occurred: Input files reference and reads have incompatible contigs: No overlapping contigs found.<br>  reference contigs = [chr1, chr2, chr3, chr4, chr5, chr6, chr7, chrX, chr8, chr9, chr10, chr11]<br>  reads contigs = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, X, Y, MT, GL<span class="hljs-number">000207.1</span>, GL<span class="hljs-number">000226.1</span>, GL<span class="hljs-number">000229.1</span>, GL<span class="hljs-number">000231.1</span>, GL<span class="hljs-number">000210.1</span>, GL<span class="hljs-number">000239.1</span>, GL<span class="hljs-number">000235.1</span>, GL<span class="hljs-number">000201.1</span>, GL<span class="hljs-number">000247.1</span>, GL<span class="hljs-number">000245.1</span>, GL<span class="hljs-number">000197.1</span>, GL<span class="hljs-number">000203.1</span>, GL<span class="hljs-number">000246.1</span>, GL<span class="hljs-number">000249.1</span>, GL<span class="hljs-number">000196.1</span>, GL<span class="hljs-number">000248.1</span>, GL<span class="hljs-number">000244.1</span>, GL<span class="hljs-number">000238.1</span>, GL<span class="hljs-number">000202.1</span>, GL<span class="hljs-number">000234.1</span>, GL<span class="hljs-number">000232.1</span>, GL<span class="hljs-number">000206.1</span>, GL<span class="hljs-number">000240.1</span>, GL<span class="hljs-number">000236.1</span>, GL<span class="hljs-number">000241.1</span>, GL<span class="hljs-number">000243.1</span>, GL<span class="hljs-number">000242.1</span>, GL<span class="hljs-number">000230.1</span>, GL<span class="hljs-number">000237.1</span>, GL<span class="hljs-number">000233.1</span>, GL<span class="hljs-number">000204.1</span>, GL<span class="hljs-number">000198.1</span>, GL<span class="hljs-number">000208.1</span>, GL<span class="hljs-number">000191.1</span>, GL<span class="hljs-number">000227.1</span>, GL<span class="hljs-number">000228.1</span>, GL<span class="hljs-number">000214.1</span>, GL<span class="hljs-number">000221.1</span>, GL<span class="hljs-number">000209.1</span>, GL<span class="hljs-number">000218.1</span>, GL<span class="hljs-number">000220.1</span>, GL<span class="hljs-number">000213.1</span>, GL<span class="hljs-number">000211.1</span>, GL<span class="hljs-number">000199.1</span>, GL<span class="hljs-number">000217.1</span>, GL<span class="hljs-number">000216.1</span>, GL<span class="hljs-number">000215.1</span>, GL<span class="hljs-number">000205.1</span>, GL<span class="hljs-number">000219.1</span>, GL<span class="hljs-number">000224.1</span>, GL<span class="hljs-number">000223.1</span>, GL<span class="hljs-number">000195.1</span>, GL<span class="hljs-number">000212.1</span>, GL<span class="hljs-number">000222.1</span>, GL<span class="hljs-number">000200.1</span>, GL<span class="hljs-number">000193.1</span>, GL<span class="hljs-number">000194.1</span>, GL<span class="hljs-number">000225.1</span>, GL<span class="hljs-number">000192.1</span>, NC_007605, hs37d5]<br></code></pre></td></tr></table></figure><p>use hg38 get error report</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs smali">A USER ERROR has occurred: Input files reference<span class="hljs-built_in"> and </span>reads have incompatible contigs: No overlapping contigs found.<br>  reference contigs = [chr1, chr10, chr11, chr11_KI270721v1_random, chr12, chr13, chr14, chr14_GL000009v2_random, chr14_GL000225v1_random, chr14_KI270722v1_random, chr14_GL000194v1_random, chr14_KI270723v1_random, chr14_KI270724v1_random, chr14_KI270725v1_random, chr14_KI270726v1_random, chr15, chr15_KI270727v1_random, chr16, chr16_KI270728v1_random, chr17, chr17_GL000205v2_random, chr17_KI270729v1_random, chr17_KI270730v1_random, chr18, chr19, chr1_KI270706v1_random, chr1_KI270707v1_random, chr1_KI270708v1_random, chr1_KI270709v1_random, chr1_KI270710v1_random, chr1_KI270711v1_random, chr1_KI270712v1_random, chr1_KI270713v1_random, chr1_KI270714v1_random, chr2, chr20, chr21, chr22, chr22_KI270731v1_random, chr22_KI270732v1_random, chr22_KI270733v1_random, chr22_KI270734v1_random, chr22_KI270735v1_random, chr22_KI270736v1_random, chr22_KI270737v1_random, chr22_KI270738v1_random, chr22_KI270739v1_random, chr2_KI270715v1_random, chr2_KI270716v1_random, chr3, chr3_GL000221v1_random, chr4, chr4_GL000008v2_random, chr5, chr5_GL000208v1_random, chr6, chr7, chr8, chr9, chr9_KI270717v1_random, chr9_KI270718v1_random, chr9_KI270719v1_random, chr9_KI270720v1_random, chr1_KI270762v1_alt, chr1_KI270766v1_alt, chr1_KI270760v1_alt, chr1_KI270765v1_alt, chr1_GL383518v1_alt, chr1_GL383519v1_alt, chr1_GL383520v2_alt, chr1_KI270764v1_alt, chr1_KI270763v1_alt, chr1_KI270759v1_alt, chr1_KI270761v1_alt, chr2_KI270770v1_alt, chr2_KI270773v1_alt, chr2_KI270774v1_alt, chr2_KI270769v1_alt, chr2_GL383521v1_alt, chr2_KI270772v1_alt, chr2_KI270775v1_alt, chr2_KI270771v1_alt, chr2_KI270768v1_alt, chr2_GL582966v2_alt, chr2_GL383522v1_alt, chr2_KI270776v1_alt, chr2_KI270767v1_alt, chr3_JH636055v2_alt, chr3_KI270783v1_alt, chr3_KI270780v1_alt, chr3_GL383526v1_alt, chr3_KI270777v1_alt, chr3_KI270778v1_alt, chr3_KI270781v1_alt, chr3_KI270779v1_alt, chr3_KI270782v1_alt, chr3_KI270784v1_alt, chr4_KI270790v1_alt, chr4_GL383528v1_alt, chr4_KI270787v1_alt, chr4_GL000257v2_alt, chr4_KI270788v1_alt, chr4_GL383527v1_alt, chr4_KI270785v1_alt, chr4_KI270789v1_alt, chr4_KI270786v1_alt, chr5_KI270793v1_alt, chr5_KI270792v1_alt, chr5_KI270791v1_alt, chr5_GL383532v1_alt, chr5_GL949742v1_alt, chr5_KI270794v1_alt, chr5_GL339449v2_alt, chr5_GL383530v1_alt, chr5_KI270796v1_alt, chr5_GL383531v1_alt, chr5_KI270795v1_alt, chr6_GL000250v2_alt, chr6_KI270800v1_alt, chr6_KI270799v1_alt, chr6_GL383533v1_alt, chr6_KI270801v1_alt, chr6_KI270802v1_alt, chr6_KB021644v2_alt, chr6_KI270797v1_alt, chr6_KI270798v1_alt, chr7_KI270804v1_alt, chr7_KI270809v1_alt, chr7_KI270806v1_alt, chr7_GL383534v2_alt, chr7_KI270803v1_alt, chr7_KI270808v1_alt, chr7_KI270807v1_alt, chr7_KI270805v1_alt, chr8_KI270818v1_alt, chr8_KI270812v1_alt, chr8_KI270811v1_alt, chr8_KI270821v1_alt, chr8_KI270813v1_alt, chr8_KI270822v1_alt, chr8_KI270814v1_alt, chr8_KI270810v1_alt, chr8_KI270819v1_alt, chr8_KI270820v1_alt, chr8_KI270817v1_alt, chr8_KI270816v1_alt, chr8_KI270815v1_alt, chr9_GL383539v1_alt, chr9_GL383540v1_alt, chr9_GL383541v1_alt, chr9_GL383542v1_alt, chr9_KI270823v1_alt, chr10_GL383545v1_alt, chr10_KI270824v1_alt, chr10_GL383546v1_alt, chr10_KI270825v1_alt, chr11_KI270832v1_alt, chr11_KI270830v1_alt, chr11_KI270831v1_alt, chr11_KI270829v1_alt, chr11_GL383547v1_alt, chr11_JH159136v1_alt, chr11_JH159137v1_alt, chr11_KI270827v1_alt, chr11_KI270826v1_alt, chr12_GL877875v1_alt, chr12_GL877876v1_alt, chr12_KI270837v1_alt, chr12_GL383549v1_alt, chr12_KI270835v1_alt, chr12_GL383550v2_alt, chr12_GL383552v1_alt, chr12_GL383553v2_alt, chr12_KI270834v1_alt, chr12_GL383551v1_alt, chr12_KI270833v1_alt, chr12_KI270836v1_alt, chr13_KI270840v1_alt, chr13_KI270839v1_alt, chr13_KI270843v1_alt, chr13_KI270841v1_alt, chr13_KI270838v1_alt, chr13_KI270842v1_alt, chr14_KI270844v1_alt, chr14_KI270847v1_alt, chr14_KI270845v1_alt, chr14_KI270846v1_alt, chr15_KI270852v1_alt, chr15_KI270851v1_alt, chr15_KI270848v1_alt, chr15_GL383554v1_alt, chr15_KI270849v1_alt, chr15_GL383555v2_alt, chr15_KI270850v1_alt, chr16_KI270854v1_alt, chr16_KI270856v1_alt, chr16_KI270855v1_alt, chr16_KI270853v1_alt, chr16_GL383556v1_alt, chr16_GL383557v1_alt, chr17_GL383563v3_alt, chr17_KI270862v1_alt, chr17_KI270861v1_alt, chr17_KI270857v1_alt, chr17_JH159146v1_alt, chr17_JH159147v1_alt, chr17_GL383564v2_alt, chr17_GL000258v2_alt, chr17_GL383565v1_alt, chr17_KI270858v1_alt, chr17_KI270859v1_alt, chr17_GL383566v1_alt, chr17_KI270860v1_alt, chr18_KI270864v1_alt, chr18_GL383567v1_alt, chr18_GL383570v1_alt, chr18_GL383571v1_alt, chr18_GL383568v1_alt, chr18_GL383569v1_alt, chr18_GL383572v1_alt, chr18_KI270863v1_alt, chr19_KI270868v1_alt, chr19_KI270865v1_alt, chr19_GL383573v1_alt, chr19_GL383575v2_alt, chr19_GL383576v1_alt, chr19_GL383574v1_alt, chr19_KI270866v1_alt, chr19_KI270867v1_alt, chr19_GL949746v1_alt, chr20_GL383577v2_alt, chr20_KI270869v1_alt, chr20_KI270871v1_alt, chr20_KI270870v1_alt, chr21_GL383578v2_alt, chr21_KI270874v1_alt, chr21_KI270873v1_alt, chr21_GL383579v2_alt, chr21_GL383580v2_alt, chr21_GL383581v2_alt, chr21_KI270872v1_alt, chr22_KI270875v1_alt, chr22_KI270878v1_alt, chr22_KI270879v1_alt, chr22_KI270876v1_alt, chr22_KI270877v1_alt, chr22_GL383583v2_alt, chr22_GL383582v2_alt, chrX_KI270880v1_alt, chrX_KI270881v1_alt, chr19_KI270882v1_alt, chr19_KI270883v1_alt, chr19_KI270884v1_alt, chr19_KI270885v1_alt, chr19_KI270886v1_alt, chr19_KI270887v1_alt, chr19_KI270888v1_alt, chr19_KI270889v1_alt, chr19_KI270890v1_alt, chr19_KI270891v1_alt, chr1_KI270892v1_alt, chr2_KI270894v1_alt, chr2_KI270893v1_alt, chr3_KI270895v1_alt, chr4_KI270896v1_alt, chr5_KI270897v1_alt, chr5_KI270898v1_alt, chr6_GL000251v2_alt, chr7_KI270899v1_alt, chr8_KI270901v1_alt, chr8_KI270900v1_alt, chr11_KI270902v1_alt, chr11_KI270903v1_alt, chr12_KI270904v1_alt, chr15_KI270906v1_alt, chr15_KI270905v1_alt, chr17_KI270907v1_alt, chr17_KI270910v1_alt, chr17_KI270909v1_alt, chr17_JH159148v1_alt, chr17_KI270908v1_alt, chr18_KI270912v1_alt, chr18_KI270911v1_alt, chr19_GL949747v2_alt, chr22_KB663609v1_alt, chrX_KI270913v1_alt, chr19_KI270914v1_alt, chr19_KI270915v1_alt, chr19_KI270916v1_alt, chr19_KI270917v1_alt, chr19_KI270918v1_alt, chr19_KI270919v1_alt, chr19_KI270920v1_alt, chr19_KI270921v1_alt, chr19_KI270922v1_alt, chr19_KI270923v1_alt, chr3_KI270924v1_alt, chr4_KI270925v1_alt, chr6_GL000252v2_alt, chr8_KI270926v1_alt, chr11_KI270927v1_alt, chr19_GL949748v2_alt, chr22_KI270928v1_alt, chr19_KI270929v1_alt, chr19_KI270930v1_alt, chr19_KI270931v1_alt, chr19_KI270932v1_alt, chr19_KI270933v1_alt, chr19_GL000209v2_alt, chr3_KI270934v1_alt, chr6_GL000253v2_alt, chr19_GL949749v2_alt, chr3_KI270935v1_alt, chr6_GL000254v2_alt, chr19_GL949750v2_alt, chr3_KI270936v1_alt, chr6_GL000255v2_alt, chr19_GL949751v2_alt, chr3_KI270937v1_alt, chr6_GL000256v2_alt, chr19_GL949752v1_alt, chr6_KI270758v1_alt, chr19_GL949753v2_alt, chr19_KI270938v1_alt, chrM, chrUn_KI270302v1, chrUn_KI270304v1, chrUn_KI270303v1, chrUn_KI270305v1, chrUn_KI270322v1, chrUn_KI270320v1, chrUn_KI270310v1, chrUn_KI270316v1, chrUn_KI270315v1, chrUn_KI270312v1, chrUn_KI270311v1, chrUn_KI270317v1, chrUn_KI270412v1, chrUn_KI270411v1, chrUn_KI270414v1, chrUn_KI270419v1, chrUn_KI270418v1, chrUn_KI270420v1, chrUn_KI270424v1, chrUn_KI270417v1, chrUn_KI270422v1, chrUn_KI270423v1, chrUn_KI270425v1, chrUn_KI270429v1, chrUn_KI270442v1, chrUn_KI270466v1, chrUn_KI270465v1, chrUn_KI270467v1, chrUn_KI270435v1, chrUn_KI270438v1, chrUn_KI270468v1, chrUn_KI270510v1, chrUn_KI270509v1, chrUn_KI270518v1, chrUn_KI270508v1, chrUn_KI270516v1, chrUn_KI270512v1, chrUn_KI270519v1, chrUn_KI270522v1, chrUn_KI270511v1, chrUn_KI270515v1, chrUn_KI270507v1, chrUn_KI270517v1, chrUn_KI270529v1, chrUn_KI270528v1, chrUn_KI270530v1, chrUn_KI270539v1, chrUn_KI270538v1, chrUn_KI270544v1, chrUn_KI270548v1, chrUn_KI270583v1, chrUn_KI270587v1, chrUn_KI270580v1, chrUn_KI270581v1, chrUn_KI270579v1, chrUn_KI270589v1, chrUn_KI270590v1, chrUn_KI270584v1, chrUn_KI270582v1, chrUn_KI270588v1, chrUn_KI270593v1, chrUn_KI270591v1, chrUn_KI270330v1, chrUn_KI270329v1, chrUn_KI270334v1, chrUn_KI270333v1, chrUn_KI270335v1, chrUn_KI270338v1, chrUn_KI270340v1, chrUn_KI270336v1, chrUn_KI270337v1, chrUn_KI270363v1, chrUn_KI270364v1, chrUn_KI270362v1, chrUn_KI270366v1, chrUn_KI270378v1, chrUn_KI270379v1, chrUn_KI270389v1, chrUn_KI270390v1, chrUn_KI270387v1, chrUn_KI270395v1, chrUn_KI270396v1, chrUn_KI270388v1, chrUn_KI270394v1, chrUn_KI270386v1, chrUn_KI270391v1, chrUn_KI270383v1, chrUn_KI270393v1, chrUn_KI270384v1, chrUn_KI270392v1, chrUn_KI270381v1, chrUn_KI270385v1, chrUn_KI270382v1, chrUn_KI270376v1, chrUn_KI270374v1, chrUn_KI270372v1, chrUn_KI270373v1, chrUn_KI270375v1, chrUn_KI270371v1, chrUn_KI270448v1, chrUn_KI270521v1, chrUn_GL000195v1, chrUn_GL000219v1, chrUn_GL000220v1, chrUn_GL000224v1, chrUn_KI270741v1, chrUn_GL000226v1, chrUn_GL000213v1, chrUn_KI270743v1, chrUn_KI270744v1, chrUn_KI270745v1, chrUn_KI270746v1, chrUn_KI270747v1, chrUn_KI270748v1, chrUn_KI270749v1, chrUn_KI270750v1, chrUn_KI270751v1, chrUn_KI270752v1, chrUn_KI270753v1, chrUn_KI270754v1, chrUn_KI270755v1, chrUn_KI270756v1, chrUn_KI270757v1, chrUn_GL000214v1, chrUn_KI270742v1, chrUn_GL000216v2, chrUn_GL000218v1, chrX, chrY, chrY_KI270740v1_random, chr1_KQ031383v1_fix, chr1_KQ983255v1_alt, chr1_KN538361v1_fix, chr1_KQ458383v1_alt, chr1_KN196473v1_fix, chr1_KZ208904v1_alt, chr1_KN196472v1_fix, chr1_KZ208905v1_alt, chr1_KQ458382v1_alt, chr1_KV880763v1_alt, chr1_KN196474v1_fix, chr1_KN538360v1_fix, chr1_KZ208906v1_fix, chr1_KQ458384v1_alt, chr2_KQ031384v1_fix, chr2_KZ208907v1_alt, chr2_KQ983256v1_alt, chr2_KZ208908v1_alt, chr2_KN538363v1_fix, chr2_KN538362v1_fix, chr3_KV766192v1_fix, chr3_KN196475v1_fix, chr3_KQ031385v1_fix, chr3_KN538364v1_fix, chr3_KZ208909v1_alt, chr3_KQ031386v1_fix, chr3_KN196476v1_fix, chr4_KQ090013v1_alt, chr4_KQ090014v1_alt, chr4_KQ090015v1_alt, chr4_KV766193v1_alt, chr4_KQ983257v1_fix, chr4_KQ983258v1_alt, chr5_KZ208910v1_alt, chr5_KN196477v1_alt, chr5_KV575243v1_alt, chr5_KV575244v1_fix, chr6_KZ208911v1_fix, chr6_KQ090017v1_alt, chr6_KQ031387v1_fix, chr6_KN196478v1_fix, chr6_KQ090016v1_fix, chr6_KV766194v1_fix, chr7_KV880764v1_fix, chr7_KV880765v1_fix, chr7_KZ208912v1_fix, chr7_KZ208913v1_alt, chr7_KQ031388v1_fix, chr8_KZ208915v1_fix, chr8_KV880767v1_fix, chr8_KV880766v1_fix, chr8_KZ208914v1_fix, chr9_KQ090018v1_alt, chr9_KQ090019v1_alt, chr9_KN196479v1_fix, chr10_KN538367v1_fix, chr10_KQ090020v1_alt, chr10_KN196480v1_fix, chr10_KQ090021v1_fix, chr10_KN538366v1_fix, chr10_KN538365v1_fix, chr11_KQ759759v1_fix, chr11_KN538368v1_alt, chr11_KV766195v1_fix, chr11_KQ090022v1_fix, chr11_KN196481v1_fix, chr12_KQ090023v1_alt, chr12_KZ208916v1_fix, chr12_KN538369v1_fix, chr12_KN196482v1_fix, chr12_KZ208918v1_alt, chr12_KQ759760v1_fix, chr12_KZ208917v1_fix, chr12_KN538370v1_fix, chr13_KN538372v1_fix, chr13_KQ090024v1_alt, chr13_KN196483v1_fix, chr13_KN538373v1_fix, chr13_KQ090025v1_alt, chr13_KN538371v1_fix, chr14_KZ208920v1_fix, chr14_KZ208919v1_alt, chr15_KN538374v1_fix, chr15_KQ031389v1_alt, chr16_KQ090026v1_alt, chr16_KV880768v1_fix, chr16_KQ090027v1_alt, chr16_KZ208921v1_alt, chr16_KQ031390v1_alt, chr17_KV766196v1_fix, chr17_KV575245v1_fix, chr17_KV766198v1_alt, chr17_KV766197v1_alt, chr18_KQ458385v1_alt, chr18_KQ090028v1_fix, chr18_KZ208922v1_fix, chr19_KQ458386v1_fix, chr19_KN196484v1_fix, chr19_KV575246v1_alt, chr19_KV575247v1_alt, chr19_KV575248v1_alt, chr19_KV575249v1_alt, chr19_KV575250v1_alt, chr19_KV575251v1_alt, chr19_KV575252v1_alt, chr19_KV575253v1_alt, chr19_KV575254v1_alt, chr19_KV575255v1_alt, chr19_KV575256v1_alt, chr19_KV575257v1_alt, chr19_KV575259v1_alt, chr19_KV575260v1_alt, chr19_KV575258v1_alt, chr22_KN196485v1_alt, chr22_KQ458387v1_alt, chr22_KQ458388v1_alt, chr22_KN196486v1_alt, chr22_KQ759761v1_alt, chr22_KQ759762v1_fix, chrX_KV766199v1_alt, chrY_KZ208923v1_fix, chrY_KZ208924v1_fix, chrY_KN196487v1_fix, chr1_KZ559100v1_fix, chr3_KZ559104v1_fix, chr3_KZ559105v1_alt, chr3_KZ559103v1_alt, chr3_KZ559102v1_alt, chr3_KZ559101v1_alt, chr7_KZ559106v1_alt, chr8_KZ559107v1_alt, chr11_KZ559109v1_fix, chr11_KZ559108v1_fix, chr11_KZ559111v1_alt, chr11_KZ559110v1_alt, chr12_KZ559112v1_alt, chr16_KZ559113v1_fix, chr17_KZ559114v1_alt, chr18_KZ559116v1_alt, chr18_KZ559115v1_fix]<br>  reads contigs = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, X, Y, MT, GL000207.1, GL000226.1, GL000229.1, GL000231.1, GL000210.1, GL000239.1, GL000235.1, GL000201.1, GL000247.1, GL000245.1, GL000197.1, GL000203.1, GL000246.1, GL000249.1, GL000196.1, GL000248.1, GL000244.1, GL000238.1, GL000202.1, GL000234.1, GL000232.1, GL000206.1, GL000240.1, GL000236.1, GL000241.1, GL000243.1, GL000242.1, GL000230.1, GL000237.1, GL000233.1, GL000204.1, GL000198.1, GL000208.1, GL000191.1, GL000227.1, GL000228.1, GL000214.1, GL000221.1, GL000209.1, GL000218.1, GL000220.1, GL000213.1, GL000211.1, GL000199.1, GL000217.1, GL000216.1, GL000215.1, GL000205.1, GL000219.1, GL000224.1, GL000223.1, GL000195.1, GL000212.1, GL000222.1, GL000200.1, GL000193.1, GL000194.1, GL000225.1, GL000192.1, NC_007605, hs37d5]<br><br>***********************************************************************<br>Set the<span class="hljs-keyword"> system</span> property GATK_STACKTRACE_ON_USER_EXCEPTION (--java-options &#x27;-DGATK_STACKTRACE_ON_USER_EXCEPTION=true&#x27;) to print the stack trace.<br></code></pre></td></tr></table></figure><p>Use human_g1k_v37.fasta as reference genome</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam \<br>-O /data/mouse/human_rme/SH007/HG00421.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>error report</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">A USER ERROR <span class="hljs-built_in">has</span> occurred: Traversal by intervals was requested but some <span class="hljs-built_in">input</span> <span class="hljs-keyword">files</span> are not indexed.<br>Please <span class="hljs-built_in">index</span> <span class="hljs-keyword">all</span> <span class="hljs-built_in">input</span> <span class="hljs-keyword">file</span><span class="hljs-variable">s:</span><br><br>samtools <span class="hljs-built_in">index</span> /data/mouse/human_rme/SH007/HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.<span class="hljs-number">20130415</span>.bam<br></code></pre></td></tr></table></figure><p>then try to index by samtools</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools index /data/mouse/human_rme/SH007/HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam<br></code></pre></td></tr></table></figure><p>Error report</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[W::bam_hdr_read] EOF marker <span class="hljs-keyword">is</span> absent. The <span class="hljs-keyword">input</span> <span class="hljs-keyword">is</span> probably truncated<br>[E::bgzf_read_block] Failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">read</span> BGZF block data at <span class="hljs-keyword">offset</span> <span class="hljs-number">4612181361</span> expected <span class="hljs-number">18560</span> bytes; hread returned <span class="hljs-number">12925</span><br>[E::bgzf_read] <span class="hljs-keyword">Read</span> block operation failed <span class="hljs-keyword">with</span> error <span class="hljs-number">4</span> <span class="hljs-keyword">after</span> <span class="hljs-number">0</span> <span class="hljs-keyword">of</span> <span class="hljs-number">4</span> bytes<br>samtools <span class="hljs-keyword">index</span>: failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">index</span> <span class="hljs-keyword">for</span> &quot;/data/mouse/human_rme/SH007/HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam&quot;: <span class="hljs-keyword">No</span> such file <span class="hljs-keyword">or</span> directory<br></code></pre></td></tr></table></figure><p>Guess: bam file is probably truncated, check bam file</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tail HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam | hexdump -C<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs tap">00000000  c1 c5<span class="hljs-number"> 58 </span>42 f1 3a a6<span class="hljs-number"> 89 </span><span class="hljs-number"> 41 </span>9b<span class="hljs-number"> 13 </span>31 bb da cd 6a  |..XB.:..A..1...j|<br>00000010  eb<span class="hljs-number"> 60 </span>5d cc 8a 1e<span class="hljs-number"> 33 </span>ec  cf cd<span class="hljs-number"> 36 </span>53<span class="hljs-number"> 54 </span>e0 ac c1  |.`]...3...6ST...|<br>00000020  cd 6f<span class="hljs-number"> 09 </span>1c f8<span class="hljs-number"> 32 </span>db c1 <span class="hljs-number"> 99 </span>6d<span class="hljs-number"> 91 </span>c6<span class="hljs-number"> 02 </span>b2 b2<span class="hljs-number"> 55 </span> |.o...2...m.....U|<br>00000030 <span class="hljs-number"> 64 </span>ab 0e<span class="hljs-number"> 63 </span>25 d2<span class="hljs-number"> 70 </span>d3 <span class="hljs-number"> 61 </span>19<span class="hljs-number"> 37 </span>84 d8 b7 d9 8d  |d..c%.p.a.7.....|<br>00000040  5a b8<span class="hljs-number"> 02 </span>f1<span class="hljs-number"> 31 </span>fe<span class="hljs-number"> 33 </span>3f <span class="hljs-number"> 07 </span>68 e7<span class="hljs-number"> 79 </span>94 2b ff f6  |Z...1.3?.h.y.+..|<br>00000050  8a a2<span class="hljs-number"> 03 </span>2a<span class="hljs-number"> 47 </span>e8<span class="hljs-number"> 45 </span>85  9d<span class="hljs-number"> 79 </span>39 8e 4b 8e fe<span class="hljs-number"> 91 </span> |...*G.E..y9.K...|<br>00000060  e9<span class="hljs-number"> 74 </span>72 6e cf<span class="hljs-number"> 35 </span>bd 3e  1f 9c 3b a3 fe<span class="hljs-number"> 00 </span>98<span class="hljs-number"> 43 </span> |.trn.5.&gt;..;....C|<br>00000070 <span class="hljs-number"> 97 </span>69 bb<span class="hljs-number"> 07 </span>12<span class="hljs-number"> 40 </span>64<span class="hljs-number"> 98 </span> 2e<span class="hljs-number"> 00 </span>70<span class="hljs-number"> 59 </span>b6 8a db<span class="hljs-number"> 86 </span> |.i...@d...pY....|<br>00000080  0a<span class="hljs-number"> 65 </span>bb<span class="hljs-number"> 34 </span>c4 8a a1 e9 <span class="hljs-number"> 34 </span>6b 9c<span class="hljs-number"> 36 </span>e3<span class="hljs-number"> 45 </span>22 b6  |.e.4....4k.6.E&quot;.|<br>00000090  c6<span class="hljs-number"> 83 </span>d9<span class="hljs-number"> 40 </span>a9<span class="hljs-number"> 32 </span>5d<span class="hljs-number"> 08 </span> 1c<span class="hljs-number"> 07 </span>40 8d 3a<span class="hljs-number"> 05 </span>17 4d  |...@.2]...@.:..M|<br>000000a0  d1<span class="hljs-number"> 14 </span>a8<span class="hljs-number"> 18 </span>16<span class="hljs-number"> 96 </span>e1 f7  ae ef aa e9<span class="hljs-number"> 49 </span>f4 f6<span class="hljs-number"> 77 </span> |............I..w|<br>000000b0 <span class="hljs-number"> 56 </span>a4<span class="hljs-number"> 65 </span>11 e8 c5 c9 ee <span class="hljs-number"> 79 </span>39 8e eb 9a<span class="hljs-number"> 33 </span>77<span class="hljs-number"> 22 </span> |V.e.....y9...3w&quot;|<br>000000c0  e4 5c cc a5<span class="hljs-number"> 44 </span>43 cc 0b <span class="hljs-number"> 88 </span>db 1d<span class="hljs-number"> 00 </span>99<span class="hljs-number"> 18 </span>bd 2d  |.\..DC.........-|<br>000000d0 <span class="hljs-number"> 13 </span>1b db<span class="hljs-number"> 02 </span>85 0b 4f b1  a1 c4 f6 a3<span class="hljs-number"> 27 </span>cc<span class="hljs-number"> 76 </span>eb  |......O.....&#x27;.v.|<br>000000e0 <span class="hljs-number"> 59 </span>49 4a cd<span class="hljs-number"> 70 </span>87<span class="hljs-number"> 93 </span>15 <span class="hljs-number"> 38 </span>10<span class="hljs-number"> 01 </span>44 7f 5c e0<span class="hljs-number"> 45 </span> |YIJ.p...8..D.\.E|<br>000000f0 <span class="hljs-number"> 53 </span>5a f9<span class="hljs-number"> 08 </span>b3<span class="hljs-number"> 14 </span>c0 bb  e4 da<span class="hljs-number"> 96 </span>85<span class="hljs-number"> 27 </span>6b<span class="hljs-number"> 58 </span>be  |SZ..........&#x27;kX.|<br>00000100  3e<span class="hljs-number"> 47 </span>71<span class="hljs-number"> 27 </span>de f6 b3 ef  4c<span class="hljs-number"> 27 </span>b0<span class="hljs-number"> 26 </span>de b6 dd<span class="hljs-number"> 84 </span> |&gt;Gq&#x27;....L&#x27;.&amp;....|<br>00000110 <span class="hljs-number"> 38 </span>b9<span class="hljs-number"> 51 </span>1b af<span class="hljs-number"> 61 </span>b9 0a  ce 0c<span class="hljs-number"> 13 </span>06<span class="hljs-number"> 46 </span>c5<span class="hljs-number"> 39 </span>8e  |8.Q..a......F.9.|<br>00000120 <span class="hljs-number"> 35 </span>b1<span class="hljs-number"> 24 </span>2a 2b<span class="hljs-number"> 94 </span>ea<span class="hljs-number"> 06 </span><span class="hljs-number"> 17 </span>9a<span class="hljs-number"> 98 </span>28 d2<span class="hljs-number"> 81 </span>77<span class="hljs-number"> 48 </span> |5.$*+......(..wH|<br>00000130  3d<span class="hljs-number"> 57 </span>88<span class="hljs-number"> 40 </span>a4<span class="hljs-number"> 79 </span>96 f3  7c 0f<span class="hljs-number"> 62 </span>05 4a e2<span class="hljs-number"> 44 </span>c7  |=W.@.y..|.b.J.D.|<br>00000140 <span class="hljs-number"> 34 </span>a4 0e d9 df 0b 0a<span class="hljs-number"> 49 </span><span class="hljs-number"> 18 </span>07 7c cf f5 fd d2 3c  |4......I..|....&lt;|<br>00000150  ab ba a2<span class="hljs-number"> 80 </span>f2 fb 8a d5 <span class="hljs-number"> 24 </span>d2 fd e5<span class="hljs-number"> 15 </span>19 1c<span class="hljs-number"> 94 </span> |........$.......|<br>00000160 <span class="hljs-number"> 33 </span>59 dc<span class="hljs-number"> 55 </span>38<span class="hljs-number"> 95 </span>2e c1 <span class="hljs-number"> 15 </span>2c<span class="hljs-number"> 28 </span>fc d4<span class="hljs-number"> 35 </span>d7 e1  |3Y.U8....,(..5..|<br>00000170 <span class="hljs-number"> 01 </span>23 b0 ce 4b d9<span class="hljs-number"> 92 </span>08 <span class="hljs-number"> 71 </span>69 6c<span class="hljs-number"> 82 </span>1b<span class="hljs-number"> 41 </span>22<span class="hljs-number"> 88 </span> |.<span class="hljs-comment">#..K...qil..A&quot;.|</span><br>00000180 <span class="hljs-number"> 74 </span>51<span class="hljs-number"> 15 </span>8a<span class="hljs-number"> 07 </span>52 f9 ea <span class="hljs-number"> 28 </span>94<span class="hljs-number"> 05 </span>3f 0c b0 f0 ce  |tQ...R..(..?....|<br>00000190 <span class="hljs-number"> 45 </span>6c<span class="hljs-number"> 94 </span>44<span class="hljs-number"> 59 </span>65<span class="hljs-number"> 42 </span>12 <span class="hljs-number"> 85 </span>a2 df 9e 2e<span class="hljs-number"> 45 </span>52<span class="hljs-number"> 15 </span> |El.DYeB......ER.|<br>000001a0 <span class="hljs-number"> 88 </span>17<span class="hljs-number"> 72 </span>e6 1d 6c dd<span class="hljs-number"> 99 </span> 9f 7d<span class="hljs-number"> 45 </span>61 a8<span class="hljs-number"> 56 </span>f3 fe  |..r..l...&#125;Ea.V..|<br>000001b0  6a 7d<span class="hljs-number"> 87 </span>e7 1a e9 fe ca  0a<span class="hljs-number"> 77 </span>8b 5a<span class="hljs-number"> 26 </span>72<span class="hljs-number"> 51 </span>76  |j&#125;.......w.Z&amp;rQv|<br>000001c0 <span class="hljs-number"> 72 </span>5e b7 e4 ca<span class="hljs-number"> 77 </span>bf ec <span class="hljs-number"> 19 </span>08 d3 cc a8 1f<span class="hljs-number"> 45 </span>0e  |r^...w........E.|<br>000001d0  ca 6a<span class="hljs-number"> 01 </span>85 f2 0b<span class="hljs-number"> 45 </span>08  b4<span class="hljs-number"> 24 </span>2b d0<span class="hljs-number"> 58 </span>c4 a2 e8  |.j....E..$+.X...|<br>000001e0  c6<span class="hljs-number"> 64 </span>cb f3<span class="hljs-number"> 85 </span>36<span class="hljs-number"> 41 </span>b8  0d cf<span class="hljs-number"> 00 </span>d2<span class="hljs-number"> 89 </span>00 8e e6  |.d...6A.........|<br>000001f0  ef<span class="hljs-number"> 72 </span>16 e1 f6 e8<span class="hljs-number"> 84 </span>fb  be 1f<span class="hljs-number"> 45 </span>c5<span class="hljs-number"> 62 </span>d1<span class="hljs-number"> 09 </span>0b  |.r........E.b...|<br>00000200  3b bb 9e<span class="hljs-number"> 50 </span>14<span class="hljs-number"> 42 </span>8c 4d <span class="hljs-number"> 96 </span>bf<span class="hljs-number"> 41 </span>e9 dd bb<span class="hljs-number"> 91 </span>88  |;..P.B.M..A.....|<br>00000210  c2 dd 5d<span class="hljs-number"> 42 </span>bd<span class="hljs-number"> 48 </span>f1 b5  9d<span class="hljs-number"> 09 </span>9a 8c<span class="hljs-number"> 75 </span>a3 1c 1f  |..]B.H......u...|<br>00000220  4e<span class="hljs-number"> 50 </span>dc 9a<span class="hljs-number"> 33 </span>6d<span class="hljs-number"> 94 </span>ed <span class="hljs-number"> 23 </span>8b<span class="hljs-number"> 01 </span>d8<span class="hljs-number"> 44 </span>a2 ef<span class="hljs-number"> 47 </span> |NP..3m..<span class="hljs-comment">#...D..G|</span><br>00000230  6f 6d 6c fc<span class="hljs-number"> 02 </span>90 2e<span class="hljs-number"> 07 </span><span class="hljs-number"> 27 </span>5a<span class="hljs-number"> 46 </span>c3 fe<span class="hljs-number"> 68 </span>30 0e  |oml.....&#x27;ZF..h0.|<br>00000240 <span class="hljs-number"> 75 </span>73 7d<span class="hljs-number"> 38 </span>bf 4c 8f c3  9f<span class="hljs-number"> 51 </span>87 f5 c6 e7 5d 0f  |us&#125;8.L...Q....].|<br>00000250  ce bb f3 c1 e4 bc eb 3f <span class="hljs-number"> 21 </span>07 a3 fb 2a<span class="hljs-number"> 74 </span>c4 0b  |.......?!...*t..|<br>00000260 <span class="hljs-number"> 85 </span>00 4e<span class="hljs-number"> 47 </span>11 ed 6e<span class="hljs-number"> 17 </span> b6<span class="hljs-number"> 44 </span>bc<span class="hljs-number"> 15 </span>3b 5b 3b 9b  |..NG..n..D..;[;.|<br>00000270  f0 d8<span class="hljs-number"> 75 </span>24<span class="hljs-number"> 77 </span>15 f3 fd  e0 ee 7e<span class="hljs-number"> 29 </span>a4<span class="hljs-number"> 39 </span>30 eb  |..u$w.....~).90.|<br>00000280  0f<span class="hljs-number"> 20 </span>d8 cd<span class="hljs-number"> 07 </span>ed 7b<span class="hljs-number"> 27 </span> 0f 4e ee<span class="hljs-number"> 55 </span>2f<span class="hljs-number"> 66 </span>28<span class="hljs-number"> 71 </span> |. ....&#123;&#x27;.N.U/f(q|<br>00000290 <span class="hljs-number"> 88 </span>e2 f6 dc<span class="hljs-number"> 10 </span>c5 2b cf <span class="hljs-number"> 46 </span>e6 7f<span class="hljs-number"> 06 </span>fa af 3d bc  |......+.F.....=.|<br>000002a0 <span class="hljs-number"> 28 </span>16 f3 a3 ef 2c 8a<span class="hljs-number"> 16 </span><span class="hljs-number"> 34 </span>20<span class="hljs-number"> 18 </span>6b b4 4e 9a<span class="hljs-number"> 67 </span> |(....,..4 .k.N.g|<br>000002b0  1b<span class="hljs-number"> 27 </span>77<span class="hljs-number"> 32 </span>bc 1f c9<span class="hljs-number"> 21 </span> 7a f3 1c a2 2b bb<span class="hljs-number"> 83 </span>61  |.&#x27;w2...!z...+..a|<br>000002c0  ae 0b de a4 d7 c9 6d<span class="hljs-number"> 87 </span><span class="hljs-number"> 77 </span>dd cd 1b<span class="hljs-number"> 47 </span>bb<span class="hljs-number"> 31 </span>67  |......m.w...G.1g|<br>000002d0  b9<span class="hljs-number"> 98 </span>c5<span class="hljs-number"> 07 </span>71 a9<span class="hljs-number"> 78 </span>58 <span class="hljs-number"> 22 </span>bb 3b<span class="hljs-number"> 81 </span>5f<span class="hljs-number"> 88 </span>f8<span class="hljs-number"> 81 </span> |....q.xX&quot;.;._...|<br>000002e0 <span class="hljs-number"> 47 </span>92<span class="hljs-number"> 42 </span>71<span class="hljs-number"> 87 </span>45<span class="hljs-number"> 31 </span>c0  aa b7 5c ae<span class="hljs-number"> 76 </span>b9 b8<span class="hljs-number"> 01 </span> |G.Bq.E1...\.v...|<br>000002f0  a1<span class="hljs-number"> 05 </span>b0 bc<span class="hljs-number"> 30 </span>74 e2<span class="hljs-number"> 03 </span> 6c<span class="hljs-number"> 26 </span>01 5f 9e<span class="hljs-number"> 73 </span>e0 3c  |....0t..l&amp;._.s.&lt;|<br>00000300  8b<span class="hljs-number"> 25 </span>7d a1<span class="hljs-number"> 74 </span>70 e7 c8 <span class="hljs-number"> 15 </span>b1<span class="hljs-number"> 24 </span>a2<span class="hljs-number"> 28 </span>19 1c 9f  |.%&#125;.tp....$.(...|<br>00000310  4c<span class="hljs-number"> 92 </span>85 c0 e2<span class="hljs-number"> 75 </span>bb e5  fb<span class="hljs-number"> 41 </span>ad<span class="hljs-number"> 75 </span>bf b6 1e<span class="hljs-number"> 52 </span> |L....u...A.u...R|<br>00000320 <span class="hljs-number"> 48 </span>48 5c a6 0b<span class="hljs-number"> 03 </span>be<span class="hljs-number"> 39 </span> d7<span class="hljs-number"> 07 </span>35<span class="hljs-number"> 39 </span>f0<span class="hljs-number"> 50 </span>cc af  |HH\....9..59.P..|<br>00000330  b0<span class="hljs-number"> 10 </span>01 4f<span class="hljs-number"> 84 </span>fb f0 bc  bb 9a<span class="hljs-number"> 33 </span>d9 cd<span class="hljs-number"> 47 </span>1c f0  |...O......3..G..|<br>00000340  3c d8<span class="hljs-number"> 73 </span>5c<span class="hljs-number"> 56 </span>88<span class="hljs-number"> 14 </span>d9  f3<span class="hljs-number"> 75 </span>24<span class="hljs-number"> 72 </span>81<span class="hljs-number"> 70 </span>9c 2d  |&lt;.s\V....u$r.p.-|<br>00000350  a2 a4<span class="hljs-number"> 91 </span>c2 8f 4a<span class="hljs-number"> 48 </span>bd  8a 3a f5 f7<span class="hljs-number"> 62 </span>e6 8b<span class="hljs-number"> 94 </span> |.....JH..:..b...|<br>00000360  ee 0a d7 a3 5b<span class="hljs-number"> 41 </span>bc b5  e7<span class="hljs-number"> 09 </span>f0<span class="hljs-number"> 40 </span>94<span class="hljs-number"> 14 </span>73 3e  |....[A.....@..s&gt;|<br>00000370 <span class="hljs-number"> 09 </span>c1<span class="hljs-number"> 69 </span>3f cf dd 0a 9d <span class="hljs-number"> 19 </span>07 fb e6 0a 0e f6 c5  |..i?............|<br>00000380  0b 4e<span class="hljs-number"> 61 </span>22<span class="hljs-number"> 66 </span>64 c5<span class="hljs-number"> 95 </span> af e3<span class="hljs-number"> 77 </span>87 3d c7 e9<span class="hljs-number"> 31 </span> |.Na&quot;fd....w.=..1|<br>00000390 <span class="hljs-number"> 26 </span>34<span class="hljs-number"> 66 </span>b7<span class="hljs-number"> 44 </span>c2<span class="hljs-number"> 50 </span>46 <span class="hljs-number"> 80 </span>a9<span class="hljs-number"> 58 </span>94 b2<span class="hljs-number"> 85 </span>8e d8  |&amp;4f.D.PF..X.....|<br>000003a0  cd<span class="hljs-number"> 64 </span>58 1c<span class="hljs-number"> 10 </span>29 ac d4 <span class="hljs-number"> 11 </span>4a d0 2a ec 3a<span class="hljs-number"> 60 </span>b6  |.dX..)...J.*.:`.|<br>000003b0  af<span class="hljs-number"> 29 </span>29<span class="hljs-number"> 27 </span>2c<span class="hljs-number"> 10 </span>28 b0 <span class="hljs-number"> 01 </span>d1 b1 4c 7c cc 4a a2  |.))&#x27;,.(....L|.J.|<br>000003c0  f2 a7 b0 5d ea<span class="hljs-number"> 89 </span>48 6d <span class="hljs-number"> 07 </span>02 c4 d1<span class="hljs-number"> 97 </span>35 f7 af  |...]..Hm.....5..|<br>000003d0 <span class="hljs-number"> 47 </span>9a f1 b7<span class="hljs-number"> 57 </span>64 bf<span class="hljs-number"> 50 </span> d0<span class="hljs-number"> 64 </span>49 5c<span class="hljs-number"> 79 </span>5e bc e4  |G...Wd.P.dI\y^..|<br>000003e0  ca f8<span class="hljs-number"> 62 </span>4f aa<span class="hljs-number"> 93 </span>77<span class="hljs-number"> 87 </span> 1d<span class="hljs-number"> 81 </span>8d cf<span class="hljs-number"> 38 </span>c6<span class="hljs-number"> 63 </span>a7  |..bO..w.....8.c.|<br>000003f0  a3 6c a1 b2 6c 7b bd b0  0f<span class="hljs-number"> 21 </span>d3<span class="hljs-number"> 58 </span>4f 6d<span class="hljs-number"> 89 </span>d2  |.l..l&#123;...!.XOm..|<br>00000400 <span class="hljs-number"> 58 </span>d9<span class="hljs-number"> 01 </span>9c<span class="hljs-number"> 59 </span>01 a6 cb  b3<span class="hljs-number"> 65 </span>b1<span class="hljs-number"> 65 </span>0c 2e 2a c7  |X...Y....e.e..*.|<br>00000410  c7<span class="hljs-number"> 38 </span>eb<span class="hljs-number"> 32 </span>d9<span class="hljs-number"> 27 </span>3b<span class="hljs-number"> 99 </span> a6 ca<span class="hljs-number"> 76 </span>d8 e0 5a df b5  |.8.2.&#x27;;...v..Z..|<br>00000420  9d a6 fa d2 8d<span class="hljs-number"> 99 </span>b4 c0 <span class="hljs-number"> 32 </span>d0<span class="hljs-number"> 28 </span>41<span class="hljs-number"> 20 </span>16 9b 4d  |........2.(A ..M|<br>00000430 <span class="hljs-number"> 27 </span>72<span class="hljs-number"> 03 </span>b6 d9<span class="hljs-number"> 74 </span>98 b9  d3 de cc 9d<span class="hljs-number"> 76 </span>7a d8<span class="hljs-number"> 81 </span> |&#x27;r...t......vz..|<br>00000440  da e9 b0<span class="hljs-number"> 51 </span>cf e9 e0<span class="hljs-number"> 70 </span><span class="hljs-number"> 77 </span>7f<span class="hljs-number"> 34 </span>34<span class="hljs-number"> 03 </span>d3 e1<span class="hljs-number"> 72 </span> |...Q...pw.44...r|<br>00000450  c8 fa 5d<span class="hljs-number"> 87 </span>71 5e a2<span class="hljs-number"> 31 </span> f1<span class="hljs-number"> 71 </span>6d<span class="hljs-number"> 15 </span>c4<span class="hljs-number"> 65 </span>01<span class="hljs-number"> 86 </span> |..].q^.1.qm..e..|<br>00000460  0d d8 ad c7<span class="hljs-number"> 53 </span>23 8d dd  aa 8b<span class="hljs-number"> 18 </span>26<span class="hljs-number"> 00 </span>b2 6d d5  |....S<span class="hljs-comment">#.....&amp;..m.|</span><br>00000470  b3<span class="hljs-number"> 43 </span>6c b8 e2<span class="hljs-number"> 02 </span>30<span class="hljs-number"> 56 </span> d8 a3 5a b6 ab<span class="hljs-number"> 84 </span>50 4f  |.Cl...0V..Z...PO|<br>00000480 <span class="hljs-number"> 19 </span>c7<span class="hljs-number"> 81 </span>34<span class="hljs-number"> 70 </span>66 0c 8c <span class="hljs-number"> 51 </span>5a<span class="hljs-number"> 39 </span>b1<span class="hljs-number"> 55 </span>67 bd<span class="hljs-number"> 28 </span> |...4pf..QZ9.Ug.(|<br>00000490 <span class="hljs-number"> 44 </span>5b bf<span class="hljs-number"> 77 </span>d6 ba<span class="hljs-number"> 52 </span>57  cd<span class="hljs-number"> 47 </span>3e f2<span class="hljs-number"> 91 </span>a7 8f f4  |D[.w..RW.G&gt;.....|<br>000004a0  c4 a4 e5 db<span class="hljs-number"> 17 </span>47 5f 7f  fe 9d e5<span class="hljs-number"> 55 </span>41 cd<span class="hljs-number"> 56 </span>bd  |.....G_....UA.V.|<br>000004b0 <span class="hljs-number"> 56 </span>ad 9d 8d 9b f3 1e 6d  bb<span class="hljs-number"> 80 </span>33 7c 3b 1a<span class="hljs-number"> 75 </span>47  |V......m..3|;.uG|<br>000004c0  7c<span class="hljs-number"> 98 </span>e7<span class="hljs-number"> 80 </span>f1<span class="hljs-number"> 90 </span>75 4c <span class="hljs-number"> 77 </span>14<span class="hljs-number"> 62 </span>9f<span class="hljs-number"> 02 </span>a6<span class="hljs-number"> 14 </span>88  ||.....uLw.b.....|<br>000004d0  c6 cc<span class="hljs-number"> 39 </span>e6 1e ca<span class="hljs-number"> 76 </span>9d <span class="hljs-number"> 12 </span>6e 2a 4e<span class="hljs-number"> 55 </span>12<span class="hljs-number"> 43 </span>50  |..9...v..n*NU.CP|<br>000004e0  0c 4e<span class="hljs-number"> 05 </span>f7 8a<span class="hljs-number"> 61 </span>24 8c <span class="hljs-number"> 95 </span>76<span class="hljs-number"> 34 </span>75 cd<span class="hljs-number"> 13 </span>c1<span class="hljs-number"> 29 </span> |.N...a$..v4u...)|<br>000004f0  4e<span class="hljs-number"> 14 </span>49 df e3<span class="hljs-number"> 10 </span>b5<span class="hljs-number"> 01 </span><span class="hljs-number"> 43 </span>66<span class="hljs-number"> 56 </span>d0<span class="hljs-number"> 52 </span>79 4c<span class="hljs-number"> 65 </span> |N.I.....CfV.RyLe|<br>00000500  8b<span class="hljs-number"> 85 </span>ca<span class="hljs-number"> 29 </span>8b<span class="hljs-number"> 50 </span>ac e7 <span class="hljs-number"> 12 </span>c1 b9 e7<span class="hljs-number"> 39 </span>10 b0 0a  |...).P......9...|<br>00000510  e8<span class="hljs-number"> 99 </span>8f c6<span class="hljs-number"> 01 </span>ef 0f 2e <span class="hljs-number"> 49 </span>95 cc 0d<span class="hljs-number"> 73 </span>5f 1f<span class="hljs-number"> 68 </span> |........I...s_.h|<br>00000520  6d f7 2f a5<span class="hljs-number"> 29 </span>b3 b6<span class="hljs-number"> 89 </span> ed 0b<span class="hljs-number"> 65 </span>74 af a8<span class="hljs-number"> 22 </span>95  |m./.).....et..&quot;.|<br>00000530  b5 3c d8<span class="hljs-number"> 64 </span>50 c5 b6<span class="hljs-number"> 96 </span> e2 c7 6c 7a db<span class="hljs-number"> 26 </span>29<span class="hljs-number"> 92 </span> |.&lt;.dP.....lz.&amp;).|<br>00000540  2c<span class="hljs-number"> 92 </span>c6 b6 a6 6c<span class="hljs-number"> 08 </span>ce  a0 5c 3e b5 5d<span class="hljs-number"> 10 </span>da 2e  |,....l...\&gt;.]...|<br>00000550  e3 b5 ed a6 fc<span class="hljs-number"> 12 </span>dd ca  f5<span class="hljs-number"> 68 </span>37 fd ae b7 2f d6  |.........h7.../.|<br>00000560 <span class="hljs-number"> 82 </span>7e fd 9d<span class="hljs-number"> 65 </span>a9<span class="hljs-number"> 92 </span>7a  f5 b4 7a d6 a8 8f 4f c3  |.~..e..z..z...O.|<br>00000570  2b fb 8c fc<span class="hljs-number"> 10 </span>57 f5<span class="hljs-number"> 76 </span> fa<span class="hljs-number"> 21 </span>41<span class="hljs-number"> 59 </span>76 ad<span class="hljs-number"> 43 </span>a2  |+....W.v.!AYv.C.|<br>00000580 <span class="hljs-number"> 70 </span>be d8<span class="hljs-number"> 76 </span>e5<span class="hljs-number"> 00 </span>58 dc  6a<span class="hljs-number"> 71 </span>05 dc<span class="hljs-number"> 58 </span>f5 2e 5c  |p..v..X.jq..X..\|<br>00000590  8c<span class="hljs-number"> 25 </span>50<span class="hljs-number"> 29 </span>5f a6 4a<span class="hljs-number"> 85 </span><span class="hljs-number"> 12 </span>eb<span class="hljs-number"> 15 </span>26<span class="hljs-number"> 64 </span>d2<span class="hljs-number"> 30 </span>14  |.%P)_.J....&amp;d.0.|<br>000005a0  0c b7<span class="hljs-number"> 63 </span>56<span class="hljs-number"> 60 </span>c8 a8<span class="hljs-number"> 62 </span><span class="hljs-number"> 80 </span>89 0c 9f<span class="hljs-number"> 69 </span>db<span class="hljs-number"> 82 </span>aa  |..cV`..b....i...|<br>000005b0  a5<span class="hljs-number"> 56 </span>a9 cc 0b b6 b6<span class="hljs-number"> 02 </span> a1<span class="hljs-number"> 13 </span>a0 1b 2b 5c c7 5f  |.V..........+\._|<br>000005c0  7c<span class="hljs-number"> 67 </span>59 f1 b6 de 3c ad  d7 cf c6 a3 6e<span class="hljs-number"> 57 </span>b7<span class="hljs-number"> 64 </span> ||gY...&lt;.....nW.d|<br>000005d0 <span class="hljs-number"> 86 </span>6b b2 4c ae<span class="hljs-number"> 17 </span>71 6e  db<span class="hljs-number"> 77 </span>8c 5d 2f<span class="hljs-number"> 62 </span>a5 ab  |.k.L..qn.w.]/b..|<br>000005e0 <span class="hljs-number"> 33 </span>ef 2a<span class="hljs-number"> 75 </span>2a 6c d3 3a  6e 8f 4d<span class="hljs-number"> 15 </span>b3 da e0 d8  |3.*u*l.:n.M.....|<br>000005f0  ad<span class="hljs-number"> 43 </span>68<span class="hljs-number"> 56 </span>4e 4b c7<span class="hljs-number"> 83 </span><span class="hljs-number"> 70 </span>01<span class="hljs-number"> 45 </span>7c a5 cc<span class="hljs-number"> 96 </span>6b  |.ChVNK..p.E|...k|<br>00000600 <span class="hljs-number"> 80 </span>a9 0b 1c<span class="hljs-number"> 30 </span>c6<span class="hljs-number"> 46 </span>00 <span class="hljs-number"> 15 </span>70 dc c2 b1 9e<span class="hljs-number"> 52 </span>5e  |....0.F..p....R^|<br>00000610  f7 7a<span class="hljs-number"> 53 </span>a0 db 2b 2c fa  e7 2f<span class="hljs-number"> 16 </span>36 4e da<span class="hljs-number"> 67 </span>a7  |.zS..+,../.6N.g.|<br>00000620  b5 7a e6 3a ae<span class="hljs-number"> 65 </span>cc dd <span class="hljs-number"> 73 </span>a7 d3 0d<span class="hljs-number"> 85 </span>e2 a8 0e  |.z.:.e..s.......|<br>00000630  8c 4d<span class="hljs-number"> 26 </span>06<span class="hljs-number"> 05 </span>d1<span class="hljs-number"> 62 </span>b0  6f<span class="hljs-number"> 29 </span>b0 6f<span class="hljs-number"> 11 </span>55<span class="hljs-number"> 70 </span>13  |.M&amp;...b.o).o.Up.|<br>00000640  eb<span class="hljs-number"> 77 </span>c5<span class="hljs-number"> 58 </span>e8 a1 5c f6 <span class="hljs-number"> 89 </span>56 e3 5c<span class="hljs-number"> 27 </span>ae<span class="hljs-number"> 32 </span>4e  |.w.X..\..V.\&#x27;.2N|<br>00000650  a3<span class="hljs-number"> 08 </span>65 d1 0c b3 5b<span class="hljs-number"> 35 </span><span class="hljs-number"> 70 </span>f7<span class="hljs-number"> 37 </span>b3<span class="hljs-number"> 63 </span>dc f0 2b  |..e...[5p.7.c..+|<br>00000660 <span class="hljs-number"> 18 </span>c7<span class="hljs-number"> 82 </span>73 a2<span class="hljs-number"> 04 </span>5f 4f  a0 5f 9c<span class="hljs-number"> 25 </span>8d bf 7b<span class="hljs-number"> 85 </span> |...s.._O._.%..&#123;.|<br>00000670 <span class="hljs-number"> 45 </span>ff 0c<span class="hljs-number"> 00 </span>fd 4b 4b<span class="hljs-number"> 65 </span> e4 b3<span class="hljs-number"> 56 </span>eb<span class="hljs-number"> 64 </span>5c<span class="hljs-number"> 46 </span>be  |E....KKe..V.d\F.|<br>00000680  2e cc<span class="hljs-number"> 79 </span>16<span class="hljs-number"> 31 </span>2c<span class="hljs-number"> 14 </span>63 <span class="hljs-number"> 43 </span>19<span class="hljs-number"> 90 </span>08 6c<span class="hljs-number"> 41 </span>07<span class="hljs-number"> 18 </span> |..y.1,.cC...lA..|<br>00000690  2b<span class="hljs-number"> 70 </span>f2 d9<span class="hljs-number"> 45 </span>d2<span class="hljs-number"> 76 </span>7b <span class="hljs-number"> 11 </span>a0 4a 8d<span class="hljs-number"> 04 </span>9a<span class="hljs-number"> 17 </span>33  |+p..E.v&#123;..J....3|<br>000006a0  6d<span class="hljs-number"> 67 </span>61<span class="hljs-number"> 70 </span>0e<span class="hljs-number"> 00 </span>d0 2c <span class="hljs-number"> 53 </span>4c 7a<span class="hljs-number"> 26 </span>40<span class="hljs-number"> 10 </span>31<span class="hljs-number"> 09 </span> |mgap...,SLz&amp;@.1.|<br>000006b0  8a<span class="hljs-number"> 29 </span>7b 6e b2 bc<span class="hljs-number"> 73 </span>aa <span class="hljs-number"> 65 </span>b9 9c<span class="hljs-number"> 09 </span>b9 db f1 8c  |.)&#123;n..s.e.......|<br>000006c0 <span class="hljs-number"> 75 </span>07 ba b3 e2<span class="hljs-number"> 30 </span>44<span class="hljs-number"> 11 </span> 0e b3<span class="hljs-number"> 74 </span>18 ce<span class="hljs-number"> 09 </span>6e 5c  |u....0D...t...n\|<br>000006d0 <span class="hljs-number"> 13 </span>65<span class="hljs-number"> 70 </span>27 d9<span class="hljs-number"> 38 </span>dc<span class="hljs-number"> 78 </span><span class="hljs-number"> 96 </span>c8 a6 df<span class="hljs-number"> 11 </span>1c 5c<span class="hljs-number"> 09 </span> |.ep&#x27;.8.x......\.|<br>000006e0 <span class="hljs-number"> 69 </span>8b<span class="hljs-number"> 18 </span>65 7b<span class="hljs-number"> 40 </span>1e<span class="hljs-number"> 57 </span><span class="hljs-number"> 80 </span>fd<span class="hljs-number"> 99 </span>63 7b<span class="hljs-number"> 56 </span>aa 0a  |i..e&#123;@.W...c&#123;V..|<br>000006f0  5a ad<span class="hljs-number"> 55 </span>0c c4 d1<span class="hljs-number"> 22 </span>6c  f3 c5<span class="hljs-number"> 45 </span>bd<span class="hljs-number"> 49 </span>36 2d 0e  |Z.U...&quot;l..E.I6-.|<br>00000700  8c 5b e9 d4 2e<span class="hljs-number"> 81 </span>c4 a5  5e<span class="hljs-number"> 98 </span>ad 8f d6<span class="hljs-number"> 74 </span>c8 a5  |.[......^....t..|<br>00000710  3b 1d<span class="hljs-number"> 09 </span>f8 ec db<span class="hljs-number"> 17 </span>55 <span class="hljs-number"> 00 </span>51 a4 ce 5b 8c<span class="hljs-number"> 58 </span>26  |;......U.Q..[.X&amp;|<br>00000720 <span class="hljs-number"> 82 </span>74 ce ed ac<span class="hljs-number"> 46 </span>b7<span class="hljs-number"> 32 </span><span class="hljs-number"> 48 </span>31<span class="hljs-number"> 17 </span>bc<span class="hljs-number"> 76 </span>7f e6 b5  |.t...F.2H1..v...|<br>00000730  9f<span class="hljs-number"> 30 </span>55 b4 f4<span class="hljs-number"> 88 </span>02 9c <span class="hljs-number"> 46 </span>2c e5 ef 6e b9 e4 ee  |.0U.....F,..n...|<br>00000740 <span class="hljs-number"> 91 </span>bf                                             |..|<br>00000742<br></code></pre></td></tr></table></figure><p>seems 28 byte empty BGZF block as an EOF marker is absent</p><p>Try </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools view -b -q 20 HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam &gt; HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.new.bam<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript">[W::bam_hdr_read] EOF marker <span class="hljs-keyword">is</span> absent. The input <span class="hljs-keyword">is</span> probably truncated<br>[E::bgzf_read_block] Failed <span class="hljs-keyword">to</span> <span class="hljs-built_in">read</span> BGZF block data <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">4612181361</span> expected <span class="hljs-number">18560</span> bytes; hread returned <span class="hljs-number">12925</span><br>[E::bgzf_read] Read block operation failed <span class="hljs-keyword">with</span> <span class="hljs-keyword">error</span> <span class="hljs-number">4</span> <span class="hljs-keyword">after</span> <span class="hljs-number">0</span> <span class="hljs-keyword">of</span> <span class="hljs-number">4</span> bytes<br>[main_samview] truncated <span class="hljs-built_in">file</span>.<br></code></pre></td></tr></table></figure><p>then try to use HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.new.bam by samtools index:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools index HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.new.bam<br></code></pre></td></tr></table></figure><p>(No error return!)</p><p>try GATK</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index<span class="hljs-regexp">/gatk-4.1.9.0/g</span>atk --java-<span class="hljs-keyword">options</span> <span class="hljs-string">&quot;-Xmx4g&quot;</span> HaplotypeCaller  \<br>-R <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index/human_g1k_v37.fasta \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.<span class="hljs-number">20130415</span>.<span class="hljs-keyword">new</span>.bam \<br>-O <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>SH007/HG00421_new.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>mapping by STAR (没有gtf文件时的做法：)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">STAR --runThreadN 6 --runMode genomeGenerate \<br>--genomeDir /data/mouse/human_rme/genome_index \<br>--genomeFastaFiles /data/mouse/human_rme/genome_index/human_g1k_v37.fasta #generate index<br><br>STAR --genomeDir /data/mouse/human_rme/genome_index \<br>    --runThreadN 20 \<br>    --readFilesIn sample_r1.fq.gz sample_r2.fq.gz \<br>    # --readFilesCommand zcat \<br>    --outFileNamePrefix sample \<br>    --outSAMtype BAM SortedByCoordinate \<br>    --outBAMsortingThreadN 10 #do mapping<br></code></pre></td></tr></table></figure><p>12.2 进度：</p><p><strong>SH007</strong></p><p>genotypeGVCF done HG00422  (5110)</p><p>genotypeGVCF HG00421  ready</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">GATK genotypeGVCF</span><br>/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; GenotypeGVCFs \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-V HG00422_new.vcf.gz \<br>-O HG00422_genotypeGVCF.vcf.gz<br></code></pre></td></tr></table></figure><p>HG00423 can’t do gatk missing RG </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools view -H HG00444Aligned.sortedByCoord.out.bam | grep &#x27;^@RG&#x27;<br></code></pre></td></tr></table></figure><p>return : none！</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar /data/mouse/human_rme/genome_index/picard.jar <br></code></pre></td></tr></table></figure><p>try AddOrReplaceReadGroups</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar /data/mouse/human_rme/genome_index/picard.jar AddOrReplaceReadGroups \<br>I=HG00423Aligned.sortedByCoord.out.bam \<br>O=HG00423Aligned.sortedByCoord.out.new.bam \<br>RGID=4 \<br>RGLB=lib1 \<br>RGPL=illumina \<br>RGPU=unit1 \<br>RGSM=20<br></code></pre></td></tr></table></figure><p>then try samtools index</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools index HG00423Aligned.sortedByCoord.out.new.bam<br></code></pre></td></tr></table></figure><p>(it seems work!!!) </p><p>gatk doing HG00423 65457 (shuting down)</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk --java-options <span class="hljs-string">&quot;-Xmx4g&quot;</span> HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423Aligned</span>.</span></span>sortedByCoord.out.<span class="hljs-keyword">new</span>.bam \<br>-O /data/mouse/human_rme/SH007/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423_new</span>.</span></span>vcf.gz \<br>-ERC GVCF<br><br># return<br>Using GATK jar /data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar<br>Running:<br>    java -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>use_async_io_read_samtools=<span class="hljs-literal">false</span> -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>use_async_io_write_samtools=<span class="hljs-literal">true</span> -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>use_async_io_write_tribble=<span class="hljs-literal">false</span> -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>compression_level=<span class="hljs-number">2</span> -Xmx4g -jar /data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar HaplotypeCaller -R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta -I <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423Aligned</span>.</span></span>sortedByCoord.out.<span class="hljs-keyword">new</span>.bam -O /data/mouse/human_rme/SH007/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423_new</span>.</span></span>vcf.gz -ERC GVCF<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.494</span> INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar!/com/intel/gkl/native/libgkl_compression.so<br>Dec <span class="hljs-number">02</span>, <span class="hljs-number">2020</span> <span class="hljs-number">3</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05</span> PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine<br>INFO: Failed <span class="hljs-keyword">to</span> detect whether we are running on Google Compute Engine.<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.775</span> INFO  HaplotypeCaller - ------------------------------------------------------------<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.776</span> INFO  HaplotypeCaller - The Genome Analysis Toolkit (GATK) v4.<span class="hljs-number">1.9</span>.<span class="hljs-number">0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.776</span> INFO  HaplotypeCaller - For support <span class="hljs-keyword">and</span> documentation go <span class="hljs-keyword">to</span> https:<span class="hljs-comment">//software.broadinstitute.org/gatk/</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - Executing <span class="hljs-keyword">as</span> zhuyufei@bdp-svr05 on Linux v5.<span class="hljs-number">3.1</span>-<span class="hljs-number">1.</span>el7.elrepo.x86_64 amd64<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - Java runtime: OpenJDK <span class="hljs-number">64</span>-Bit Server VM v1.<span class="hljs-number">8.0_152</span>-release-<span class="hljs-number">1056</span>-b12<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - Start Date/Time: <span class="hljs-number">2020</span>年<span class="hljs-number">12</span>月<span class="hljs-number">2</span>日 下午<span class="hljs-number">03</span>时<span class="hljs-number">21</span>分<span class="hljs-number">05</span>秒<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - ------------------------------------------------------------<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - ------------------------------------------------------------<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.833</span> INFO  HaplotypeCaller - HTSJDK Version: <span class="hljs-number">2.23</span>.<span class="hljs-number">0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - Picard Version: <span class="hljs-number">2.23</span>.<span class="hljs-number">3</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.COMPRESSION_LEVEL : <span class="hljs-number">2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : <span class="hljs-literal">false</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : <span class="hljs-literal">true</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : <span class="hljs-literal">false</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - Deflater: IntelDeflater<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - Inflater: IntelInflater<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - GCS max retries/reopens: <span class="hljs-number">20</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.835</span> INFO  HaplotypeCaller - Requester pays: disabled<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.835</span> INFO  HaplotypeCaller - Initializing engine<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.227</span> INFO  HaplotypeCaller - Done initializing engine<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.228</span> INFO  HaplotypeCallerEngine - Tool is <span class="hljs-keyword">in</span> reference confidence mode <span class="hljs-keyword">and</span> the annotation, the following changes will be made <span class="hljs-keyword">to</span> any specified annotations: &#x27;StrandBiasBySample&#x27; will be enabled. &#x27;ChromosomeCounts&#x27;, &#x27;FisherStrand&#x27;, &#x27;StrandOddsRatio&#x27; <span class="hljs-keyword">and</span> &#x27;QualByDepth&#x27; annotations have been disabled<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.235</span> INFO  HaplotypeCallerEngine - Standard Emitting <span class="hljs-keyword">and</span> Calling confidence set <span class="hljs-keyword">to</span> <span class="hljs-number">0.0</span> <span class="hljs-keyword">for</span> reference-model confidence output<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.235</span> INFO  HaplotypeCallerEngine - All sites annotated <span class="hljs-keyword">with</span> PLs forced <span class="hljs-keyword">to</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">for</span> reference-model confidence output<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.248</span> INFO  NativeLibraryLoader - Loading libgkl_utils.so from jar:file:/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar!/com/intel/gkl/native/libgkl_utils.so<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.249</span> INFO  NativeLibraryLoader - Loading libgkl_pairhmm_omp.so from jar:file:/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar!/com/intel/gkl/native/libgkl_pairhmm_omp.so<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Using CPU-supported AVX-<span class="hljs-number">512</span> instructions<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Flush-<span class="hljs-keyword">to</span>-zero (FTZ) is enabled <span class="hljs-keyword">when</span> running PairHMM<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Available threads: <span class="hljs-number">64</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Requested threads: <span class="hljs-number">4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  PairHMM - Using the OpenMP multi-threaded AVX-accelerated native PairHMM implementation<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.336</span> INFO  ProgressMeter - Starting traversal<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.337</span> INFO  ProgressMeter -        Current Locus  Elapsed Minutes     Regions Processed   Regions/Minute<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">16.341</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">11753701</span>              <span class="hljs-number">0.2</span>                 <span class="hljs-number">39180</span>         <span class="hljs-number">235056.5</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">26.339</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">28001701</span>              <span class="hljs-number">0.3</span>                 <span class="hljs-number">93340</span>         <span class="hljs-number">279992.0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">36.340</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">42413701</span>              <span class="hljs-number">0.5</span>                <span class="hljs-number">141380</span>         <span class="hljs-number">282731.7</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">46.341</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">57197701</span>              <span class="hljs-number">0.7</span>                <span class="hljs-number">190660</span>         <span class="hljs-number">285961.4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">59.455</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">70118701</span>              <span class="hljs-number">0.9</span>                <span class="hljs-number">233730</span>         <span class="hljs-number">264017.2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">09.454</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">84668701</span>              <span class="hljs-number">1.1</span>                <span class="hljs-number">282230</span>         <span class="hljs-number">268292.2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">19.454</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">99485701</span>              <span class="hljs-number">1.2</span>                <span class="hljs-number">331620</span>         <span class="hljs-number">272128.2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">29.454</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">111821701</span>              <span class="hljs-number">1.4</span>                <span class="hljs-number">372740</span>         <span class="hljs-number">269071.3</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">39.455</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">125609701</span>              <span class="hljs-number">1.6</span>                <span class="hljs-number">418700</span>         <span class="hljs-number">269786.7</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">49.617</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">139055701</span>              <span class="hljs-number">1.7</span>                <span class="hljs-number">463520</span>         <span class="hljs-number">269279.6</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">59.643</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">153017701</span>              <span class="hljs-number">1.9</span>                <span class="hljs-number">510060</span>         <span class="hljs-number">270106.4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">09.768</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">163760701</span>              <span class="hljs-number">2.1</span>                <span class="hljs-number">545870</span>         <span class="hljs-number">265350.4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">19.767</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">176396701</span>              <span class="hljs-number">2.2</span>                <span class="hljs-number">587990</span>         <span class="hljs-number">264403.8</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">29.983</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">188480701</span>              <span class="hljs-number">2.4</span>                <span class="hljs-number">628270</span>         <span class="hljs-number">262424.3</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">39.984</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">201497701</span>              <span class="hljs-number">2.6</span>                <span class="hljs-number">671660</span>         <span class="hljs-number">262288.6</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">50.582</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">213197701</span>              <span class="hljs-number">2.7</span>                <span class="hljs-number">710660</span>         <span class="hljs-number">259609.7</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">00.582</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">225782701</span>              <span class="hljs-number">2.9</span>                <span class="hljs-number">752610</span>         <span class="hljs-number">259155.8</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">10.583</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">236975701</span>              <span class="hljs-number">3.1</span>                <span class="hljs-number">789920</span>         <span class="hljs-number">257240.1</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">20.582</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">247268701</span>              <span class="hljs-number">3.2</span>                <span class="hljs-number">824230</span>         <span class="hljs-number">254595.0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">46.185</span> INFO  HaplotypeCaller - Shutting down engine<br><span class="hljs-literal">[<span class="hljs-number">2020</span>年<span class="hljs-number">12</span>月<span class="hljs-number">2</span>日 下午<span class="hljs-number">03</span>时<span class="hljs-number">24</span>分<span class="hljs-number">46</span>秒]</span> org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller <span class="hljs-keyword">done</span>. Elapsed time: <span class="hljs-number">3.68</span> minutes.<br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>total<span class="hljs-constructor">Memory()</span>=<span class="hljs-number">4291821568</span><br>Exception <span class="hljs-keyword">in</span> thread <span class="hljs-string">&quot;main&quot;</span> java.lang.OutOfMemoryError: Java heap space<br>        at java.util.stream.Nodes$DoubleArrayNode.&lt;init&gt;(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Nodes</span>.</span></span>java:<span class="hljs-number">1429</span>)<br>        at java.util.stream.Nodes$DoubleFixedNodeBuilder.&lt;init&gt;(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Nodes</span>.</span></span>java:<span class="hljs-number">1589</span>)<br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Nodes</span>.</span></span>double<span class="hljs-constructor">Builder(Nodes.<span class="hljs-params">java</span>:279)</span><br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DoublePipeline</span>.</span></span>make<span class="hljs-constructor">NodeBuilder(DoublePipeline.<span class="hljs-params">java</span>:164)</span><br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractPipeline</span>.</span></span>evaluate(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractPipeline</span>.</span></span>java:<span class="hljs-number">543</span>)<br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractPipeline</span>.</span></span>evaluate<span class="hljs-constructor">ToArrayNode(AbstractPipeline.<span class="hljs-params">java</span>:260)</span><br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DoublePipeline</span>.</span></span><span class="hljs-keyword">to</span><span class="hljs-constructor">Array(DoublePipeline.<span class="hljs-params">java</span>:506)</span><br>        at org.broadinstitute.hellbender.utils.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MathUtils</span>.</span></span>median(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MathUtils</span>.</span></span>java:<span class="hljs-number">841</span>)<br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlock</span>.</span></span>get<span class="hljs-constructor">MedianDP(GVCFBlock.<span class="hljs-params">java</span>:75)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HomRefBlock</span>.</span></span>create<span class="hljs-constructor">HomRefGenotype(HomRefBlock.<span class="hljs-params">java</span>:73)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlock</span>.</span></span><span class="hljs-keyword">to</span><span class="hljs-constructor">VariantContext(GVCFBlock.<span class="hljs-params">java</span>:49)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlockCombiner</span>.</span></span>emit<span class="hljs-constructor">CurrentBlock(GVCFBlockCombiner.<span class="hljs-params">java</span>:177)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlockCombiner</span>.</span></span>signal<span class="hljs-constructor">EndOfInput(GVCFBlockCombiner.<span class="hljs-params">java</span>:227)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFWriter</span>.</span></span>close(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFWriter</span>.</span></span>java:<span class="hljs-number">70</span>)<br>        at org.broadinstitute.hellbender.tools.walkers.haplotypecaller.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HaplotypeCaller</span>.</span></span>close<span class="hljs-constructor">Tool(HaplotypeCaller.<span class="hljs-params">java</span>:216)</span><br>        at org.broadinstitute.hellbender.engine.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GATKTool</span>.</span></span><span class="hljs-keyword">do</span><span class="hljs-constructor">Work(GATKTool.<span class="hljs-params">java</span>:1053)</span><br>        at org.broadinstitute.hellbender.cmdline.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CommandLineProgram</span>.</span></span>run<span class="hljs-constructor">Tool(CommandLineProgram.<span class="hljs-params">java</span>:140)</span><br>        at org.broadinstitute.hellbender.cmdline.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CommandLineProgram</span>.</span></span>instance<span class="hljs-constructor">MainPostParseArgs(CommandLineProgram.<span class="hljs-params">java</span>:192)</span><br>        at org.broadinstitute.hellbender.cmdline.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CommandLineProgram</span>.</span></span>instance<span class="hljs-constructor">Main(CommandLineProgram.<span class="hljs-params">java</span>:211)</span><br>        at org.broadinstitute.hellbender.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>run<span class="hljs-constructor">CommandLineProgram(Main.<span class="hljs-params">java</span>:160)</span><br>        at org.broadinstitute.hellbender.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>main<span class="hljs-constructor">Entry(Main.<span class="hljs-params">java</span>:203)</span><br>        at org.broadinstitute.hellbender.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>main(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>java:<span class="hljs-number">289</span>)<br><br></code></pre></td></tr></table></figure><p><strong>SH014</strong></p><p>HG00442 vcf ready</p><p>HG00443 vcf ready</p><p>gatk HaplotypeCaller doing HG00444 but shutting down (1299)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I HG00444Aligned.sortedByCoord.out.new.bam \<br>-O /data/mouse/human_rme/SH014/HG00444_new.vcf.gz \<br>-ERC GVCF<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">return</span></span><br>Using GATK jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar<br>Running:<br>    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx4g -jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar HaplotypeCaller -R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta -I HG00444Aligned.sortedByCoord.out.new.bam -O /data/mouse/human_rme/SH014/HG00444_new.vcf.gz -ERC GVCF<br>15:51:47.944 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so<br>Dec 02, 2020 3:51:48 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine<br>INFO: Failed to detect whether we are running on Google Compute Engine.<br>15:51:48.116 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:51:48.116 INFO  HaplotypeCaller - The Genome Analysis Toolkit (GATK) v4.1.9.0<br>15:51:48.117 INFO  HaplotypeCaller - For support and documentation go to https://software.broadinstitute.org/gatk/<br>15:51:48.225 INFO  HaplotypeCaller - Executing as zhuyufei@bdp-svr05 on Linux v5.3.1-1.el7.elrepo.x86_64 amd64<br>15:51:48.225 INFO  HaplotypeCaller - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_152-release-1056-b12<br>15:51:48.225 INFO  HaplotypeCaller - Start Date/Time: 2020年12月2日 下午03时51分47秒<br>15:51:48.225 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:51:48.225 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:51:48.226 INFO  HaplotypeCaller - HTSJDK Version: 2.23.0<br>15:51:48.226 INFO  HaplotypeCaller - Picard Version: 2.23.3<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.COMPRESSION_LEVEL : 2<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : false<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : true<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : false<br>15:51:48.227 INFO  HaplotypeCaller - Deflater: IntelDeflater<br>15:51:48.227 INFO  HaplotypeCaller - Inflater: IntelInflater<br>15:51:48.227 INFO  HaplotypeCaller - GCS max retries/reopens: 20<br>15:51:48.228 INFO  HaplotypeCaller - Requester pays: disabled<br>15:51:48.228 INFO  HaplotypeCaller - Initializing engine<br>15:51:48.606 INFO  HaplotypeCaller - Done initializing engine<br>15:51:48.608 INFO  HaplotypeCallerEngine - Tool is in reference confidence mode and the annotation, the following changes will be made to any specified annotations: &#x27;StrandBiasBySample&#x27; will be enabled. &#x27;ChromosomeCounts&#x27;, &#x27;FisherStrand&#x27;, &#x27;StrandOddsRatio&#x27; and &#x27;QualByDepth&#x27; annotations have been disabled<br>15:51:48.615 INFO  HaplotypeCallerEngine - Standard Emitting and Calling confidence set to 0.0 for reference-model confidence output<br>15:51:48.615 INFO  HaplotypeCallerEngine - All sites annotated with PLs forced to true for reference-model confidence output<br>15:51:48.631 INFO  NativeLibraryLoader - Loading libgkl_utils.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_utils.so<br>15:51:48.632 INFO  NativeLibraryLoader - Loading libgkl_pairhmm_omp.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_pairhmm_omp.so<br>15:51:48.687 INFO  IntelPairHmm - Using CPU-supported AVX-512 instructions<br>15:51:48.687 INFO  IntelPairHmm - Flush-to-zero (FTZ) is enabled when running PairHMM<br>15:51:48.688 INFO  IntelPairHmm - Available threads: 64<br>15:51:48.688 INFO  IntelPairHmm - Requested threads: 4<br>15:51:48.688 INFO  PairHMM - Using the OpenMP multi-threaded AVX-accelerated native PairHMM implementation<br>15:51:48.725 INFO  ProgressMeter - Starting traversal<br>15:51:48.725 INFO  ProgressMeter -        Current Locus  Elapsed Minutes     Regions Processed   Regions/Minute<br>15:51:58.727 INFO  ProgressMeter -           1:11600701              0.2                 38670         232020.0<br>15:52:08.726 INFO  ProgressMeter -           1:27983701              0.3                 93280         279826.0<br>15:52:18.727 INFO  ProgressMeter -           1:42827701              0.5                142760         285501.0<br>15:52:28.747 INFO  ProgressMeter -           1:57899701              0.7                193000         289340.9<br>15:52:39.822 INFO  ProgressMeter -           1:70169701              0.9                233900         274654.1<br>15:52:49.822 INFO  ProgressMeter -           1:85727701              1.0                285760         280629.2<br>15:52:59.823 INFO  ProgressMeter -          1:101075701              1.2                336920         284328.7<br>15:53:09.824 INFO  ProgressMeter -          1:113090701              1.4                376970         278896.2<br>15:53:19.906 INFO  ProgressMeter -          1:127433701              1.5                424780         279518.8<br>15:53:29.910 INFO  ProgressMeter -          1:142109701              1.7                473700         280899.8<br>15:53:39.985 INFO  ProgressMeter -          1:155774701              1.9                519250         280019.8<br>15:53:49.996 INFO  ProgressMeter -          1:166265701              2.0                554220         274205.7<br>15:54:00.097 INFO  ProgressMeter -          1:178859701              2.2                596200         272297.5<br>15:54:10.227 INFO  ProgressMeter -          1:191456701              2.4                638190         270608.7<br>15:54:20.303 INFO  ProgressMeter -          1:204050701              2.5                680170         269237.4<br>15:54:30.432 INFO  ProgressMeter -          1:216647701              2.7                722160         267951.3<br>15:54:40.525 INFO  ProgressMeter -          1:229241701              2.9                764140         266870.8<br>15:54:50.526 INFO  ProgressMeter -          1:240734701              3.0                802450         264835.0<br>15:55:26.303 INFO  HaplotypeCaller - Shutting down engine<br>[2020年12月2日 下午03时55分26秒] org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller done. Elapsed time: 3.64 minutes.<br>Runtime.totalMemory()=4291821568<br>Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space<br>        at java.util.stream.Nodes$DoubleArrayNode.&lt;init&gt;(Nodes.java:1429)<br>        at java.util.stream.Nodes$DoubleFixedNodeBuilder.&lt;init&gt;(Nodes.java:1589)<br>        at java.util.stream.Nodes.doubleBuilder(Nodes.java:279)<br>        at java.util.stream.DoublePipeline.makeNodeBuilder(DoublePipeline.java:164)<br>        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:543)<br>        at java.util.stream.AbstractPipeline.evaluateToArrayNode(AbstractPipeline.java:260)<br>        at java.util.stream.DoublePipeline.toArray(DoublePipeline.java:506)<br>        at org.broadinstitute.hellbender.utils.MathUtils.median(MathUtils.java:841)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.getMedianDP(GVCFBlock.java:75)<br>        at org.broadinstitute.hellbender.utils.variant.writers.HomRefBlock.createHomRefGenotype(HomRefBlock.java:73)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.toVariantContext(GVCFBlock.java:49)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.emitCurrentBlock(GVCFBlockCombiner.java:177)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.signalEndOfInput(GVCFBlockCombiner.java:227)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFWriter.close(GVCFWriter.java:70)<br>        at org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller.closeTool(HaplotypeCaller.java:216)<br>        at org.broadinstitute.hellbender.engine.GATKTool.doWork(GATKTool.java:1053)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.runTool(CommandLineProgram.java:140)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMainPostParseArgs(CommandLineProgram.java:192)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMain(CommandLineProgram.java:211)<br>        at org.broadinstitute.hellbender.Main.runCommandLineProgram(Main.java:160)<br>        at org.broadinstitute.hellbender.Main.mainEntry(Main.java:203)<br>        at org.broadinstitute.hellbender.Main.main(Main.java:289)<br></code></pre></td></tr></table></figure><p>Solution: java程序溢出</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-Xmx75000M</span><br></code></pre></td></tr></table></figure><p><strong>SH021</strong></p><p>HG00463 vcf ready</p><p>gatk doing HG00464 but shutting down (633) </p><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs julia"><span class="hljs-built_in">Exception</span> <span class="hljs-keyword">in</span> thread <span class="hljs-string">&quot;main&quot;</span> java.lang.<span class="hljs-built_in">OutOfMemoryError</span>: Java heap space<br></code></pre></td></tr></table></figure><p>gatk HaplotypeCaller doing HG00465 but shutting down(729)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I HG00465Aligned.sortedByCoord.out.new.bam \<br>-O /data/mouse/human_rme/SH021/HG00465_new.vcf.gz \<br>-ERC GVCF<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">return</span></span><br>Using GATK jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar<br>Running:<br>    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx4g -jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar HaplotypeCaller -R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta -I HG00465Aligned.sortedByCoord.out.new.bam -O /data/mouse/human_rme/SH021/HG00465_new.vcf.gz -ERC GVCF<br>15:35:01.927 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so<br>Dec 02, 2020 3:35:02 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine<br>INFO: Failed to detect whether we are running on Google Compute Engine.<br>15:35:02.092 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:35:02.092 INFO  HaplotypeCaller - The Genome Analysis Toolkit (GATK) v4.1.9.0<br>15:35:02.093 INFO  HaplotypeCaller - For support and documentation go to https://software.broadinstitute.org/gatk/<br>15:35:02.192 INFO  HaplotypeCaller - Executing as zhuyufei@bdp-svr05 on Linux v5.3.1-1.el7.elrepo.x86_64 amd64<br>15:35:02.192 INFO  HaplotypeCaller - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_152-release-1056-b12<br>15:35:02.192 INFO  HaplotypeCaller - Start Date/Time: 2020年12月2日 下午03时35分01秒<br>15:35:02.192 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:35:02.193 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Version: 2.23.0<br>15:35:02.194 INFO  HaplotypeCaller - Picard Version: 2.23.3<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.COMPRESSION_LEVEL : 2<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : false<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : true<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : false<br>15:35:02.195 INFO  HaplotypeCaller - Deflater: IntelDeflater<br>15:35:02.195 INFO  HaplotypeCaller - Inflater: IntelInflater<br>15:35:02.195 INFO  HaplotypeCaller - GCS max retries/reopens: 20<br>15:35:02.195 INFO  HaplotypeCaller - Requester pays: disabled<br>15:35:02.195 INFO  HaplotypeCaller - Initializing engine<br>15:35:02.568 INFO  HaplotypeCaller - Done initializing engine<br>15:35:02.569 INFO  HaplotypeCallerEngine - Tool is in reference confidence mode and the annotation, the following changes will be made to any specified annotations: &#x27;StrandBiasBySample&#x27; will be enabled. &#x27;ChromosomeCounts&#x27;, &#x27;FisherStrand&#x27;, &#x27;StrandOddsRatio&#x27; and &#x27;QualByDepth&#x27; annotations have been disabled<br>15:35:02.576 INFO  HaplotypeCallerEngine - Standard Emitting and Calling confidence set to 0.0 for reference-model confidence output<br>15:35:02.576 INFO  HaplotypeCallerEngine - All sites annotated with PLs forced to true for reference-model confidence output<br>15:35:02.589 INFO  NativeLibraryLoader - Loading libgkl_utils.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_utils.so<br>15:35:02.590 INFO  NativeLibraryLoader - Loading libgkl_pairhmm_omp.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_pairhmm_omp.so<br>15:35:02.642 INFO  IntelPairHmm - Using CPU-supported AVX-512 instructions<br>15:35:02.642 INFO  IntelPairHmm - Flush-to-zero (FTZ) is enabled when running PairHMM<br>15:35:02.642 INFO  IntelPairHmm - Available threads: 64<br>15:35:02.642 INFO  IntelPairHmm - Requested threads: 4<br>15:35:02.642 INFO  PairHMM - Using the OpenMP multi-threaded AVX-accelerated native PairHMM implementation<br>15:35:02.671 INFO  ProgressMeter - Starting traversal<br>15:35:02.672 INFO  ProgressMeter -        Current Locus  Elapsed Minutes     Regions Processed   Regions/Minute<br>15:35:12.675 INFO  ProgressMeter -           1:13535701              0.2                 45120         270720.0<br>15:35:22.673 INFO  ProgressMeter -           1:28421701              0.3                 94740         284220.0<br>15:35:32.672 INFO  ProgressMeter -           1:42599701              0.5                142000         284000.0<br>15:35:42.673 INFO  ProgressMeter -           1:56069701              0.7                186900         280343.0<br>15:35:59.292 INFO  ProgressMeter -           1:70610701              0.9                235370         249425.1<br>15:36:09.292 INFO  ProgressMeter -           1:83174701              1.1                277250         249699.8<br>15:36:19.293 INFO  ProgressMeter -           1:97466701              1.3                324890         254413.3<br>15:36:29.294 INFO  ProgressMeter -          1:108578701              1.4                361930         250696.1<br>15:36:39.295 INFO  ProgressMeter -          1:121907701              1.6                406360         252337.4<br>15:36:49.407 INFO  ProgressMeter -          1:135599701              1.8                452000         254087.2<br>15:36:59.411 INFO  ProgressMeter -          1:148913701              1.9                496380         255131.7<br>15:37:10.510 INFO  ProgressMeter -          1:157865701              2.1                526220         246978.2<br>15:37:20.743 INFO  ProgressMeter -          1:168830701              2.3                562770         244556.8<br>15:37:30.823 INFO  ProgressMeter -          1:180791701              2.5                602640         244064.5<br>15:37:40.934 INFO  ProgressMeter -          1:192755701              2.6                642520         243591.0<br>15:37:50.934 INFO  ProgressMeter -          1:205016701              2.8                683390         243687.8<br>15:38:00.935 INFO  ProgressMeter -          1:217073701              3.0                723580         243543.5<br>15:38:10.935 INFO  ProgressMeter -          1:228584701              3.1                761950         242835.8<br>15:38:20.935 INFO  ProgressMeter -          1:239054701              3.3                796850         241149.4<br>15:38:49.666 INFO  HaplotypeCaller - Shutting down engine<br>[2020年12月2日 下午03时38分49秒] org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller done. Elapsed time: 3.80 minutes.<br>Runtime.totalMemory()=4292345856<br>Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space<br>        at java.util.stream.Nodes$DoubleArrayNode.&lt;init&gt;(Nodes.java:1429)<br>        at java.util.stream.Nodes$DoubleFixedNodeBuilder.&lt;init&gt;(Nodes.java:1589)<br>        at java.util.stream.Nodes.doubleBuilder(Nodes.java:279)<br>        at java.util.stream.DoublePipeline.makeNodeBuilder(DoublePipeline.java:164)<br>        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:543)<br>        at java.util.stream.AbstractPipeline.evaluateToArrayNode(AbstractPipeline.java:260)<br>        at java.util.stream.DoublePipeline.toArray(DoublePipeline.java:506)<br>        at org.broadinstitute.hellbender.utils.MathUtils.median(MathUtils.java:841)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.getMedianDP(GVCFBlock.java:75)<br>        at org.broadinstitute.hellbender.utils.variant.writers.HomRefBlock.createHomRefGenotype(HomRefBlock.java:73)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.toVariantContext(GVCFBlock.java:49)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.emitCurrentBlock(GVCFBlockCombiner.java:177)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.signalEndOfInput(GVCFBlockCombiner.java:227)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFWriter.close(GVCFWriter.java:70)<br>        at org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller.closeTool(HaplotypeCaller.java:216)<br>        at org.broadinstitute.hellbender.engine.GATKTool.doWork(GATKTool.java:1053)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.runTool(CommandLineProgram.java:140)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMainPostParseArgs(CommandLineProgram.java:192)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMain(CommandLineProgram.java:211)<br>        at org.broadinstitute.hellbender.Main.runCommandLineProgram(Main.java:160)<br>        at org.broadinstitute.hellbender.Main.mainEntry(Main.java:203)<br>        at org.broadinstitute.hellbender.Main.main(Main.java:289)<br></code></pre></td></tr></table></figure><p><strong>SH002</strong></p><p>gatk HaplotypeCaller doing HG00407 (1060)</p><p>gatk HaplotypeCaller doing HG00406(1182) (but shutting down at Current Locus 1:246638732; try agin then shutting Current Locus down 1:241940732)</p><p>gatk HaplotypeCaller doing HG00408 (1455) (but shutting down at Current Locus 1:240860701 )</p><h1 id="imprinting-gene"><a href="#imprinting-gene" class="headerlink" title="imprinting gene"></a>imprinting gene</h1><p>基因铭印\parencite{reik2001genomic}是在真兽类哺乳动物中观察到的一种表观遗传现象。对于大多数常染色体基因，两个亲本拷贝都是转录或沉默。然而，在一小组基因中，其中一个拷贝以亲本特有的方式被关闭，从而导致单等位基因表达。这些基因被称为“印迹”，因为沉默的基因拷贝在卵子或精子中具有表观遗传标记或印迹。</p><p>印迹基因在胎儿和胎盘组织中发挥重要作用，在产前和产后的发育和生长中发挥重要作用\parencite{morison2005census}。有趣的是，母方表达的基因会限制胚胎的生长，而父方表达的基因会促进胚胎的生长。Igf2和 Igf2r在小鼠体内的拮抗作用是这种突出场景的一个典型案例。父方表达Igf2基因的缺失导致了宫内生长迟缓。另一方面，缺失母方表达的Igf2r基因，导致过度生长\parencite{lau1994loss}。</p><p>母方和父方表达的基因的拮抗作用引发了一系列进化理论的争论，旨在解释在“自然选择”过程中遗传印记的起源。目前最为科学接受的理论是亲属理论\parencite{haig1989selective, moore1991genomic}。简单地说，这个理论认为在多配偶的哺乳动物物种中，沉默来自母系的生长抑制基因可以导致胚胎的生长。这与营养需求增加有关，从而导致以后代为代价开发母亲资源，而后代可能是另一个男性的后代。</p><p>一个基因调控机制的进化优先沉默一个基因的亲本等位基因意味着父方和母方表达基因在进化过程中经历不同的选择压力。这一假设得到了两个群体揭示了不同的序列保守模式的支持。父系表达基因的蛋白质编码 DNA 序列在不同哺乳动物中保存得很好，而母系表达基因则差异很大。是否父方和母方表达的基因在分子功能和基因调控上也不同，这是一个尚未详细研究的问题。许多研究表明，印迹基因不仅在胚胎发育过程中起重要作用，而且还具有出生后的功能。因此，以产前发育为中心的亲属理论或许可以解释基因铭印进化的某些方面，但不是全部\parencite{hamed2012cellular}。</p><p>在出生后的发育过程中，基因铭印会影响内分泌网络、能量代谢和行为。对小鼠的敲除研究表明，表达 Peg1和 Peg3基因的两个父方基因具有明显的行为表型\parencite{lefebvre1998abnormal}。从父亲那里遗传到这些基因的非等位基因的雌性表现出缺乏母性照顾行为，包括吞食胎盘和筑巢以及幼崽聚集。</p><p>另一个有趣的事实是，胎盘哺乳动物如老鼠和人类，以及有袋动物如负鼠和袋鼠，都有基因铭印。卵生哺乳动物，如鸭嘴兽和针鼹鼠，似乎缺乏印记基因。胎盘哺乳动物和有袋类动物区别于卵生哺乳动物的一个生殖策略是允许胚胎直接影响用于自身生长的母性资源的数量。相反，在卵子中发育的胚胎不能直接影响母体资源。大多数无脊椎动物和脊椎动物使用产卵繁殖策略。值得注意的是，它们也可以进行孤雌生殖ー一种繁殖形式，即雌配子不经过雄配子受精而发育成一个新的二倍体个体(注意，孤雌生殖胚胎来自同一母体基因组的复制，而图2中描述的雌核发育胚胎来自两个不同的母体基因组)。生物体进行单性生殖的能力很可能表明基因铭印的完全缺失，因为这表明父系基因组是可有可无的。然而，在哺乳动物中，印迹基因表达控制胎儿生长的直接结果是孤雌生殖是不可能的。双亲都必须产生可存活的后代，使哺乳动物完全依赖有性生殖进行繁殖。因此，哺乳动物几乎不存在孤雌生殖现象\parencite{renfree2009evolution}。</p><p>为什么基因铭印只在一些哺乳动物中进化，而在脊椎动物中却没有？基因组印记的三个特征ーー许多印记基因的生长调节功能，印记基因对胎盘哺乳动物和有袋哺乳动物的限制，以及父系基因组对胎儿发育的必要性，为两个同样有吸引力的假说提供了证据。</p><p>第一个假设提出，基因铭印的进化是为了回应“父母冲突”的情况\parencite{moore1991genomic}。这源于母体和父体基因组的对立利益: 胚胎的发育依赖于父母一方，但是受到胚胎的影响，胚胎的基因组来自父母双方。父方表达的印记基因被认为可以促进胚胎发育，从而最大限度地提高拥有特定父方基因组的个体后代的适应性。母方表达的印迹基因被认为可以抑制胎儿的生长。这将使得母系资源更平等地分配给所有后代，并增加母系基因组向多个后代的传递，这些后代可能有不同的父系基因组。</p><p>第二个假设被称为“滋养层防御”\parencite{varmuza1994genomic}。这就提出，如果自发的卵母细胞激活导致胚胎的完全发育，那么母体基因组就有可能因为具备内部繁殖的解剖学条件而面临风险。由于男性缺乏必要的内部繁殖解剖设备，他们不共享相同的风险，应自发激活精子发生。因此，印记被认为可以抑制母染色体上促进胎盘发育的基因，或者激活限制这一过程的基因。因此，胎盘侵入母体子宫血管所必需的基因只能在受精后由父体基因组表达。</p><p>这两种假说都指出印迹基因在调节胎盘发育和功能方面的作用，然而，无论是亲代冲突还是滋养层防御模型都不能为所有的数据提供完整的解释\parencite{wilkins2003good}。有趣的是，植物胚乳中也发现了印迹基因，这种组织被比作胎盘，因为它将营养资源从亲本植物转移到胚胎中\parencite{grossniklaus2014transcriptional}。这一发现加强了关于基因铭印是作为调节父母和子女之间营养物质转移的手段进化而来的论点。有可能的是，并不是一个集群中的所有基因都是刻意为之的印记机制的目标，有些基因可能只是这个过程的“无辜旁观者”，而且它们的功能也不能提供有关基因铭印的信息。受印迹机制影响的无辜旁观者基因的存在可以令人满意地解释印迹基因的奇特丰富性，但在发育过程中没有明显的生物学功能\parencite{bartolomei1997genomic}。</p><h2 id="method-design"><a href="#method-design" class="headerlink" title="method design"></a>method design</h2><p>artical: <a href="https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0">https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0</a></p><p>这篇文章的主要思路是通过SNV来确定子代基因来自于父母双方的哪一方。</p><p>印记基因假说：</p><blockquote><p>Genomic imprinting is a special case of mono-allelic expression where genes are expressed in a parent-of-origin (PofO)-specific manner. Although several hypotheses exist to explain why genomic imprinting occurs, the parental conflict hypothesis that imprinted genes evolved from a parental battle between males and females to influence the allocation of maternal resources to offspring. This type of mono-allelic expression can be observed in mammals at different developmental stages and is dependent on stage, cell, and tissue type.</p></blockquote><h3 id="Material"><a href="#Material" class="headerlink" title="Material"></a>Material</h3><p>165 trio from HapMap/1000 Genomes Projects with RNA-Seq data from lymphoblastoid cell lines (LCLs) and 131 trios from the Genome-of-the-Netherlands </p><h3 id="Focus"><a href="#Focus" class="headerlink" title="Focus"></a>Focus</h3><p>complete imprinting (exclusive expression of the paternal or maternal allele) and incomplete imprinting (bias in expression towards the maternal or paternal allele)</p><h3 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h3><p>allele-specific RNA-Seq analysis of parent-offspring trios: </p><p>used phased genotypes to compute the relative expression from the maternal and paternal alleles in RNA-Seq reads at expressed heterozygous single nucleotide variants (SNVs);</p><p>summed the paternal and maternal counts for all heterozygous SNVs contained in a gene(irrespective of their exonic or intronic nature);</p><p>statistical tests to check for consistent parental expression bias of autosomal genes within the populations: Wilcoxon signed-rank (WSR) test and ShrinkBayes (SB);</p><ol><li><p>Strand-specific RNA-Seq in lymphoblastoid cell lines</p><ol><li><p>quality control by fastqc (version 0.11.2)</p></li><li><p>Over-represented sequences were removed by trimmomatic (version 0.32) [reads ≥ 30 bp in length were kept]</p></li><li><p>Cleaned reads were mapped to the human reference genome (hg19) with Gencode v16 annotations by STAR aligner (version 2.3.0) [yielding a mean of 79% uniquely mapped reads]</p></li><li><p>intermediate BAM file processing such as add read groups and sorting and merging BAM files of the same samples by Picard (version 1.112)</p></li><li><p>correct for mapping errors and biases which can result in false-positive allele-specific read assignments by WASP software (version 0.1)<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4626402/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4626402/</a> [resulting in the removal of a mean of 36% of reads that overlapped SNVs in each sample] {WASP input: bam; then identifies mapped reads that overlap known polymorphisms}</p></li><li><p>SNVs in each offspring were assigned on parental origin </p></li><li><p>determine allele-specific expression by heterozygous sites</p></li><li><p>quantified reference and alternate RNA-Seq reads mapped at heterozygous loci by AlleleCounter (v0.2, <a href="https://github.com/secastel/allelecounter">https://github.com/secastel/allelecounter</a>) </p></li><li><p>reference and alternate allele counts were used with PofO information to assign counts to the maternal and paternal alleles at each heterozygous site [Reads that did not uniquely map, or had base quality ≤ 10, were discarded.]</p></li><li><p>Use filter to reduce the mapping errors:</p><p>① removing heterozygous SNVs that had a mappability score &lt; 1 (based on the “CRG GEM Alignability of 50mers with no more than 2 mismatches” track, downloaded from UCSC genome browser)</p><p>② removing heterozygous SNVs that overlapped CNVs with MAF ≥ 5% identified in samples from the 1000 Genomes and HapMap Projects (ftp://<a href="http://ftp.1000genomes.ebi.ac.uk/vol1/withdrawn/phase3/integrated_sv_map/">ftp.1000genomes.ebi.ac.uk/vol1/withdrawn/phase3/integrated_sv_map/</a> and common CNVs</p><p>③ removing heterozygous SNVs that are segmental duplications</p><p>④ removing heterozygous SNVs that are simple repeats (both downloaded from “Variation and Repeats” track group of the UCSC genome browser). </p><p>[These filters resulted in the removal of 21% of heterozygous sites, leaving ~ 3.1 million sites for downstream analysis.]</p></li><li><p>Genotyping DNA: </p><p>BEAGLE  (<a href="https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0#ref-CR57">https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0#ref-CR57</a>) and IMPUTE2. Using GATK:UnifiedGenotyper as input for BEAGLE, treating all samples as unrelated. SHAPEIT2 and MVNcall19 were then used along with trio information to phase the complete set of SNVs. Each haplotype transmitted to the offspring, and therefore, allelic parental origin was then obtained from the phased haplotypes</p></li></ol></li></ol><ol><li><p>overall Genotype data processing</p><ol><li><p>get genotype data from smples</p><p> The <strong>GATK</strong> joint genotyping workflow can be applied in genotyping, here list the steps:</p><p> ①Versions 3.0 and above of GATK offer the possibility of calling DNA variants on cohorts of samples using the <strong>HaplotypeCaller</strong> algorithm in Genomic Variant Call Format (GVCF) mode.</p><p> input: RNA data</p><p> output: one GVCF file per sample</p><p> ②variants are called from the GVCF files through a joint genotyping analysis. </p></li><li><p>quality control: resolving strand inconsistencies, removing multi-allelic SNVs and indels, removing SNVs not present in the 1000 Genomes data</p></li><li><p>Use PLINK (versions 1.07 and 1.9), vcftools (version 0.1.15) and Beagle Utilities to convert coordinates from hg18 to hg19</p></li></ol></li></ol><h1 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h1><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br></pre></td><td class="code"><pre><code class="hljs tex">@article&#123;wutz2011gene,<br>  title=&#123;Gene silencing in X-chromosome inactivation: advances in understanding facultative heterochromatin formation&#125;,<br>  author=&#123;Wutz, Anton&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;12&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;542--553&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;barlow2011genomic,<br>  title=&#123;Genomic imprinting: a mammalian epigenetic discovery model&#125;,<br>  author=&#123;Barlow, Denise P&#125;,<br>  journal=&#123;Annual review of genetics&#125;,<br>  volume=&#123;45&#125;,<br>  pages=&#123;379--403&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Annual Reviews&#125;<br>&#125;<br><br>@article&#123;ferron2011postnatal,<br>  title=&#123;Postnatal loss of Dlk1 imprinting in stem cells and niche astrocytes regulates neurogenesis&#125;,<br>  author=&#123;Ferr&#123;<span class="hljs-keyword">\&#x27;</span>o&#125;n, Sacri R and Charalambous, Marika and Radford, Elizabeth and McEwen, Kirsten and Wildner, Hendrik and Hind, Eleanor and Morante-Redolat, Jose Manuel and Laborda, Jorge and Guillemot, Francois and Bauer, Steven R and others&#125;,<br>  journal=&#123;Nature&#125;,<br>  volume=&#123;475&#125;,<br>  number=&#123;7356&#125;,<br>  pages=&#123;381--385&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;lo2003allelic,<br>  title=&#123;Allelic variation in gene expression is common in the human genome&#125;,<br>  author=&#123;Lo, H Shuen and Wang, Zhining and Hu, Ying and Yang, Howard H and Gere, Sheryl and Buetow, Kenneth H and Lee, Maxwell P&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;13&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;1855--1862&#125;,<br>  year=&#123;2003&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@misc&#123;bartolomei25mammalian,<br>  title=&#123;Mammalian genomic imprinting. Cold Spring Harb Perspect Biol. 2011; 3 (7)&#125;,<br>  author=&#123;Bartolomei, MS and Ferguson-Smith, AC&#125;,<br>  publisher=&#123;Epub 2011/05/18. doi: 10.1101/cshperspect. a002592. PubMed PMID: 21576252&#125;<br>&#125;<br><br>@article&#123;heijmans2008persistent,<br>  title=&#123;Persistent epigenetic differences associated with prenatal exposure to famine in humans&#125;,<br>  author=&#123;Heijmans, Bastiaan T and Tobi, Elmar W and Stein, Aryeh D and Putter, Hein and Blauw, Gerard J and Susser, Ezra S and Slagboom, P Eline and Lumey, LH&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;105&#125;,<br>  number=&#123;44&#125;,<br>  pages=&#123;17046--17049&#125;,<br>  year=&#123;2008&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;deng2014single,<br>  title=&#123;Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells&#125;,<br>  author=&#123;Deng, Qiaolin and Ramsk&#123;<span class="hljs-keyword">\&quot;</span>o&#125;ld, Daniel and Reinius, Bj&#123;<span class="hljs-keyword">\&quot;</span>o&#125;rn and Sandberg, Rickard&#125;,<br>  journal=&#123;Science&#125;,<br>  volume=&#123;343&#125;,<br>  number=&#123;6167&#125;,<br>  pages=&#123;193--196&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;American Association for the Advancement of Science&#125;<br>&#125;<br><br>@article&#123;gendrel2014developmental,<br>  title=&#123;Developmental dynamics and disease potential of random monoallelic gene expression&#125;,<br>  author=&#123;Gendrel, Anne-Valerie and Attia, Mikael and Chen, Chong-Jian and Diabangouaya, Patricia and Servant, Nicolas and Barillot, Emmanuel and Heard, Edith&#125;,<br>  journal=&#123;Developmental cell&#125;,<br>  volume=&#123;28&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;366--380&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;chess2012mechanisms,<br>  title=&#123;Mechanisms and consequences of widespread random monoallelic expression&#125;,<br>  author=&#123;Chess, Andrew&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;13&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;421--428&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;tycko2010allele,<br>  title=&#123;Allele-specific DNA methylation: beyond imprinting&#125;,<br>  author=&#123;Tycko, Benjamin&#125;,<br>  journal=&#123;Human molecular genetics&#125;,<br>  volume=&#123;19&#125;,<br>  number=&#123;R2&#125;,<br>  pages=&#123;R210--R220&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;ohlsson2007widespread,<br>  title=&#123;Widespread monoallelic expression&#125;,<br>  author=&#123;Ohlsson, Rolf&#125;,<br>  journal=&#123;Science&#125;,<br>  volume=&#123;318&#125;,<br>  number=&#123;5853&#125;,<br>  pages=&#123;1077--1078&#125;,<br>  year=&#123;2007&#125;,<br>  publisher=&#123;American Association for the Advancement of Science&#125;<br>&#125;<br><br>@article&#123;esteller2000promoter,<br>  title=&#123;Promoter hypermethylation and BRCA1 inactivation in sporadic breast and ovarian tumors&#125;,<br>  author=&#123;Esteller, Manel and Silva, Jose Maria and Dominguez, Gemma and Bonilla, Felix and Matias-Guiu, Xavier and Lerma, Enrique and Bussaglia, Elena and Prat, Jaime and Harkes, I Clara and Repasky, Elizabeth A and others&#125;,<br>  journal=&#123;JNCI: Journal of the National Cancer Institute&#125;,<br>  volume=&#123;92&#125;,<br>  number=&#123;7&#125;,<br>  pages=&#123;564--569&#125;,<br>  year=&#123;2000&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;thrall2006brca1,<br>  title=&#123;BRCA1 expression in a large series of sporadic ovarian carcinomas: a Gynecologic Oncology Group study&#125;,<br>  author=&#123;Thrall, M and Gallion, HH and Kryscio, R and Kapali, M and Armstrong, DK and Deloia, Julie A&#125;,<br>  journal=&#123;International Journal of Gynecologic Cancer&#125;,<br>  volume=&#123;16&#125;,<br>  number=&#123;Suppl 1&#125;,<br>  pages=&#123;166--171&#125;,<br>  year=&#123;2006&#125;,<br>  publisher=&#123;BMJ Specialist Journals&#125;<br>&#125;<br><br>@article&#123;yan2002allelic,<br>  title=&#123;Allelic variation in human gene expression&#125;,<br>  author=&#123;Yan, Hai and Yuan, Weishi and Velculescu, Victor E and Vogelstein, Bert and Kinzler, Kenneth W and others&#125;,<br>  journal=&#123;Science&#125;,<br>  volume=&#123;297&#125;,<br>  number=&#123;5584&#125;,<br>  pages=&#123;1143--1143&#125;,<br>  year=&#123;2002&#125;<br>&#125;<br><br>@article&#123;cedar2008choreography,<br>  title=&#123;Choreography of Ig allelic exclusion&#125;,<br>  author=&#123;Cedar, Howard and Bergman, Yehudit&#125;,<br>  journal=&#123;Current opinion in immunology&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;308--317&#125;,<br>  year=&#123;2008&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;borel2015biased,<br>  title=&#123;Biased allelic expression in human primary fibroblast single cells&#125;,<br>  author=&#123;Borel, Christelle and Ferreira, Pedro G and Santoni, Federico and Delaneau, Olivier and Fort, Alexandre and Popadin, Konstantin Y and Garieri, Marco and Falconnet, Emilie and Ribaux, Pascale and Guipponi, Michel and others&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;96&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;70--80&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;risso2014normalization,<br>  title=&#123;Normalization of RNA-seq data using factor analysis of control genes or samples&#125;,<br>  author=&#123;Risso, Davide and Ngai, John and Speed, Terence P and Dudoit, Sandrine&#125;,<br>  journal=&#123;Nature biotechnology&#125;,<br>  volume=&#123;32&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;896--902&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;lappalainen2013transcriptome,<br>  title=&#123;Transcriptome and genome sequencing uncovers functional variation in humans&#125;,<br>  author=&#123;Lappalainen, Tuuli and Sammeth, Michael and Friedl&#123;<span class="hljs-keyword">\&quot;</span>a&#125;nder, Marc R and Ac‘t Hoen, Peter and Monlong, Jean and Rivas, Manuel A and Gonzalez-Porta, Mar and Kurbatova, Natalja and Griebel, Thasso and Ferreira, Pedro G and others&#125;,<br>  journal=&#123;Nature&#125;,<br>  volume=&#123;501&#125;,<br>  number=&#123;7468&#125;,<br>  pages=&#123;506--511&#125;,<br>  year=&#123;2013&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;li2009sequence,<br>  title=&#123;The sequence alignment/map format and SAMtools&#125;,<br>  author=&#123;Li, Heng and Handsaker, Bob and Wysoker, Alec and Fennell, Tim and Ruan, Jue and Homer, Nils and Marth, Gabor and Abecasis, Goncalo and Durbin, Richard&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;16&#125;,<br>  pages=&#123;2078--2079&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;trapnell2012differential,<br>  title=&#123;Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks&#125;,<br>  author=&#123;Trapnell, Cole and Roberts, Adam and Goff, Loyal and Pertea, Geo and Kim, Daehwan and Kelley, David R and Pimentel, Harold and Salzberg, Steven L and Rinn, John L and Pachter, Lior&#125;,<br>  journal=&#123;Nature protocols&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;562--578&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;trapnell2010transcript,<br>  title=&#123;Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation&#125;,<br>  author=&#123;Trapnell, Cole and Williams, Brian A and Pertea, Geo and Mortazavi, Ali and Kwan, Gordon and Van Baren, Marijke J and Salzberg, Steven L and Wold, Barbara J and Pachter, Lior&#125;,<br>  journal=&#123;Nature biotechnology&#125;,<br>  volume=&#123;28&#125;,<br>  number=&#123;5&#125;,<br>  pages=&#123;511--515&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;harrow2012gencode,<br>  title=&#123;GENCODE: the reference human genome annotation for The ENCODE Project&#125;,<br>  author=&#123;Harrow, Jennifer and Frankish, Adam and Gonzalez, Jose M and Tapanari, Electra and Diekhans, Mark and Kokocinski, Felix and Aken, Bronwen L and Barrell, Daniel and Zadissa, Amonida and Searle, Stephen and others&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;22&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1760--1774&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;xie2019modeling,<br>  title=&#123;Modeling allele-specific expression at the gene and SNP levels simultaneously by a Bayesian logistic mixed regression model&#125;,<br>  author=&#123;Xie, Jing and Ji, Tieming and Ferreira, Marco AR and Li, Yahan and Patel, Bhaumik N and Rivera, Rocio M&#125;,<br>  journal=&#123;BMC bioinformatics&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;530&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br><br>@article&#123;mckenna2010genome,<br>  title=&#123;The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data&#125;,<br>  author=&#123;McKenna, Aaron and Hanna, Matthew and Banks, Eric and Sivachenko, Andrey and Cibulskis, Kristian and Kernytsky, Andrew and Garimella, Kiran and Altshuler, David and Gabriel, Stacey and Daly, Mark and others&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1297--1303&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;li2011statistical,<br>  title=&#123;A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data&#125;,<br>  author=&#123;Li, Heng&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;27&#125;,<br>  number=&#123;21&#125;,<br>  pages=&#123;2987--2993&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;kim2015hisat,<br>  title=&#123;HISAT: a fast spliced aligner with low memory requirements&#125;,<br>  author=&#123;Kim, Daehwan and Langmead, Ben and Salzberg, Steven L&#125;,<br>  journal=&#123;Nature methods&#125;,<br>  volume=&#123;12&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;357--360&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;li2009fast,<br>  title=&#123;Fast and accurate short read alignment with Burrows--Wheeler transform&#125;,<br>  author=&#123;Li, Heng and Durbin, Richard&#125;,<br>  journal=&#123;bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;14&#125;,<br>  pages=&#123;1754--1760&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;mayba2014mbased,<br>  title=&#123;MBASED: allele-specific expression detection in cancer tissues and cell lines&#125;,<br>  author=&#123;Mayba, Oleg and Gilbert, Houston N and Liu, Jinfeng and Haverty, Peter M and Jhunjhunwala, Suchit and Jiang, Zhaoshi and Watanabe, Colin and Zhang, Zemin&#125;,<br>  journal=&#123;Genome biology&#125;,<br>  volume=&#123;15&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;405&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;edsgard2016geneiase,<br>  title=&#123;GeneiASE: Detection of condition-dependent and static allele-specific expression from RNA-seq data without haplotype information&#125;,<br>  author=&#123;Edsg&#123;<span class="hljs-keyword">\&quot;</span>a&#125;rd, Daniel and Iglesias, Maria Jesus and Reilly, Sarah-Jayne and Hamsten, Anders and Tornvall, Per and Odeberg, Jacob and Emanuelsson, Olof&#125;,<br>  journal=&#123;Scientific reports&#125;,<br>  volume=&#123;6&#125;,<br>  pages=&#123;21134&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;harvey2015quasar,<br>  title=&#123;QuASAR: quantitative allele-specific analysis of reads&#125;,<br>  author=&#123;Harvey, Chris T and Moyerbrailean, Gregory A and Davis, Gordon O and Wen, Xiaoquan and Luca, Francesca and Pique-Regi, Roger&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;31&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;1235--1242&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;fan2020asep,<br>  title=&#123;ASEP: Gene-based detection of allele-specific expression across individuals in a population by RNA sequencing&#125;,<br>  author=&#123;Fan, Jiaxin and Hu, Jian and Xue, Chenyi and Zhang, Hanrui and Susztak, Katalin and Reilly, Muredach P and Xiao, Rui and Li, Mingyao&#125;,<br>  journal=&#123;PLoS Genetics&#125;,<br>  volume=&#123;16&#125;,<br>  number=&#123;5&#125;,<br>  pages=&#123;e1008786&#125;,<br>  year=&#123;2020&#125;,<br>  publisher=&#123;Public Library of Science&#125;<br>&#125;<br><br>@article&#123;castel2016rare,<br>  title=&#123;Rare variant phasing and haplotypic expression from RNA sequencing with phASER&#125;,<br>  author=&#123;Castel, Stephane E and Mohammadi, Pejman and Chung, Wendy K and Shen, Yufeng and Lappalainen, Tuuli&#125;,<br>  journal=&#123;Nature communications&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;1--6&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;li2009fast,<br>  title=&#123;Fast and accurate short read alignment with Burrows--Wheeler transform&#125;,<br>  author=&#123;Li, Heng and Durbin, Richard&#125;,<br>  journal=&#123;bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;14&#125;,<br>  pages=&#123;1754--1760&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;li2009sequence,<br>  title=&#123;The sequence alignment/map format and SAMtools&#125;,<br>  author=&#123;Li, Heng and Handsaker, Bob and Wysoker, Alec and Fennell, Tim and Ruan, Jue and Homer, Nils and Marth, Gabor and Abecasis, Goncalo and Durbin, Richard&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;16&#125;,<br>  pages=&#123;2078--2079&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;poplin2017scaling,<br>  title=&#123;Scaling accurate genetic variant discovery to tens of thousands of samples&#125;,<br>  author=&#123;Poplin, Ryan and Ruano-Rubio, Valentin and DePristo, Mark A and Fennell, Tim J and Carneiro, Mauricio O and Van der Auwera, Geraldine A and Kling, David E and Gauthier, Laura D and Levy-Moonshine, Ami and Roazen, David and others&#125;,<br>  journal=&#123;BioRxiv&#125;,<br>  pages=&#123;201178&#125;,<br>  year=&#123;2017&#125;,<br>  publisher=&#123;Cold Spring Harbor Laboratory&#125;<br>&#125;<br><br>@article&#123;sherry2001dbsnp,<br>  title=&#123;dbSNP: the NCBI database of genetic variation&#125;,<br>  author=&#123;Sherry, Stephen T and Ward, M-H and Kholodov, M and Baker, J and Phan, Lon and Smigielski, Elizabeth M and Sirotkin, Karl&#125;,<br>  journal=&#123;Nucleic acids research&#125;,<br>  volume=&#123;29&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;308--311&#125;,<br>  year=&#123;2001&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;cingolani2012program,<br>  title=&#123;A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of Drosophila melanogaster strain w1118; iso-2; iso-3&#125;,<br>  author=&#123;Cingolani, Pablo and Platts, Adrian and Wang, Le Lily and Coon, Melissa and Nguyen, Tung and Wang, Luan and Land, Susan J and Lu, Xiangyi and Ruden, Douglas M&#125;,<br>  journal=&#123;Fly&#125;,<br>  volume=&#123;6&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;80--92&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Taylor <span class="hljs-keyword">\&amp;</span> Francis&#125;<br>&#125;<br><br>@article&#123;ruden2012using,<br>  title=&#123;Using Drosophila melanogaster as a model for genotoxic chemical mutational studies with a new program, SnpSift&#125;,<br>  author=&#123;Ruden, Douglas Mark and Cingolani, Pablo and Patel, Viral M and Coon, Melissa and Nguyen, Tung and Land, Susan J and Lu, Xiangyi&#125;,<br>  journal=&#123;Frontiers in genetics&#125;,<br>  volume=&#123;3&#125;,<br>  pages=&#123;35&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Frontiers&#125;<br>&#125;<br><br>@article&#123;ahn2019analysis,<br>  title=&#123;Analysis of allele-specific expression using RNA-seq of the Korean native pig and Landrace reciprocal cross&#125;,<br>  author=&#123;Ahn, Byeongyong and Choi, Min-Kyeung and Yum, Joori and Cho, In-Cheol and Kim, Jin-Hoi and Park, Chankyu&#125;,<br>  journal=&#123;Asian-Australasian journal of animal sciences&#125;,<br>  volume=&#123;32&#125;,<br>  number=&#123;12&#125;,<br>  pages=&#123;1816&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;Asian-Australasian Association of Animal Production Societies (AAAP)&#125;<br>&#125;<br><br>@article&#123;jadhav2019rna,<br>  title=&#123;RNA-Seq in 296 phased trios provides a high-resolution map of genomic imprinting&#125;,<br>  author=&#123;Jadhav, Bharati and Monajemi, Ramin and Gagalova, Kristina K and Ho, Daniel and Draisma, Harmen HM and van de Wiel, Mark A and Franke, Lude and Heijmans, Bastiaan T and van Meurs, Joyce and Jansen, Rick and others&#125;,<br>  journal=&#123;BMC biology&#125;,<br>  volume=&#123;17&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;50&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;BioMed Central&#125;<br>&#125;<br><br>@article&#123;barallon2010recommendation,<br>  title=&#123;Recommendation of short tandem repeat profiling for authenticating human cell lines, stem cells, and tissues&#125;,<br>  author=&#123;Barallon, Rita and Bauer, Steven R and Butler, John and Capes-Davis, Amanda and Dirks, Wilhelm G and Elmore, Eugene and Furtado, Manohar and Kline, Margaret C and Kohara, Arihiro and Los, Georgyi V and others&#125;,<br>  journal=&#123;In Vitro Cellular <span class="hljs-keyword">\&amp;</span> Developmental Biology-Animal&#125;,<br>  volume=&#123;46&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;727--732&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;dumache2018chimerism,<br>  title=&#123;Chimerism Monitoring by Short Tandem Repeat (STR) Markers in Allogeneic Stem Cell Transplantation.&#125;,<br>  author=&#123;Dumache, Raluca and Enache, Alexandra and Barbarii, Ligia and Constantinescu, Carmen and Pascalau, Andreea and Jinca, Cristian and Arghirescu, Smaranda&#125;,<br>  journal=&#123;Clinical laboratory&#125;,<br>  volume=&#123;64&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1535--1543&#125;,<br>  year=&#123;2018&#125;<br>&#125;<br><br>@article&#123;nims2010short,<br>  title=&#123;Short tandem repeat profiling: part of an overall strategy for reducing the frequency of cell misidentification&#125;,<br>  author=&#123;Nims, Raymond W and Sykes, Greg and Cottrill, Karin and Ikonomi, Pranvera and Elmore, Eugene&#125;,<br>  journal=&#123;In Vitro Cellular <span class="hljs-keyword">\&amp;</span> Developmental Biology-Animal&#125;,<br>  volume=&#123;46&#125;,<br>  number=&#123;10&#125;,<br>  pages=&#123;811--819&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;huang2002mutation,<br>  title=&#123;Mutation patterns at dinucleotide microsatellite loci in humans&#125;,<br>  author=&#123;Huang, Qing-Yang and Xu, Fu-Hua and Shen, Hui and Deng, Hong-Yi and Liu, Yong-Jun and Liu, Yao-Zhong and Li, Jin-Long and Recker, Robert R and Deng, Hong-Wen&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;70&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;625--634&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;di1998heterogeneity,<br>  title=&#123;Heterogeneity of microsatellite mutations within and between loci, and implications for human demographic histories&#125;,<br>  author=&#123;Di Rienzo, Anna and Donnelly, Peter and Toomajian, Chris and Sisk, Bronwyn and Hill, Adrian and Petzl-Erler, Maria Luiza and Haines, G Ken and Barch, David H&#125;,<br>  journal=&#123;Genetics&#125;,<br>  volume=&#123;148&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;1269--1284&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Genetics Soc America&#125;<br>&#125;<br><br>@article&#123;hastbacka1992linkage,<br>  title=&#123;Linkage disequilibrium mapping in isolated founder populations: diastrophic dysplasia in Finland&#125;,<br>  author=&#123;H&#123;<span class="hljs-keyword">\&quot;</span>a&#125;stbacka, Johanna and de la Chapelle, Albert and Kaitila, Ilkka and Sistonen, Pertti and Weaver, Alix and Lander, Eric&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;2&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;204--211&#125;,<br>  year=&#123;1992&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;holtkemper2001mutation,<br>  title=&#123;Mutation rates at two human Y-chromosomal microsatellite loci using small pool PCR techniques&#125;,<br>  author=&#123;Holtkemper, Ulrike and Rolf, Burkhard and Hohoff, Carsten and Forster, Peter and Brinkmann, Bernd&#125;,<br>  journal=&#123;Human molecular genetics&#125;,<br>  volume=&#123;10&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;629--633&#125;,<br>  year=&#123;2001&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;huang2002mutation,<br>  title=&#123;Mutation patterns at dinucleotide microsatellite loci in humans&#125;,<br>  author=&#123;Huang, Qing-Yang and Xu, Fu-Hua and Shen, Hui and Deng, Hong-Yi and Liu, Yong-Jun and Liu, Yao-Zhong and Li, Jin-Long and Recker, Robert R and Deng, Hong-Wen&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;70&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;625--634&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;fan2007brief,<br>  title=&#123;A brief review of short tandem repeat mutation&#125;,<br>  author=&#123;Fan, Hao and Chu, Jia-You&#125;,<br>  journal=&#123;Genomics, proteomics <span class="hljs-keyword">\&amp;</span> bioinformatics&#125;,<br>  volume=&#123;5&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;7--14&#125;,<br>  year=&#123;2007&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;benson1999tandem,<br>  title=&#123;Tandem repeats finder: a program to analyze DNA sequences&#125;,<br>  author=&#123;Benson, Gary&#125;,<br>  journal=&#123;Nucleic acids research&#125;,<br>  volume=&#123;27&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;573--580&#125;,<br>  year=&#123;1999&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;gymrek2012lobstr,<br>  title=&#123;lobSTR: a short tandem repeat profiler for personal genomes&#125;,<br>  author=&#123;Gymrek, Melissa and Golan, David and Rosset, Saharon and Erlich, Yaniv&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;22&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;1154--1162&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;tang2017strscan,<br>  title=&#123;STRScan: targeted profiling of short tandem repeats in whole-genome sequencing data&#125;,<br>  author=&#123;Tang, Haixu and Nzabarushimana, Etienne&#125;,<br>  journal=&#123;BMC bioinformatics&#125;,<br>  volume=&#123;18&#125;,<br>  number=&#123;11&#125;,<br>  pages=&#123;31--36&#125;,<br>  year=&#123;2017&#125;,<br>  publisher=&#123;BioMed Central&#125;<br>&#125;<br><br>@misc&#123;andrews2010fastqc,<br>  title=&#123;FastQC: a quality control tool for high throughput sequence data&#125;,<br>  author=&#123;Andrews, Simon and others&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Babraham Bioinformatics, Babraham Institute, Cambridge, United Kingdom&#125;<br>&#125;<br><br>@article&#123;kent2002human,<br>  title=&#123;The human genome browser at UCSC&#125;,<br>  author=&#123;Kent, W James and Sugnet, Charles W and Furey, Terrence S and Roskin, Krishna M and Pringle, Tom H and Zahler, Alan M and Haussler, David&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;12&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;996--1006&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;richard2008comparative,<br>  title=&#123;Comparative genomics and molecular dynamics of DNA repeats in eukaryotes&#125;,<br>  author=&#123;Richard, Guy-Franck and Kerrest, Alix and Dujon, Bernard&#125;,<br>  journal=&#123;Microbiology and molecular biology reviews&#125;,<br>  volume=&#123;72&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;686--727&#125;,<br>  year=&#123;2008&#125;,<br>  publisher=&#123;Am Soc Microbiol&#125;<br>&#125;<br><br>@article&#123;gulcher2012microsatellite,<br>  title=&#123;Microsatellite markers for linkage and association studies&#125;,<br>  author=&#123;Gulcher, Jeffrey&#125;,<br>  journal=&#123;Cold Spring Harbor Protocols&#125;,<br>  volume=&#123;2012&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;pdb--top068510&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Cold Spring Harbor Laboratory Press&#125;<br>&#125;<br><br>@article&#123;brinkmann1998mutation,<br>  title=&#123;Mutation rate in human microsatellites: influence of the structure and length of the tandem repeat&#125;,<br>  author=&#123;Brinkmann, Bernd and Klintschar, Michael and Neuhuber, Franz and H&#123;<span class="hljs-keyword">\&quot;</span>u&#125;hne, Julia and Rolf, Burkhard&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;62&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;1408--1415&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;kit1961equilibrium,<br>  title=&#123;Equilibrium sedimentation in density gradients of DNA preparations from animal tissues&#125;,<br>  author=&#123;Kit, Saul&#125;,<br>  journal=&#123;Journal of molecular biology&#125;,<br>  volume=&#123;3&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;711--IN2&#125;,<br>  year=&#123;1961&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@book&#123;turnpenny2016emery,<br>  title=&#123;Emery&#x27;s Elements of Medical Genetics E-Book&#125;,<br>  author=&#123;Turnpenny, Peter D and Ellard, Sian&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Elsevier Health Sciences&#125;<br>&#125;<br><br>@article&#123;king1997evolutionary,<br>  title=&#123;Evolutionary tuning knobs&#125;,<br>  author=&#123;King, David G and Soller, Morris and Kashi, Yechezkel&#125;,<br>  journal=&#123;Endeavour&#125;,<br>  volume=&#123;21&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;36--40&#125;,<br>  year=&#123;1997&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;chistiakov2006microsatellites,<br>  title=&#123;Microsatellites and their genomic distribution, evolution, function and applications: a review with special reference to fish genetics&#125;,<br>  author=&#123;Chistiakov, Dimitry A and Hellemans, Bart and Volckaert, Filip AM&#125;,<br>  journal=&#123;Aquaculture&#125;,<br>  volume=&#123;255&#125;,<br>  number=&#123;1-4&#125;,<br>  pages=&#123;1--29&#125;,<br>  year=&#123;2006&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;pearson2005repeat,<br>  title=&#123;Repeat instability: mechanisms of dynamic mutations&#125;,<br>  author=&#123;Pearson, Christopher E and Edamura, Kerrie Nichol and Cleary, John D&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;6&#125;,<br>  number=&#123;10&#125;,<br>  pages=&#123;729--742&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;klintschar2004haplotype,<br>  title=&#123;Haplotype studies support slippage as the mechanism of germline mutations in short tandem repeats&#125;,<br>  author=&#123;Klintschar, Michael and Dauber, Eva-Maria and Ricci, Ugo and Cerri, Nicoletta and Immel, Uta-Dorothee and Kleiber, Manfred and Mayr, Wolfgang R&#125;,<br>  journal=&#123;Electrophoresis&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;20&#125;,<br>  pages=&#123;3344--3348&#125;,<br>  year=&#123;2004&#125;,<br>  publisher=&#123;Wiley Online Library&#125;<br>&#125;<br><br>@article&#123;brinkmann1998mutation,<br>  title=&#123;Mutation rate in human microsatellites: influence of the structure and length of the tandem repeat&#125;,<br>  author=&#123;Brinkmann, Bernd and Klintschar, Michael and Neuhuber, Franz and H&#123;<span class="hljs-keyword">\&quot;</span>u&#125;hne, Julia and Rolf, Burkhard&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;62&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;1408--1415&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;gymrek2016abundant,<br>  title=&#123;Abundant contribution of short tandem repeats to gene expression variation in humans&#125;,<br>  author=&#123;Gymrek, Melissa and Willems, Thomas and Guilmatre, Audrey and Zeng, Haoyang and Markus, Barak and Georgiev, Stoyan and Daly, Mark J and Price, Alkes L and Pritchard, Jonathan K and Sharp, Andrew J and others&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;48&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;22--29&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;marcotte1999census,<br>  title=&#123;A census of protein repeats&#125;,<br>  author=&#123;Marcotte, Edward M and Pellegrini, Matteo and Yeates, Todd O and Eisenberg, David&#125;,<br>  journal=&#123;Journal of molecular biology&#125;,<br>  volume=&#123;293&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;151--160&#125;,<br>  year=&#123;1999&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;sutherland1995simple,<br>  title=&#123;Simple tandem DNA repeats and human genetic disease.&#125;,<br>  author=&#123;Sutherland, Grant R and Richards, Robert I&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;92&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;3636--3641&#125;,<br>  year=&#123;1995&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;hancock2005simple,<br>  title=&#123;Simple sequence repeats in proteins and their significance for network evolution&#125;,<br>  author=&#123;Hancock, John M and Simon, Michelle&#125;,<br>  journal=&#123;Gene&#125;,<br>  volume=&#123;345&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;113--118&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;fondon2004molecular,<br>  title=&#123;Molecular origins of rapid and continuous morphological evolution&#125;,<br>  author=&#123;Fondon, John W and Garner, Harold R&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;101&#125;,<br>  number=&#123;52&#125;,<br>  pages=&#123;18058--18063&#125;,<br>  year=&#123;2004&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;verstrepen2005intragenic,<br>  title=&#123;Intragenic tandem repeats generate functional variability&#125;,<br>  author=&#123;Verstrepen, Kevin J and Jansen, An and Lewitter, Fran and Fink, Gerald R&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;37&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;986--990&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;moxon1994adaptive,<br>  title=&#123;Adaptive evolution of highly mutable loci in pathogenic bacteria&#125;,<br>  author=&#123;Moxon, E Richard and Rainey, Paul B and Nowak, Martin A and Lenski, Richard E&#125;,<br>  journal=&#123;Current biology&#125;,<br>  volume=&#123;4&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;24--33&#125;,<br>  year=&#123;1994&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;grunewald2015chimeric,<br>  title=&#123;Chimeric EWSR1-FLI1 regulates the Ewing sarcoma susceptibility gene EGR2 via a GGAA microsatellite&#125;,<br>  author=&#123;Gr&#123;<span class="hljs-keyword">\&quot;</span>u&#125;newald, Thomas GP and Bernard, Virginie and Gilardi-Hebenstreit, Pascale and Raynal, Virginie and Surdez, Didier and Aynaud, Marie-Ming and Mirabeau, Olivier and Cidre-Aranaz, Florencia and Tirode, Franck and Zaidi, Sakina and others&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;47&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1073--1078&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;musa2019cooperation,<br>  title=&#123;Cooperation of cancer drivers with regulatory germline variants shapes clinical outcomes&#125;,<br>  author=&#123;Musa, Julian and Cidre-Aranaz, Florencia and Aynaud, Marie-Ming and Orth, Martin F and Knott, Maximilian ML and Mirabeau, Olivier and Mazor, Gal and Varon, Mor and H&#123;<span class="hljs-keyword">\&quot;</span>o&#125;lting, Tilman LB and Grosset&#123;<span class="hljs-keyword">\^</span>e&#125;te, Sandrine and others&#125;,<br>  journal=&#123;Nature communications&#125;,<br>  volume=&#123;10&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;1--10&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;forster2015elevated,<br>  title=&#123;Elevated germline mutation rate in teenage fathers&#125;,<br>  author=&#123;Forster, Peter and Hohoff, Carsten and Dunkelmann, Bettina and Sch&#123;<span class="hljs-keyword">\&quot;</span>u&#125;renkamp, Marianne and Pfeiffer, Heidi and Neuhuber, Franz and Brinkmann, Bernd&#125;,<br>  journal=&#123;Proceedings of the Royal Society B: Biological Sciences&#125;,<br>  volume=&#123;282&#125;,<br>  number=&#123;1803&#125;,<br>  pages=&#123;20142898&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;The Royal Society&#125;<br>&#125;<br><br>@article&#123;weber1993mutation,<br>  title=&#123;Mutation of human short tandem repeats&#125;,<br>  author=&#123;Weber, James L and Wong, Carmen&#125;,<br>  journal=&#123;Human molecular genetics&#125;,<br>  volume=&#123;2&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;1123--1128&#125;,<br>  year=&#123;1993&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;jarne1996microsatellites,<br>  title=&#123;Microsatellites, from molecules to populations and back&#125;,<br>  author=&#123;Jarne, Philippe and Lagoda, Pierre JL&#125;,<br>  journal=&#123;Trends in ecology <span class="hljs-keyword">\&amp;</span> evolution&#125;,<br>  volume=&#123;11&#125;,<br>  number=&#123;10&#125;,<br>  pages=&#123;424--429&#125;,<br>  year=&#123;1996&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;kruglyak1998equilibrium,<br>  title=&#123;Equilibrium distributions of microsatellite repeat length resulting from a balance between slippage events and point mutations&#125;,<br>  author=&#123;Kruglyak, Semyon and Durrett, Richard T and Schug, Malcolm D and Aquadro, Charles F&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;95&#125;,<br>  number=&#123;18&#125;,<br>  pages=&#123;10774--10778&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;reik2001genomic,<br>  title=&#123;Genomic imprinting: parental influence on the genome&#125;,<br>  author=&#123;Reik, Wolf and Walter, J&#123;<span class="hljs-keyword">\&quot;</span>o&#125;rn&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;2&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;21--32&#125;,<br>  year=&#123;2001&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;morison2005census,<br>  title=&#123;A census of mammalian imprinting&#125;,<br>  author=&#123;Morison, Ian M and Ramsay, Joshua P and Spencer, Hamish G&#125;,<br>  journal=&#123;TRENDS in Genetics&#125;,<br>  volume=&#123;21&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;457--465&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;lau1994loss,<br>  title=&#123;Loss of the imprinted IGF2/cation-independent mannose 6-phosphate receptor results in fetal overgrowth and perinatal lethality.&#125;,<br>  author=&#123;Lau, MM and Stewart, CE and Liu, Ziying and Bhatt, Harshida and Rotwein, Peter and Stewart, Colin L&#125;,<br>  journal=&#123;Genes <span class="hljs-keyword">\&amp;</span> Development&#125;,<br>  volume=&#123;8&#125;,<br>  number=&#123;24&#125;,<br>  pages=&#123;2953--2963&#125;,<br>  year=&#123;1994&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;haig1989selective,<br>  title=&#123;Selective forces in the emergence of the seed habit&#125;,<br>  author=&#123;Haig, David and Westoby, Mark&#125;,<br>  journal=&#123;Biological Journal of the Linnean Society&#125;,<br>  volume=&#123;38&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;215--238&#125;,<br>  year=&#123;1989&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;moore1991genomic,<br>  title=&#123;Genomic imprinting in mammalian development: a parental tug-of-war&#125;,<br>  author=&#123;Moore, Tom and Haig, David&#125;,<br>  journal=&#123;Trends in genetics&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;45--49&#125;,<br>  year=&#123;1991&#125;,<br>  publisher=&#123;Elsevier Current Trends&#125;<br>&#125;<br><br>@article&#123;lefebvre1998abnormal,<br>  title=&#123;Abnormal maternal behaviour and growth retardation associated with loss of the imprinted gene Mest&#125;,<br>  author=&#123;Lefebvre, Louis and Viville, St&#123;<span class="hljs-keyword">\&#x27;</span>e&#125;phane and Barton, Sheila C and Ishino, Fumitoshi and Keverne, Eric B and Surani, M Azim&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;163--169&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;hamed2012cellular,<br>  title=&#123;Cellular functions of genetically imprinted genes in human and mouse as annotated in the gene ontology&#125;,<br>  author=&#123;Hamed, Mohamed and Ismael, Siba and Paulsen, Martina and Helms, Volkhard&#125;,<br>  journal=&#123;PloS one&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;11&#125;,<br>  pages=&#123;e50285&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Public Library of Science&#125;<br>&#125;<br><br>@article&#123;renfree2009evolution,<br>  title=&#123;Evolution of genomic imprinting: insights from marsupials and monotremes&#125;,<br>  author=&#123;Renfree, Marilyn B and Hore, Timothy A and Shaw, Geoffrey and Marshall Graves, Jennifer A and Pask, Andrew J&#125;,<br>  journal=&#123;Annual review of genomics and human genetics&#125;,<br>  volume=&#123;10&#125;,<br>  pages=&#123;241--262&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Annual Reviews&#125;<br>&#125;<br><br>@article&#123;moore1991genomic,<br>  title=&#123;Genomic imprinting in mammalian development: a parental tug-of-war&#125;,<br>  author=&#123;Moore, Tom and Haig, David&#125;,<br>  journal=&#123;Trends in genetics&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;45--49&#125;,<br>  year=&#123;1991&#125;,<br>  publisher=&#123;Elsevier Current Trends&#125;<br>&#125;<br><br>@article&#123;varmuza1994genomic,<br>  title=&#123;Genomic imprinting—defusing the ovarian time bomb&#125;,<br>  author=&#123;Varmuza, Sue and Mann, Mellissa&#125;,<br>  journal=&#123;Trends in Genetics&#125;,<br>  volume=&#123;10&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;118--123&#125;,<br>  year=&#123;1994&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;wilkins2003good,<br>  title=&#123;What good is genomic imprinting: the function of parent-specific gene expression&#125;,<br>  author=&#123;Wilkins, Jon F and Haig, David&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;4&#125;,<br>  number=&#123;5&#125;,<br>  pages=&#123;359--368&#125;,<br>  year=&#123;2003&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;grossniklaus2014transcriptional,<br>  title=&#123;Transcriptional silencing by polycomb-group proteins&#125;,<br>  author=&#123;Grossniklaus, Ueli and Paro, Renato&#125;,<br>  journal=&#123;Cold Spring Harbor perspectives in biology&#125;,<br>  volume=&#123;6&#125;,<br>  number=&#123;11&#125;,<br>  pages=&#123;a019331&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;bartolomei1997genomic,<br>  title=&#123;Genomic imprinting in mammals&#125;,<br>  author=&#123;Bartolomei, Marisa S and Tilghman, Shirley M&#125;,<br>  journal=&#123;Annual review of genetics&#125;,<br>  volume=&#123;31&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;493--525&#125;,<br>  year=&#123;1997&#125;,<br>  publisher=&#123;Annual Reviews 4139 El Camino Way, PO Box 10139, Palo Alto, CA 94303-0139, USA&#125;<br>&#125;<br><br><br><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RME</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UCSD Bioinfomatics</title>
    <link href="/2021/01/19/20210119UCSD_Bioinfomatics/"/>
    <url>/2021/01/19/20210119UCSD_Bioinfomatics/</url>
    
    <content type="html"><![CDATA[<p><strong>20201003UCSD基因组测序.pdf获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20201003UCSD%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%B5%8B%E5%BA%8F.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><p><strong>20200929UCSD发现DNA中的隐藏信息.pdf获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20200929UCSD%E5%8F%91%E7%8E%B0DNA%E4%B8%AD%E7%9A%84%E9%9A%90%E8%97%8F%E4%BF%A1%E6%81%AF.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><p><strong>20201004UCSD基因蛋白质和基因组的比对.pdf获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20201004UCSD%E5%9F%BA%E5%9B%A0%E8%9B%8B%E7%99%BD%E8%B4%A8%E5%92%8C%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%9A%84%E6%AF%94%E5%AF%B9.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><p><strong>20201005UCSD分子进化.pdf获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20201005UCSD%E5%88%86%E5%AD%90%E8%BF%9B%E5%8C%96.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h1 id="UCSD-Bioinfomatics"><a href="#UCSD-Bioinfomatics" class="headerlink" title="UCSD Bioinfomatics"></a>UCSD Bioinfomatics</h1><p>python version: 3.8</p><h2 id="week-1"><a href="#week-1" class="headerlink" title="week 1"></a>week 1</h2><h3 id="simply-count-k-mers-in-string"><a href="#simply-count-k-mers-in-string" class="headerlink" title="simply count k-mers in string"></a>simply count k-mers in string</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">string1 = <span class="hljs-string">&quot;ACAACTATGCATACTATCGGGAACTATCCT&quot;</span><br><span class="hljs-built_in">print</span>(string1.count(<span class="hljs-string">&quot;ACTAT&quot;</span>))<br></code></pre></td></tr></table></figure><h3 id="move-a-frame-on-string-to-find-all-the-k-mers"><a href="#move-a-frame-on-string-to-find-all-the-k-mers" class="headerlink" title="move a frame on string to find all the k-mers"></a>move a frame on string to find all the k-mers</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">string1 = <span class="hljs-string">&quot;ACGATATCTCGAAATGAGCTATATCTCGTCCTGTACTAAA&quot;</span><br>k_mer1 = <span class="hljs-string">&quot;ATATCTCAT&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PatternCount</span>(<span class="hljs-params">Text, Pattern</span>):</span><br>    count = <span class="hljs-number">0</span> <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Text)):<br>        j = Text[i:i+<span class="hljs-built_in">len</span>(Pattern)]             <br>        <span class="hljs-keyword">if</span> j == Pattern:                                  <br>            count = count + <span class="hljs-number">1</span><br>            <span class="hljs-comment">#print(j)</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br>    <span class="hljs-built_in">print</span>(count)<br><br>PatternCount(string1, k_mer1)<br></code></pre></td></tr></table></figure><h3 id="find-the-most-frequent-k-mer-in-the-string"><a href="#find-the-most-frequent-k-mer-in-the-string" class="headerlink" title="find the most frequent k-mer in the string"></a>find the most frequent k-mer in the string</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<br>string2 = <span class="hljs-string">&quot;CGTTGCTCGCATAGACCGTACGCGACTGACGC&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">FrequentWords</span>(<span class="hljs-params"><span class="hljs-type">Sequence</span>,K</span>):</span><br>c = (Counter((<span class="hljs-type">Sequence</span>[i:i+K] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-type">Sequence</span>)-K+<span class="hljs-number">1</span>)))).most_common()<br><span class="hljs-built_in">print</span>(c)<br>FrequentWords(string2,<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><h3 id="Solve-the-Reverse-Complement-Problem"><a href="#Solve-the-Reverse-Complement-Problem" class="headerlink" title="Solve the Reverse Complement Problem"></a>Solve the Reverse Complement Problem</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> Bio<br><span class="hljs-keyword">from</span> Bio.Seq <span class="hljs-keyword">import</span> Seq<br>dna1 = Seq(<span class="hljs-string">&quot;AACCGATGACGAAGCGACCGCGAAATCAGACCATGCGTGACAGTGCAAGGTCACCTCGTATCATCCGGCATGGCGACGAGCCGGGATGGAGTTTACCCGTGATGCATGTGATTTAGTTAGAC&quot;</span>)<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ReverseDNA</span>(<span class="hljs-params">dan1</span>):</span><br> <span class="hljs-keyword">pass</span> ReverseDNA(DNAseq):<br>complementing_strand = DNAseq.reverse_complement()<br><span class="hljs-built_in">print</span>(complementing_strand)<br>ReverseDNA(dna1)<br></code></pre></td></tr></table></figure><h3 id="Solve-the-Pattern-Matching-Problem"><a href="#Solve-the-Pattern-Matching-Problem" class="headerlink" title="Solve the Pattern Matching Problem"></a>Solve the Pattern Matching Problem</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> Bio<br><span class="hljs-keyword">from</span> Bio.Seq <span class="hljs-keyword">import</span> Seq<br>file_input = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;/Users/keqinliu/Downloads/Vibrio_cholerae.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>)<br>dna2 = file_input.read()<br>file_input.close()<br>k_mer2 = <span class="hljs-string">&quot;CTTGATCAT&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PatternLocation</span>(<span class="hljs-params">Text, Pattern</span>):</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Text)):<br>j = Text[i:i+<span class="hljs-built_in">len</span>(Pattern)]<br><span class="hljs-keyword">if</span> j == Pattern:<br><span class="hljs-built_in">print</span>(i)<br>PatternLocation(dna2, k_mer2)<br></code></pre></td></tr></table></figure><h3 id="Find-patterns-forming-clumps-in-a-string"><a href="#Find-patterns-forming-clumps-in-a-string" class="headerlink" title="Find patterns forming clumps in a string"></a>Find patterns forming clumps in a string</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<br>string2 = <span class="hljs-string">&quot;AACAGGGAGTCAGGAAAACTAAGCCACGCAATGTTTATTAGATTACTAGATTACGATTACATTAATTCGTTCGTTACAGAGTTCGTTACAGAATCAGTGGAAACCACCACGGAAAAAACAGACCTCCAAGGTCTACCTGGATAACTTGGTTCGTTTTATCACACTATATCATTATCTGCCGATCACGTGATTAAGGCGCATTCACCGAGCAACTAATTCCATAGATTCTCACTCAGAGGAGATGGTGAGGGACCTCGGCGTACCCATCCCGCAGCAACATGACAAGGTAGCGTTGCATAGCGATCTCTAAAAAGAGCGTCCTAATAAGCAAAGCTTATCGGTTACAGAGACACAGACACGACAGAGACACACCCTGCCTTGGTCGGAGAAGAAGAATGCAGGAAGAGAAGAATGCTTCGTGTTACCAAGTCAGAGTTGTCATTAGCAGTTGTCACACTCGGGCAGATCTTGGGTGTGTGGATGCCTGCCTAGGCCTAGAGCAGAGCGCTCGTATCCTACGTGTAGTCGTATCGCCACCATTCCAACCAATAATATGCAGTAGGGCAGTCCTCGATGATCGTGAGGAGCCACATATGGAGCCACATCATGGGAATGCAATTCGTTGCAATTCGCGGCAATTCGCTGCTTCTCGTCTCTACGATTGGGCTTCTTTTCCCGTCCGACGGCAGCGATTGGTTCCTGATCTAGCGCAGAGTAACTGGGAAATTCGCACCACTTCGACGCAATATGAACTGTCGATTGATTGCATACAAAAAGTCTATTCAAGAAATGTCTATTGGCCGTACTGGGCCACCTAGCGGTAAACACGCCCACGCCCCCGCACGCCCCCGCTTTCGTGGATCTCGCAACTTCTGGCTGCACCTCTAATGTGCAGTTAACAACCGCTATCGGTCTGGAGCGAATTAGAACCGCTGCAGGTCTGTGAACTAACTAGATCAGGTCGCTAAACGGAAAAGTCAGTTGGACTACAACTGAGATAGCTAGATGATTAATTTACATTCCCTCGTGGCCAATATCGTCGCTACAAGGCGGGGTAAACAGAGGTAAAGGTAAACAGGCTGGGGGGCTCGGGGGGCTCGACGACTAGTGTTCAAGATCATTCCCACCTGCTCAGGTACCTTCCGGCCAGTCCGTCGAACAACCAAATTAGCTAATATCAGTCCCAGACTCACGTTTCGGATTTGGTCAGCTACGAATTGGTGGCAATGTGGCCTTATTGCAGACACACAACACCGGGACACCGGGAAGTGCCGATTTAGATGTTACGTGGTACCCGCGGTACCCGCCCCGCCGCCAAGCTATGGGTTACGCGTGCTTTATAATAATCCCCTATGCGTAGTCAGCTTTTCCCCGGGTCCCTATTTGAATCCATTTGAATCCCCTATCGCATCGCATCATCCAGGCAAGTCATACAAAAGATTCGTTTCAGACCCAACAGAGCGGCTTTGGCAGTGTATCACGTCACTGTACAAATGTACCATAACGCTAGACCGTTCAATTCGTATACTCAGACGATGCATTAGCTTCGCGGGAAGTAGACAAAGCGGGACGCATAAGACCATATATTAGATTCACCCTCTGTATTCAGGTAATGATGTATGCCGTGTTCAACCTACTGATGTATCTGCCACATCCGGAGCAGTGTGAGCGTGAGTCAGGTCCTATTACAGTACAAGATTTAGATTGTAGGACCACAGCTGCCCCTTGGATTTGCCGGCTGGTGGCTGTGATCACGAACTCCTCTTTCCTGGGAGCTCCGGGATGGCACGGTTACCAGTGTATCTCTAGTGATTGCAAGGTCTTTTTCGATGAAGCGCTTCCGCTCCTGCCGGCATTGAACCGGGAATGTCAAGTGAAATCAGAAGCGGTATCCGATAAGTTTCGTGCGGCGTCGTACTAGTTCAAAGAATTCGTATGGTTACGGCAATCGTTATGGTATCTCGGTATG&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">FrequentWords</span>(<span class="hljs-params"><span class="hljs-type">Sequence</span>,K,L</span>):</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(<span class="hljs-type">Sequence</span>)):<br>j = <span class="hljs-type">Sequence</span>[i:i+L]<br>c = (Counter((j[i:i+K] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(L-K+<span class="hljs-number">1</span>)))).most_common()<br><span class="hljs-built_in">print</span>(c)<br>FrequentWords(string2,<span class="hljs-number">9</span>,<span class="hljs-number">29</span>)<br></code></pre></td></tr></table></figure><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="calculate-skew"><a href="#calculate-skew" class="headerlink" title="calculate skew"></a>calculate skew</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">string1 = <span class="hljs-string">&quot;TAAAGACTGCCGAGAGGCCAACACGAGTGCTAGAACGAGGGGCGTAAACGCGGGTCCGAT&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Skew</span>(<span class="hljs-params">genome, i</span>):</span><br>string1 = genome[<span class="hljs-number">0</span>:i]<br>count = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> base <span class="hljs-keyword">in</span> string1:<br><span class="hljs-keyword">if</span> base == <span class="hljs-string">&quot;C&quot;</span>:<br>count += -<span class="hljs-number">1</span><br><span class="hljs-keyword">elif</span> base == <span class="hljs-string">&quot;G&quot;</span>:<br>count += <span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(count)<br>Skew(string1, <span class="hljs-number">14</span>)<br></code></pre></td></tr></table></figure><h3 id="Minimum-Skew-Problem-Find-a-position-in-a-genome-where-the-skew-diagram-attains-a-minimum"><a href="#Minimum-Skew-Problem-Find-a-position-in-a-genome-where-the-skew-diagram-attains-a-minimum" class="headerlink" title="Minimum Skew Problem: Find a position in a genome where the skew diagram attains a minimum."></a>Minimum Skew Problem: Find a position in a genome where the skew diagram attains a minimum.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">string2 = <span class="hljs-string">&quot;ATAGCCCGCAGCTCGGACAGCGGACCGGCTCGATTCGCGTACACGTAGGAAGAAGGATTCGCCAACCCCATTTGAACAAC&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">skew</span>(<span class="hljs-params">sequence</span>):</span><br>    c = <span class="hljs-number">0</span><br>    g = <span class="hljs-number">0</span><br>    min_skew = <span class="hljs-number">0</span><br>    skew_list = []<br>    index = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> sequence:<br>        index += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;C&#x27;</span>:<br>            c += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> i == <span class="hljs-string">&#x27;G&#x27;</span>:<br>            g += <span class="hljs-number">1</span><br>        skew = g-c<br>        <span class="hljs-keyword">if</span> skew &lt; min_skew:<br>            skew_list = [index]<br>            min_skew = skew<br>        <span class="hljs-keyword">if</span> skew == min_skew <span class="hljs-keyword">and</span> index <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> skew_list:<br>            skew_list.append(index)    <br>    <span class="hljs-built_in">print</span>(skew_list)<br>skew(string2)<br></code></pre></td></tr></table></figure><h3 id="Hamming-Distance-Problem-Compute-the-Hamming-distance-between-two-strings"><a href="#Hamming-Distance-Problem-Compute-the-Hamming-distance-between-two-strings" class="headerlink" title="Hamming Distance Problem: Compute the Hamming distance between two strings."></a>Hamming Distance Problem: Compute the Hamming distance between two strings.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">string3 = <span class="hljs-string">&quot;CATTAAGACCTCCCGTTCAATATGTCGTGAGACTCATGTA&quot;</span><br>string4 = <span class="hljs-string">&quot;GGCCGATTGACCATGAACAGTCATGCTTACAGTACCGGAG&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">HammingDistance</span>(<span class="hljs-params">string_1, string_2</span>):</span><br>    hammingdistance = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(string_2)):<br>        <span class="hljs-keyword">if</span> string_1[i] != string_2[i]:<br>            hammingdistance += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(hammingdistance)<br><br>HammingDistance(string3, string4)<br></code></pre></td></tr></table></figure><h3 id="Approximate-Pattern-Matching-Problem-Find-all-approximate-occurrences-of-a-pattern-in-a-string"><a href="#Approximate-Pattern-Matching-Problem-Find-all-approximate-occurrences-of-a-pattern-in-a-string" class="headerlink" title="Approximate Pattern Matching Problem: Find all approximate occurrences of a pattern in a string."></a>Approximate Pattern Matching Problem: Find all approximate occurrences of a pattern in a string.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">text_string = <span class="hljs-string">&quot;TTATCTTATAGTAAAATCCGAGTCGACTTGGTCTG&quot;</span><br>pattern_string = <span class="hljs-string">&quot;TACGCCAGCAA&quot;</span><br>most_mismatches = <span class="hljs-number">5</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">HammingDistance</span>(<span class="hljs-params">string_1, string_2</span>):</span><br>    hammingdistance = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(string_2)):<br>        <span class="hljs-keyword">if</span> string_1[i] != string_2[i]:<br>            hammingdistance += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span>(hammingdistance)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PatternFinding</span>(<span class="hljs-params">pattern, text, d</span>):</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(text)-<span class="hljs-built_in">len</span>(pattern)+<span class="hljs-number">1</span>):<br>        pattern_frame = text[i:i+<span class="hljs-built_in">len</span>(pattern)]<br>        <span class="hljs-keyword">if</span> HammingDistance(pattern, pattern_frame) &lt;= d:<br>            <span class="hljs-built_in">print</span>(i)<br><br>PatternFinding(pattern_string, text_string, most_mismatches)<br></code></pre></td></tr></table></figure><h3 id="count-pattern"><a href="#count-pattern" class="headerlink" title="count pattern"></a>count pattern</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">text_string = <span class="hljs-string">&quot;AACAAGCTGATAAACATTTAAAGAG&quot;</span><br>pattern_string = <span class="hljs-string">&quot;AAAAA&quot;</span><br>most_mismatches = <span class="hljs-number">2</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">HammingDistance</span>(<span class="hljs-params">string_1, string_2</span>):</span><br>    hammingdistance = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(string_2)):<br>        <span class="hljs-keyword">if</span> string_1[i] != string_2[i]:<br>            hammingdistance += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span>(hammingdistance)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PatternFinding</span>(<span class="hljs-params">pattern, text, d</span>):</span><br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(text)-<span class="hljs-built_in">len</span>(pattern)+<span class="hljs-number">1</span>):<br>        pattern_frame = text[i:i+<span class="hljs-built_in">len</span>(pattern)]<br>        <span class="hljs-keyword">if</span> HammingDistance(pattern, pattern_frame) &lt;= d:<br>            count += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(count)<br><br><br>PatternFinding(pattern_string, text_string, most_mismatches)<br></code></pre></td></tr></table></figure><h3 id="Frequent-Words-with-Mismatches-Problem-Find-the-most-frequent-k-mers-with-mismatches-in-a-string"><a href="#Frequent-Words-with-Mismatches-Problem-Find-the-most-frequent-k-mers-with-mismatches-in-a-string" class="headerlink" title="Frequent Words with Mismatches Problem: Find the most frequent k-mers with mismatches in a string."></a>Frequent Words with Mismatches Problem: Find the most frequent k-mers with mismatches in a string.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict<br><br>text_string = <span class="hljs-string">&quot;GAGGAGACCACCAATAAGACCAATAAGACCTTACAATAAGTTACACCGAGTTACTTACAATACCACCGAGAAGA&quot;</span><br>pattern_length = <span class="hljs-number">6</span><br>most_mismatches = <span class="hljs-number">2</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">FrequentWordsWithMismatches</span>(<span class="hljs-params">Genome, k, d</span>):</span><br>    start = time.process_time()<br>    aprox_frq_words = []<br>    frequencies = defaultdict(<span class="hljs-keyword">lambda</span>: <span class="hljs-number">0</span>)<br>    <span class="hljs-comment"># all existent kmers with d mismatches of current kmer in genome</span><br>    <span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Genome) - k + <span class="hljs-number">1</span>):<br>        curr_kmer_and_neighbors = PermuteMotifDistanceTimes(Genome[index : index + k], d)<br>        <span class="hljs-keyword">for</span> kmer <span class="hljs-keyword">in</span> curr_kmer_and_neighbors:<br>            frequencies[kmer] += <span class="hljs-number">1</span> <br><br>    <span class="hljs-keyword">for</span> kmer <span class="hljs-keyword">in</span> frequencies:<br>        <span class="hljs-keyword">if</span> frequencies[kmer] == <span class="hljs-built_in">max</span>(frequencies.values()):<br>            aprox_frq_words.append(kmer)<br>    end = time.process_time()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Time:&quot;</span>, end - start)<br>    <span class="hljs-built_in">print</span>(aprox_frq_words)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PermuteMotifOnce</span>(<span class="hljs-params">motif, alphabet=&#123;<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;T&quot;</span>&#125;</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Gets all strings within hamming distance 1 of motif and returns it as a</span><br><span class="hljs-string">    list.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>(itertools.chain.from_iterable([[<br>        motif[:pos] + nucleotide + motif[pos + <span class="hljs-number">1</span>:] <span class="hljs-keyword">for</span><br>        nucleotide <span class="hljs-keyword">in</span> alphabet] <span class="hljs-keyword">for</span><br>        pos <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(motif))])))<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PermuteMotifDistanceTimes</span>(<span class="hljs-params">motif, d</span>):</span><br>    workingSet = &#123;motif&#125;<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(d):<br>        workingSet = <span class="hljs-built_in">set</span>(itertools.chain.from_iterable(<span class="hljs-built_in">map</span>(PermuteMotifOnce, workingSet)))<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(workingSet)<br><br>FrequentWordsWithMismatches(text_string, pattern_length, most_mismatches)<br></code></pre></td></tr></table></figure><h3 id="Frequent-Words-with-Mismatches-and-Reverse-Complements-Problem-Find-the-most-frequent-k-mers-with-mismatches-and-reverse-complements-in-a-string"><a href="#Frequent-Words-with-Mismatches-and-Reverse-Complements-Problem-Find-the-most-frequent-k-mers-with-mismatches-and-reverse-complements-in-a-string" class="headerlink" title="Frequent Words with Mismatches and Reverse Complements Problem: Find the most frequent k-mers (with mismatches and reverse complements) in a string."></a>Frequent Words with Mismatches and Reverse Complements Problem: Find the most frequent k-mers (with mismatches and reverse complements) in a string.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">mismatches_and_rc</span>(<span class="hljs-params">text,k,d</span>):</span><br>    frequencyarray=&#123;&#125;<br>    rev_text=rev_comp(text)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>**k):<br>        frequencyarray[i]=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> frequencyarray:<br>        count,r_count=<span class="hljs-number">0</span>,<span class="hljs-number">0</span><br>        count=PatternMatching(text,NumberToPattern(i,k),d)<br>        r_count=PatternMatching(rev_text,NumberToPattern(i,k),d)<br>        frequencyarray[i]=count+r_count<br>    <span class="hljs-keyword">return</span> frequencyarray<br>            <br>        <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PatternMatching</span>(<span class="hljs-params">text,pat,d</span>):</span><br>    count=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>        p=text[i:i+<span class="hljs-built_in">len</span>(pat)]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(p)!= <span class="hljs-built_in">len</span>(pat): <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> hammingdistance(p,pat)&lt;=d:<br>            count=count+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> count<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">PatternToNumber</span>(<span class="hljs-params">pattern</span>):</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pattern)==<span class="hljs-number">0</span>: <span class="hljs-keyword">return</span><br>    SymbolToNumber = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-number">3</span>&#125;<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(pattern)==<span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> SymbolToNumber[pattern]<br>    n=<span class="hljs-built_in">len</span>(pattern)<br>    symbol=pattern[n-<span class="hljs-number">1</span>]<br>    prefix=pattern[:n-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">4</span>*PatternToNumber(prefix)+SymbolToNumber[symbol])<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">NumberToPattern</span>(<span class="hljs-params">index,k</span>):</span><br>    NumberToSymbol = &#123;<span class="hljs-number">0</span>:<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-number">1</span>:<span class="hljs-string">&#x27;C&#x27;</span>,<span class="hljs-number">2</span>:<span class="hljs-string">&#x27;G&#x27;</span>,<span class="hljs-number">3</span>:<span class="hljs-string">&#x27;T&#x27;</span>&#125;<br>    <span class="hljs-keyword">if</span> k==<span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> NumberToSymbol[index]<br>    prefix_index=index//<span class="hljs-number">4</span><br>    r=index%<span class="hljs-number">4</span><br>    symbol=NumberToSymbol[r]<br>    <span class="hljs-keyword">return</span> NumberToPattern(prefix_index,k-<span class="hljs-number">1</span>)+symbol<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hammingdistance</span>(<span class="hljs-params">p,q</span>):</span><br>    count=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(p)!= <span class="hljs-built_in">len</span>(q):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;The two sequences vary in lenghts&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(p)):<br>        <span class="hljs-keyword">if</span> p[i]!=q[i]:<br>            count=count+<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> count<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rev_comp</span>(<span class="hljs-params">pattern</span>):</span><br>    rpattern=<span class="hljs-string">&#x27;&#x27;</span><br>    a=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> pattern:<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;A&#x27;</span>:<br>            a.append(<span class="hljs-string">&#x27;T&#x27;</span>)<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;T&#x27;</span>:<br>            a.append(<span class="hljs-string">&#x27;A&#x27;</span>)<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;C&#x27;</span>:<br>            a.append(<span class="hljs-string">&#x27;G&#x27;</span>)<br>        <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;G&#x27;</span>:<br>            a.append(<span class="hljs-string">&#x27;C&#x27;</span>)<br>    rpattern =rpattern.join(a)<br>    <span class="hljs-keyword">return</span>(rpattern[::-<span class="hljs-number">1</span>])<br><br><br>text=<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;AAAAAAAAAA&#x27;</span>)<br>k=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-number">2</span>))<br>d=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-number">1</span>))<br>approx_kmers = mismatches_and_rc(text,k,d)<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> approx_kmers:<br>    <span class="hljs-keyword">if</span> approx_kmers[a]== <span class="hljs-built_in">max</span>(approx_kmers.values()):<br>        <span class="hljs-built_in">print</span>(NumberToPattern(a,k),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="Exercise-Break-What-is-the-expected-number-of-occurrences-of-a-9-mer-in-500-random-DNA-strings-each-of-length-1000-Assume-that-the-sequences-are-formed-by-selecting-each-nucleotide-A-C-G-T-with-the-same-probability-0-25"><a href="#Exercise-Break-What-is-the-expected-number-of-occurrences-of-a-9-mer-in-500-random-DNA-strings-each-of-length-1000-Assume-that-the-sequences-are-formed-by-selecting-each-nucleotide-A-C-G-T-with-the-same-probability-0-25" class="headerlink" title="Exercise Break: What is the expected number of occurrences of a 9-mer in 500 random DNA strings, each of length 1000? Assume that the sequences are formed by selecting each nucleotide (A, C, G, T) with the same probability (0.25)."></a>Exercise Break: What is the expected number of occurrences of a 9-mer in 500 random DNA strings, each of length 1000? Assume that the sequences are formed by selecting each nucleotide (A, C, G, T) with the same probability (0.25).</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br>a = math.<span class="hljs-built_in">pow</span>(<span class="hljs-number">4</span>,<span class="hljs-number">9</span>)<br>b = <span class="hljs-number">500</span>*<span class="hljs-number">992</span>/a<br><span class="hljs-built_in">print</span>(b)<br></code></pre></td></tr></table></figure><h3 id="Code-Challenge-Implement-MotifEnumeration-reproduced-below"><a href="#Code-Challenge-Implement-MotifEnumeration-reproduced-below" class="headerlink" title="Code Challenge: Implement MotifEnumeration (reproduced below)."></a>Code Challenge: Implement MotifEnumeration (reproduced below).</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">HammingDistance</span>(<span class="hljs-params">p, q</span>):</span><br>    count=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(p)):<br>        <span class="hljs-keyword">if</span> p[i]!=q[i]:<br>            count+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> count<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Neighbors</span>(<span class="hljs-params">Pattern, d</span>):</span><br>    <span class="hljs-keyword">if</span> d==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> [Pattern]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(Pattern)==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> [<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>]<br>    Neighborhood=[]<br>    Suffix_Pattern=Pattern[<span class="hljs-number">1</span>:]<br>    FirstSymbol_Pattern=Pattern[<span class="hljs-number">0</span>]<br>    SuffixNeighbors = Neighbors(Suffix_Pattern, d)<br>    <span class="hljs-keyword">for</span> Text <span class="hljs-keyword">in</span> SuffixNeighbors:<br>        <span class="hljs-keyword">if</span> HammingDistance(Suffix_Pattern, Text) &lt; d:<br>            <span class="hljs-keyword">for</span> nucleotide <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;A&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>]:<br>                Neighborhood.append(nucleotide+Text)<br>        <span class="hljs-keyword">else</span>:<br>            Neighborhood.append(FirstSymbol_Pattern+Text)<br>    <span class="hljs-keyword">return</span> Neighborhood<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MotifEnumeration</span>(<span class="hljs-params">dna, k, d</span>):</span><br>    patterns=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span> (<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(dna[<span class="hljs-number">0</span>])-k+<span class="hljs-number">1</span>):<br>        neighbors=Neighbors(dna[<span class="hljs-number">0</span>][i:i+k],d)<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> neighbors:<br>            count=<span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> dna:<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(l)-k+<span class="hljs-number">1</span>):<br>                    <span class="hljs-keyword">if</span> HammingDistance(j, l[i:i+k])&lt;=d:<br>                        count+=<span class="hljs-number">1</span><br>                        <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> count==<span class="hljs-built_in">len</span>(dna):<br>                patterns.append(j)<br>    Patterns = [] <br>    [Patterns.append(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> patterns <span class="hljs-keyword">if</span> x <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> Patterns] <br>    Result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> Patterns:<br>        Result = Result + <span class="hljs-string">&quot; &quot;</span> + <span class="hljs-built_in">str</span>(item)<br>    <span class="hljs-built_in">print</span>(Result)<br><br><br>string_list = [<span class="hljs-string">&quot;TCTAGCTTCGCTCTCTTTGCAACCT&quot;</span>, <span class="hljs-string">&quot;GGCTCACTATCTATCGCACCCTACT&quot;</span>, <span class="hljs-string">&quot;CTATGAAACTATTTCGGACATGAAG&quot;</span>]<br>MotifEnumeration(string_list, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><h3 id="Median-String-Problem-Find-a-median-string-solition1-only-to-find-out-all-the-k-mers-which-occur-in-sequence-collection"><a href="#Median-String-Problem-Find-a-median-string-solition1-only-to-find-out-all-the-k-mers-which-occur-in-sequence-collection" class="headerlink" title="Median String Problem: Find a median string.  solition1: only to find out all the k-mers which occur in sequence collection"></a>Median String Problem: Find a median string.  solition1: only to find out all the k-mers which occur in sequence collection</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hamming</span>(<span class="hljs-params">p1, p2</span>):</span><br>    d = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(p1)):<br>        <span class="hljs-keyword">if</span> p1[i] != p2[i]:<br>            d += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span>(d)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">MedianString</span>(<span class="hljs-params">dna, k</span>):</span><br>    <span class="hljs-comment"># iterate through each Dna string</span><br>    kmerList = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> dna:<br>        String = line<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(String) - k+<span class="hljs-number">1</span>):<br>            pattern = String[i:i+k]<br>            <span class="hljs-keyword">if</span> pattern <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> kmerList:<br>                kmerList.append(pattern)<br>            <br>        <span class="hljs-comment"># pattern that minimizes hamming distance</span><br>        distance = <span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;inf&#x27;</span>)<br>        <span class="hljs-keyword">for</span> kmer <span class="hljs-keyword">in</span> kmerList:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(String) - k+<span class="hljs-number">1</span>):<br>                <span class="hljs-keyword">if</span> distance &gt; hamming(kmer, String[i:i+k]):<br>                    distance = hamming(kmer, String[i:i+k])<br>                    Median = kmer<br>    <span class="hljs-keyword">return</span>(Median)<br><br>dna = [<span class="hljs-string">&quot;ATA&quot;</span>,<br><span class="hljs-string">&quot;ACA&quot;</span>,<br><span class="hljs-string">&quot;AGA&quot;</span>,<br><span class="hljs-string">&quot;AAT&quot;</span>,<br><span class="hljs-string">&quot;AAC&quot;</span>]<br>k = <span class="hljs-number">3</span><br><span class="hljs-built_in">print</span>(MedianString(dna, k))<br></code></pre></td></tr></table></figure><h3 id="Profile-most-Probable-k-mer-Problem-Find-a-Profile-most-probable-k-mer-in-a-string-Code-Challenge-Solve-the-Profile-most-Probable-k-mer-Problem"><a href="#Profile-most-Probable-k-mer-Problem-Find-a-Profile-most-probable-k-mer-in-a-string-Code-Challenge-Solve-the-Profile-most-Probable-k-mer-Problem" class="headerlink" title="Profile-most Probable k-mer Problem: Find a Profile-most probable k-mer in a string. Code Challenge: Solve the Profile-most Probable k-mer Problem."></a>Profile-most Probable k-mer Problem: Find a Profile-most probable k-mer in a string. Code Challenge: Solve the Profile-most Probable k-mer Problem.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python">filename = <span class="hljs-string">&#x27;dataset_159_3.txt&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> dataset:<br>    data = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> dataset:<br>        data.append(line.strip())<br>    Text = data[<span class="hljs-number">0</span>]<br>    k = <span class="hljs-built_in">int</span>(data[<span class="hljs-number">1</span>])<br>    raw_profile = data[<span class="hljs-number">2</span>:]<br>    bases = [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;T&#x27;</span>]<br>    profile_matrix = [<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">float</span>, raw_profile[i].split())) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(raw_profile))]<br>    prof_dict = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(bases, profile_matrix))<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_probability</span>(<span class="hljs-params">kmer,profile_mat</span>):</span><br>  prob=<span class="hljs-number">1</span><br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(kmer)):<br>    <span class="hljs-keyword">if</span> kmer[i]==<span class="hljs-string">&#x27;A&#x27;</span>:<br>      prob=prob*profile_mat[<span class="hljs-number">0</span>][i]<br>    <span class="hljs-keyword">if</span> kmer[i]==<span class="hljs-string">&#x27;C&#x27;</span>:<br>      prob=prob*profile_mat[<span class="hljs-number">1</span>][i]<br>    <span class="hljs-keyword">if</span> kmer[i]==<span class="hljs-string">&#x27;G&#x27;</span>:<br>      prob=prob*profile_mat[<span class="hljs-number">2</span>][i]<br>    <span class="hljs-keyword">if</span> kmer[i]==<span class="hljs-string">&#x27;T&#x27;</span>:<br>      prob=prob*profile_mat[<span class="hljs-number">3</span>][i]<br>  <span class="hljs-keyword">return</span> prob<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">profile</span>(<span class="hljs-params">dna_seq,k,profile_matrix</span>):</span><br>  max_probab=<span class="hljs-number">0</span><br>  <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(dna_seq)-k+<span class="hljs-number">1</span>):<br>    kmer=dna_seq[i:i+k]<br>    pro=compute_probability(kmer,profile_matrix)<br>    <span class="hljs-keyword">if</span> pro&gt;max_probab:<br>      max_probab=pro<br>      sol=kmer<br>  <span class="hljs-keyword">return</span> sol<br><br><span class="hljs-built_in">print</span>(profile(Text, k, profile_matrix))<br></code></pre></td></tr></table></figure><h3 id="Code-Challenge-Implement-GreedyMotifSearch"><a href="#Code-Challenge-Implement-GreedyMotifSearch" class="headerlink" title="Code Challenge: Implement GreedyMotifSearch."></a>Code Challenge: Implement GreedyMotifSearch.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs python">in_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dataset_159_5.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br><br>line = <span class="hljs-number">1</span><br>in_kmer = <span class="hljs-number">0</span><br>in_dna=[]<br>ldata = <span class="hljs-string">&#x27;&#x27;</span><br>in_m=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> in_data <span class="hljs-keyword">in</span> in_file:<br>    ldata = in_data.strip(<span class="hljs-string">&#x27; \t\n\r&#x27;</span>)<br>    <span class="hljs-keyword">if</span> (line==<span class="hljs-number">1</span>):<br>        in_kmer = <span class="hljs-built_in">int</span>(ldata.split()[<span class="hljs-number">0</span>])<br>        in_m = <span class="hljs-built_in">int</span>(ldata.split()[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">elif</span> (line&gt;=<span class="hljs-number">2</span>):<br>        in_dna.append(ldata)    <br>    line+=<span class="hljs-number">1</span><br>    <br>motifs=[]<br>profile_motif_matrix=&#123;&#125;<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">GGCGTTCAGGCA</span><br><span class="hljs-string">GGC A[0.0, 0.0, 0.0] C[0.0, 0.0, 1.0] T[0.0, 0.0, 0.0] G[1.0, 1.0, 0.0]</span><br><span class="hljs-string">    =&gt; [&#x27;AAGAATCAGTCA&#x27;, &#x27;CAAGGAGTTCGC&#x27;, &#x27;CACGTCAATCAC&#x27;, &#x27;CAATAATATTCG&#x27;]</span><br><span class="hljs-string">    =&gt; [&#x27;GGC&#x27;, &#x27;AAG&#x27;, &#x27;CAA&#x27;, &#x27;CAC&#x27;, &#x27;CAA&#x27;] (max_probability_dna_kmer)</span><br><span class="hljs-string">    =&gt; A[1.0, 4.0, 2.0], C[3.0, 0.0, 2.0], T[0.0, 0.0, 0.0], G[1.0, 1.0, 1.0]/5(in_m)</span><br><span class="hljs-string">        =&gt; max(Col1 1,3,0,1) =&gt; 3 - 5(in_m) = 2 (score_motif)</span><br><span class="hljs-string">        =&gt; max(Col2 4,0,0,1) =&gt; 4 - 5(in_m) = 1 (score_motif)</span><br><span class="hljs-string">        =&gt; max(Col3 2,2,0,1) =&gt; 2 - 5(in_m) = 3 (score_motif) =&gt; 6.0</span><br><span class="hljs-string">    =&gt; A[0.2, 0.8, 0.4], C[0.6, 0.0, 0.4], T[0.0, 0.0, 0.0], G[0.2, 0.2, 0.2]</span><br><span class="hljs-string">GCG A[0.0, 0.0, 0.0] C[0.0, 1.0, 0.0] T[0.0, 0.0, 0.0] G[1.0, 0.0, 1.0]</span><br><span class="hljs-string">    =&gt; [&#x27;AAGAATCAGTCA&#x27;, &#x27;CAAGGAGTTCGC&#x27;, &#x27;CACGTCAATCAC&#x27;, &#x27;CAATAATATTCG&#x27;]</span><br><span class="hljs-string">    =&gt; [&#x27;GCG&#x27;, &#x27;AAG&#x27;, &#x27;CAA&#x27;, &#x27;CAC&#x27;, &#x27;CAA&#x27;] (max_probability_dna_kmer)</span><br><span class="hljs-string">    =&gt; A[0.2, 0.8, 0.4], C[0.6, 0.2, 0.2], T[0.0, 0.0, 0.0], G[0.2, 0.0, 0.4] (/5)</span><br><span class="hljs-string">...</span><br><span class="hljs-string">GCA A[0.0, 0.0, 1.0] C[0.0, 1.0, 0.0] T[0.0, 0.0, 0.0] G[0.0, 0.0, 1.0]</span><br><span class="hljs-string">    =&gt; [&#x27;AAGAATCAGTCA&#x27;, &#x27;CAAGGAGTTCGC&#x27;, &#x27;CACGTCAATCAC&#x27;, &#x27;CAATAATATTCG&#x27;]</span><br><span class="hljs-string">    =&gt; [&#x27;GCA&#x27;, &#x27;AAG&#x27;, &#x27;CAA&#x27;, &#x27;CAC&#x27;, &#x27;CAA&#x27;] (max_probability_dna_kmer)</span><br><span class="hljs-string">    =&gt; A[0.2, 0.8, 0.6], C[0.6, 0.2, 0.2], T[0.0, 0.0, 0.0], G[0.2, 0.0, 0.2] (/5)</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ScoreMotif</span>():</span><br>    alist=[]<br>    clist=[]<br>    tlist=[]<br>    glist=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,in_kmer):<br>        alist.append(<span class="hljs-number">0.00</span>)<br>        clist.append(<span class="hljs-number">0.00</span>)<br>        tlist.append(<span class="hljs-number">0.00</span>)<br>        glist.append(<span class="hljs-number">0.00</span>)<br>    <span class="hljs-keyword">for</span> j, motif <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(motifs):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,in_kmer):<br>            single =motif[i]<br>            ac = single.count(<span class="hljs-string">&#x27;A&#x27;</span>)           <br>            cc = single.count(<span class="hljs-string">&#x27;C&#x27;</span>)           <br>            tc = single.count(<span class="hljs-string">&#x27;T&#x27;</span>)           <br>            gc = single.count(<span class="hljs-string">&#x27;G&#x27;</span>)           <br>            alist[i]=(alist[i]+<span class="hljs-built_in">float</span>(ac))<br>            clist[i]=(clist[i]+<span class="hljs-built_in">float</span>(cc))<br>            tlist[i]=(tlist[i]+<span class="hljs-built_in">float</span>(tc))<br>            glist[i]=(glist[i]+<span class="hljs-built_in">float</span>(gc))<br>        profile_motif_matrix[<span class="hljs-string">&#x27;A&#x27;</span>] =alist<br>        profile_motif_matrix[<span class="hljs-string">&#x27;C&#x27;</span>] =clist<br>        profile_motif_matrix[<span class="hljs-string">&#x27;G&#x27;</span>] =glist<br>        profile_motif_matrix[<span class="hljs-string">&#x27;T&#x27;</span>] =tlist<br><br>    score_motif=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(motifs)==in_m):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,in_kmer):<br>            lv=<span class="hljs-number">0</span><br>            a = profile_motif_matrix[<span class="hljs-string">&#x27;A&#x27;</span>][i]<br>            c = profile_motif_matrix[<span class="hljs-string">&#x27;C&#x27;</span>][i]<br>            g = profile_motif_matrix[<span class="hljs-string">&#x27;G&#x27;</span>][i]<br>            t = profile_motif_matrix[<span class="hljs-string">&#x27;T&#x27;</span>][i]<br>            <span class="hljs-keyword">if</span>(a&gt;lv <span class="hljs-keyword">and</span> a!=<span class="hljs-number">0</span>):<br>                lv=a<br>            <span class="hljs-keyword">if</span>(c&gt;lv <span class="hljs-keyword">and</span> c!=<span class="hljs-number">0</span>):<br>                lv=c<br>            <span class="hljs-keyword">if</span>(g&gt;lv <span class="hljs-keyword">and</span> g!=<span class="hljs-number">0</span>):<br>                lv=g<br>            <span class="hljs-keyword">if</span>(t&gt;lv <span class="hljs-keyword">and</span> t!=<span class="hljs-number">0</span>):<br>                lv=t<br>            lv=in_m-lv   <br>            score_motif+=lv<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,in_kmer):<br>        profile_motif_matrix[<span class="hljs-string">&#x27;A&#x27;</span>][i]/=(j+<span class="hljs-number">1.0</span>)<br>        profile_motif_matrix[<span class="hljs-string">&#x27;C&#x27;</span>][i]/=(j+<span class="hljs-number">1.0</span>)<br>        profile_motif_matrix[<span class="hljs-string">&#x27;G&#x27;</span>][i]/=(j+<span class="hljs-number">1.0</span>)<br>        profile_motif_matrix[<span class="hljs-string">&#x27;T&#x27;</span>][i]/=(j+<span class="hljs-number">1.0</span>)<br>    <span class="hljs-keyword">return</span> score_motif<br><br>best_motif_score =in_m*in_kmer<br>best_motif= []<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(in_dna[<span class="hljs-number">0</span>])-in_kmer+<span class="hljs-number">1</span>):<br>    dna_kmer = in_dna[<span class="hljs-number">0</span>][k:k+in_kmer]<br>    motifs.append(dna_kmer)<br>    ScoreMotif()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(in_dna)):<br>        max_probability_dna_kmer = -<span class="hljs-number">1</span><br>        dna_kmer=<span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(in_dna[i])-in_kmer+<span class="hljs-number">1</span>):<br>            p = in_dna[i][j:j+in_kmer]<br>            probability_dna_kmer =<span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(p)):<br>                probability_dna_kmer*= profile_motif_matrix[p[l]][l]<br>            <span class="hljs-keyword">if</span>(probability_dna_kmer&gt;max_probability_dna_kmer):<br>                max_probability_dna_kmer = probability_dna_kmer<br>                dna_kmer = p<br>        motifs.append(dna_kmer)<br>        motif_score = ScoreMotif()<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(motifs)==in_m):<br>            <span class="hljs-keyword">if</span> (motif_score&lt;best_motif_score):<br>                best_motif=motifs<br>                best_motif_score = motif_score<br>    motifs=[]<br>    profile_motif_matrix=&#123;&#125;<br><br><span class="hljs-keyword">for</span> i, f <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(best_motif):<br>    <span class="hljs-built_in">print</span> (f)<br></code></pre></td></tr></table></figure><h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="Code-Challenge-Implement-RandomizedMotifSearch"><a href="#Code-Challenge-Implement-RandomizedMotifSearch" class="headerlink" title="Code Challenge: Implement RandomizedMotifSearch."></a>Code Challenge: Implement RandomizedMotifSearch.</h3><p>Input: Integers k and t, followed by a collection of strings Dna.</p><p>Output: A collection BestMotifs resulting from running RandomizedMotifSearch(Dna, k, t) 1,000 times.</p><p>problem occurs: the output seems not correct</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Count</span>(<span class="hljs-params">Motifs</span>):</span><br>    count = &#123;&#125; <span class="hljs-comment"># initializing the count dictionary</span><br>    k = <span class="hljs-built_in">len</span>(Motifs[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">for</span> symbol <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ACGT&quot;</span>:<br>        count[symbol] = []<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>            count[symbol].append(<span class="hljs-number">0</span>)<br><br>    t = <span class="hljs-built_in">len</span>(Motifs)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>            symbol = Motifs[i][j]<br>            count[symbol][j] += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> count<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Consensus</span>(<span class="hljs-params">Motifs</span>):</span><br>    k = <span class="hljs-built_in">len</span>(Motifs[<span class="hljs-number">0</span>])<br>    count = Count(Motifs)<br>    consensus = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>        m = <span class="hljs-number">0</span><br>        frequentSymbol = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> symbol <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ACGT&quot;</span>:<br>            <span class="hljs-keyword">if</span> count[symbol][j] &gt; m:<br>                m = count[symbol][j]<br>                frequentSymbol = symbol<br>        consensus += frequentSymbol<br>    <span class="hljs-keyword">return</span> consensus<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Score</span>(<span class="hljs-params">Motifs</span>):</span><br>    consensus = Consensus(Motifs)<br>    t = <span class="hljs-built_in">len</span>(Motifs)<br>    k = <span class="hljs-built_in">len</span>(Motifs[<span class="hljs-number">0</span>])<br>    score = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>        FrequentSymbol = consensus[i]<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>            <span class="hljs-keyword">if</span> Motifs[j][i] != FrequentSymbol:<br>                score = score + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> score<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Pr</span>(<span class="hljs-params">Text, Profile</span>):</span><br>    p = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Text)):<br>        p = p * Profile[Text[i]][i]<br>    <span class="hljs-keyword">return</span> p<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ProfileMostProbablePattern</span>(<span class="hljs-params">Text, k, Profile</span>):</span><br>    p_dict = &#123;&#125;<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Text)- k +<span class="hljs-number">1</span>):<br>        p = Pr(Text[i: i+k], Profile)<br>        p_dict[i] = p<br>    m = <span class="hljs-built_in">max</span>(p_dict.values())<br>    keys = [k <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> p_dict.items() <span class="hljs-keyword">if</span> v == m]<br>    ind = keys[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">return</span> Text[ind: ind +k]<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Motifs</span>(<span class="hljs-params">Profile, Dna</span>):</span><br>    motifs = []<br>    t = <span class="hljs-built_in">len</span>(Dna)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        motif = ProfileMostProbablePattern(Dna[i], k, Profile)<br>        motifs.append(motif)<br>    <span class="hljs-keyword">return</span> motifs<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RandomMotifs</span>(<span class="hljs-params">Dna, k, t</span>):</span><br>    <span class="hljs-comment"># place your code here.</span><br>    motifs= []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        ind = random.randint(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(Dna[<span class="hljs-number">0</span>])-k)<br>        motif = Dna[i][ind:ind +k]<br>        motifs.append(motif)<br>    <span class="hljs-keyword">return</span> motifs<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RandomizedMotifSearch</span>(<span class="hljs-params">Dna, k, t</span>):</span><br>    M = RandomMotifs(Dna, k, t)<br>    BestMotifs = M<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        Profile = ProfileWithPseudocounts(M)<br>        M = Motifs(Profile, Dna)<br>        <span class="hljs-keyword">if</span> Score(M) &lt; Score(BestMotifs):<br>            BestMotifs = M<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> BestMotifs <br> <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ProfileWithPseudocounts</span>(<span class="hljs-params">Motifs</span>):</span><br>    t = <span class="hljs-built_in">len</span>(Motifs)<br>    k = <span class="hljs-built_in">len</span>(Motifs[<span class="hljs-number">0</span>])<br>    count = CountWithPseudocounts(Motifs)<br>    profile= &#123;&#125;<br>    <span class="hljs-comment">## divide the number of motif strings to get frequency</span><br>    <span class="hljs-keyword">for</span> letter <span class="hljs-keyword">in</span> count.keys():<br>        profile[letter] = [<span class="hljs-built_in">float</span>(x)/ (t+<span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> count[letter]]<br>    <span class="hljs-keyword">return</span> profile<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">CountWithPseudocounts</span>(<span class="hljs-params">Motifs</span>):</span><br>    t = <span class="hljs-built_in">len</span>(Motifs)<br>    k = <span class="hljs-built_in">len</span>(Motifs[<span class="hljs-number">0</span>])<br>    count = &#123;&#125;<br>    <span class="hljs-keyword">for</span> symbol <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ACGT&quot;</span>:<br>        count[symbol] = []<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>            count[symbol].append(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k):<br>            symbol = Motifs[i][j]<br>            count[symbol][j] += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> count<br><br>dna = [<span class="hljs-string">&quot;CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA&quot;</span>,<br><span class="hljs-string">&quot;GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG&quot;</span>,<br><span class="hljs-string">&quot;TAGTACCGAGACCGAAAGAAGTATACAGGCGT&quot;</span>,<br><span class="hljs-string">&quot;TAGATCAAGTTTCAGGTGCACGTCGGTGAACC&quot;</span>,<br><span class="hljs-string">&quot;AATCCACCAGCTCCACGTGCAATGTTGGCCTA&quot;</span><br>]<br>k = <span class="hljs-number">8</span><br>t = <span class="hljs-number">5</span><br><br><span class="hljs-built_in">print</span>(RandomizedMotifSearch(dna,k,t))<br></code></pre></td></tr></table></figure><h2 id="distance-between-leaves"><a href="#distance-between-leaves" class="headerlink" title="distance between leaves"></a>distance between leaves</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> queue<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">In this chapter, we define the length of a path in a tree as the sum of the lengths of its edges (rather than the number of edges </span><br><span class="hljs-string">on the path). As a result, the evolutionary distance between two present-day species corresponding to leaves i and j in a tree T is </span><br><span class="hljs-string">equal to the length of the unique path connecting i and j, denoted di,j(T).</span><br><span class="hljs-string">Distances Between Leaves Problem: Compute the distances between leaves in a weighted tree.</span><br><span class="hljs-string">     Input:  An integer n followed by the adjacency list of a weighted tree with n leaves.</span><br><span class="hljs-string">     Output: An n x n matrix (di,j), where di,j is the length of the path between leaves i and j.</span><br><span class="hljs-string">Code Challenge: Solve the Distances Between Leaves Problem. The tree is given as an adjacency list of a graph whose leaves are </span><br><span class="hljs-string">integers between 0 and n - 1; the notation a-&gt;b:c means that node a is connected to node b by an edge of weight c. The matrix </span><br><span class="hljs-string">you return should be space-separated.</span><br><span class="hljs-string">Sample Input:</span><br><span class="hljs-string">4</span><br><span class="hljs-string">0-&gt;4:11</span><br><span class="hljs-string">1-&gt;4:2</span><br><span class="hljs-string">2-&gt;5:6</span><br><span class="hljs-string">3-&gt;5:7</span><br><span class="hljs-string">4-&gt;0:11</span><br><span class="hljs-string">4-&gt;1:2</span><br><span class="hljs-string">4-&gt;5:4</span><br><span class="hljs-string">5-&gt;4:4</span><br><span class="hljs-string">5-&gt;3:7</span><br><span class="hljs-string">5-&gt;2:6</span><br><span class="hljs-string">Sample Output:</span><br><span class="hljs-string">0132122</span><br><span class="hljs-string">1301213</span><br><span class="hljs-string">2112013</span><br><span class="hljs-string">2213130</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DistanceBetweenLeaves</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span><br>        n, adjDict = self._<span class="hljs-built_in">input</span>()<br>        distMatrix = self.calculateDistMatrix(n, adjDict)<br>        self.printDistMatrix(distMatrix)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_input</span>(<span class="hljs-params">self</span>):</span><br>        data = sys.stdin.read().strip().split()<br>        n = <span class="hljs-built_in">int</span>(data[<span class="hljs-number">0</span>])<br>        adjDict = <span class="hljs-built_in">dict</span>()<br>        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data[<span class="hljs-number">1</span>:]:<br>            d = d.split(<span class="hljs-string">&#x27;-&gt;&#x27;</span>)<br>            d1 = d[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;:&#x27;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">int</span>(d[<span class="hljs-number">0</span>]) <span class="hljs-keyword">in</span> adjDict:<br>                adjDict[<span class="hljs-built_in">int</span>(d[<span class="hljs-number">0</span>])] = []<br>            adjDict[<span class="hljs-built_in">int</span>(d[<span class="hljs-number">0</span>])].append((<span class="hljs-built_in">int</span>(d1[<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(d1[<span class="hljs-number">1</span>])))<br>        <span class="hljs-keyword">return</span> n, adjDict<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">readFromFile</span>(<span class="hljs-params">self</span>):</span><br>        f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;input.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>        data = []<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>            data.append(line.strip())<br>        n = <span class="hljs-built_in">int</span>(data[<span class="hljs-number">0</span>])<br>        adjDict = <span class="hljs-built_in">dict</span>()<br>        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> data[<span class="hljs-number">1</span>:]:<br>            d = d.split(<span class="hljs-string">&#x27;-&gt;&#x27;</span>)<br>            d1 = d[<span class="hljs-number">1</span>].split(<span class="hljs-string">&#x27;:&#x27;</span>)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">int</span>(d[<span class="hljs-number">0</span>]) <span class="hljs-keyword">in</span> adjDict:<br>                adjDict[<span class="hljs-built_in">int</span>(d[<span class="hljs-number">0</span>])] = []<br>            adjDict[<span class="hljs-built_in">int</span>(d[<span class="hljs-number">0</span>])].append((<span class="hljs-built_in">int</span>(d1[<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(d1[<span class="hljs-number">1</span>])))<br>        <span class="hljs-keyword">return</span> n, adjDict<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">saveResult</span>(<span class="hljs-params">self, result</span>):</span><br>        f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;result.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printDistMatrix</span>(<span class="hljs-params">self, distMatrix</span>):</span><br>        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> distMatrix:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; &#x27;</span>.join([<span class="hljs-built_in">str</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d]))<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculateDistMatrix</span>(<span class="hljs-params">self, n, adjDict</span>):</span><br>        distMatrix = [[<span class="hljs-number">0</span>]*n <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br><br>        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bfs</span>(<span class="hljs-params">s</span>):</span><br>            dist = <span class="hljs-built_in">dict</span>()<br>            q = queue.Queue()<br>            dist[s] = <span class="hljs-number">0</span><br>            q.put(s)<br>            <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> q.empty():<br>                currNode = q.get()<br>                <span class="hljs-keyword">for</span> node, weight <span class="hljs-keyword">in</span> adjDict[currNode]:<br>                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> node <span class="hljs-keyword">in</span> dist:<br>                        dist[node] = dist[currNode] + weight<br>                        <span class="hljs-keyword">if</span> node &lt; n:<br>                            distMatrix[s][node] = dist[node]<br>                        q.put(node)<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            bfs(i)<br>        <br>        <span class="hljs-keyword">return</span> distMatrix<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    DistanceBetweenLeaves()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>BIOINFO</tag>
      
      <tag>PYTHON</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.1.19 python practice</title>
    <link href="/2021/01/19/20210119pythonpractice/"/>
    <url>/2021/01/19/20210119pythonpractice/</url>
    
    <content type="html"><![CDATA[<h1 id="python-practice"><a href="#python-practice" class="headerlink" title="python practice"></a>python practice</h1><p>python practice</p><p>python version: 2.7</p><p>tutorial: Python生物信息学数据管理</p><h2 id="lesson4"><a href="#lesson4" class="headerlink" title="lesson4"></a>lesson4</h2><h3 id="count"><a href="#count" class="headerlink" title="count"></a>count</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">seq =<span class="hljs-string">&#x27;&#x27;&#x27;MDDREDLVYQAKLAEQAERYDEMVESMKKVAGMDVELTVEERNLLSVAYKNVIGARRASW</span><br><span class="hljs-string">RIISSIEQKEENKGGEDKLKMIREYRQMVETELKLICCDILDVLDKHLIPAANTGESKVF</span><br><span class="hljs-string">YYKMKGDYHRYLAEFATGNDRKEAAENSLVAYKAASDIAMTELPPTHPIRLGLALNFSVF</span><br><span class="hljs-string">YYEILNSPDRACRLAKAAFDDAIAELDTLSEESYKDSTLIMQLLRDNLTLWTSDMQGDGE</span><br><span class="hljs-string">EQNKEALQDVEDENQ&#x27;&#x27;&#x27;</span><br>number = seq.count(<span class="hljs-string">&#x27;W&#x27;</span>)<br><span class="hljs-built_in">print</span> number<br></code></pre></td></tr></table></figure><h3 id="fasta-filter"><a href="#fasta-filter" class="headerlink" title="fasta filter"></a>fasta filter</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.2</span><br><span class="hljs-keyword">import</span> os<br>path_1= os.path.abspath(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;fasta_filter.fasta&#x27;</span>)<br>file_new = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">if</span> seq[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq.count(<span class="hljs-string">&#x27;W&#x27;</span>) &gt; <span class="hljs-number">1</span>:<br>            file_new.write(header + seq)<br>            seq = <span class="hljs-string">&#x27;&#x27;</span><br>            header = line<br><span class="hljs-keyword">if</span> seq[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq.count(<span class="hljs-string">&#x27;W&#x27;</span>) &gt;= <span class="hljs-number">2</span>:<br>    file_new.write(header + seq)<br>file_new.close()<br>file_read.close()<br></code></pre></td></tr></table></figure><h3 id="calculate-ratio"><a href="#calculate-ratio" class="headerlink" title="calculate ratio"></a>calculate ratio</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.3</span><br><span class="hljs-keyword">import</span> os<br>path = (os.path.abspath(<span class="hljs-string">&#x27;multiple_DNA.fasta&#x27;</span>))<br>file_read = <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        head = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = line + seq<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-built_in">print</span> head,a,g,c,t<br>        head = line<br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-built_in">print</span> head,a,g,c,t<br>file_read.close()<br></code></pre></td></tr></table></figure><h3 id="calculate-ratio-from-gb-file"><a href="#calculate-ratio-from-gb-file" class="headerlink" title="calculate ratio from gb file"></a>calculate ratio from gb file</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#homework for 4.5.5</span><br><span class="hljs-keyword">import</span> os<br>path = (<span class="hljs-string">&#x27;AY810830.GB&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_gb&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>] == <span class="hljs-string">&#x27;ACCESSION&#x27;</span>:<br>        AC = line.split()[<span class="hljs-number">1</span>].strip()<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;ORIGIN&#x27;</span>:<br>        flag = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> flag == <span class="hljs-number">1</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">if</span> fields != <span class="hljs-string">&#x27;&#x27;</span>:<br>            seq = <span class="hljs-string">&#x27;&#x27;</span>.join(fields[<span class="hljs-number">1</span>:])<br>            seq = seq.upper()<br>            file_write.write(seq)<br><br>file_read.close()<br>file_write.close()<br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_gb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = file.read()<br>a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br><span class="hljs-built_in">print</span> a,g,c,t<br>    <br>file.close<br></code></pre></td></tr></table></figure><h3 id="read-ac-from-gb-file-and-write-into-fasta-file"><a href="#read-ac-from-gb-file-and-write-into-fasta-file" class="headerlink" title="read ac from gb.file and write into fasta.file"></a>read ac from gb.file and write into fasta.file</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#read ac from gb.file and write into fasta.file</span><br><span class="hljs-keyword">import</span> os<br>path_1 = os.path.abspath(<span class="hljs-string">&#x27;AY810830.gb&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;AY810830.fasta&#x27;</span>)<br>file_gb = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_fasta = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_gb:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>] == <span class="hljs-string">&#x27;ACCESSION&#x27;</span>:<br>        AC = line.split()[<span class="hljs-number">1</span>].strip()<br>        file_fasta.write(<span class="hljs-string">&#x27;&gt;&#x27;</span>+<span class="hljs-string">&#x27;|&#x27;</span>+AC+<span class="hljs-string">&#x27;|&#x27;</span>+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;ORIGIN&#x27;</span>:<br>        flag = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> flag == <span class="hljs-number">1</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">if</span> fields != []:<br>            seq = <span class="hljs-string">&#x27;&#x27;</span>.join(fields[<span class="hljs-number">1</span>:])<br>            file_fasta.write(seq.upper()+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            <span class="hljs-built_in">print</span> seq<br>file_gb.close()<br>file_fasta.close()<br></code></pre></td></tr></table></figure><h3 id="read-fasta-and-write-homo-sapien-to-a-new-fasta"><a href="#read-fasta-and-write-homo-sapien-to-a-new-fasta" class="headerlink" title="read fasta and write homo sapien to a new fasta"></a>read fasta and write homo sapien to a new fasta</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#read fasta and write homo sapien to a new fasta</span><br><span class="hljs-keyword">import</span> os<br>path_1 = os.path.abspath(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_write = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Homo sapiens&#x27;</span> <span class="hljs-keyword">in</span> header:<br>            file_write.write(header + seq)<br>            seq = <span class="hljs-string">&#x27;&#x27;</span><br>            header = line<br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">in</span> header:<br>    file_write.write(header + seq)<br>file_write.close()<br></code></pre></td></tr></table></figure><h3 id="save-multiple-fasta-from-fasta"><a href="#save-multiple-fasta-from-fasta" class="headerlink" title="save multiple fasta from fasta"></a>save multiple fasta from fasta</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.1</span><br><span class="hljs-keyword">import</span> os<br>path = os.path.abspath(<span class="hljs-string">&#x27;Swissprot.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        file_write = <span class="hljs-built_in">open</span>(<span class="hljs-built_in">str</span>(header.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]), <span class="hljs-string">&#x27;w&#x27;</span>)<br>        file_write.write(header + seq.upper())<br>        header = line<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> header:<br>    AC = header.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    file_write = <span class="hljs-built_in">open</span>(<span class="hljs-built_in">str</span>(AC), <span class="hljs-string">&#x27;w&#x27;</span>)<br>    file_write.write(header + seq.upper())<br>        <br>file_write.close()<br>file_read.close()<br></code></pre></td></tr></table></figure><h2 id="lesson5"><a href="#lesson5" class="headerlink" title="lesson5"></a>lesson5</h2><h3 id="4-5-1-dictionary"><a href="#4-5-1-dictionary" class="headerlink" title="4.5.1 dictionary"></a>4.5.1 dictionary</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">dic = &#123;<span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;START&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;Glycin&#x27;</span> &#125;<br><span class="hljs-built_in">print</span> dic.keys()<br><span class="hljs-built_in">print</span> dic.values()<br><span class="hljs-built_in">print</span> dic<br></code></pre></td></tr></table></figure><h3 id="4-5-2"><a href="#4-5-2" class="headerlink" title="4.5.2"></a>4.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br>number_start = <span class="hljs-number">0</span><br>number_stop = <span class="hljs-number">0</span><br>rna_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        rna_seq = rna_seq + line.strip()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(rna_seq), <span class="hljs-number">3</span>):<br>    codon = rna_seq[i:i+<span class="hljs-number">3</span>]<br>    <span class="hljs-keyword">if</span> codon == <span class="hljs-string">&#x27;AUG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;GUG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;AUA&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UUG&#x27;</span>:<br>        number_start = number_start + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> codon == <span class="hljs-string">&#x27;UAG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UGA&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UAA&#x27;</span>:<br>        number_stop = number_stop + <span class="hljs-number">1</span><br>    <br><span class="hljs-built_in">print</span> number_start,number_stop<br></code></pre></td></tr></table></figure><h3 id="4-5-2-2"><a href="#4-5-2-2" class="headerlink" title="4.5.2(2)"></a>4.5.2(2)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>text = <span class="hljs-string">&#x27;&#x27;</span><br>check = &#123;<span class="hljs-string">&#x27;(MMPs)&#x27;</span>:<span class="hljs-string">&#x27;(MMPs) found&#x27;</span>, <span class="hljs-string">&#x27;cells&#x27;</span>:<span class="hljs-string">&#x27;cells found&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;abstract.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    text += line<br>    columns = line.split()<br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> columns:<br>        <span class="hljs-keyword">if</span> word <span class="hljs-keyword">in</span> check:<br>            <span class="hljs-built_in">print</span> check[word]<br>      <br><span class="hljs-built_in">print</span> text<br></code></pre></td></tr></table></figure><h3 id="4-5-4"><a href="#4-5-4" class="headerlink" title="4.5.4"></a>4.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">aa_seq = <span class="hljs-string">&#x27;MVDREQLVQKARLAEQAERYDDMAAAMKNVTELNEPLSNEERNLLSVAYKNVVGARRSSW\</span><br><span class="hljs-string">RVISSIEQKTSADGNEKKIEMVRAYREKIEKELEAVCQDVLSLLDNYLIKNCSETQYESK\</span><br><span class="hljs-string">VFYLKMKGDYYRYLAEVATGEKRATVVESSEKAYSEAHEISKEHMQPTHPIRLGLALNYS\</span><br><span class="hljs-string">VFYYEIQNAPEQACHLAKTAFDDAIAELDTLNEDSYKDSTLIMQLLRDNLTLWTSDQQDD\</span><br><span class="hljs-string">DGGEGNN&#x27;</span><br><span class="hljs-built_in">print</span> aa_seq<br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>pref_E = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br>pref_H = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;0.97&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;1.30&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.80&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;0.26&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.28&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.81&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;0.71&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.60&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;0.74&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.22&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.67&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.62&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.63&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.90&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.72&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.19&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;1.29&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> aa_seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> pref_H <span class="hljs-keyword">and</span> res <span class="hljs-keyword">in</span> pref_E:<br>        <span class="hljs-keyword">if</span> pref_H[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_E[res] &lt; pref_H[res]:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;H&#x27;</span><br>        <span class="hljs-keyword">elif</span> pref_E[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_H[res] &lt; pref_E[res]:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;E&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;L&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure><h3 id="4-5-5"><a href="#4-5-5" class="headerlink" title="4.5.5"></a>4.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">seq = <span class="hljs-string">&#x27;MVDREQLVQKARLAEQAERYDDMAAAMKNVTELNEPLSNEERNLLSVAYKNVVGARRSSW\</span><br><span class="hljs-string">RVISSIEQKTSADGNEKKIEMVRAYREKIEKELEAVCQDVLSLLDNYLIKNCSETQYESK\</span><br><span class="hljs-string">VFYLKMKGDYYRYLAEVATGEKRATVVESSEKAYSEAHEISKEHMQPTHPIRLGLALNYS\</span><br><span class="hljs-string">VFYYEIQNAPEQACHLAKTAFDDAIAELDTLNEDSYKDSTLIMQLLRDNLTLWTSDQQDD\</span><br><span class="hljs-string">DGGEGNN&#x27;</span><br><br>aa_table = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br><br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> aa_table:<br>        <span class="hljs-keyword">if</span> aa_table[res] &gt; <span class="hljs-string">&#x27;1.00&#x27;</span>:<br>            output_seq += res.upper()<br>        <span class="hljs-keyword">else</span>:<br>            output_seq += res.lower()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br>        <span class="hljs-keyword">break</span><br>    <br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure><h3 id="find-“MMP”-and-“cell”-in-abstract"><a href="#find-“MMP”-and-“cell”-in-abstract" class="headerlink" title="find “MMP” and “cell” in abstract"></a>find “MMP” and “cell” in abstract</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>number_1 = <span class="hljs-number">0</span><br>number_2 = <span class="hljs-number">0</span><br>abstract = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;abstract.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    abstract = abstract + line.strip()<br><span class="hljs-built_in">print</span> abstract<br><br>number_1 = abstract.count(<span class="hljs-string">&#x27;MMPs&#x27;</span>)<br>number_2 = abstract.count(<span class="hljs-string">&#x27;cell&#x27;</span>)<br><br><span class="hljs-keyword">if</span> number_1 &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;MMPs found&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;MMPs not found&#x27;</span><br><span class="hljs-keyword">if</span> number_2 &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;cell found&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;cell not found&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="protein-disorder-prediction"><a href="#protein-disorder-prediction" class="headerlink" title="protein disorder prediction"></a>protein disorder prediction</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>propensities = &#123;<br>   <span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-number">0.2299</span>, <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-number">0.5523</span>, <span class="hljs-string">&#x27;Q&#x27;</span>:-<span class="hljs-number">0.18770</span>, <span class="hljs-string">&#x27;A&#x27;</span>:-<span class="hljs-number">0.2615</span>,<br>   <span class="hljs-string">&#x27;R&#x27;</span>:-<span class="hljs-number">0.1766</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0.1429</span>, <span class="hljs-string">&#x27;C&#x27;</span>:-<span class="hljs-number">0.01515</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-number">0.0089</span>,<br>   <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">0.2276</span>, <span class="hljs-string">&#x27;E&#x27;</span>:-<span class="hljs-number">0.2047</span>, <span class="hljs-string">&#x27;V&#x27;</span>:-<span class="hljs-number">0.38620</span>, <span class="hljs-string">&#x27;F&#x27;</span>:-<span class="hljs-number">0.2256</span>,<br>   <span class="hljs-string">&#x27;W&#x27;</span>:-<span class="hljs-number">0.2434</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-number">0.4332</span>, <span class="hljs-string">&#x27;H&#x27;</span>:-<span class="hljs-number">0.00120</span>, <span class="hljs-string">&#x27;Y&#x27;</span>:-<span class="hljs-number">0.2075</span>,<br>   <span class="hljs-string">&#x27;I&#x27;</span>:-<span class="hljs-number">0.4222</span>, <span class="hljs-string">&#x27;K&#x27;</span>:-<span class="hljs-number">0.1001</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">0.33793</span>, <span class="hljs-string">&#x27;M&#x27;</span>:-<span class="hljs-number">0.2259</span><br>   &#125;<br>input_seq = <span class="hljs-string">&quot;IVGGYTCGANTVPYQVSLNSGYHFCGGSLINSQWVVSAAHCYKSG\</span><br><span class="hljs-string">IQVRLGEDNINVVEGNEQFISASKSIVHPSYNSNTLNNDIMLIKLKSAASLNSR\</span><br><span class="hljs-string">VASISLPTSCASAGTQCLISGWGNTKSSGTSYPDVLKCLKAPILSDSSCKSAYP\</span><br><span class="hljs-string">GQITSNMFCAGYLEGGKDSCQGDSGGPVVCSGKLQGIVSWGSGCAQKNKPGVYT\</span><br><span class="hljs-string">KVCNYVSWIKQTIASN&quot;</span><br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>threshod = <span class="hljs-number">0.3</span><br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> propensities:<br>        <span class="hljs-keyword">if</span> propensities[res] &gt;= threshod:<br>            output_seq = output_seq + res.upper()<br>        <span class="hljs-keyword">else</span>:<br>            output_seq = output_seq + res.lower()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized charachter:&#x27;</span> , res<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure><h3 id="read-from-a-pdb-file-and-write-into-a-amino-acid-form"><a href="#read-from-a-pdb-file-and-write-into-a-amino-acid-form" class="headerlink" title="read from a pdb file and write into a amino-acid form"></a>read from a pdb file and write into a amino-acid form</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>aa_codes = &#123;<br>     <span class="hljs-string">&#x27;ALA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CYS&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;ASP&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GLU&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br>     <span class="hljs-string">&#x27;PHE&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;GLY&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;HIS&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;LYS&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>     <span class="hljs-string">&#x27;ILE&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;LEU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;MET&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;ASN&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>     <span class="hljs-string">&#x27;PRO&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;GLN&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;ARG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;SER&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>     <span class="hljs-string">&#x27;THR&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;VAL&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;TYR&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;TRP&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>&#125;<br>aa_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;SEQRES&#x27;</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">for</span> resname <span class="hljs-keyword">in</span> fields[<span class="hljs-number">4</span>:]:<br>           aa_seq = aa_seq + aa_codes[resname]<br>i = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;1TLD&#x27;</span><br><span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(aa_seq):<br>    <span class="hljs-built_in">print</span> aa_seq[i:i+<span class="hljs-number">48</span>]<br>    i = i+<span class="hljs-number">48</span><br></code></pre></td></tr></table></figure><h3 id="translate-RNA-into-amino-acid-input-is-RNA-seq"><a href="#translate-RNA-into-amino-acid-input-is-RNA-seq" class="headerlink" title="translate RNA into amino-acid (input is RNA-seq)"></a>translate RNA into amino-acid (input is RNA-seq)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br><br><span class="hljs-comment"># read the RNA sequence into a single string</span><br>rna = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>): <br>        rna = rna + line.strip()<br><br><span class="hljs-comment"># translate one frame at a time</span><br><span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    prot = <span class="hljs-string">&#x27;&#x27;</span> <br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Reading frame &#x27;</span> + <span class="hljs-built_in">str</span>(frame + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(frame, <span class="hljs-built_in">len</span>(rna), <span class="hljs-number">3</span>):<br>        codon = rna[i:i + <span class="hljs-number">3</span>]<br>        <span class="hljs-keyword">if</span> codon <span class="hljs-keyword">in</span> codon_table:<br>            <span class="hljs-keyword">if</span> codon_table[codon] == <span class="hljs-string">&#x27;STOP&#x27;</span>:<br>                prot = prot + <span class="hljs-string">&#x27;*&#x27;</span><br>            <span class="hljs-keyword">else</span>: <br>                prot = prot + codon_table[codon]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># handle too short codons</span><br>            prot = prot + <span class="hljs-string">&#x27;-&#x27;</span> <br><br>    <span class="hljs-comment"># format to blocks of 48 columns</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(prot):<br>        <span class="hljs-built_in">print</span> prot[i:i + <span class="hljs-number">48</span>]<br>        i = i + <span class="hljs-number">48</span><br></code></pre></td></tr></table></figure><h3 id="translate-RNA-into-amino-acid-input-is-RNA-file"><a href="#translate-RNA-into-amino-acid-input-is-RNA-file" class="headerlink" title="translate RNA into amino-acid (input is RNA-file)"></a>translate RNA into amino-acid (input is RNA-file)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#translate rna to amino_acid</span><br><span class="hljs-keyword">import</span> os<br>file_read = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br>rna = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>):<br>        rna = rna + line.strip()<br><span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    prot = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;read frame&#x27;</span> + <span class="hljs-built_in">str</span>(frame + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(frame, <span class="hljs-built_in">len</span>(rna), <span class="hljs-number">3</span>):<br>        codon = rna[i:i + <span class="hljs-number">3</span>]<br>        <span class="hljs-keyword">if</span> codon <span class="hljs-keyword">in</span> codon_table:<br>            <span class="hljs-keyword">if</span> codon_table[codon] == <span class="hljs-string">&#x27;STOP&#x27;</span>:<br>                prot = prot + <span class="hljs-string">&#x27;*&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                prot = prot + codon_table[codon]<br>        <span class="hljs-keyword">else</span>:<br>            prot = prot + <span class="hljs-string">&#x27;-&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(prot):<br>        <span class="hljs-built_in">print</span> prot[i:i + <span class="hljs-number">48</span>]<br>        i = i + <span class="hljs-number">48</span><br><br>file_read.close()<br></code></pre></td></tr></table></figure><h2 id="lesson6"><a href="#lesson6" class="headerlink" title="lesson6"></a>lesson6</h2><h3 id="6-5-1"><a href="#6-5-1" class="headerlink" title="6.5.1"></a>6.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new_swissprot.fasta&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>ac = <span class="hljs-string">&#x27;&#x27;</span><br>AC = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> ac == <span class="hljs-string">&#x27;&#x27;</span>:<br>        ac = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>].strip()<br>        <span class="hljs-built_in">print</span> ac<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>        file_write.write(ac + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        ac = <span class="hljs-string">&#x27;&#x27;</span><br><br>file_write.close()<br></code></pre></td></tr></table></figure><h3 id="6-5-2"><a href="#6-5-2" class="headerlink" title="6.5.2"></a>6.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>index = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    index += <span class="hljs-number">1</span><br>    number = index%<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> number == <span class="hljs-number">0</span>:<br>        file_write.write(line)<br>        <span class="hljs-built_in">print</span> line<br>        <br>file_write.close()<br></code></pre></td></tr></table></figure><h3 id="6-5-3"><a href="#6-5-3" class="headerlink" title="6.5.3"></a>6.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>list_1 = []<br>list_2 = []<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_1:<br>    list_1.append(line)<br>    <br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_2:<br>    list_2.append(line)<br><br><br>set_1 = <span class="hljs-built_in">set</span>(list_1)<br>set_2 = <span class="hljs-built_in">set</span>(list_2)<br>dif = set_1.symmetric_difference(set_2)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;dif&quot;</span>, <span class="hljs-built_in">list</span>(dif)<br></code></pre></td></tr></table></figure><h3 id="6-5-4"><a href="#6-5-4" class="headerlink" title="6.5.4"></a>6.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>list_1 = []<br>list_2 = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_1:<br>    list_1.append(line)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_2:<br>    list_2.append(line)<br><br>set_1 = <span class="hljs-built_in">set</span>(list_1)<br>set_2 = <span class="hljs-built_in">set</span>(list_2)<br>set_unique1 = set_1.difference(set_2)<br>set_unique2 = set_2.difference(set_1)<br>set_same1 = set_1.intersection(set_2)<br><br>write_1 = []<br>write_2 = []<br>write_3 = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_unique1:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        write_1.append(line.strip())<br><span class="hljs-built_in">print</span> write_1<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_unique2:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&lt;&#x27;</span>:<br>        write_2.append(line.strip())<br><span class="hljs-built_in">print</span> write_2<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_same1:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;#&#x27;</span>:<br>        write_3.append(line.strip())<br><span class="hljs-built_in">print</span> write_3<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="6-5-5"><a href="#6-5-5" class="headerlink" title="6.5.5"></a>6.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>tracking = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts.tracking&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts_filtered.tracking&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> tracking:<br>    columns = track.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    wildtype = columns[<span class="hljs-number">4</span>:<span class="hljs-number">7</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    treatment = columns[<span class="hljs-number">7</span>:<span class="hljs-number">10</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    <span class="hljs-keyword">if</span> wildtype &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> treatment &lt; <span class="hljs-number">1</span>:<br>        output_file.write(track)<br>tracking.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="find-different-number-from-2-list"><a href="#find-different-number-from-2-list" class="headerlink" title="find different number from 2 list"></a>find different number from 2 list</h3><p>solution 1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>data_b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>]<br>data_a_not_b = []<br>data_b_not_a = []<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_a:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data_b:<br>        data_a_not_b.append(number)<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_b:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data_a:<br>        data_b_not_a.append(number)<br><span class="hljs-built_in">print</span> data_a_not_b, data_b_not_a<br></code></pre></td></tr></table></figure><p>solution 2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])<br>data_b = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>])d<br>data1 = data_a.difference(data_b)<br>data2 = data_b.difference(data_a)<br><span class="hljs-built_in">print</span> data1, data2<br></code></pre></td></tr></table></figure><h3 id="save-same-number-from-2-list"><a href="#save-same-number-from-2-list" class="headerlink" title="save same number from 2 list"></a>save same number from 2 list</h3><p>solution1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>data_b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>]<br>data = []<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_a:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">in</span> data_b:<br>        data.append(number)<br><span class="hljs-built_in">print</span> data<br></code></pre></td></tr></table></figure><p>solution2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])<br>data_b1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>])   <br>data_1 = data_a1.intersection(data_b1)<br><span class="hljs-built_in">print</span> data_1<br></code></pre></td></tr></table></figure><h3 id="remove-element-from-set"><a href="#remove-element-from-set" class="headerlink" title="remove element from set"></a>remove element from set</h3><p>remove function</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.remove(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure><p>pop function</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.pop()<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure><p>discard function</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.discard(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure><h3 id="transcript-ilter"><a href="#transcript-ilter" class="headerlink" title="transcript ilter"></a>transcript ilter</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">fimport os<br>tracking = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts.tracking&#x27;</span>)<br>out_put = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> tracking:<br>    columns = track.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    wildtype = columns[<span class="hljs-number">4</span>:<span class="hljs-number">7</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    treatment = columns[<span class="hljs-number">7</span>:<span class="hljs-number">10</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    <span class="hljs-keyword">if</span> wildtype &lt; <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> treatment &lt; <span class="hljs-number">2</span>:<br>        out_put += track<br><span class="hljs-built_in">print</span> out_put<br></code></pre></td></tr></table></figure><h2 id="lesson7"><a href="#lesson7" class="headerlink" title="lesson7"></a>lesson7</h2><h3 id="turn-table-into-dict"><a href="#turn-table-into-dict" class="headerlink" title="turn table into dict"></a>turn table into dict</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>table = [[<span class="hljs-string">&#x27;protein&#x27;</span>,<span class="hljs-string">&#x27;ext1&#x27;</span>,<span class="hljs-string">&#x27;ext2&#x27;</span>,<span class="hljs-string">&#x27;ext3&#x27;</span>],<br>         [<span class="hljs-number">0.16</span>, <span class="hljs-number">0.038</span>, <span class="hljs-number">0.044</span>, <span class="hljs-number">0.040</span>],<br>         [<span class="hljs-number">0.33</span>, <span class="hljs-number">0.089</span>, <span class="hljs-number">0.095</span>, <span class="hljs-number">0.091</span>],<br>         [<span class="hljs-number">0.66</span>, <span class="hljs-number">0.184</span>, <span class="hljs-number">0.191</span>, <span class="hljs-number">0.191</span>],<br>         [<span class="hljs-number">1.00</span>, <span class="hljs-number">0.280</span>, <span class="hljs-number">0.292</span>, <span class="hljs-number">0.283</span>],<br>         [<span class="hljs-number">1.32</span>, <span class="hljs-number">0.365</span>, <span class="hljs-number">0.367</span>, <span class="hljs-number">0.365</span>],<br>         [<span class="hljs-number">1.66</span>, <span class="hljs-number">0.444</span>, <span class="hljs-number">0.441</span>, <span class="hljs-number">0.444</span>]]<br><span class="hljs-built_in">dict</span> = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    n = n + <span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">0</span>], key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">1</span>], key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">2</span>], key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">3</span>]&#125;<br>    <span class="hljs-built_in">dict</span>[<span class="hljs-string">&#x27;row&#x27;</span> + <span class="hljs-built_in">str</span>(n)] = entry<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">dict</span><br>    <br><br>list_1 = []<br><span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> <span class="hljs-built_in">dict</span>:<br>    key = <span class="hljs-built_in">dict</span>[entry]<br>    list_1.append([key[<span class="hljs-string">&#x27;protein&#x27;</span>], key[<span class="hljs-string">&#x27;ext1&#x27;</span>], key[<span class="hljs-string">&#x27;ext2&#x27;</span>], key[<span class="hljs-string">&#x27;ext3&#x27;</span>]])<br><span class="hljs-built_in">print</span> list_1<br><br>out = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table:<br>    line = [<span class="hljs-built_in">str</span>(cell) <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row]<br>    out = out + <span class="hljs-string">&#x27;\t&#x27;</span>.join(line) + <span class="hljs-string">&#x27;\n&#x27;</span><br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>).write(out)<br></code></pre></td></tr></table></figure><h3 id="7-5-1"><a href="#7-5-1" class="headerlink" title="7.5.1"></a>7.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> table<br><br>ext1 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext1.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">1</span>]))<br><br>ext2 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext2.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">2</span>]))<br><br>ext3 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext3.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">3</span>]))<br><br>ave1 = <span class="hljs-built_in">sum</span>(ext1)/<span class="hljs-built_in">len</span>(ext1)<br>ave2 = <span class="hljs-built_in">sum</span>(ext2)/<span class="hljs-built_in">len</span>(ext2)<br>ave3 = <span class="hljs-built_in">sum</span>(ext3)/<span class="hljs-built_in">len</span>(ext3)<br>ave_all = [<span class="hljs-string">&#x27;average&#x27;</span>, ave1, ave2, ave3]<br><br>table.insert(<span class="hljs-number">7</span>, ave_all)<br><span class="hljs-built_in">print</span> table<br></code></pre></td></tr></table></figure><h3 id="7-5-2"><a href="#7-5-2" class="headerlink" title="7.5.2"></a>7.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-built_in">dict</span> = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    n = n+<span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">0</span>], key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">1</span>], key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">2</span>], key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">3</span>]&#125;<br>    <span class="hljs-built_in">dict</span>[<span class="hljs-string">&#x27;row&#x27;</span>+<span class="hljs-built_in">str</span>(n)] = entry<br><br><span class="hljs-built_in">print</span> <span class="hljs-built_in">dict</span><br></code></pre></td></tr></table></figure><h3 id="7-5-3"><a href="#7-5-3" class="headerlink" title="7.5.3"></a>7.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>RNA_table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;RNA_table.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    RNA_table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> RNA_table<br></code></pre></td></tr></table></figure><h3 id="7-5-4"><a href="#7-5-4" class="headerlink" title="7.5.4"></a>7.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>RNA_table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;RNA_table.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    RNA_table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><br><span class="hljs-built_in">print</span> RNA_table<br><br>RNA_dic = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = RNA_table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> RNA_table[<span class="hljs-number">1</span>:]:<br>    n = n+<span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">1</span>],key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">2</span>],key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">3</span>],key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">4</span>]&#125;<br>    RNA_dic[n] = entry<br><span class="hljs-built_in">print</span> RNA_dic<br>                    <br>seq1 = <span class="hljs-string">&#x27;AGCAUCUA&#x27;</span><br>seq2 = <span class="hljs-string">&#x27;ACCGUUCU&#x27;</span><br><br>seq_dic = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;U&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>&#125;<br><br>score = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> base1, base2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(seq1,seq2):<br>    entry = RNA_dic[<span class="hljs-built_in">float</span>(seq_dic[base1])]<br>    score = score + <span class="hljs-built_in">float</span>(entry[base2])<br><span class="hljs-built_in">print</span> score<br></code></pre></td></tr></table></figure><h3 id="7-5-5"><a href="#7-5-5" class="headerlink" title="7.5.5"></a>7.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>lowry_data = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lowry_data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    lowry_data.append(line.strip().split())<br><span class="hljs-built_in">print</span> lowry_data[<span class="hljs-number">1</span>]<br><br>    <br>lowry_table = lowry_data[<span class="hljs-number">1</span>:]<br>protein, ext1, ext2, ext3 = <span class="hljs-built_in">zip</span>(*lowry_table)<br>new_table = <span class="hljs-built_in">zip</span>(protein)<br><span class="hljs-keyword">for</span> prot <span class="hljs-keyword">in</span> new_table:<br>    <span class="hljs-built_in">print</span> prot<br><br>lowry_dic = &#123;&#125;<br>n = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> lowry_data[<span class="hljs-number">1</span>:]:<br>    key = &#123;<span class="hljs-string">&#x27;ext1&#x27;</span>:row[<span class="hljs-number">1</span>],<span class="hljs-string">&#x27;ext2&#x27;</span>:row[<span class="hljs-number">2</span>],<span class="hljs-string">&#x27;ext3&#x27;</span>:row[<span class="hljs-number">3</span>]&#125;<br>    lowry_dic[row[n]] = key<br><span class="hljs-built_in">print</span> lowry_dic<br>    <br>    <br><span class="hljs-built_in">print</span> lowry_dic[<span class="hljs-string">&#x27;0.16&#x27;</span>]    <br><br><span class="hljs-built_in">print</span> lowry_dic.keys()<br></code></pre></td></tr></table></figure><h2 id="lesson8"><a href="#lesson8" class="headerlink" title="lesson8"></a>lesson8</h2><h3 id="8-5-1"><a href="#8-5-1" class="headerlink" title="8.5.1"></a>8.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lowry_data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new_lowry_data&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br>header = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>        columns = line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>        table.append(columns)<br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    columns = line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    columns[<span class="hljs-number">1</span>] = <span class="hljs-built_in">float</span>(columns[<span class="hljs-number">1</span>])<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">1</span>))<br><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">3</span>:<br>        row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>        output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        i = i+<span class="hljs-number">1</span><br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-2"><a href="#8-5-2" class="headerlink" title="8.5.2"></a>8.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_by_length_Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br>length = <span class="hljs-number">0</span><br>header = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        length = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line.strip()<br>        length += <span class="hljs-built_in">len</span>(line)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        row = [header, seq, length]<br>        table.append(row)<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> header != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    row = [header, seq, length]<br>    table.append(row)<br><br><br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table:<br>    row[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(row[<span class="hljs-number">2</span>])<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">2</span>))<br><br>output_file.write(<span class="hljs-string">&#x27;Gene ID&#x27;</span> +<span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;sequence&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;seq length&#x27;</span> + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>output_file.close()<br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-3"><a href="#8-5-3" class="headerlink" title="8.5.3"></a>8.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;excel_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_excel_file.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    row = line.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    table.append(row)<br><span class="hljs-built_in">print</span> table<br><br>table_new = []<br><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    col[<span class="hljs-number">3</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">3</span>])<br>    col[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">2</span>])<br>    col[<span class="hljs-number">1</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">1</span>])<br>    col[<span class="hljs-number">0</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">0</span>])<br>    table_new.append(col)<br>table_new_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>))<br><br><span class="hljs-built_in">print</span> table_new_sorted<br><br>output_file.write(<span class="hljs-string">&#x27;protein&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;ext1&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;ext2&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> +<span class="hljs-string">&#x27;ext3&#x27;</span> + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_new_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-4"><a href="#8-5-4" class="headerlink" title="8.5.4"></a>8.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>dic = &#123;&#125;<br>header = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line.strip()<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        dic[header] = seq<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    dic[header] = seq<br><br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(dic):<br>    <span class="hljs-built_in">print</span> key, dic[key]<br><br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-5"><a href="#8-5-5" class="headerlink" title="8.5.5"></a>8.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;BlastOut.csv&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_blastout.csv&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    col = line.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    col[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">2</span>])<br>    table.append(col)<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">2</span>),reverse = <span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="sort-table"><a href="#sort-table" class="headerlink" title="sort table"></a>sort table</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;random_distribution.tsv&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    columns = line.split()<br>    columns = [<span class="hljs-built_in">float</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> columns]<br>    table.append(columns)<br><br>column = <span class="hljs-number">1</span><br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(column))<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\t&#x27;</span>.join(row)<br></code></pre></td></tr></table></figure><h2 id="lesson9"><a href="#lesson9" class="headerlink" title="lesson9"></a>lesson9</h2><h3 id="9-5-1"><a href="#9-5-1" class="headerlink" title="9.5.1"></a>9.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>pro_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    pro_seq += line<br><span class="hljs-keyword">for</span> base <span class="hljs-keyword">in</span> pro_seq:<br>    motif = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;C(.&#123;1,4&#125;)C&#x27;</span>)<br>    all_matches = motif.findall(pro_seq)<br>    matches = motif.finditer(pro_seq)<br><span class="hljs-keyword">if</span> all_matches:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;motif matched:&#x27;</span><br>    <span class="hljs-keyword">for</span> motif <span class="hljs-keyword">in</span> matches:<br>        <span class="hljs-built_in">print</span> motif.group()<br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="9-5-2"><a href="#9-5-2" class="headerlink" title="9.5.2"></a>9.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;multiple abstracts.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>text = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    text += line<br>word1 = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;[Ii][Nn]&#x27;</span>)<br>word2 = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;[In][Ss]&#x27;</span>)<br><br><br>word1_matches = word1.findall(text)<br>word2_matches = word2.findall(text)<br><br>number1 = <span class="hljs-number">0</span><br>number2 = <span class="hljs-number">0</span><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;in:&#x27;</span>,<span class="hljs-built_in">len</span>(word1_matches)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;is&#x27;</span>,<span class="hljs-built_in">len</span>(word2_matches)<br><br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="9-5-3"><a href="#9-5-3" class="headerlink" title="9.5.3"></a>9.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>header = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br>Homo_kinase_seq = <span class="hljs-string">&#x27;&#x27;</span><br>motif = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;R.[ST][^P]&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;kinase&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq = line<br>        Homo_kinase_seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>        Homo_kinase_seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;kinase&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><br>motif_match = motif.findall(Homo_kinase_seq)<br><span class="hljs-built_in">print</span> motif_match<br></code></pre></td></tr></table></figure><h3 id="9-5-4"><a href="#9-5-4" class="headerlink" title="9.5.4"></a>9.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br><br>url = <span class="hljs-string">&#x27;https://pubmed.ncbi.nlm.nih.gov/18235848/&#x27;</span><br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><br><br>author_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;data-ga-label=&quot;(.&#123;10,40&#125;)&lt;&#x27;</span>)<br>author_text = author_regexp.finditer(html)<br><br><br><span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> author_text:<br>    <span class="hljs-built_in">print</span> name.group(<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span> name.start()<br>    <span class="hljs-built_in">print</span> name.end()<br></code></pre></td></tr></table></figure><h3 id="find-TFBS-matches-in-genome"><a href="#find-TFBS-matches-in-genome" class="headerlink" title="find TFBS matches in genome"></a>find TFBS matches in genome</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br>genome_seq = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;genome.txt&#x27;</span>).read()<br>sites = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;TFBS.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    fields = line.split()<br>    site = fields[<span class="hljs-number">1</span>]<br>    tf = fields[<span class="hljs-number">0</span>]<br>    sites.append((tf,site))<br><br><span class="hljs-keyword">for</span> tf,site <span class="hljs-keyword">in</span> sites:<br>    tfsite = re.<span class="hljs-built_in">compile</span>(site)<br>    all_matches = tfsite.findall(genome_seq)<br>    matches = tfsite.finditer(genome_seq)<br>    <span class="hljs-keyword">if</span> all_matches:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;tf&#x27;</span>,<span class="hljs-string">&#x27;:&#x27;</span><br>        <span class="hljs-keyword">for</span> tfbs <span class="hljs-keyword">in</span> matches:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\t&#x27;</span>,tfbs.group(),tfbs.start(),tfbs.end()<br></code></pre></td></tr></table></figure><h3 id="read-html"><a href="#read-html" class="headerlink" title="read html"></a>read html</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br>pmid = <span class="hljs-string">&#x27;18235848&#x27;</span><br>url = <span class="hljs-string">&#x27;http://www.ncbi.nlm.nih.gov/pubmed?term=%s&#x27;</span> % pmid<br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><span class="hljs-built_in">print</span> html<br>title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>title_text = title_regexp.search(html)<br>abstract_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&quot;S.&#123;20,3000&#125;\.&quot;&#x27;</span>)<br>abstract_text = abstract_regexp.search(html)<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;ABSTRACT:&#x27;</span>, abstract_text.group()<br></code></pre></td></tr></table></figure><h3 id="read-multiple-html"><a href="#read-multiple-html" class="headerlink" title="read multiple html"></a>read multiple html</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br>pmid = [<span class="hljs-string">&#x27;18235848&#x27;</span>,<span class="hljs-string">&#x27;22607149&#x27;</span>,<span class="hljs-string">&#x27;2405002&#x27;</span>,<span class="hljs-string">&#x27;21630672&#x27;</span>]<br><span class="hljs-keyword">for</span> pmid <span class="hljs-keyword">in</span> pmid:<br>    url = <span class="hljs-string">&#x27;http://www.ncbi.nlm.nih.gov/pubmed?term=%s&#x27;</span> % pmid<br>    <span class="hljs-keyword">import</span> ssl<br>    ssl._create_default_https_context = ssl._create_unverified_context<br>    handler = urllib2.urlopen(url)<br>    html = handler.read()<br>    title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>    title_text = title_regexp.search(html)<br>    abstract_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&quot;S.&#123;20,3000&#125;\.&quot;&#x27;</span>)<br>    abstract_text = abstract_regexp.search(html)<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;ABSTRACT:&#x27;</span>, abstract_text.group()<br></code></pre></td></tr></table></figure><h3 id="read-title-from-AO3-html"><a href="#read-title-from-AO3-html" class="headerlink" title="read title from AO3 html"></a>read title from AO3 html</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br><br>url = <span class="hljs-string">&#x27;https://archiveofourown.org/works/7289389&#x27;</span><br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><span class="hljs-built_in">print</span> html<br>title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>title_text = title_regexp.search(html)<br><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br></code></pre></td></tr></table></figure><h2 id="lesson10"><a href="#lesson10" class="headerlink" title="lesson10"></a>lesson10</h2><h3 id="10-5-1"><a href="#10-5-1" class="headerlink" title="10.5.1"></a>10.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> struct<br><br>seq = []<br>header = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">turn_pdb_to_fasta</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read a pdb file and turn to fasta file&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">global</span> header,seq<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(pdb_file):<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;DBREF&#x27;</span>):<br>            header = line.split()[<span class="hljs-number">6</span>]<br>        <span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;SEQRES&#x27;</span>):<br>            seq.append(line.split()[<span class="hljs-number">4</span>:])<br>    <span class="hljs-keyword">return</span> header, seq<br><br><br>header, seq = turn_pdb_to_fasta(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>)<br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;&gt;&#x27;</span> + header + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>proseq = <span class="hljs-string">&#x27;&#x27;</span><br>aa_codes = &#123;<br>     <span class="hljs-string">&#x27;ALA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CYS&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;ASP&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GLU&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br>     <span class="hljs-string">&#x27;PHE&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;GLY&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;HIS&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;LYS&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>     <span class="hljs-string">&#x27;ILE&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;LEU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;MET&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;ASN&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>     <span class="hljs-string">&#x27;PRO&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;GLN&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;ARG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;SER&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>     <span class="hljs-string">&#x27;THR&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;VAL&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;TYR&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;TRP&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> seq:<br>    <span class="hljs-keyword">for</span> aa <span class="hljs-keyword">in</span> row:<br>        aa_name = aa_codes[aa]<br>        proseq += aa_name<br><span class="hljs-built_in">print</span> proseq<br></code></pre></td></tr></table></figure><h3 id="10-5-2"><a href="#10-5-2" class="headerlink" title="10.5.2"></a>10.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> save_multiple_fasta_from_fasta <span class="hljs-keyword">import</span> save_ac_and_seq_from_fasta<br>AC = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>) <span class="hljs-keyword">and</span> AC == <span class="hljs-string">&#x27;&#x27;</span>:<br>        AC = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> AC != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>    <span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>) <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        save_ac_and_seq_from_fasta(AC, seq)<br>        AC = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">if</span> AC != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    save_ac_and_seq_from_fasta(AC, seq)<br></code></pre></td></tr></table></figure><h3 id="10-5-3"><a href="#10-5-3" class="headerlink" title="10.5.3"></a>10.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> calculate_atom_distance <span class="hljs-keyword">import</span> calculate_distance<br><span class="hljs-keyword">from</span> get_main_residues_from_1TLD_pdb <span class="hljs-keyword">import</span> parse_atom_line<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_3_result.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_ca_atoms</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;get all ca atom data from pdb&#x27;&#x27;&#x27;</span><br>    pdb = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>    ca_list = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> pdb:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;ATOM&#x27;</span>):<br>            data = parse_atom_line(line)<br>            chain, res_type, res_num, atom, x, y, z = data<br>            <span class="hljs-keyword">if</span> atom == <span class="hljs-string">&#x27;CA&#x27;</span> <span class="hljs-keyword">and</span> chain == <span class="hljs-string">&#x27;A&#x27;</span>:<br>                ca_list.append(data)<br>    pdb.close()<br>    <span class="hljs-keyword">return</span> ca_list<br><br>ca_atoms = get_ca_atoms(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>)<br><span class="hljs-keyword">for</span> i, atom1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ca_atoms):<br>    name1 = atom1[<span class="hljs-number">1</span>] + atom1[<span class="hljs-number">2</span>]<br>    coord1 = atom1[<span class="hljs-number">4</span>:]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(ca_atoms)):<br>        atom2 = ca_atoms[j]<br>        name2 = atom2[<span class="hljs-number">1</span>] + atom2[<span class="hljs-number">2</span>]<br>        coord2 = atom2[<span class="hljs-number">4</span>:]<br>        dist = calculate_distance(coord1, coord2)<br>        output_file.write(name1 + <span class="hljs-string">&#x27;\t&#x27;</span> + name2 + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-built_in">str</span>(dist) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output_file.close()<br>            <br><span class="hljs-built_in">input</span> = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_3_result.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>all_distance = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>:<br>    distance = <span class="hljs-built_in">float</span>(line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)[<span class="hljs-number">2</span>])<br>    all_distance.append(distance)<br><br><span class="hljs-built_in">min</span>(all_distance)<br></code></pre></td></tr></table></figure><h3 id="10-5-4"><a href="#10-5-4" class="headerlink" title="10.5.4"></a>10.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> calculate_atom_distance <span class="hljs-keyword">import</span> calculate_distance<br><span class="hljs-keyword">from</span> get_main_residues_from_1TLD_pdb <span class="hljs-keyword">import</span> parse_atom_line<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_4_result.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_ca_atoms</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;get all ca atom data from pdb&#x27;&#x27;&#x27;</span><br>    pdb = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;3G5U.pdb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>    list_A = []<br>    list_B = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> pdb:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;ATOM&#x27;</span>):<br>            data = parse_atom_line(line)<br>            chain, res_type, res_num, atom, x, y, z = data<br>            <span class="hljs-keyword">if</span> chain == <span class="hljs-string">&#x27;A&#x27;</span>:<br>                list_A.append(data)<br>            <span class="hljs-keyword">elif</span> chain == <span class="hljs-string">&#x27;B&#x27;</span>:<br>                list_B.append(data)<br>                <br>    pdb.close()<br>    <span class="hljs-keyword">return</span> list_A, list_B<br><br>A_atoms, B_atoms = get_ca_atoms(<span class="hljs-string">&#x27;3G5U.pdb&#x27;</span>)<br><span class="hljs-keyword">for</span> i, atom1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(A_atoms):<br>    name1 = atom1[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;\t&#x27;</span> + atom1[<span class="hljs-number">1</span>] + atom1[<span class="hljs-number">2</span>]<br>    coord1 = atom1[<span class="hljs-number">4</span>:]<br>    <span class="hljs-keyword">for</span> j, atom2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(B_atoms):<br>        atom2 = B_atoms[j]<br>        name2 = atom1[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;\t&#x27;</span> + atom2[<span class="hljs-number">1</span>] + atom2[<span class="hljs-number">2</span>]<br>        coord2 = atom2[<span class="hljs-number">4</span>:]<br>        dist = calculate_distance(coord1, coord2)<br>        <span class="hljs-keyword">if</span> dist &lt; <span class="hljs-number">6</span>:<br>            output_file.write(name1 + <span class="hljs-string">&#x27;\t&#x27;</span> + name2 + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-built_in">str</span>(dist) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="10-5-5"><a href="#10-5-5" class="headerlink" title="10.5.5"></a>10.5.5</h3><p>protein_accessibility_prediction.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">accessibility</span>(<span class="hljs-params">input_seq</span>):</span><br>    output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>    pref_E = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br>    pref_H = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;0.97&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;1.30&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.80&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;0.26&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.28&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.81&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;0.71&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.60&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;0.74&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.22&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.67&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.62&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.63&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.90&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.72&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.19&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;1.29&#x27;</span>&#125;<br>    <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>        <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> pref_H <span class="hljs-keyword">and</span> res <span class="hljs-keyword">in</span> pref_E:<br>            <span class="hljs-keyword">if</span> pref_H[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_E[res] &lt; pref_H[res]:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;H&#x27;</span><br>            <span class="hljs-keyword">elif</span> pref_E[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_H[res] &lt; pref_E[res]:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;E&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;L&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br>    <span class="hljs-keyword">return</span> output_seq<br></code></pre></td></tr></table></figure><p>protein_disorder_predict.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">protein_disorder_predict</span>(<span class="hljs-params">input_seq</span>):</span><br>    propensities = &#123;<span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-number">0.2299</span>, <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-number">0.5523</span>, <span class="hljs-string">&#x27;Q&#x27;</span>:-<span class="hljs-number">0.18770</span>, <span class="hljs-string">&#x27;A&#x27;</span>:-<span class="hljs-number">0.2615</span>,<br>    <span class="hljs-string">&#x27;R&#x27;</span>:-<span class="hljs-number">0.1766</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0.1429</span>, <span class="hljs-string">&#x27;C&#x27;</span>:-<span class="hljs-number">0.01515</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-number">0.0089</span>,<br>    <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">0.2276</span>, <span class="hljs-string">&#x27;E&#x27;</span>:-<span class="hljs-number">0.2047</span>, <span class="hljs-string">&#x27;V&#x27;</span>:-<span class="hljs-number">0.38620</span>, <span class="hljs-string">&#x27;F&#x27;</span>:-<span class="hljs-number">0.2256</span>,<br>    <span class="hljs-string">&#x27;W&#x27;</span>:-<span class="hljs-number">0.2434</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-number">0.4332</span>, <span class="hljs-string">&#x27;H&#x27;</span>:-<span class="hljs-number">0.00120</span>, <span class="hljs-string">&#x27;Y&#x27;</span>:-<span class="hljs-number">0.2075</span>,<br>    <span class="hljs-string">&#x27;I&#x27;</span>:-<span class="hljs-number">0.4222</span>, <span class="hljs-string">&#x27;K&#x27;</span>:-<span class="hljs-number">0.1001</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">0.33793</span>, <span class="hljs-string">&#x27;M&#x27;</span>:-<span class="hljs-number">0.2259</span>&#125;<br>    output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>    threshod = <span class="hljs-number">0.3</span><br>    <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>        <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> propensities:<br>            <span class="hljs-keyword">if</span> propensities[res] &gt;= threshod:<br>                output_seq = output_seq + res.upper()<br>            <span class="hljs-keyword">else</span>:<br>                output_seq = output_seq + res.lower()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized charachter:&#x27;</span> , res<br>    <span class="hljs-keyword">return</span> output_seq<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> protein_disorder_predict <span class="hljs-keyword">import</span> protein_disorder_predict<br><span class="hljs-keyword">from</span> protein_accessibility_predict <span class="hljs-keyword">import</span> accessibility<br><br>input_seq = <span class="hljs-string">&#x27;MTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLLSVAYKNVVGARRSS\</span><br><span class="hljs-string">WRVISSIEQKTERNEKKQQMGKEYREKIEAELQDICNDVLELLDKYLIPNATQPESKVFY\</span><br><span class="hljs-string">LKMKGDYFRYLSEVASGDNKQTTVSNSQQAYQEAFEISKKEMQPTHPIRLGLALNFSVFY\</span><br><span class="hljs-string">YEILNSPEKACSLAKTAFDEAIAELDTLNEESYKDSTLIMQLLRDNLTLWTSENQGDEGD\</span><br><span class="hljs-string">AGEGEN&#x27;</span><br><br>predictor = <span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-keyword">if</span> predictor == <span class="hljs-string">&#x27;1&#x27;</span>:<br>    prediction = protein_disorder_predict(input_seq)<br>    <span class="hljs-built_in">print</span> prediction<br><span class="hljs-keyword">elif</span> predictor == <span class="hljs-string">&#x27;2&#x27;</span>:<br>    prediction = accessibility(input_seq)<br>    <span class="hljs-built_in">print</span> prediction<br></code></pre></td></tr></table></figure><h2 id="lesson11"><a href="#lesson11" class="headerlink" title="lesson11"></a>lesson11</h2><h3 id="11-5-1-11-5-2"><a href="#11-5-1-11-5-2" class="headerlink" title="11.5.1+11.5.2"></a>11.5.1+11.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + self.get_PDB_code() + self.get_angle1() + self.get_angle2()<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure><h3 id="11-5-3"><a href="#11-5-3" class="headerlink" title="11.5.3"></a>11.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + <span class="hljs-string">&#x27;\t&#x27;</span> +\<br>               self.get_PDB_code() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle1() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle2()<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure><h3 id="11-5-4-module"><a href="#11-5-4-module" class="headerlink" title="11.5.4_module"></a>11.5.4_module</h3><p>TRANSMEMBRANE_HELICES</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + <span class="hljs-string">&#x27;\t&#x27;</span> +\<br>               self.get_PDB_code() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle1() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle2()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> TRANSMEMBRANE_HELICES <span class="hljs-keyword">import</span> transmembrane_helices<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure><h3 id="11-5-5"><a href="#11-5-5" class="headerlink" title="11.5.5"></a>11.5.5</h3><p>neurons</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">neuron_data = []<br><span class="hljs-keyword">import</span> math<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DentriticLengths</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, filename</span>):</span><br>        self.filename = filename<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_data</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        <span class="hljs-keyword">return</span> neuron_data<br>        <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_average</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        average = <span class="hljs-built_in">sum</span>(neuron_data)/<span class="hljs-built_in">len</span>(neuron_data)<br>        <span class="hljs-keyword">return</span> average<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_sttddev</span>(<span class="hljs-params">self</span>):</span><br>        square = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        average = <span class="hljs-built_in">sum</span>(neuron_data)/<span class="hljs-built_in">len</span>(neuron_data)<br>        <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_data:<br>            n = length - average<br>            square += n**<span class="hljs-number">2</span><br>        sttddev = math.sqrt(square / <span class="hljs-built_in">len</span>(neuron_data))<br>        <span class="hljs-keyword">return</span> sttddev<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(neuron_data), <span class="hljs-built_in">str</span>(self.get_average()), <span class="hljs-built_in">str</span>(self.get_sttddev())<br><br><br>n = DentriticLengths(<span class="hljs-string">&quot;neuron_data.txt&quot;</span>)<br><span class="hljs-built_in">print</span> n.get_data()<br><span class="hljs-built_in">print</span> n.get_average()<br><span class="hljs-built_in">print</span> n.get_sttddev()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> neurons <span class="hljs-keyword">import</span> DentriticLengths<br><br>n = Dentriticlengths(<span class="hljs-string">&quot;neuron_data.txt&quot;</span>)<br><span class="hljs-built_in">print</span> n<br></code></pre></td></tr></table></figure><h2 id="lesson12"><a href="#lesson12" class="headerlink" title="lesson12"></a>lesson12</h2><h3 id="12-5-1"><a href="#12-5-1" class="headerlink" title="12.5.1"></a>12.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = bigger + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondary = [], []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span>:<br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br>primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.txt&#x27;</span>)<br>count_pri = evaluate_data(primary)<br>count_sec = evaluate_data(secondary)<br>write_output(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br></code></pre></td></tr></table></figure><h3 id="12-5-2"><a href="#12-5-2" class="headerlink" title="12.5.2"></a>12.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = bigger + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondary = [], []<br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span>:<br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br><span class="hljs-keyword">try</span>:<br>    primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.xls&#x27;</span>)<br>    count_pri = evaluate_data(primary)<br>    count_sec = evaluate_data(secondary)<br>    write_output(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br><span class="hljs-keyword">except</span> IOError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;You have input a wrong file name&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure><h3 id="12-5-3"><a href="#12-5-3" class="headerlink" title="12.5.3"></a>12.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_input_file</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read input file and turn it to data&#x27;&#x27;&#x27;</span><br>    neuron_length = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        length = <span class="hljs-built_in">float</span>(line.split()[<span class="hljs-number">1</span>])<br>        neuron_length.append(length)<br>    <span class="hljs-keyword">return</span> neuron_length<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br><span class="hljs-keyword">try</span>:<br>    filename = <span class="hljs-string">&quot;12_5_3_test.txt&quot;</span><br>    neuron_length = read_input_file(filename)<br>    <span class="hljs-built_in">print</span> calculate_average(neuron_length)<br>    <span class="hljs-built_in">print</span> calculate_stdev(neuron_length)<br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;could not convert string to float: -&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure><h3 id="12-5-4"><a href="#12-5-4" class="headerlink" title="12.5.4"></a>12.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_input_file</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read input file and turn it to data&#x27;&#x27;&#x27;</span><br>    neuron_length = []<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>            <span class="hljs-keyword">try</span>:<br>                length = <span class="hljs-built_in">float</span>(line.split()[<span class="hljs-number">1</span>])<br>                neuron_length.append(length)<br>            <span class="hljs-keyword">except</span> ValueError:<br>                <span class="hljs-built_in">print</span> <span class="hljs-string">&quot; - can not be transformed into float&quot;</span><br>                <span class="hljs-keyword">raise</span> SystemExit       <br>        <span class="hljs-keyword">return</span> neuron_length<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;could not convert string to float: -&quot;</span><br>        <span class="hljs-keyword">raise</span> SystemExit<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br><br>filename = <span class="hljs-string">&quot;12_5_3_test.txt&quot;</span><br>neuron_length = read_input_file(filename)<br><span class="hljs-built_in">print</span> calculate_average(neuron_length)<br><span class="hljs-built_in">print</span> calculate_stdev(neuron_length)<br></code></pre></td></tr></table></figure><h3 id="12-5-5"><a href="#12-5-5" class="headerlink" title="12.5.5"></a>12.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br>        <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">float_neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(float_neuron_length)/<span class="hljs-built_in">len</span>(float_neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">float_neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(float_neuron_length)/<span class="hljs-built_in">len</span>(float_neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> float_neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(float_neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br>raw_neuron_length = []<br>float_neuron_length = []<br>number = <span class="hljs-literal">None</span><br><span class="hljs-keyword">while</span> number != <span class="hljs-string">&#x27;q&#x27;</span>:<br>    number = raw_input(<span class="hljs-string">&quot;Insert a number: &quot;</span>)<br>    raw_neuron_length.append(number)<br><span class="hljs-built_in">print</span> raw_neuron_length<br><span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> raw_neuron_length:<br>    <span class="hljs-keyword">if</span> length != <span class="hljs-string">&#x27;q&#x27;</span>:<br>        float_neuron_length.append(<span class="hljs-built_in">float</span>(length))<br><span class="hljs-built_in">print</span> float_neuron_length<br>   <br><span class="hljs-built_in">print</span> calculate_average(float_neuron_length)<br><span class="hljs-built_in">print</span> calculate_stdev(float_neuron_length)<br></code></pre></td></tr></table></figure><h3 id="handling-exceptions"><a href="#handling-exceptions" class="headerlink" title="handling exceptions"></a>handling exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Catching errors with try.. except</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.3.3 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">try</span>:<br>    a = <span class="hljs-built_in">float</span>(raw_input(<span class="hljs-string">&quot;Insert a number:&quot;</span>))<br>    <span class="hljs-built_in">print</span> a<br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;You haven&#x27;t inserted a number. Please retry.&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure><h3 id="handling-exceptions-else"><a href="#handling-exceptions-else" class="headerlink" title="handling exceptions else"></a>handling exceptions else</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Catching errors with try.. except.. else</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.3.3 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">try</span>:<br>    filename = raw_input(<span class="hljs-string">&quot;Insert a filename:&quot;</span>)<br>    in_file = <span class="hljs-built_in">open</span>(filename)<br><span class="hljs-keyword">except</span> IOError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;The filename %s has not been found.&quot;</span> % filename<br>    <span class="hljs-keyword">raise</span> SystemExit<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> in_file:<br>        <span class="hljs-built_in">print</span> line<br>        in_file.close()<br></code></pre></td></tr></table></figure><h3 id="programs-with-bugs"><a href="#programs-with-bugs" class="headerlink" title="programs with bugs"></a>programs with bugs</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">A program with bugs. Try to fix them all!</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.2.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondry = [], []<br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span><br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br>primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.xls&#x27;</span>)<br>count_pri = evaluate_data(primary)<br>count_sec = evaluate_data(secondary)<br>write_output_file(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br></code></pre></td></tr></table></figure><h2 id="lesson13"><a href="#lesson13" class="headerlink" title="lesson13"></a>lesson13</h2><h3 id="13-5-1"><a href="#13-5-1" class="headerlink" title="13.5.1"></a>13.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rpy2.robjects <span class="hljs-keyword">as</span> robjects<br>r = robjects.r<br>table = r(<span class="hljs-string">&quot;read.table(&#x27;data_for_practice_1.txt&#x27;, sep = &#x27;\t&#x27;)&quot;</span>)<br>m = r.mean(table[<span class="hljs-number">1</span>], trim = <span class="hljs-number">0</span>, na_rm = <span class="hljs-string">&#x27;FALSE&#x27;</span>)<br>sdev = r.sd(table[<span class="hljs-number">1</span>])<br>value = <span class="hljs-number">0.01844</span><br>zscore = (m[<span class="hljs-number">0</span>] - value)/sdev[<span class="hljs-number">0</span>]<br>x = r.<span class="hljs-built_in">abs</span>(zscore)<br>pvalue = r.pnorm(-x[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span> m[<span class="hljs-number">0</span>], sdev[<span class="hljs-number">0</span>], zscore, pvalue[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><h3 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-built_in">print</span> sys.argv<br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=" "></a> </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rpy2.robjects <span class="hljs-keyword">as</span> robjects<br>r = robjects.r<br>table = r(<span class="hljs-string">&quot;read.table(&#x27;Chi-square_input.txt&#x27;,header = TRUE, sep = &#x27;\t&#x27;)&quot;</span>)<br>cont_table = r.table(table[<span class="hljs-number">1</span>],table[<span class="hljs-number">2</span>])<br>chitest = r(<span class="hljs-string">&#x27;chisq.test&#x27;</span>)<br><span class="hljs-built_in">print</span> chitest(table[<span class="hljs-number">1</span>],table[<span class="hljs-number">2</span>])<br></code></pre></td></tr></table></figure><h3 id="os-listdir-test"><a href="#os-listdir-test" class="headerlink" title="os_listdir_test"></a>os_listdir_test</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(<span class="hljs-string">&#x27;/Users/keqinliu/studying document/bioinfo/python/practice/chapter13-practice&#x27;</span>):<br>    os.system(<span class="hljs-string">&#x27;&lt;my_program&gt;%s&#x27;</span>%(filename))<br></code></pre></td></tr></table></figure><h2 id="lesson14"><a href="#lesson14" class="headerlink" title="lesson14"></a>lesson14</h2><h3 id="14-5-4"><a href="#14-5-4" class="headerlink" title="14.5.4"></a>14.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>dir_list = os.listdir(<span class="hljs-string">&#x27;/Users/keqinliu/studying_document/bioinfo/python_practice/chapter14-practice/&#x27;</span>)<br><span class="hljs-built_in">print</span> dir_list<br>dir_count = <span class="hljs-built_in">len</span>(dir_list)<br><span class="hljs-built_in">print</span> dir_count<br></code></pre></td></tr></table></figure><h3 id="avoid-file-closing-lag"><a href="#avoid-file-closing-lag" class="headerlink" title="avoid_file_closing_lag"></a>avoid_file_closing_lag</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Avoid the lag when applications share files.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 14.3.5 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br>sys.path.append(<span class="hljs-string">&#x27;/home/RNA-seq/&#x27;</span>)<br><span class="hljs-keyword">from</span> pathvariables <span class="hljs-keyword">import</span> tophat_dir, index_dir, cufflinks_dir<br><br><span class="hljs-comment"># the tophat program creates a file </span><br>os.system(<span class="hljs-string">&#x27;tophat -o &#x27;</span> + tophat_dir + <span class="hljs-string">&#x27; &#x27;</span> + index_dir + <span class="hljs-string">&#x27;sample.fastq&#x27;</span>)<br><br><span class="hljs-comment"># here we don&#x27;t know whether the tophat output file is already finished</span><br><span class="hljs-comment"># we open and close a dummy file, so the operating system catches up</span><br>lag_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dummy.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>lag_file.write(<span class="hljs-string">&#x27;tophat completed&#x27;</span>)<br>lag_file.close()<br><br><span class="hljs-comment"># read the output file</span><br><span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">&#x27;/home/RNA-seq/dummy.txt&#x27;</span>):<br>    os.system(<span class="hljs-string">&#x27;cufflinks -o &#x27;</span> + cufflinks_dir + <span class="hljs-string">&#x27; &#x27;</span><br>              + tophat_dir + <span class="hljs-string">&#x27;/accepted_hits.bam&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="bl2seq-wrapper"><a href="#bl2seq-wrapper" class="headerlink" title="bl2seq_wrapper"></a>bl2seq_wrapper</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Python wrapper for the bl2seq program.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 15.4.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> urllib2<br><br>sys.path.append(<span class="hljs-string">&#x27;pathmodules/&#x27;</span>)<br><span class="hljs-keyword">from</span> blastvariables <span class="hljs-keyword">import</span> *<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_bl2seq</span>(<span class="hljs-params">seq1, seq2</span>):</span><br>    os.system(<span class="hljs-string">&quot;bl2seq -p blastp -i &quot;</span> + input_seq + seq1 + <span class="hljs-string">&quot;.fasta -j &quot;</span><br>              + input_seq + seq2 + <span class="hljs-string">&quot;.fasta -o &quot;</span> + blast_out + seq1<br>              + <span class="hljs-string">&quot;-&quot;</span> + seq2 + <span class="hljs-string">&quot;.aln&quot;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_seq</span>(<span class="hljs-params">seq1, seq2</span>):</span><br>    <span class="hljs-keyword">for</span> seq <span class="hljs-keyword">in</span> (seq1, seq2):<br>        url = <span class="hljs-string">&#x27;http://www.uniprot.org/uniprot/&#x27;</span> + seq + <span class="hljs-string">&#x27;.fasta&#x27;</span><br>        handler = urllib2.urlopen(url)<br>        fasta = handler.read()<br>        out = <span class="hljs-built_in">open</span>(input_seq + seq + <span class="hljs-string">&#x27;.fasta&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>        out.write(fasta)<br>        out.close()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">try</span>:<br>        seq1 = sys.argv[<span class="hljs-number">1</span>]<br>        seq2 = sys.argv[<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;usage: Bl2seqWrapper.py seq1-UniprotAC seq2-UniprotAC&#x27;</span><br>        <span class="hljs-keyword">raise</span> SystemExit<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> os.path.exists(input_seq + seq1 + <span class="hljs-string">&#x27;.fasta&#x27;</span>) <span class="hljs-keyword">and</span> os.path.exists(input_seq + seq2 + <span class="hljs-string">&#x27;.fasta&#x27;</span>):<br>            run_bl2seq(seq1, seq2)<br>        <span class="hljs-keyword">else</span>:<br>            get_seq(seq1, seq2)<br>            run_bl2seq(seq1, seq2)<br></code></pre></td></tr></table></figure><h3 id="cuffcompare-pipeline"><a href="#cuffcompare-pipeline" class="headerlink" title="cuffcompare_pipeline"></a>cuffcompare_pipeline</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Run two external programs from one Python script.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 14.2.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> os<br><br>tophat_output_dir = <span class="hljs-string">&#x27;/home/RNA-seq/tophat&#x27;</span><br>tophat_output_file = <span class="hljs-string">&#x27;accepted_hits.bam&#x27;</span><br>bowtie_index_dir = <span class="hljs-string">&#x27;/home/RNA-seq/index&#x27;</span><br>cufflinks_output_dir = <span class="hljs-string">&#x27;/home/RNA-seq/cufflinks&#x27;</span><br>cufflinks_output_file = <span class="hljs-string">&#x27;transcripts.gtf&#x27;</span><br>illumina_output_file = <span class="hljs-string">&#x27;sample.fastq&#x27;</span><br><br>tophat_command = <span class="hljs-string">&#x27;tophat -o %s %s %s&#x27;</span> % (tophat_output_dir, bowtie_index_dir, illumina_output_file)<br>os.system(tophat_command)<br><br>cufflinks_command = <span class="hljs-string">&#x27;cufflinks -o %s %s%s%s&#x27;</span> % (cufflinks_output_dir, tophat_output_dir, os.sep, tophat_output_file)<br>os.system(cufflinks_command)<br></code></pre></td></tr></table></figure><h2 id="lesson16"><a href="#lesson16" class="headerlink" title="lesson16"></a>lesson16</h2><h3 id="16-2"><a href="#16-2" class="headerlink" title="16.2"></a>16.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> pie, title, figure, savefig<br>nucleotides = <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;U&#x27;</span><br>count = [<span class="hljs-number">1024</span>, <span class="hljs-number">759</span>, <span class="hljs-number">606</span>, <span class="hljs-number">398</span>]<br>explode = [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.05</span>, <span class="hljs-number">0.05</span>]<br><br>colors = [<span class="hljs-string">&#x27;#f0f0f0&#x27;</span>, <span class="hljs-string">&#x27;#dddddd&#x27;</span>, <span class="hljs-string">&#x27;#bbbbbb&#x27;</span>, <span class="hljs-string">&#x27;#999999&#x27;</span>]<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_percent</span>(<span class="hljs-params">value</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;FORMATS FLOAT VALUES IN PIE SLICES TO PERCENT&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;%4.1f%%&quot;</span> % (value)<br><br>figure(<span class="hljs-number">1</span>)<br>title(<span class="hljs-string">&#x27;Nucleotides in 23s RNA from T.thermophilus&#x27;</span>)<br>pie(count, explode=explode, labels=nucleotides, shadow=<span class="hljs-literal">None</span>, colors=colors, autopct=get_percent)<br>savefig(<span class="hljs-string">&#x27;figure3&#x27;</span>, dpi=<span class="hljs-number">300</span>)<br></code></pre></td></tr></table></figure><h3 id="16-3-1"><a href="#16-3-1" class="headerlink" title="16.3.1"></a>16.3.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, plot, savefig<br>xdata = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>ydata = [<span class="hljs-number">1.25</span>, <span class="hljs-number">2.33</span>, <span class="hljs-number">4.3</span>, <span class="hljs-number">9.00</span>]<br>figure()<br>plot(xdata, ydata)<br>savefig(<span class="hljs-string">&#x27;figure1.png&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="16-4-1"><a href="#16-4-1" class="headerlink" title="16.4.1"></a>16.4.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, plot, text, axis, savefig, title<br><span class="hljs-keyword">import</span> math<br><br>figure()<br>xdata = [<span class="hljs-number">0.1</span> * i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)]<br>ydata = [math.sin(y) <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> xdata]<br><br>plot(xdata, ydata, <span class="hljs-string">&#x27;kd&#x27;</span>, linewidth = <span class="hljs-number">1</span>)<br>axis([<span class="hljs-number">0</span>, <span class="hljs-number">3</span> * math.pi, -<span class="hljs-number">1.2</span>, <span class="hljs-number">1.2</span>])<br>title(<span class="hljs-string">&#x27;y=sin(x)&#x27;</span>)<br>savefig(<span class="hljs-string">&#x27;figure2.png&#x27;</span>, dpi = <span class="hljs-number">300</span>) <br></code></pre></td></tr></table></figure><h3 id="16-5-1"><a href="#16-5-1" class="headerlink" title="16.5.1"></a>16.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, title, xlabel, ylabel, yticks, barh, axis, savefig<br>length = [<span class="hljs-number">16.38</span><br>, <span class="hljs-number">139.90</span><br>, <span class="hljs-number">441.46</span><br>, <span class="hljs-number">29.03</span><br>, <span class="hljs-number">40.93</span><br>, <span class="hljs-number">202.07</span><br>, <span class="hljs-number">142.30</span><br>, <span class="hljs-number">346.00</span><br>, <span class="hljs-number">300.00</span>]<br>neuron = [<span class="hljs-string">&quot;neuron1&quot;</span>,<span class="hljs-string">&quot;neuron2&quot;</span>,<span class="hljs-string">&quot;neuron3&quot;</span>,<span class="hljs-string">&quot;neuron4&quot;</span>,<span class="hljs-string">&quot;neuron5&quot;</span>,<span class="hljs-string">&quot;neuron6&quot;</span>,<span class="hljs-string">&quot;neuron7&quot;</span>\<br>          ,<span class="hljs-string">&quot;neuron8&quot;</span>,<span class="hljs-string">&quot;neuron9&quot;</span>]<br><br>figure()<br>title(<span class="hljs-string">&quot;Lengths of neoron&quot;</span>)<br>xlabel(<span class="hljs-string">&quot;length&quot;</span>)<br>ylabel(<span class="hljs-string">&quot;neuron&quot;</span>)<br>barh(neuron, length)<br><br>savefig(<span class="hljs-string">&quot;16.5.1.png&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="16-5-2"><a href="#16-5-2" class="headerlink" title="16.5.2"></a>16.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> title, xlabel, ylabel, figure, plot, savefig, errorbar, xticks<br>figure()<br><br>t_data = [<span class="hljs-number">606</span>, <span class="hljs-number">759</span>, <span class="hljs-number">1024</span>, <span class="hljs-number">398</span>]<br>x1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>err1 = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>errorbar(x1, t_data, err1, fmt=<span class="hljs-string">&quot;ro&quot;</span>)<br>e_data = [<span class="hljs-number">762</span>, <span class="hljs-number">639</span>, <span class="hljs-number">912</span>, <span class="hljs-number">591</span>]<br>x2 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>err2 = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>errorbar(x2, e_data, err2, fmt=<span class="hljs-string">&quot;rs&quot;</span>)<br><br><br>ylabel(<span class="hljs-string">&quot;Ratio of base count&quot;</span>)<br>xlabel(<span class="hljs-string">&quot;Base&quot;</span>)<br>xticks(x1, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;U&quot;</span>))<br>title(<span class="hljs-string">&quot;T.thermophiles / E.coli&quot;</span>)<br>savefig(<span class="hljs-string">&quot;16.5.2.png&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="16-5-3"><a href="#16-5-3" class="headerlink" title="16.5.3"></a>16.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, title, xlabel, ylabel, hist, axis, grid, savefig<br>seqlength = []<br>seq = <span class="hljs-string">&quot;&quot;</span><br>title = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SwissProt.fasta&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> title == <span class="hljs-string">&quot;&quot;</span>:<br>        title = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> title != <span class="hljs-string">&quot;&quot;</span>:<br>        seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&quot;&quot;</span>:<br>        length = <span class="hljs-built_in">len</span>(seq)<br>        seqlength.append(length)<br>        seq = <span class="hljs-string">&quot;&quot;</span><br>        title = line<br>length = <span class="hljs-built_in">len</span>(seq)<br>seqlength.append(length)<br><br><span class="hljs-built_in">print</span> seqlength<br>        <br>n_bin = <span class="hljs-number">2</span><br>figure()<br>num, bins, patches = hist(seqlength, n_bin, density = <span class="hljs-number">1.0</span>, histtype = <span class="hljs-string">&quot;bar&quot;</span>, \<br>                          facecolor = <span class="hljs-string">&quot;green&quot;</span>, alpha = <span class="hljs-number">0.7</span>,rwidth = <span class="hljs-number">0.85</span>)<br><br>xlabel(<span class="hljs-string">&quot;seqlength&quot;</span>)<br>ylabel(<span class="hljs-string">&quot;frequence&quot;</span>)<br>axis()<br>grid(<span class="hljs-literal">True</span>)<br>savefig(<span class="hljs-string">&quot;16.5.3.png&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="draw-comparison-of-test-and-train-accuracy"><a href="#draw-comparison-of-test-and-train-accuracy" class="headerlink" title="draw comparison of test and train accuracy"></a>draw comparison of test and train accuracy</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#use n_neighbors as independent variable,</span><br><span class="hljs-comment">#get comparison of train_data accuracy and test_data accuracy</span><br><span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<br><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>cancer = load_breast_cancer()<br>X_train, X_test, y_train, y_test = train_test_split(cancer.data, cancer.target,<br>                                                    stratify=cancer.target,<br>                                                    random_state = <span class="hljs-number">66</span> )<br>training_accuracy=[]<br>test_accuracy=[]<br>neighbors_setting=<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">11</span>)<br><br><span class="hljs-keyword">for</span> n_neighbors <span class="hljs-keyword">in</span> neighbors_setting:<br>    clf = KNeighborsClassifier(n_neighbors = n_neighbors)<br>    clf.fit(X_train, y_train)<br>    training_accuracy.append(clf.score(X_train, y_train))<br>    test_accuracy.append(clf.score(X_test, y_test))<br><br>plt.plot(neighbors_setting, training_accuracy, label=<span class="hljs-string">&quot;training_accuracy&quot;</span>)<br>plt.plot(neighbors_setting, test_accuracy, label=<span class="hljs-string">&quot;test_accuracy&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;accuracy&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;n_neighbors&quot;</span>)<br>plt.legend()<br>plt.show()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PYTHON</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>微卫星序列资料准备</title>
    <link href="/2020/12/16/20201216%E5%BE%AE%E5%8D%AB%E6%98%9F%E5%BA%8F%E5%88%97/"/>
    <url>/2020/12/16/20201216%E5%BE%AE%E5%8D%AB%E6%98%9F%E5%BA%8F%E5%88%97/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20201216%E5%BE%AE%E5%8D%AB%E6%98%9F%E5%BA%8F%E5%88%97.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h1 id="微卫星序列"><a href="#微卫星序列" class="headerlink" title="微卫星序列"></a>微卫星序列</h1><p>微卫星（英语：Microsatellite，亦称为简单重复序列（Simple Sequence Repeats，SSRs）或<strong>短串联重复序列</strong>（英语：short tandem repeats，<strong>STRs</strong>））是多型性的一种类型。指两个或多个核苷酸重复排列，且不同的重复序列相邻的形式，其中某些 DNA 序列(长度从一个到六个或更多的碱基对不等)被重复，通常为5-50次。，常见于非编码的内含子中。(二核苷酸微卫星、三核苷酸微卫星、四或五核苷酸微卫星都属于微卫星，即单重复mono-，双重复di-，三重复tri-，四重复tetra-，五重复penta-和六重复hexanucleotide，每种类型的总数随着重复单元大小的增加而减少。人类基因组中最常见的 str 是二核苷酸重复序列。另一方面，根据重复序列的结构，可将 str 分为完全重复序列(简单重复序列)和不完全重复序列(复合重复序列) ，前者只包含一个重复单元，后者由不同组成的重复序列组成。)</p><p>微卫星和它们较长的近亲小卫星一起被归类为 VNTR (串联重复序列的可变数目variable number of tandem repeats) DNA。“卫星” DNA 这个名称指的是早期的观察，即离心试管中的基因组 DNA 可以从伴随的重复 DNA 的“卫星”层中分离出一个突出的体 DNA 层。它们被广泛用于癌症诊断、亲属关系分析(特别是亲子鉴定)和法医鉴定。它们还用于遗传连锁分析，以定位一个基因或突变负责给定的特征或疾病。微卫星也被用于测量亚种、群体和个体之间的群体遗传学。</p><blockquote><p>目前用于法医分析的微型卫星都是四核苷酸或五核苷酸重复序列，因为这些重复序列提供了高度的无差错数据，同时短到足以在非理想条件下保存降解。即使是更短的重复序列也会受到 PCR 断断续续和优先扩增等伪影的影响，而更长的重复序列会受到生物可分解添加物的影响更大，并且 PCR 扩增效果也会更差。</p><p>法医学的另一个考虑是，必须尊重个人的医疗隐私，以便选择非编码、不影响基因调节的法医 str，而且通常不是可能涉及亨廷顿氏病等三联体扩增疾病的三核苷酸 str。</p></blockquote><p>微卫星常被法医遗传学家和遗传系谱学学家称为短串联重复序列(short tandem repeats, str) ，或者被植物遗传学家称为简单序列重复序列(simple sequence repeats, SSRs)。</p><p>非编码区的微卫星可能没有任何特定功能，因此可能无法进行选择对照; 这使它们能够不受阻碍地在代代之间积累突变，并产生可用于 DNA 指纹鉴定和识别目的的变异性。其他微卫星位于基因的调控侧翼或内含子区，或直接位于基因的密码子——在这种情况下微卫星突变可导致表型变化和疾病，特别是在脆性 x 综合征和亨廷顿氏病等三联体扩增疾病中。</p><p>由于 SSRs 通常位于启动子、非翻译区甚至编码序列中，这种突变可以直接影响基因功能的几乎任何方面。某些三联体重复序列的突变扩增是导致一些遗传性神经退行性疾病的原因，但 SSR 等位基因也可能导致大脑和行为特征的正常变异。</p><blockquote><p>短串联重复序列(Short tandem repeats，str)和可变数目串联重复序列(variable number tandem repeats，VNTRs)又称微卫星(micro-and minatellites) ，在操作上分别定义为 DNA 长度为1ー6 bp 和≥7 bp 的串联重复单位。这些串联重复序列之间的突变率可能比基因组的独特部分高几个数量级，在 STRs 中每代10^-6到10^-2个核苷酸不等。一个特定位点的突变率可能变化很大，而最长和最纯的串联重复序列通常定义了最不稳定的 STRs 和 VNTRs。因此，长期以来，strs/vntr 一直被认为是基因组中最多态的标记之一。它们也是基因组不稳定性的重要来源，这种不稳定性与几种人类疾病有关，包括重复扩增障碍，因为它们有通过复制滑移、 DNA 修复或非等位基因同源重组扩增的趋势。</p></blockquote><h3 id="微卫星的突变机制"><a href="#微卫星的突变机制" class="headerlink" title="微卫星的突变机制"></a>微卫星的突变机制</h3><p>与点突变只影响单个核苷酸不同，微卫星突变会导致整个重复单位的增加或减少，有时会同时发生两个或更多的重复。因此，微卫星位点的突变速率预计将不同于其他突变速率，如碱基置换率。微卫星突变的真正原因是争论不休的。</p><p>微卫星序列突变可能是由于减数分裂中的不等交换（Unequal crossing over in meiosis）。这是一个众所周知的产生大块卫星 DNA 的机制。它与同源染色体之间重复单位的交换有关。然而，这一过程涉及不同的染色体，因此在 STR 突变中起着限制性作用。然而，这种机制可能是 STR 多步骤突变的原因\citep{huang2002mutation}。</p><p>微卫星序列突变可能是由于反向转位机制（Retrotransposition mechanism）。这一机制推测，丰富的碱基转录因子是由逆转录本的3’延伸产生的，类似于 mRNA 的多聚腺苷酸化。有证据表明，最常见的人类STR与富含A的成分和转座因子之间存在联系。然而，转座因子的高密度并不总是与 STRs 的高密度相吻合。还需要进一步的研究来阐明它是否是 STR 突变的真正机制。</p><p>微卫星突变的原因除了点突变外，还有可能是由DNA聚合酶滑移（replication slippage）导致的。这也被称为 DNA 滑脱，聚合酶滑脱，或滑脱链错配。DNA 聚合酶是在复制过程中负责阅读 DNA 的酶，在沿着模板链移动时会滑落，并继续在错误的核苷酸上。DNA 聚合酶滑移更有可能发生在重复序列(如 cgcg)被复制时。由于微卫星是由这样的重复序列组成的，DNA 聚合酶在这些序列区域中可能会以较高的速率产生错误。一些研究已经发现证据表明滑动是微卫星突变的原因。通常，每个微卫星的滑移大约每1000代发生一次。因此，在基因组的其他部分，重复 DNA 的滑脱性变化比点突变更常见3个数量级。大多数滑移只会导致一个重复单位的改变，不同等位基因长度和重复单位大小的滑移率也不同，在不同的物种中也是如此。</p><p><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1672022907600096-gr1.jpg" alt="img"></p><p>但其滑移率与 STR 的表观突变率不一致。体外实验表明，DNA 滑移发生率非常高。但在活体内，大部分 DNA 环通过错配修复系统被识别和消除。研究表明，一个功能性错配修复系统可以降低 STR 突变率100到1000倍。因此，观察到的 STR 突变率取决于滑动率和修复系统纠正不匹配的效率\citep{fan2007brief}。</p><p>位点间的突变率存在明显的差异。Chakraborty 等表明，在人类非致病性 STR 基因座中，二核苷酸重复序列的突变率最高，而四核苷酸 STR 基因座的突变率低50% 。然而，疾病相关的三核苷酸重复突变率超过正常值四至七倍。</p><p>目前已经发展了多种方法来阐明 STRs 的突变率，如家族方法\citep{huang2002mutation}、生物模型方法、种群方法\citep{di1998heterogeneity}和生殖细胞方法。家族方法是最直接的方法，其中突变率和突变类型都可以在从父母到后代的 STR 传播过程中直接检测\citep{huang2002mutation}。在生物模型方法中，将 STR 克隆到载体中，在宿主体内进行繁殖，从而评价 STR 突变的自发率，并估计各种因素对 STR 突变的影响。利用种群方法，可以检测到 STRs 的共同进化起源，并且可以追溯到许多代\citep{hastbacka1992linkage}。STR 突变率也可以通过生殖细胞方法直接分析生殖细胞，特别是精子\citep{holtkemper2001mutation}。</p><p>研究者调查了来自53个多世代家系的630名受试者在362个常染色体二核苷酸微卫星位点的97个突变事件的模式和特征。一个大小依赖的突变偏见(其中长等位基因偏向于收缩，而短等位基因偏向于扩展)被观察到。突变的大小(重复数在突变过程中改变)和突变的方向(收缩或扩展)与标准化等位基因大小之间存在显著的负相关关系。与早期在人类身上的发现相比，研究中的大多数突变事件(63%)是涉及多个重复单位变化的多步骤事件。突变率与重组率无相关性。研究数据表明，微卫星位点的突变动力学比广义逐步突变模型更为复杂\citep{huang2002mutation}。</p><h3 id="微卫星序列突变对蛋白的影响"><a href="#微卫星序列突变对蛋白的影响" class="headerlink" title="微卫星序列突变对蛋白的影响"></a>微卫星序列突变对蛋白的影响</h3><p>在哺乳动物中，20% 至40% 的蛋白质含有由短序列重复序列编码的重复序列。大多数基因组蛋白质编码部分的短序列重复序列都有三个核苷酸的重复单位，因为这个长度在突变时不会引起帧移位。每一个三核苷酸重复序列被转录成相同氨基酸的重复序列。在酵母中，最常见的重复氨基酸是谷氨酰胺、谷氨酸、天冬氨酸和丝氨酸。</p><p>这些重复片段的突变可以影响蛋白质的物理和化学性质，并可能产生逐渐和可预测的蛋白质作用的变化。例如，Runx2基因群体重复区的长度变化导致了家养犬(Canis familiaris)面部长度的差异，这与较长的序列长度和较长的面部长度有关。这种联系也适用于更广泛的食肉动物种类。HoxA13基因内多丙氨酸片段的长度变化与人类的手足生殖器综合症有关，这是一种发展障碍。其他三重复序列的长度变化与人类的40多种神经系统疾病有关，特别是脆性 x 综合征和亨廷顿舞蹈病等三重复序列扩展性疾病。复制滑移的进化变化也发生在更简单的生物体中。例如，微卫星长度变化在酵母表面膜蛋白中很常见，提供了细胞特性的快速进化。具体来说，FLO1基因的长度变化控制着对底物的粘附程度。短序列重复还能使致病细菌的表面蛋白发生迅速的进化变化，这可能使它们跟上宿主的免疫变化。真菌(粉色面包霉菌)中短序列重复序列的长度变化控制着其生物钟周期的持续时间。</p><h3 id="微卫星序列对基因调控的影响"><a href="#微卫星序列对基因调控的影响" class="headerlink" title="微卫星序列对基因调控的影响"></a>微卫星序列对基因调控的影响</h3><p>启动子和其他顺式调控区内微卫星长度的变化可以在世代间快速改变基因表达。人类基因组在调控区包含许多(&gt; 16,000)短序列重复序列，为许多基因的表达提供了“调节旋钮”。通过改变启动子间距，细菌 SSRs 的长度变化可以影响流感嗜血桿菌菌毛的形成。二核苷酸微卫星与人类基因组顺式调控区的丰富变异有关。田鼠抗利尿激素1a 受体基因控制区的微卫星影响它们的社会行为和一夫一妻制水平。</p><p>在尤文氏肉瘤中，一个点突变产生了一个扩展的 GGAA 微卫星，这个微卫星结合了一个转录因子，这反过来又激活了驱动癌症的 EGR2基因。此外，其他 GGAA 微卫星可能影响与尤文肉瘤患者临床预后有关的基因的表达。（似乎GGAA微卫星序列可以调节增强子活性，也就是说，微卫星序列可以调节转录元件的活性？）</p><h3 id="分析方法"><a href="#分析方法" class="headerlink" title="分析方法"></a>分析方法</h3><p>重复 DNA 不容易使用下一代 DNA 测序方法。因此，微卫星通常通过传统的 PCR 扩增和幅度测定来进行分析，有时接着进行 Sanger DNA 测序。</p><blockquote><p>在法医学中，分析是通过从感兴趣的样本细胞中提取细胞核 DNA，然后通过聚合酶链式反应扩增提取 DNA 的特定多态性区域来完成的。一旦这些序列被放大，它们就可以通过凝胶电泳或者毛细管电泳来解析，这样分析师就可以确定有问题的微卫星序列有多少个重复。</p></blockquote><p>Detecting short tandem repeats using WGS</p><h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>法医学数据库：</p><p>英国：SGM + 系统</p><p>美国：FBI CODIS Core STR Loci</p><p>澳大利亚：NCIDD</p><p>RAD-测序——ddRADseq数据</p><blockquote><p>ddRAD，是 RAD 测序协议的一种变体，用于 SNP 的发现和基因分型。在这种变化中，采用二次限制消化代替碎块剪切，提高了粒度选择步骤的可调性和准确性。</p><p>优势：不需要参考基因组；与全基因组测序相比，相对便宜；基因组覆盖度可以通过选择不同的限制性内切酶来调整。</p></blockquote><h2 id="生信分析工具"><a href="#生信分析工具" class="headerlink" title="生信分析工具"></a>生信分析工具</h2><p><strong>lobSTR</strong></p><p>一种在个人基因组中分析 STRs 的新方法。利用信号处理和统计学习的概念来避免间隙对齐，并解决 STR 调用中的特定噪声模式。</p><p>lobSTR 实现提供了一个完整的解决方案，它采用原始测序数据并报告每个异常 STR 位点上的等位基因。程序的输入是一个或多个 FASTA/FASTQ 或 BAM 格式的序列库。输出是 BAM 格式 STR 读取的对齐方式，以及自定义制表符分隔文本格式中每个 STR 位点最可能的等位基因。lobSTR 支持多线程处理。</p><p> <a href="http://jura.wi.mit.edu/erlich/lobSTR/">http://jura.wi.mit.edu/erlich/lobSTR/</a></p><p><a href="http://lobstr.teamerlich.org/">http://lobstr.teamerlich.org/</a> （usage and download）</p><p>原文： <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3371701/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3371701/</a></p><p>输入：fastq/fasta/bam（最好用bwa）格式的数据</p><p>输出：bam 格式的 STR reads 以及自定义制表符分隔文本格式中每个 STR 位点最可能的等位基因</p><p>在线教程：arvados <a href="https://dev.arvados.org/projects/arvados/wiki/LobSTR_tutorial">https://dev.arvados.org/projects/arvados/wiki/LobSTR_tutorial</a></p><p>可视化：<a href="http://melissagymrek.com/pybamview/index.html">pybamview</a>；<a href="http://samtools.sourceforge.net/tview.shtml">samtools tview</a>；UCSC; IGV</p><p><strong>Tantem Repeat Database</strong></p><p>地址：<a href="http://tandem.bu.edu/trf/trf.html">http://tandem.bu.edu/trf/trf.html</a></p><p>用户名：jinsy.liu@gmail.com</p><p>密码：prgu3556</p><p>可以提交genbank编号或上传数据进行在线分析，然后获得一份输出结果：</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2020-12-17 下午3.18.58.png" alt="截屏2020-12-17 下午3.18.58"></p><p>（该结果列出了STR开始的位点等信息）</p><p><strong>STRScan</strong></p><p>它使用贪婪算法对下一代测序(NGS)数据进行目标 STR 分析。测试了来自 Venter 基因组测序和全基因组测序千人基因组计划的数据。结果表明，STRScan 可以在目标集中描绘出 lobSTR 遗漏的20% 以上的 str。</p><blockquote><p>用于在下一代测序(NGS)数据中对 STRs 进行剖析。在这里，我们采用了一种针对性的方法来进行 STR 分析: <strong>我们尝试只研究用户定义的 STR 基因座子集，而不是在整个基因组范围内挖掘所有 STR (这是 lobSTR 或 STR-fm 的目标)</strong> ，这种方法对于法医或基因检测特别有用，因此避免了耗时的全基因组读取映射程序。因此，我们的方法不受参考基因组中以线性 DNA 序列表示的 STR 基因座序列比较的限制，可以采用微调比对算法进行 DNA 序列中的 STR 鉴定。除了挖掘全基因组测序数据外，我们的方法还可以直接应用于目标 STR 样本 NGS 数据中的 STR 分析，经过 STR 浓缩，或者特定 STR 基因座的 PCR 扩增(例如用于身份鉴定或基因检测)。</p></blockquote><p>在 STRScan 中，每个 STR 基因座由一个或多个重复单元的串联拷贝以及重复单元之间的上游、下游和中间序列组成的模式表示，这些模式可以从生物体(如人类)的参考基因组序列中构建出来。</p><p>缺陷：从传统的下一代测序技术(例如，Illumina 公司的全基因组测序序列测定器)获得的短片段可能不适合用于 STR 的定向分析: 在全基因组测序数据中，只有少量的短片段能够被识别出来支持常见的 STR 面板(例如 y 染色体和 CODIS)。另一方面，相对较长的读取自 Illumina miSeq，可能达到500-600bps 的长度，相当于文特尔基因组数据集中的桑格测序读取长度，对于目标 STR 分析更加敏感(如表1所示)。结合特定 STR 基因座的目标扩增，miSeq 测序可以在 DNA 取证中获得满意的 STR 分型灵敏度，在基因疾病筛查中获得目标 STR 分型灵敏度。</p><p><a href="http://darwin.informatics.indiana.edu/str/">http://darwin.informatics.indiana.edu/str/</a></p><p>原文：<a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1800-z">https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1800-z</a></p><p><strong>STR-FM</strong></p><p>STR-FM，使用基于侧翼的映射的微卫星分析，一个计算流水线，可以检测短读数据的 STR 等位基因的全谱，可以适应新兴的读映射算法，并可以应用于异种遗传样本(如，肿瘤，病毒，和细胞器的基因组)。</p><p>原文：<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4417121/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4417121/</a></p><p><strong>HipSTR</strong></p><p>HipSTR，一种新的基于单倍型的方法，可以从 Illumina 测序数据进行稳定的 STR 基因分型和分期。</p><p>原文：<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5482724/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5482724/</a></p><p>安装与教程：<a href="https://hipstr-tool.github.io/HipSTR/">https://hipstr-tool.github.io/HipSTR/</a></p><p><strong>RepeatSeq</strong></p><p>使用贝叶斯模型选择引导一个经验派生的错误模型，其中包括序列和读取特性。</p><p>原文：<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3592458/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3592458/</a></p><p>安装与教程：<a href="https://github.com/adaptivegenome/repeatseq">https://github.com/adaptivegenome/repeatseq</a></p><p><strong>STRaitRazor</strong></p><p>STRait Razor，这是一个用于描述大规模并行处理机测序数据中短串联重复序列(short tandem repeats，str)单倍型特征的程序。</p><p>原文：<a href="https://pubmed.ncbi.nlm.nih.gov/28605651/">https://pubmed.ncbi.nlm.nih.gov/28605651/</a></p><p><strong>STRmix</strong></p><p>STRmix是专家法医软件，可以解决以前无法解析的混合 DNA 图谱。</p><p>STRmix包含一个功能，允许软件直接在数据库中匹配混合的 DNA 图谱。对于那些没有嫌疑人，而且在一份样本中有来自多个捐献者的 DNA 的案件来说，这是一个重大进步。</p><p><strong>STRsearch</strong></p><p>STRsearch 不仅可以通过计算 STR 区域的重复模式和 INDELs 来确定等位基因，而且还可以将 MPS 结果转换为标准的 STR 命名法(数字和字母)。</p><p>原文：<a href="https://hereditasjournal.biomedcentral.com/articles/10.1186/s41065-020-00120-6">https://hereditasjournal.biomedcentral.com/articles/10.1186/s41065-020-00120-6</a></p><p>安装与教程：<a href="https://github.com/AnJingwd/STRsearch">https://github.com/AnJingwd/STRsearch</a></p><p><strong>GangSTR</strong></p><p>原文：<a href="https://academic.oup.com/nar/article/47/15/e90/5518310">https://academic.oup.com/nar/article/47/15/e90/5518310</a></p><h2 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h2><p>Analysis of tandem repeat variability in a three-generation nuclear family</p><p><a href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA229524">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA229524</a></p><p>原文章：<a href="https://academic.oup.com/nar/article/42/9/5728/2903185#119400513">https://academic.oup.com/nar/article/42/9/5728/2903185#119400513</a></p><p>研究流程/方法：</p><p>HapMap trio</p><p><a href="https://www.ncbi.nlm.nih.gov/variation/news/NCBI_retiring_HapMap/">https://www.ncbi.nlm.nih.gov/variation/news/NCBI_retiring_HapMap/</a></p><h2 id="微卫星序列是否受表观遗传修饰-调控"><a href="#微卫星序列是否受表观遗传修饰-调控" class="headerlink" title="微卫星序列是否受表观遗传修饰/调控"></a>微卫星序列是否受表观遗传修饰/调控</h2><p>发现了一个来自于人类 x 连锁的视网膜色素变性2 RP2启动子的 CpG 岛的外源性串联 GAAA 重复序列230-bp，其5meCpG 状态与 XCI 相关。</p><p>AR CAG 和 RP2 GAAA多态性与正确识别母系来源的染色体优先失活（可以区分Xa和Xi）\citep{machado20145}</p><h2 id="微卫星序列在T细胞里的突变方向"><a href="#微卫星序列在T细胞里的突变方向" class="headerlink" title="微卫星序列在T细胞里的突变方向"></a>微卫星序列在T细胞里的突变方向</h2><h2 id="微卫星序列在干细胞中是否更稳定"><a href="#微卫星序列在干细胞中是否更稳定" class="headerlink" title="微卫星序列在干细胞中是否更稳定"></a>微卫星序列在干细胞中是否更稳定</h2><p>微卫星序列可以用于鉴定细胞谱系、干细胞\citep{barallon2010recommendation}。微卫星分子遗传标记技术是目前为数不多的几种可用的 DNA 分析技术之一，目前正被提议用于人类细胞系、干细胞和组织的常规鉴定(认证)。与同工酶分析、核型分析、人类白细胞抗原分型等方法相比，该技术的优势在于，只要对适当数量和类型的基因座进行评估，STR 分析可以在个体水平上建立身份\citep{nims2010short}。</p><p>微卫星序列可以用于检测异基因造血干细胞移植后受者血液中的共者血细胞百分比，这一结果可以用于监测移植后进化，对预测移植物排斥反应和疾病复发的风险是有用的\citep{dumache2018chimerism}。</p><p>发现人类STR似乎容易富集在Alu元件附近。</p><h2 id="来自父母哪一方的微卫星序列更稳定？"><a href="#来自父母哪一方的微卫星序列更稳定？" class="headerlink" title="来自父母哪一方的微卫星序列更稳定？"></a>来自父母哪一方的微卫星序列更稳定？</h2><p>应用于人类身份鉴定的STR：</p><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2020-12-17 下午1.13.15.png" alt="截屏2020-12-17 下午1.13.15"></p><p>在从父母到子女的传播过程中，重复序列的长度有时会扩大。大多数重复序列没有可察觉的功能，但有些重复序列的数量超过某一特定阈值时有可能成为致病性。</p><h2 id="利用STR构建细胞发育树"><a href="#利用STR构建细胞发育树" class="headerlink" title="利用STR构建细胞发育树"></a>利用STR构建细胞发育树</h2><p>大致思路：</p><p><strong>收集同一个体的不同时期/组织细胞测序数据；</strong></p><p><strong>lobSTR call STR</strong>；</p><blockquote><p>原则上，任何突变信息都可能有助于谱系树的重建。我们关注 MS 即 微卫星 突变的原因如下:</p><p>(1) MS 滑移突变，即在 MS 中插入或删除重复单位，被认为是在 DNA 复制过程中发生的，因此与细胞分裂耦合; </p><p>(2) MS 突变发生率相对较高，并提供了广泛的选择范围;</p><p>(3) MS 突变被认为是在不同的位点上独立发生的，通常不影响表型，而且由于大多数突变发生在非编码基因组序列中，因此不可能通过体细胞选择突变</p><p>(4) MS 在人和小鼠中比较丰富</p><p>(5) 错配修复基因突变的动物在所有组织中的错配修复基因[32,33]都表现出非常高的突变率，可用于实验和分析。</p></blockquote><p><strong>利用获得的STR和Nei’s DA distance (1983)公式计算细胞间遗传距离</strong>：<img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-01-21 下午2.55.39.png" alt="截屏2021-01-21 下午2.55.39"></p><p>Nei’s DA distance比较适用于微卫星，其计算过程中的假设是：</p><p>其他计算遗传距离的方法还包括：</p><p>Absolute distance – the distance between two samples（i and j  is the average absolute differences between their number of repeats in all alleles which were analyzed in both samples) :<img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-01-21 下午3.01.20.png" alt="截屏2021-01-21 下午3.01.20"></p><p>Normalized Absolute distance – the distance between two samples (i and j is the average normalized absolute difference between their number of repeats in all alleles which were analyzed in both samples): <img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-01-21 下午3.01.52.png" alt="截屏2021-01-21 下午3.01.52"></p><p>Euclidean distance – the distance between two samples:<img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-01-21 下午3.02.48.png" alt="截屏2021-01-21 下午3.02.48"></p><p>“Equal or not” distance – the distance between two samples ( i and j is the number of alleles that differ between the two identifiers): <img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-01-21 下午3.03.37.png" alt="截屏2021-01-21 下午3.03.37"></p><p><strong>根据计算出的遗传距离构建n个细胞间的n x n遗传距离矩阵</strong>；</p><p><strong>利用UPGMA算法构建细胞发育树（rooted tree）</strong>；</p><p><strong>统计学检验</strong>：</p><p>Hardy–Weinberg expectations</p><blockquote><p>对象应该是一群能进行繁殖的population</p></blockquote><p>检测数据的整体显著性</p><blockquote><p>Holm-Bonferroni Method</p><p>The <strong>Holm-Bonferroni Method</strong> (also called Holm’s Sequential Bonferroni Procedure) is a way to deal with familywise error rates (FWER) for multiple hypothesis tests.</p></blockquote><p>对于population，FST value and RST value</p><blockquote><p><em>F</em>-statistics: <a href="https://www.nature.com/articles/6883270#ref-CR32">Weir &amp; Cockerham (1984)</a> <strong>Values</strong> can range from 0 to 1. <strong>High FST</strong> implies a considerable degree of differentiation among populations. </p><p><em>R</em>ST: <a href="https://www.nature.com/articles/6883270#ref-CR28">Slatkin (1995)</a>. Rst is a pairwise population genetic distance that is analogous to Fst, but that takes into account differences in the number of repeats between microsatellite alleles (allele size). 该检验表明等位基因大小是否提供了更多的种群分化信息。Significant tests on Rst values are expected if populations had diverged for a sufficiently long time and/or if populations exchanged migrants at a rate similar or inferior to the mutation rate (Hardy et al., 2003). </p><p>Differences between <em>F</em>ST/<em>R</em>ST values for different loci combinations were tested using the Wilcoxon rank sum test and the median test. </p></blockquote><p>对于population，Migration indices (<em>Nm</em>)</p><blockquote><p>用 RST 代替 FST </p><p>应用公式 <em>F</em>ST=1/(4<em>Nm</em>+1) <a href="https://www.nature.com/articles/6883270#ref-CR33">Wright (1969)</a></p></blockquote><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs tex"><br>@article&#123;barallon2010recommendation,<br>  title=&#123;Recommendation of short tandem repeat profiling for authenticating human cell lines, stem cells, and tissues&#125;,<br>  author=&#123;Barallon, Rita and Bauer, Steven R and Butler, John and Capes-Davis, Amanda and Dirks, Wilhelm G and Elmore, Eugene and Furtado, Manohar and Kline, Margaret C and Kohara, Arihiro and Los, Georgyi V and others&#125;,<br>  journal=&#123;In Vitro Cellular <span class="hljs-keyword">\&amp;</span> Developmental Biology-Animal&#125;,<br>  volume=&#123;46&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;727--732&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;dumache2018chimerism,<br>  title=&#123;Chimerism Monitoring by Short Tandem Repeat (STR) Markers in Allogeneic Stem Cell Transplantation.&#125;,<br>  author=&#123;Dumache, Raluca and Enache, Alexandra and Barbarii, Ligia and Constantinescu, Carmen and Pascalau, Andreea and Jinca, Cristian and Arghirescu, Smaranda&#125;,<br>  journal=&#123;Clinical laboratory&#125;,<br>  volume=&#123;64&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1535--1543&#125;,<br>  year=&#123;2018&#125;<br>&#125;<br><br>@article&#123;nims2010short,<br>  title=&#123;Short tandem repeat profiling: part of an overall strategy for reducing the frequency of cell misidentification&#125;,<br>  author=&#123;Nims, Raymond W and Sykes, Greg and Cottrill, Karin and Ikonomi, Pranvera and Elmore, Eugene&#125;,<br>  journal=&#123;In Vitro Cellular <span class="hljs-keyword">\&amp;</span> Developmental Biology-Animal&#125;,<br>  volume=&#123;46&#125;,<br>  number=&#123;10&#125;,<br>  pages=&#123;811--819&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;huang2002mutation,<br>  title=&#123;Mutation patterns at dinucleotide microsatellite loci in humans&#125;,<br>  author=&#123;Huang, Qing-Yang and Xu, Fu-Hua and Shen, Hui and Deng, Hong-Yi and Liu, Yong-Jun and Liu, Yao-Zhong and Li, Jin-Long and Recker, Robert R and Deng, Hong-Wen&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;70&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;625--634&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;di1998heterogeneity,<br>  title=&#123;Heterogeneity of microsatellite mutations within and between loci, and implications for human demographic histories&#125;,<br>  author=&#123;Di Rienzo, Anna and Donnelly, Peter and Toomajian, Chris and Sisk, Bronwyn and Hill, Adrian and Petzl-Erler, Maria Luiza and Haines, G Ken and Barch, David H&#125;,<br>  journal=&#123;Genetics&#125;,<br>  volume=&#123;148&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;1269--1284&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Genetics Soc America&#125;<br>&#125;<br><br>@article&#123;hastbacka1992linkage,<br>  title=&#123;Linkage disequilibrium mapping in isolated founder populations: diastrophic dysplasia in Finland&#125;,<br>  author=&#123;H&#123;<span class="hljs-keyword">\&quot;</span>a&#125;stbacka, Johanna and de la Chapelle, Albert and Kaitila, Ilkka and Sistonen, Pertti and Weaver, Alix and Lander, Eric&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;2&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;204--211&#125;,<br>  year=&#123;1992&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;holtkemper2001mutation,<br>  title=&#123;Mutation rates at two human Y-chromosomal microsatellite loci using small pool PCR techniques&#125;,<br>  author=&#123;Holtkemper, Ulrike and Rolf, Burkhard and Hohoff, Carsten and Forster, Peter and Brinkmann, Bernd&#125;,<br>  journal=&#123;Human molecular genetics&#125;,<br>  volume=&#123;10&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;629--633&#125;,<br>  year=&#123;2001&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;huang2002mutation,<br>  title=&#123;Mutation patterns at dinucleotide microsatellite loci in humans&#125;,<br>  author=&#123;Huang, Qing-Yang and Xu, Fu-Hua and Shen, Hui and Deng, Hong-Yi and Liu, Yong-Jun and Liu, Yao-Zhong and Li, Jin-Long and Recker, Robert R and Deng, Hong-Wen&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;70&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;625--634&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;fan2007brief,<br>  title=&#123;A brief review of short tandem repeat mutation&#125;,<br>  author=&#123;Fan, Hao and Chu, Jia-You&#125;,<br>  journal=&#123;Genomics, proteomics <span class="hljs-keyword">\&amp;</span> bioinformatics&#125;,<br>  volume=&#123;5&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;7--14&#125;,<br>  year=&#123;2007&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>GWAS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2020.11.3 实验室轮转工作</title>
    <link href="/2020/11/03/20201103scRNA_seq_by_seurat_rotationwork/"/>
    <url>/2020/11/03/20201103scRNA_seq_by_seurat_rotationwork/</url>
    
    <content type="html"><![CDATA[<p><strong>20201103rotation_report.pdf获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20201103rotation_report.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><p><strong>20201103scRNA_seq_by_seurat_rotationwork.pdf获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20201103scRNA_seq_by_seurat_rotationwork.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p><h1 id="Data-availability"><a href="#Data-availability" class="headerlink" title="Data availability"></a>Data availability</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>www.ncbi.nlm.nih.gov<span class="hljs-regexp">/geo/</span>query/acc.cgi?acc=GSE109555<br></code></pre></td></tr></table></figure><p>load TPM matrix into R studio</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">test&lt;-read.table(<span class="hljs-string">&quot;/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/GSE109555_All_Embryo_TPM.txt&quot;</span>)<br></code></pre></td></tr></table></figure><p>Logarithmic processing of matrices</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">test &lt;- log10(test + <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>sort by embryo stage(day)</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs R">library(dplyr)<br>only_d6 &lt;- select(test, starts_with(<span class="hljs-string">&quot;D6&quot;</span>))<br>only_d8 &lt;- select(test, starts_with(<span class="hljs-string">&quot;D8&quot;</span>))<br>only_d10 &lt;- select(test, starts_with(<span class="hljs-string">&quot;D10&quot;</span>))<br>only_d12 &lt;- select(test, starts_with(<span class="hljs-string">&quot;D12&quot;</span>))<br>only_d14 &lt;- select(test, starts_with(<span class="hljs-string">&quot;D14&quot;</span>))<br><br>all_stage &lt;- cbind(only_d6,only_d8,only_d10,only_d12,only_d14)<br></code></pre></td></tr></table></figure><p>Create Seurat Object</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs R">library(Seurat)<br>all_stage_new &lt;- CreateSeuratObject(<br>  counts = all_stage, <span class="hljs-comment"># test is all sample_gene matrix</span><br>  project = <span class="hljs-string">&quot;SeuratProject&quot;</span>,<br>  assay = <span class="hljs-string">&quot;RNA&quot;</span>,<br>  min.cells = <span class="hljs-number">0</span>,<br>  min.features = <span class="hljs-number">0</span>,<br>  names.field = <span class="hljs-number">1</span>,<br>  names.delim = <span class="hljs-string">&quot;-&quot;</span>,<br>  meta.data = <span class="hljs-literal">NULL</span><br>)<br></code></pre></td></tr></table></figure><p>Find Variable Features</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs R">all_stage_new_gene &lt;- FindVariableFeatures(all_stage_new, selection.method = <span class="hljs-string">&quot;vst&quot;</span>, nfeatures = <span class="hljs-number">2000</span>)<br>all_stage_new_top10 &lt;- head(VariableFeatures(all_stage_new_gene), <span class="hljs-number">10</span>)<br>all_stage_new_genes &lt;- rownames(all_stage_new)<br>all_stage_new &lt;- ScaleData(all_stage_new, features = all_stage_new_genes)<br>variable_all_stage_new_gene &lt;- FindVariableFeatures(object = all_stage_new)<br></code></pre></td></tr></table></figure><p>do elbowplot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">all_stage_new &lt;- RunPCA(all_stage_new, features = VariableFeatures(object = variable_all_stage_new_gene))<br>ElbowPlot(all_stage_new)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/elbow_all_stage_new.png" alt="elbow_all_stage_new"></p><p>do TSNEplot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs r">all_stage_new &lt;- FindNeighbors(all_stage_new, dims = <span class="hljs-number">1</span>:<span class="hljs-number">15</span>)<br>all_stage_new &lt;- FindClusters(all_stage_new, dims = <span class="hljs-number">1</span>:<span class="hljs-number">15</span>, print = <span class="hljs-literal">FALSE</span>)<br>all_stage_new &lt;- RunTSNE(all_stage_new, dims.use = <span class="hljs-number">1</span>:<span class="hljs-number">15</span>)<br>TSNEPlot(all_stage_new, pt.size = <span class="hljs-number">0.5</span>)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/tsne_all_stage_new.png" alt="tsne_all_stage_new"></p><p> show the embryonic cells at each stage separately (day 6 to day 14) in the total cluster results</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs R">only_d6 &lt;- CreateSeuratObject(<br>   counts = only_d6, <span class="hljs-comment"># test is all sample_gene matrix</span><br>   project = <span class="hljs-string">&quot;SeuratProject&quot;</span>,<br>   assay = <span class="hljs-string">&quot;RNA&quot;</span>,<br>   min.cells = <span class="hljs-number">0</span>,<br>   min.features = <span class="hljs-number">0</span>,<br>   names.field = <span class="hljs-number">1</span>,<br>   names.delim = <span class="hljs-string">&quot;-&quot;</span>,<br>   meta.data = <span class="hljs-literal">NULL</span><br> ) <span class="hljs-comment">#Create Seurat Object</span><br> <br>only_d6_gene &lt;- FindVariableFeatures(only_d6, selection.method = <span class="hljs-string">&quot;vst&quot;</span>, nfeatures = <span class="hljs-number">2000</span>)<br>only_d6_gene &lt;- rownames(only_d6)<br>only_d6 &lt;- ScaleData(only_d6, features = only_d6_gene)<br>variable_only_d6_gene &lt;- FindVariableFeatures(object = only_d6)<br>only_d6 &lt;- RunPCA(only_d6, features = VariableFeatures(object = variable_only_d6_gene))<br>only_d6 &lt;- JackStraw(only_d6, num.replicate = <span class="hljs-number">100</span>)<br>only_d6 &lt;- ScoreJackStraw(only_d6, dims = <span class="hljs-number">1</span>:<span class="hljs-number">20</span>)<br>only_d6 &lt;- FindNeighbors(only_d6, dims = <span class="hljs-number">1</span>:<span class="hljs-number">10</span>)<br>only_d6 &lt;- FindClusters(only_d6, resolution = <span class="hljs-number">0.5</span>)<br>only_d6 &lt;- RunUMAP(only_d6, dims = <span class="hljs-number">1</span>:<span class="hljs-number">10</span>)<br><br><br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d6_in_all_stage_tsne.png" alt="d6_in_all_stage_tsne"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d8_in_all_stage_tsne.png" alt="d8_in_all_stage_tsne"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d10_in_all_stage_tsne.png" alt="d10_in_all_stage_tsne"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d12_in_all_stage_tsne.png" alt="d12_in_all_stage_tsne"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d14_in_all_stage_tsne.png" alt="d14_in_all_stage_tsne"></p><p>then do heatmap and ridgeplot</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs R">epi_feature &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;POU5F1&quot;</span>, <span class="hljs-string">&quot;NANOG&quot;</span>, <span class="hljs-string">&quot;SOX2&quot;</span>, <span class="hljs-string">&quot;DPPA5&quot;</span>, <span class="hljs-string">&quot;IFITM1&quot;</span>, <span class="hljs-string">&quot;MEG3&quot;</span>, <span class="hljs-string">&quot;KHDC3L&quot;</span>, <span class="hljs-string">&quot;TDGF1&quot;</span>, <span class="hljs-string">&quot;DPPA4&quot;</span>, <span class="hljs-string">&quot;IFITM3&quot;</span>)<br>te_feature &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SLC7A2&quot;</span>, <span class="hljs-string">&quot;RAB31&quot;</span>, <span class="hljs-string">&quot;GRHL1&quot;</span>, <span class="hljs-string">&quot;FYB&quot;</span>, <span class="hljs-string">&quot;TEAD1&quot;</span>, <span class="hljs-string">&quot;DLX3&quot;</span>, <span class="hljs-string">&quot;HSD17B1&quot;</span>, <span class="hljs-string">&quot;HSD3B1&quot;</span>, <span class="hljs-string">&quot;CLDN4&quot;</span>, <span class="hljs-string">&quot;ABCG2&quot;</span>,<span class="hljs-string">&quot;WLS&quot;</span>,<span class="hljs-string">&quot;MBNL3&quot;</span>,<span class="hljs-string">&quot;MPP1&quot;</span>,<span class="hljs-string">&quot;TFAP2A&quot;</span>, <span class="hljs-string">&quot;ACKR2&quot;</span>)<br>pe_feature &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;GPX2&quot;</span>, <span class="hljs-string">&quot;PDGFRA&quot;</span>, <span class="hljs-string">&quot;APOA1&quot;</span>, <span class="hljs-string">&quot;ADD3&quot;</span>, <span class="hljs-string">&quot;APOE&quot;</span>, <span class="hljs-string">&quot;GATA4&quot;</span>, <span class="hljs-string">&quot;SPARC&quot;</span>, <span class="hljs-string">&quot;CKB&quot;</span>, <span class="hljs-string">&quot;GJA1&quot;</span>, <span class="hljs-string">&quot;MARCKS&quot;</span>,<span class="hljs-string">&quot;NID2&quot;</span>,<span class="hljs-string">&quot;CNN3&quot;</span>)<br>icm_feature &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;NANOG&quot;</span>,<span class="hljs-string">&quot;GATA6&quot;</span>, <span class="hljs-string">&quot;EOMES&quot;</span>, <span class="hljs-string">&quot;SOX2&quot;</span>, <span class="hljs-string">&quot;POU5F1&quot;</span>, <span class="hljs-string">&quot;FGF4&quot;</span>)<br>RidgePlot(all_stage_new, features = epi_feature)<br>RidgePlot(all_stage_new, features = te_feature)<br>RidgePlot(all_stage_new, features = pe_feature)<br>DoHeatmap(subset(all_stage_new, downsample = <span class="hljs-number">100</span>), features = epi_feature, size = <span class="hljs-number">3</span>)<br>DoHeatmap(subset(all_stage_new, downsample = <span class="hljs-number">100</span>), features = te_feature, size = <span class="hljs-number">3</span>)<br>DoHeatmap(subset(all_stage_new, downsample = <span class="hljs-number">100</span>), features = pe_feature, size = <span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_EPI_heatmap.png" alt="all_stage_new_EPI_heatmap"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_EPI_ridgeplot.png" alt="all_stage_new_EPI_ridgeplot"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_PE_heatmap.png" alt="all_stage_new_PE_heatmap"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_PE_ridgeplot.png" alt="all_stage_new_PE_ridgeplot"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_TE_heatmap.png" alt="all_stage_new_TE_heatmap"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_TE_ridgeplot.png" alt="all_stage_new_TE_ridgeplot"></p><p>Show top 100 (actuallly top 96) differentially expressed genes in ascending order</p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_new_stage_top100_49_60.png" alt="all_new_stage_top100_49_60"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_top100_1_12.png" alt="all_stage_new_top100_1_12"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_top100_13_24.png" alt="all_stage_new_top100_13_24"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_top100_25_36.png" alt="all_stage_new_top100_25_36"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_top100_37_48.png" alt="all_stage_new_top100_37_48"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_top100_61_72.png" alt="all_stage_new_top100_61_72"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_top100_73_84.png" alt="all_stage_new_top100_73_84"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_top100_85_96.png" alt="all_stage_new_top100_85_96"></p><p>Show cluster results by embryonic stage in total cluster results</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs R">cell_type &lt;- RenameIdents(object = all_stage_new, <br>                                  <span class="hljs-string">&quot;0&quot;</span> = <span class="hljs-string">&quot;Day8&quot;</span>,<br>                                  <span class="hljs-string">&quot;1&quot;</span> = <span class="hljs-string">&quot;Day12&quot;</span>,<br>                                  <span class="hljs-string">&quot;2&quot;</span> = <span class="hljs-string">&quot;Day8&quot;</span>,<br>                                  <span class="hljs-string">&quot;3&quot;</span> = <span class="hljs-string">&quot;Day10&quot;</span>,<br>                                  <span class="hljs-string">&quot;4&quot;</span> = <span class="hljs-string">&quot;Day10&quot;</span>,<br>                                  <span class="hljs-string">&quot;5&quot;</span> = <span class="hljs-string">&quot;Day6&quot;</span>,<br>                                  <span class="hljs-string">&quot;6&quot;</span> = <span class="hljs-string">&quot;Day10&quot;</span>,<br>                                  <span class="hljs-string">&quot;7&quot;</span> = <span class="hljs-string">&quot;Day12&quot;</span>,<br>                                  <span class="hljs-string">&quot;8&quot;</span> = <span class="hljs-string">&quot;Day8&quot;</span>,<br>                                  <span class="hljs-string">&quot;9&quot;</span> = <span class="hljs-string">&quot;Day14&quot;</span>,<br>                                  <span class="hljs-string">&quot;10&quot;</span> = <span class="hljs-string">&quot;Day10&quot;</span>,<br>                                  <span class="hljs-string">&quot;11&quot;</span> = <span class="hljs-string">&quot;Day12&quot;</span>,<br>                                  <span class="hljs-string">&quot;12&quot;</span> = <span class="hljs-string">&quot;Day12&quot;</span>,<br>                                  <span class="hljs-string">&quot;13&quot;</span> = <span class="hljs-string">&quot;Day14&quot;</span>,<br>                                  <span class="hljs-string">&quot;14&quot;</span> = <span class="hljs-string">&quot;Day6-10&quot;</span>,<br>                                  <span class="hljs-string">&quot;15&quot;</span> = <span class="hljs-string">&quot;Day6&quot;</span>)<br>DimPlot(object = cell_type, <br>        reduction = <span class="hljs-string">&quot;tsne&quot;</span>, <br>        label = <span class="hljs-literal">TRUE</span>,<br>        label.size = <span class="hljs-number">3</span>,<br>        repel = <span class="hljs-literal">TRUE</span>)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/sample_type.png" alt="sample_type"></p><p>In addition, we attempted to view the labeling results of EPI, PE and TE cells at each stage of the cell mass (from day 6 to day 14).</p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d6_in_all_stage_new_EPI.png" alt="d6_in_all_stage_new_EPI"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d6_in_all_stage_new_PE.png" alt="d6_in_all_stage_new_PE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d6_in_all_stage_new_TE.png" alt="d6_in_all_stage_new_TE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d8_in_all_stage_new_EPI.png" alt="d8_in_all_stage_new_EPI"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d8_in_all_stage_new_PE.png" alt="d8_in_all_stage_new_PE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d8_in_all_stage_new_TE.png" alt="d8_in_all_stage_new_TE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d10_in_all_new_stage_EPI.png" alt="d10_in_all_new_stage_EPI"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d10_in_all_stage_new_PE.png" alt="d10_in_all_stage_new_PE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d10_in_all_stage_new_TE.png" alt="d10_in_all_stage_new_TE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d12_in_all_stage_new_EPI.png" alt="d12_in_all_stage_new_EPI"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d12_in_all_stage_new_PE.png" alt="d12_in_all_stage_new_PE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d12_in_all_stage_new_TE.png" alt="d12_in_all_stage_new_TE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d14_in_all_stage_new_EPI.png" alt="d14_in_all_stage_new_EPI"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d14_in_all_stage_new_PE.png" alt="d14_in_all_stage_new_PE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/d14_in_all_stage_new_TE.png" alt="d14_in_all_stage_new_TE"></p><p>Similarly, show cluster results in the total cluster results  by cell type </p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs r">cells.ident &lt;- FetchData(all_stage_new, vars=<span class="hljs-string">&quot;ident&quot;</span>)<br><br>FeaturePlot(all_stage_new, <br>             cells=rownames(cells.ident), <br>             features = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SLC7A2&quot;</span>, <span class="hljs-string">&quot;RAB31&quot;</span>, <span class="hljs-string">&quot;GRHL1&quot;</span>, <span class="hljs-string">&quot;FYB&quot;</span>, <span class="hljs-string">&quot;TEAD1&quot;</span>, <span class="hljs-string">&quot;DLX3&quot;</span>, <span class="hljs-string">&quot;HSD17B1&quot;</span>, <span class="hljs-string">&quot;HSD3B1&quot;</span>, <span class="hljs-string">&quot;CLDN4&quot;</span>, <span class="hljs-string">&quot;ABCG2&quot;</span>,<span class="hljs-string">&quot;WLS&quot;</span>,<span class="hljs-string">&quot;MBNL3&quot;</span>,<span class="hljs-string">&quot;MPP1&quot;</span>), <span class="hljs-comment">#TE</span><br>             label = <span class="hljs-literal">TRUE</span>)<br>FeaturePlot(all_stage_new, <br>             cells=rownames(cells.ident), <br>             features = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;GPX2&quot;</span>, <span class="hljs-string">&quot;PDGFRA&quot;</span>, <span class="hljs-string">&quot;APOA1&quot;</span>, <span class="hljs-string">&quot;ADD3&quot;</span>, <span class="hljs-string">&quot;APOE&quot;</span>, <span class="hljs-string">&quot;GATA4&quot;</span>, <span class="hljs-string">&quot;SPARC&quot;</span>, <span class="hljs-string">&quot;CKB&quot;</span>, <span class="hljs-string">&quot;GJA1&quot;</span>, <span class="hljs-string">&quot;MARCKS&quot;</span>,<span class="hljs-string">&quot;NID2&quot;</span>,<span class="hljs-string">&quot;CNN3&quot;</span>),<br>             label = <span class="hljs-literal">TRUE</span>) <span class="hljs-comment">#PE</span><br>FeaturePlot(all_stage_new, <br>             cells=rownames(cells.ident), <br>             features = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;POU5F1&quot;</span>, <span class="hljs-string">&quot;NANOG&quot;</span>, <span class="hljs-string">&quot;SOX2&quot;</span>, <span class="hljs-string">&quot;DPPA5&quot;</span>, <span class="hljs-string">&quot;IFITM1&quot;</span>, <span class="hljs-string">&quot;MEG3&quot;</span>, <span class="hljs-string">&quot;KHDC3L&quot;</span>, <span class="hljs-string">&quot;TDGF1&quot;</span>, <span class="hljs-string">&quot;DPPA4&quot;</span>, <span class="hljs-string">&quot;IFITM3&quot;</span>),<br>             label = <span class="hljs-literal">TRUE</span>) <span class="hljs-comment">#EPI</span><br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_EPI.png" alt="all_stage_new_EPI"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_PE.png" alt="all_stage_new_PE"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/all_stage_new_TE.png" alt="all_stage_new_TE"></p><p>The labeling results are then shown in the cluster results based on the three different cell types：</p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/cell_type.png" alt="cell_type"></p><p>downstream GO analysis</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs R">BiocManager::install(<span class="hljs-string">&quot;DOSE&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;topGO&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;clusterProfiler&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;pathview&quot;</span>)<br>library(DOSE)<br>library(org.Hs.eg.db)<br>library(topGO)<br>library(clusterProfiler)<br>library(pathview)<br>x &lt;- all_stage_new_top100<br>test = bitr(x, <span class="hljs-comment">#your gene list</span><br>            fromType=<span class="hljs-string">&quot;SYMBOL&quot;</span>, <span class="hljs-comment">#SYMBOL format</span><br>            toType=<span class="hljs-string">&quot;ENTREZID&quot;</span>,  <span class="hljs-comment"># ENTERZID format</span><br>            OrgDb=<span class="hljs-string">&quot;org.Hs.eg.db&quot;</span>) <span class="hljs-comment">#human database</span><br>head(test,<span class="hljs-number">2</span>)<br>ggo &lt;- groupGO(gene = test$ENTREZID, OrgDb = org.Hs.eg.db, ont = <span class="hljs-string">&quot;CC&quot;</span>,level = <span class="hljs-number">3</span>,readable = <span class="hljs-literal">TRUE</span>)<br>genelist &lt;- all_stage_new_genes<br>genelist = bitr(genelist, <span class="hljs-comment">#gene list</span><br>            fromType=<span class="hljs-string">&quot;SYMBOL&quot;</span>, <span class="hljs-comment">#SYMBOL format</span><br>            toType=<span class="hljs-string">&quot;ENTREZID&quot;</span>,  <span class="hljs-comment">#ENTERZID format</span><br>            OrgDb=<span class="hljs-string">&quot;org.Hs.eg.db&quot;</span>) <span class="hljs-comment">#human database</span><br>ego_ALL &lt;- enrichGO(gene = test$ENTREZID, <br>                    <span class="hljs-comment">#universe = genelist, #Background gene set</span><br>                    OrgDb = org.Hs.eg.db, <br>                    <span class="hljs-comment">#keytype = &#x27;ENSEMBL&#x27;,</span><br>                    ont = <span class="hljs-string">&quot;ALL&quot;</span>, <span class="hljs-comment">#choose fromm ALL CC BP MF</span><br>                    pAdjustMethod = <span class="hljs-string">&quot;BH&quot;</span>, <span class="hljs-comment">#chose one method from ’holm”, “hochberg”, “hommel”, “bonferroni”, “BH”, “BY”, “fdr”, “none”</span><br>                    pvalueCutoff = <span class="hljs-number">1</span>, <span class="hljs-comment">#The p-value will filter out a lot, so set pvalueCutoff = 1 to output all the results</span><br>                    qvalueCutoff = <span class="hljs-number">1</span>,<br>                    readable = <span class="hljs-literal">TRUE</span>) <span class="hljs-comment">#turn Gene ID to gene Symbol </span><br>head(ego_ALL)<br>ego_MF &lt;- enrichGO(gene = test$ENTREZID, OrgDb = org.Hs.eg.db,ont = <span class="hljs-string">&quot;MF&quot;</span>, pAdjustMethod = <span class="hljs-string">&quot;BH&quot;</span>,pvalueCutoff = <span class="hljs-number">1</span>,qvalueCutoff = <span class="hljs-number">1</span>,readable = <span class="hljs-literal">FALSE</span>)<br>head(ego_MF)<br>dotplot(ego_MF,title=<span class="hljs-string">&quot;EnrichmentGO_MF_dot&quot;</span>)<br><br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/EnrichmentGO_MF_dot.png" alt="EnrichmentGO_MF_dot"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">barplot(ego_MF, showCategory=<span class="hljs-number">20</span>,title=<span class="hljs-string">&quot;EnrichmentGO_MF&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/EnrichmentGO_MF.png" alt="EnrichmentGO_MF"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">plotGOgraph(ego_MF)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/Library/Application Support/typora-user-images/截屏2020-11-03 下午3.28.27.png" alt="截屏2020-11-03 下午3.28.27"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs R">ego_MF.fil &lt;- simplify(ego_MF, cutoff=<span class="hljs-number">0.05</span>, by=<span class="hljs-string">&quot;pvalue&quot;</span>, select_fun=<span class="hljs-built_in">min</span>)<br>kk &lt;- enrichKEGG(gene = test$ENTREZID,<br>                 organism = <span class="hljs-string">&#x27;hsa&#x27;</span>, <span class="hljs-comment">#KEGG can use organism = &#x27;hsa&#x27;</span><br>                 pvalueCutoff = <span class="hljs-number">1</span>)<br>dotplot(kk,title=<span class="hljs-string">&quot;Enrichment KEGG_dot&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/Enrichment_KEGG_dot.png" alt="Enrichment_KEGG_dot"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R">write.csv(summary(kk),<span class="hljs-string">&quot;/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/KEGG-enrich.csv&quot;</span>,row.names =<span class="hljs-literal">FALSE</span>)<br>hsa04915 &lt;- pathview(gene.data = all_stage_new_genes,<br>                     pathway.id = <span class="hljs-string">&quot;hsa04915&quot;</span>,<br>                     species = <span class="hljs-string">&quot;hsa&quot;</span>,<br>                     limit = <span class="hljs-built_in">list</span>(gene=<span class="hljs-built_in">max</span>(<span class="hljs-built_in">abs</span>(test)), cpd=<span class="hljs-number">1</span>))<br>goplot(ego_MF)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/goplot.png" alt="goplot"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs r">emapplot(ego_MF, showCategory = <span class="hljs-number">30</span>)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/emapplot.png" alt="emapplot"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">cnetplot(ego_MF, showCategory = <span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/cnetplot.png" alt="cnetplot"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">oragnx &lt;- setReadable(ego_ALL, <span class="hljs-string">&#x27;org.Hs.eg.db&#x27;</span>, <span class="hljs-string">&#x27;ENTREZID&#x27;</span>) <br>browseKEGG(kk, <span class="hljs-string">&#x27;hsa04015&#x27;</span>) <span class="hljs-comment"># hsa xxxxx</span><br></code></pre></td></tr></table></figure><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/hsa04015.png" alt="hsa04015"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/hsa04115.png" alt="hsa04115"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/hsa04145.png" alt="hsa04145"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/hsa04210.png" alt="hsa04210"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/hsa04913.png" alt="hsa04913"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/hsa04915.png" alt="hsa04915"></p><p><img src="/Users/keqinliu/studying_document/bioinfo/genes_involved_in_embryo_irreversible_development_analysis_project/human_embryo_implantation_rawdata/all_stage_new/hsa05418.png" alt="hsa05418"></p>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>BIOINFO</tag>
      
      <tag>R</tag>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20200926医学统计学</title>
    <link href="/2020/09/26/20200926%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6/"/>
    <url>/2020/09/26/20200926%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6/</url>
    
    <content type="html"><![CDATA[<h1 id="2020-9-26-医学统计学整理"><a href="#2020-9-26-医学统计学整理" class="headerlink" title="2020.9.26 医学统计学整理"></a>2020.9.26 医学统计学整理</h1><p><strong>pdf版获取</strong><br><br><br><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20200926%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6.pdf" width="100%" height="550" type="application/pdf"></div><br><br></p>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>BIOSTATISTICS</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>

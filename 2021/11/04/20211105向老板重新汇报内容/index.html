

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  
    <meta name="description" content="">
  
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
  <title>2021.11.04 和导师talk记录 - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Liu Keqin</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="2021.11.04 和导师talk记录">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-11-04 17:18" pubdate>
        2021年11月4日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      9.1k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      97
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2021.11.04 和导师talk记录</h1>
            
            <div class="markdown-body">
              <h1><span id="2021-11-04-report">2021-11-04 REPORT</span><a href="#2021-11-04-report" class="header-anchor">#</a></h1><h2><span id="x-ran-se-ti">X染色体</span><a href="#x-ran-se-ti" class="header-anchor">#</a></h2><p><img src="https://onlinelibrary.wiley.com/cms/asset/4c424bf7-db0d-485f-afb2-c4b4cd58eb8f/gepi21782-fig-0001-m.png" srcset="/img/loading.gif" alt="image"></p>
<blockquote>
<p>包含性染色体处理的GWAS理想流程</p>
</blockquote>
<p>实际实施过程中存在的问题：</p>
<ol>
<li><p>抽样过程中的男女性别比例控制</p>
<blockquote>
<p>实验组和control组性别比例差异，可能导致第一类错误</p>
</blockquote>
</li>
<li><p>基因分型芯片的选择</p>
<blockquote>
<p>在考虑性染色体的GWAS研究中，X染色体在不同类型芯片上的覆盖率很重要。一般来说，可以通过与染色体物理长度相关的单核苷酸多态性(SNPs)的数量来估计染色体的覆盖率。虽然X染色体的长度约占整个人类基因组的5% ，但在常用的基因分型平芯片上，X染色体SNP的覆盖率分别为：2.0% (GeneChip Human Mapping 500K Array Set by Affymetrix) ，2.6% (HumanOmni5-Quad BeadChip by Illumina)到3.5% (Genome-Wide Human SNP Array 6.0 by Affymetrix)。</p>
<p>而且，在1KG计划中鉴定的X染色体上SNP的比例也仅有4%左右。</p>
</blockquote>
</li>
<li><p>QC过程中，在X染色体上丢失的 SNPs 比例比在常染色体上丢失的多。因此，就质量控制的结果而言，X染色体的数据质量比常染色体低。</p>
</li>
</ol>
<p>不过，总体来说，特殊的遗传情况可以通过合理选择调用、归因和关联算法来处理。虽然需要承认没有单一的最佳分析方法，但因此在分析中包括X染色体变体是可控的。</p>
<blockquote>
<p>在将X染色体默认纳入GWAS的努力中，一个重要的障碍是: 目前不能简单地将x染色体与常染色体分析一起运行。对于基因型的调用，应该考虑男性和女性的不同模型。同样，对于X染色体的归因，需要设置额外的参数。</p>
<p>尽管统计技术应当是可实现的，但X染色体上的关联分析工具很少在典型的软件包中实现，如PLINK和SNPTEST。</p>
<blockquote>
<p>在PLINK中，实现了没有失活的加性模型的测试，在SNPTEST中，一些测试在新的测试版程序中实现了，但没有描述这些是如何计算的。</p>
<p>因此，大多数有关X染色体的计算需要单独实现。</p>
</blockquote>
<p>不过，通过选择合理的算法和参数设置，将X染色体纳入GWAS应当是可以实现的。</p>
</blockquote>
<h2><span id="gwas-summary-statistics">GWAS summary statistics</span><a href="#gwas-summary-statistics" class="header-anchor">#</a></h2><p>一般包含以下内容：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>列标</th>
<th>缩写</th>
<th>描述</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td>chromosome/染色体</td>
<td>CHR</td>
<td>突变所在的染色体</td>
<td>8</td>
</tr>
<tr>
<td>variant_id/突变ID</td>
<td>SNP</td>
<td>突变的rs_id</td>
<td>Rs62513865</td>
</tr>
<tr>
<td>base_pair_location/基对位置</td>
<td>BP</td>
<td>突变的基对位置</td>
<td>101592213</td>
</tr>
<tr>
<td>effect_allele/效应等位基因</td>
<td>/</td>
<td>该突变的效应等位基因</td>
<td>G</td>
</tr>
<tr>
<td>other_allele/其他等位基因</td>
<td>/</td>
<td>无效等位基因</td>
<td>A</td>
</tr>
<tr>
<td>effect_allele_frequency/效应等位基因频率</td>
<td>/</td>
<td>影响等位基因在对照群体中的频率</td>
<td>0.998</td>
</tr>
<tr>
<td>odds_ratio/优势比</td>
<td>OR</td>
<td>变异/性状关联的优势比</td>
<td>1.00652</td>
</tr>
<tr>
<td>standard_error/标准误差</td>
<td>SE</td>
<td>变异/性状关联的标准错误</td>
<td>0.0165</td>
</tr>
<tr>
<td>p_value/P值</td>
<td>P</td>
<td>变异/性状关联的 p 值</td>
<td>0.808600</td>
</tr>
</tbody>
</table>
</div>
<h2><span id="pascal-suan-fa">PASCAL算法</span><a href="#pascal-suan-fa" class="header-anchor">#</a></h2><p>Pascal（通路评分算法）\parencite{lamparter2016fast}是一个易于使用的工具，用于从GWAS结果中进行基因评分和通路分析。Pascal使用外部数据来估计连锁不平衡性。因此，用户只需要提供基因组范围的SNP p值。然后，Pascal得出基因和预定义路径的p值。Pascal不使用蒙特卡洛模拟来推导基因的p值。这导致了速度和准确性的提高。这种基因评分的速度可以用来控制路径评分的假阳性率。对于路径评分，PASCAL实施并测试了富集策略，与超几何富集相比，非常有利。这种比较是在大量的GWAS结果的基础上进行的，使我们有信心推荐Pascal用于GWAS结果的下游分析。Pascal主要是用Java编写的，已经在Unix系统和Mac OsX上进行了测试。</p>
<p>pascal计算包中即包含1KG-EUR的数据用于计算连锁不平衡。</p>
<p><img src="https://www2.unil.ch/cbg/images/thumb/e/e1/PascalFigure1.jpg/500px-PascalFigure1.jpg" srcset="/img/loading.gif" alt="PascalFigure1.jpg"></p>
<blockquote>
<p>【计算基因和通路分数的方法概述】</p>
<p>(a) PASCAL通过汇总GWAS荟萃分析中的SNP p值来计算基因分数（因此不需要单个基因型），同时利用外部数据校正连锁不平衡（LD）结构。计算方案如下：在给定参考群体的LD信息的情况下，有效而准确地计算基因P值。因此，有两种方案可供选择：最大和卡方统计，它们分别基于最显著的SNP和整个区域的平均关联信号。</p>
<p>(b) PASCAL使用外部数据库为每个输出的途径定义基因集。然后，PASCAL通过合并属于相同途径的基因，即基因集的得分来计算途径得分。快速基因评分法使PASCAL能够动态地重新计算基因分数，方法是将处于LD中的、因而不能独立处理的各途径基因的SNP p值汇总。这相当于融合基因并计算一个新的分数，将相应基因座的全部LD结构考虑在内。PASCAL使用两种无参数程序之一（卡方或经验分数）评估高分（可能融合）基因的通路富集，避免了标准二元富集测试所固有的p值截止。</p>
</blockquote>
<p><img src="https://www2.unil.ch/cbg/images/thumb/c/c5/Pascal_network_analysis.png/260px-Pascal_network_analysis.png" srcset="/img/loading.gif" alt="Pascal network analysis.png"></p>
<blockquote>
<p>【pascal网络分析（实例）】</p>
<p>Pascal的效率和准确性为大规模的分析打开了大门，因为在大多数基于网络的GWAS分析方法中，总结基因层面的SNP p值是一个关键步骤。Pascal是这项工作的关键，开发者整合了37个GWAS数据集和近400个组织特异性基因调控回路，系统地分析了受性状相关基因变异干扰的基因的相互联系。这项研究表明，疾病相关的遗传变异往往会扰乱细胞类型或组织中的调控模块，而这些调控模块对该疾病具有高度的特异性，从而对疾病机制有了新的认识。</p>
</blockquote>
<h3><span id="pascal-de-ji-ben-jie-shao"><strong>PASCAL的基本介绍</strong></span><a href="#pascal-de-ji-ben-jie-shao" class="header-anchor">#</a></h3><blockquote>
<p>全基因组关联研究（GWAS）通常产生与性状或疾病相关的SNPs列表。然而，这样的输出结果几乎没有揭示潜在的分子机制，需要有工具从SNP水平的结果中提取生物学洞察力。路径分析工具整合了来自基因组不同位置的多个SNPs的信号，以便将相关的基因组区域映射到已确立的路径上，即已知的协同作用的基因集。</p>
<p>路径分析的目的是通过将观察到的SNP集合的关联信号汇总为路径水平的信号来提供对相关生物过程的洞察力。这通常分两步进行：首先，单个SNPs被映射到基因上，它们的关联P值被合并为基因分数；其次，基因被分组为路径，它们的基因分数被合并为路径分数。现有的工具在每个步骤所使用的方法以及为纠正由于连锁不平衡引起的相关性而采用的策略上有所不同。</p>
<p>SNPs通常根据物理距离、连锁不平衡（LD）或两者的结合被映射到基因。基因通常被分配到使用成熟的数据库（如基因本体论、KEGG、PANTHER、REACTOME、BIOCARTA）或内部注释（例如，基于共表达）的路径。</p>
<p>现在已经开发了各种方法，将SNP的汇总统计数字汇总到基因分数中。一个常见的汇总方法是只使用包括感兴趣的基因在内的窗口内最有意义的SNP，例如通过指定最大齐次方（MOCS）作为基因评分统计量（贡献齐次方值可以通过使用反齐次方量化转换从SNP p值中获得）。另一种方法是结合基因区域内所有SNP的结果，例如使用秩和（SOCS）统计法。MOCS和SOCS统计都会受到基因的几个特性的干扰。具体来说，在这两种情况下，必须对基因大小和 LD 结构进行校正，以获得一个良好校准的统计量的 P 值。在本文的其余部分，我们也将MOCS和SOCS统计的P值分别称为最大基因分数和总基因分数。P值可以通过表型标签互换来估计，但这种方法既需要计算，又需要获得实际研究的基因型数据，而这些数据很少被共享。因此，人们往往只能获得关联的汇总统计，而不能获得单个基因型。在这种情况下，一种方法是回归出混杂因素。这种方法在流行的MAGENTA工具中被采用，但只提供了部分解决方案，因为大量的残余混杂因素仍然存在。</p>
<p>在此采取的另一种方法是，利用MOCS和SOCS统计量的无效分布只取决于贡献基因型的成对相关矩阵这一事实。在没有原始基因型的情况下，这个相关矩阵仍然可以从种族匹配的、公开的基因型数据中估计出来，正如和其他人提出的用于GWAS结果的条件性多SNP分析。这种方法已经在Versatile Gene-based Association Study (VEGAS)软件中实现，产生的结果接近于表型标签互换的结果。然而，虽然VEGAS比通过表型标签互换估计的速度快，但它仍然依赖蒙特卡洛方法来估计P值。这就限制了它对高度显著的基因分数的效率。</p>
<p>一旦基因分数被计算出来，路径分析工具就会使用各种策略在相关基因组之间进行汇总。最常见的用于分析GWAS元分析结果的方法，如流行的GWAS途径分析工具MAGENTA，是基于二元富集度测试，它依靠一个阈值参数来定义哪些基因与性状显著相关。然而，在这种策略下，刚刚错过阈值的弱相关基因的潜在贡献就会丧失，而且对于如何设置阈值参数也没有明确的指导。事实上，在不知道其他选择是否会产生更好的结果的情况下，保持默认参数似乎是一种常见的做法。</p>
<p>在这项工作中，PASCAL开发者着重于改进路径富集分析的两个主要方面。首先，研究者为MOCS和SOCS统计的P值估计纳入了数字和分析解决方案。这消除了对表型排列或蒙特卡洛模拟的需要，从而使分数计算更快。第二，研究者开发了严格的I型错误控制策略，并实施了改良的Fisher方法来计算无参数的通路得分[19]。虽然算法的某些元素已经在统计遗传学的其他领域提出，但这一方法的新颖性在于将复杂的分析方法独特地结合在一起用于路径分析，从而提高了计算速度、精度、I型误差控制和功率。</p>
<blockquote>
<h3><span id="pascal-de-you-dian">PASCAL的优点</span><a href="#pascal-de-you-dian" class="header-anchor">#</a></h3><ol>
<li><p>速度快。与VEGAS相比，PASCAL的计算速度大大加快了，所需的时间大幅缩短。对于HapMap估算的数据，VEGAS花了29小时计算18132个基因分数，在单核计算机上运行的PASCAL只花了大约30分钟。对于1KG的输入数据，PASCAL在两个小时内完成了任意一个统计量的计算，而VEGAS则需要10多天。</p>
</li>
<li><p>和经典基因分数评分算法有很好的一致性。Pascal和VEGAS的基因分数之间有很好的一致性，但低于$10^{-6}$的基因分数除外（因为将VEGAS限制在108次蒙特卡洛运行，它不能以良好的精度估计小于$10^{-6}$的p值）。相比之下，Pascal可以在p值低至$10^{-15}$的情况下，以较高的精度计算基因得分。总之，Pascal算法中的分析方案在效率和精度方面都有很大的提高。直接比较Pascal的总分和最大基因分数，发现两种评分方法之间有很好的一致性。在两种方法的结果不一致的情况下，最大分值往往更有意义。</p>
</li>
<li><p>PASCAL能够控制由于邻近基因引起的膨胀</p>
<p> 一般来说，从基因分数计算路径分数的方法都假定这些分数在无效假设下是独立的。然而，相邻的基因由于LD的关系往往有相关的分数，而且有时是同一pathway的一部分。这就导致了在无效假设下的路径得分P值分布不均匀。MAGENTA处理这个问题的方法是根据LD修剪基因分数，只使用该区域的最高基因分数。但是，这在计算路径得分时，会对高基因得分产生偏差。</p>
<p> PASCAL的快速基因分数计算方法允许用基因融合的策略来解决这个问题。简而言之，对于每条孕育着相关基因的途径，使用与单个基因相同的方法对每个相关基因组（即融合基因）重新计算基因得分，从而将相应区域的全部LD结构考虑在内。</p>
</li>
<li><p>相对于超几何通路富集检验，PASCAL的灵敏度和特异度都更高。</p>
<p> 从基因（或SNP）的排序列表中得出路径分数的常用统计方法是，首先应用一个固定的阈值，以定义一个被认为与给定性状显著相关的元素子集。然后用一个超几何测试来计算路径统计，评估该路径是否包含比预期更多的重要元素。例如，MAGENTA工具中就采用了这种方法。另一个常见的策略是使用秩和（Wilcoxon）检验。</p>
</li>
<li><p>在路径的丰富程度上，相对于基于超几何测验的路径，PASCAL具有更高的效率</p>
<p> 帕斯卡发现了许多生物学上可能的通路，但是标准的二元富集分析没有发现。</p>
</li>
</ol>
</blockquote>
<h3><span id="pascal-ji-suan-yuan-li"><strong>PASCAL计算原理</strong></span><a href="#pascal-ji-suan-yuan-li" class="header-anchor">#</a></h3><ol>
<li><p>gene score</p>
<blockquote>
<p>Pascal基因评分方法包括以下步骤：首先，如果SNPs位于基因体周围的特定窗口内，就将这个SNP分配给基因。PASCAL的开发者使用了从基因向上和向下延伸50kb的窗口。由于需要一个参考群体来估计SNP关联值的Z-cores之间的相关结构，开发者使用了1000基因组计划（1KG）的欧洲人群，这使得研究者可以将自定义方法灵活地应用于来自不同板块（HapMap、1KG估算、metaboChip或ImmunoChip）的汇总统计。</p>
<p>0假设：（在无效假设下，可以证明我们基因区的n个SNPs的Z-cores为多变量正态。）</p>
<blockquote>
<p>$z \sim N_n(0,\Sigma) $</p>
</blockquote>
<p>$\Sigma$是成对的SNP-by-SNP的协变量矩阵</p>
<p>在这里，定义基础统计量：SOCS($T_{sum}$) 和 MOCS($T_{max}$) 为：</p>
<blockquote>
<p>$T_{sum} = \sum_{i=1}^n z_i^2$</p>
<p>$T_{max} = max(z_i^2)$</p>
</blockquote>
<p>可以分别证明，$T_{sum}$ 是按照 $\chi_1^2$分布的随机变量的加权和分布的。</p>
<p>$T_{sum} \sim \sum_i\lambda_i\chi_1^2$</p>
<p>其中$\lambda_i$是$\Sigma$的第i个特征值。它的分布函数可以用数字来评估。为了估计$T_{max}$的无效分布，我们利用了以下事实:</p>
<blockquote>
<p>$P[T_{max} \geq t]  = P[max(|z_i|) \geq t] = 1 - P(|z_i| &lt; t, i = 1,2,…n)$ </p>
</blockquote>
<p>这相当于对多变量正态进行矩形积分，对此有一个有效的算法。目前这种积分的实现适合于估计大于$10^{-15}$的p值。为了估算低于这个限度的基因P值，我们将该区域SNP的最小P值与该基因内的有效测试数相乘（见基因分数计算的算法细节）。</p>
</blockquote>
</li>
<li><p>gene fusion</p>
<blockquote>
<p>路径分析方法通常假设用于定义路径富集的基因分数是独立的。然而，功能相关的基因经常在基因组上聚集，并且在LD中藏有SNP，导致相关的基因分数违反这一假设。为了规避这个问题，我们为一个给定的途径检查其在染色体上物理上接近的任何基因是否在LD中。如果是的话，在计算通路得分时，我们考虑由该基因簇的所有SNP组成的单一实体（所谓的融合基因）。然后，我们用这个融合基因来替换基因簇中的基因，并计算其基因得分，但只用于计算这一特定途径的得分。然后根据独立通路基因和融合基因的P值计算出通路得分，融合基因整合了依赖通路基因的关联信号。通过这种方式，相邻的通路基因的LD结构被考虑在内。我们的基因评分方法有利于这种方法，因为它对于重新计算所有融合基因的分数具有足够的速度和可扩展性。</p>
</blockquote>
</li>
<li><p>pathway scores</p>
<blockquote>
<p>对于路径分析，我们提出了一种无参数的富集策略，不需要指定基因得分阈值，因此允许弱关联基因对路径富集作出贡献。一般的方法包括三个步骤。(1)对基因分数进行转换，使其遵循目标分布；(2)通过对路径成员基因和融合基因的转换分数进行加总，计算出测试统计量；(3)用分析或经验方法评估观察到的测试统计量是否高于预期，即路径中的性状相关基因被富集了。我们考虑了这种途径评分方法的两种变体。第</p>
<p>一种变体被称为chi-squared方法。</p>
<ol>
<li>对基因得分的P值进行排序，使最低的P值得到最高的排序。然后将排名值除以基因数加1，得到均匀分布。</li>
<li>均匀分布值通过$\chi_1^2$量化函数进行转换，得到$\chi_1^2$分布的基因分数。</li>
<li>对大小为m的给定途径的$\chi_1^2$基因分数进行加总，并根据$\chi_m^2$分布进行测试。</li>
</ol>
<p>第二个变种是经验抽样法。</p>
<ol>
<li>基因分数的P值直接用$\chi_1^2$量化函数进行转换，得到新的基因分数$F_{\chi_1^2}^{-1}(1-p)$</li>
<li>一个大小为m的通路的原始通路得分是通过对所有通路基因的转换后的基因得分进行求和来计算的。</li>
<li>p值的蒙特卡洛估计是通过随机抽查m大小的基因集，并计算达到比给定途径基因集更高分值的基因集的比例来获得的。</li>
</ol>
<p>对于PASCAL的基准测试程序，研究者结合从MsigDB下载的KEGG、REACTOME和BIOCARTA的结果，创建了一个通路库。</p>
</blockquote>
</li>
<li><p>derivation of  the sum-score</p>
<blockquote>
<p>把Z视为将表型回归到一个基因区的n个SNPs中的每一个的Z统计量的向量。根据结构，每个Z统计量在空值下的平均值为零。当结果性状和基因型都被标准化时，线性回归的Z-统计量基本上是基因型和表现型向量的标量乘积。换句话说，该区域的每个Z统计量代表了同一组独立、同分布的随机变量的加权平均。可以证明，即两个Z-统计量之间的相关性等于权重之间的相关性，即相应SNP之间的相关性。因此，Z的协方差矩阵只是一对SNP-by-SNP的相关矩阵，用Σ表示。此外，中心极限定理确保在样本量足够大的情况下，Z统计量是正态分布。这些事实加在一起，可以得出——在不存在信号的无效假设下，Z遵循多变量正态分布，即 $z \sim N_n(0,\Sigma)$</p>
<p>$\Sigma$的特征值分解为： $\Sigma = \Gamma\Lambda\Gamma^T$</p>
<p>其中Γ和Λ分别是特征向量和特征值的矩阵。将z与Σ的平方根的倒数相乘，会得到一个独立随机变量的向量。让y被定义为:</p>
<p>$y = \Lambda^{-1/2}\Gamma^Tz$</p>
<p>然后：</p>
<p>$y \sim N_n(0,I_n)$</p>
<p>随后：</p>
<p>$z^Tz = z^T\Gamma\Gamma^Tz = y^T\Lambda Y \sim \sum_i \lambda_i\chi_1^2$</p>
<p>其中，$\lambda_i$是$\Sigma$的第i个特征值，代表卡方分布。</p>
</blockquote>
</li>
<li><p>参数设置</p>
<blockquote>
<p>如果没有另外说明，PASCAL总是在以下设置下使用：PASCAL将基因区域向上游和下游扩展了50kb用于基因评分。只使用欧洲1KG样本中MAF达到0.05的SNPs。对于路径得分的计算，我们删除了HLA-区域。基因融合参数被设置为1Mb，这样在计算一个特定的通路得分时，所有相距不到1Mb的通路成员基因都被融合起来进行计算。</p>
</blockquote>
</li>
<li><p>路径得分的I型错误控制的模拟设置</p>
<blockquote>
<p>使用了EUR-1KG队列中379人的基因型。相应的表型值被模拟为独立的、标准的正态分布变量。使用线性回归计算2,692,429个被测SNPs中每个的单变量Z-cores。模拟重复了100次。由于我们调查了基因融合的影响，LD矩阵是由同一数据集估计的，以避免任何可能来自样本外LD估计的影响。</p>
</blockquote>
</li>
<li><p>基因分数计算的算法细节</p>
<p> max-score</p>
<blockquote>
<p>该算法首先尝试使用蒙特卡洛模拟来推导p值。如果p值太小，无法在几次蒙特卡洛抽签中估计出来，那么该程序就会使用矩形多变量正态积分的算法[41]。所使用的积分算法的实现适合于估计大于$10^{-15}$的p值。此外，由于数值稳定性的考虑，这种实现方式仅限于大小低于1000的相关矩阵。因此，处于非常高的LD（$r^2$&gt;0.98）的SNPs被修剪以降低相关矩阵的大小。如果超过1000个SNPs落入基因，或者基因的p值低于$10^{-15}$，我们通过将基因区域的最小SNP-wise p值乘以有效测试数来近似计算基因得分。有效检测次数是指解释99.5%的总变异所需的最小主成分数。</p>
</blockquote>
<p> sum-score</p>
<blockquote>
<p>该算法依靠戴维斯算法来计算独立分布的随机变量的加权和的分布函数值。如果出现收敛问题，则使用Farebrother算法作为备份。</p>
</blockquote>
<p> web-resource</p>
<blockquote>
<p>PASCAL在线执行程序：<a target="_blank" rel="noopener" href="http://www2.unil.ch/cbg/index.php?title=Pascal">http://www2.unil.ch/cbg/index.php?title=Pascal</a></p>
<p>PASCAL源代码：<a target="_blank" rel="noopener" href="https://github.com/dlampart/Pascal">https://github.com/dlampart/Pascal</a></p>
</blockquote>
</li>
</ol>
</blockquote>
<p>总结来说，PASCAL是一种新型的GBA（gene-based analysis）方法。</p>
<p>其他常用的GBA方法还有：MAGMA，VEGAS。</p>
<blockquote>
<p><strong>MAGMA</strong> \parencite{de2015magma}</p>
<p>目前有各种基因和基因组分析的方法[7-13]。然而，大多数现有方法的一个问题是，它们首先总结每个标记的关联，然后再将其汇总到基因或基因组。正如Moskvina等人所证明的，这使得统计能力强烈依赖于局部的连锁不平衡（LD），也降低了检测依赖于多个标记的关联的能力。 另一个问题是，目前的基因组分析方法通常使用基于排列组合的方法。这些方法通常在计算上要求很高，而且由于没有使用参数模型，所以往往没有明确评估哪一个无效假设，以及做了哪些假设。这使得确定分析的属性更加困难，如基因组的显著性与其组成基因的显著性之间的关系，或分析是否纠正了多基因结构。这使结果的解释变得复杂，并阻碍了不同基因组分析方法的结果之间的比较。</p>
<p>为了解决此类问题，研究者开发了MAGMA（Multi-marker Analysis of GenoMic Annotation），这是一个快速灵活的工具，用于GWAS基因型数据的基因和基因组分析。MAGMA的基因分析使用多元回归方法，以适当纳入标记物之间的LD，并检测多标记物效应。基因组分析是围绕该基因分析建立的一个独立层，提供了独立改变和扩展基因和基因组分析的灵活性。自足的和竞争性的基因组分析都是通过基因水平的回归模型实现的。这种回归方法提供了一个通用的框架，它也可以分析连续的基因属性，如基因表达水平，以及基因组和其他基因属性的条件分析，并且可以扩展到允许对多个基因组和其他基因属性进行联合和交互分析。更传统的基因分析模型也得到了实现，以进行比较并提供SNP汇总统计的分析。</p>
<blockquote>
<p><strong>模型结构</strong></p>
<p>MAGMA基因组分析分为两个不同的、基本独立的部分。在第一部分，进行基因分析以量化每个基因与表型的关联程度。此外，还估计了基因之间的相关关系。这些相关性反映了基因之间的LD，在基因组分析中需要补偿基因之间的依赖关系。基因P值和基因相关矩阵随后被用于第二部分，进行实际的基因组分析。</p>
<p>以这种方式将这两部分分析解耦的好处是，每一部分都可以独立于另一部分进行改变，简化了对模型任何一部分的改变和扩展的开发。此外，由于第二部分只使用第一部分的输出，而不是原始基因型数据，它们不需要在同一时间或地点进行，这使得在同一数据上进行多个基因组分析或在大规模合作中分析多个数据集变得更加直接。</p>
<p><strong>基因分析</strong></p>
<p>MAGMA的基因分析是基于一个多线性主成分回归模型，使用F-检验来计算基因的P值。该模型首先将一个基因的SNP矩阵投射到其主成分（PC）上，修剪掉特征值很小的PC，然后在线性回归模型中使用这些PC作为表型的预测因子。这通过去除多余的参数来提高功率，并保证在存在高度串联的SNP时模型是可识别的。默认情况下，SNP数据矩阵中只有0.1%的方差被修剪掉了。</p>
<blockquote>
<p>模型：$ Y = \alpha_{0g}\vec{1} + X^*_g\alpha_g + W\beta_g + \varepsilon_g $</p>
<p>$X^*_g$是PCs矩阵</p>
<p>$Y$是表型</p>
<p>$W$是模型的协变量矩阵</p>
<p>向量$\alpha_g$是遗传效应</p>
<p>$\beta_g$是可选的协变量效应</p>
<p>$\alpha_0g$是截距</p>
<p>$\varepsilon_g$是余向量</p>
<p>F-test的0假设为：$\alpha_g = \vec0$  即在所有协变量的条件下，基因g对表型Y没有影响。（完全随机设计的单因素方差分析（completely randomized design one-way ANOVA））</p>
</blockquote>
<p>这种基因分析模型的选择是出于对统计和实际问题的平衡。这种多元回归模型确保SNP之间的LD被充分考虑。它还提供了灵活性，可以根据需要容纳额外的协变量和交互项而不改变模型。同时，由于F检验有一个已知的渐进抽样分布，基因P值的计算时间非常短，使基因分析比基于互换的替代方法快得多。</p>
<p>当Y是一个二元表型时，线性回归模型也被应用。虽然这违反了F-检验的一些假设，但将F-检验的p值与基于permutation的F-统计量的p值进行比较表明，F-检验仍然是准确的。因此，MAGMA默认使用渐进式F-检验的P值，尽管它也提供了一个选项，使用自适应的互换程序计算基于互换的P值。此外，与逻辑回归模型的比较表明，线性模型的结果实际上等同于更传统的逻辑回归模型的结果，但没有计算成本。</p>
<p><strong>基因集合分析</strong></p>
<p>1.基因组分析</p>
<p>为了进行基因组分析，对于每个基因g，用上一步基因分析计算出的基因p值pg被转换成Z值 $z_g = \Phi^{-1}(1-p_g) $</p>
<p>其中 $\Phi^{-1}$ 是probit函数。这就产生了一个大致正态分布的变量Z，其元素 $Z_g$ 反映了每个基因与表型的关联强度，数值越高，对应的关联越强。</p>
<p>2.Self-contained gene-set analysis</p>
<p>Self-contained gene-set analysis检验确定基因组中的基因是否与所关注的表型共同相关。因此，使用上述的变量Z，可以为每个基因组s制定一个非常简单的仅有截距的线性回归模型：$Z_s = \beta_0\vec1 + \varepsilon_s$</p>
<p>其中 $Z_s$  是 Z 的子向量，对应于基因集合s中的基因。评估 $β_0 = 0$ 与备选的 $β_0 &gt; 0$，可以得到一个self-contained test，因为在0假设下，没有一个基因与表型相关，即 $z_g$ 对每个基因g都有一个标准的正常分布。</p>
<p>3.竞争性基因组分析</p>
<p>竞争性基因组分析检测一个基因组中的基因是否比其他基因与所关注的表型有更强的关联。为了在回归框架内测试这一点，模型首先被扩展到包括数据中的所有基因。然后定义一个带有元素 $s_g$ 的二元指标变量 $S_s$，对于基因组s中的每个基因g，$s_g=1$，否则为0。把 $S_s$ 作为Z的预测因子，就得到了这个模型: $Z = \beta_0\vec1 + S_s\beta_s + \varepsilon$</p>
<p>这个模型中的参数 $β_s$ 反映了基因组中的基因和基因组外的基因之间的关联性差异，因此，对零假设 $β_s=0$ 和单边选择 $β_s&gt;0$ 进行检验，可以得到一个竞争性检验。请注意，这相当于单边双样本t检验，即比较基因组基因的平均关联和不在基因组中的基因的平均关联。同样，Self-contained gene-set analysis相当于单边单样本t检验，将基因组基因的平均关联性与0进行比较。</p>
<p>应该清楚的是，在这个框架中，基因组分析模型是形式更普遍的基因水平回归模型的一个具体实例。在这个广义的基因组分析模型中$Z = \beta_0\vec1 + C_1\beta_1 + C_2\beta_2 + … + \varepsilon $</p>
<p>变量 $C_1$，$C_2$，…，可以反映任何基因属性，从用于竞争性基因组分析的二进制指标到连续变量，如基因大小和表达水平。这种基因属性的任何转换和相互作用也可以被加入。因此，这种通用的基因组分析模型允许测试基因组和其他基因特性的任何组合的条件效应、联合效应和交互效应。在实践中，MAGMA中实现的竞争性基因组分析实际上默认使用这样一个广义模型，对 $β_s$ 进行条件测试，并对基因大小、基因密度和（如果适用，例如在荟萃分析中）基础样本大小的差异（如果存在这种影响）的潜在混杂效应进行校正。这是通过将这些变量以及这些变量的对数作为协变量添加到基因级回归模型中来实现的。基因密度被定义为有效基因大小与基因中SNP总数之比，而有效基因大小又被定义为剪枝后剩余的主成分数量。</p>
<p>在这个基因级回归框架中出现的一个复杂情况是，标准线性回归模型假设误差项具有独立的正态分布，即 $\varepsilon \sim MVN(\vec0, \sigma^2I)$</p>
<p>然而，由于LD，相邻的基因一般会有相关性，违反了这个假设。这个问题可以通过使用广义最小二乘法来解决，并假设$\varepsilon \sim MVN(\vec0, \sigma^2R)$</p>
<p>在MAGMA中，所需的基因-基因相关矩阵R是通过使用基因分析多元回归模型中每对基因的模型平方和（SSM）之间的相关性来近似计算的，在它们共同的无效假设下，即没有关联。这些相关性是每对基因中SNP之间相关性的函数，因此能很好地反映LD，而且由于它们有一个方便的闭式解，所以很容易计算（见 “补充方法-实施细节”）。请注意，对于自足式分析，只使用与基因组中的基因相对应的子矩阵 $R_s$，而不是R。此外，由于自足式的无效假设保证所有的 $z_g$ 具有标准的正态分布，所以误差方差 $σ^2$ 可以设置为1。</p>
<p><strong>SNP汇总统计的分析</strong></p>
<p>由于原始基因型数据可能并不总是可用于分析，MAGMA还提供更传统的SNP-wise基因分析模型，即PLINK和VEGAS中实现的类型。这些SNP-wise模型首先分析一个基因中的单个SNP，并将产生的SNP p值合并为一个基因测试统计，因此即使只有SNP p值可用，也可以使用。尽管评估基因测试统计需要对基因中SNP之间的LD进行估计，但基于与计算SNP p值的数据具有相似血统的参考数据的估计已被证明可以产生准确的结果。</p>
<p>在MAGMA中实现了两种类型的基因检验统计：一种是基因中SNP的 $\chi^2$ 统计量的平均值，另一种是基因中SNP的顶级 $\chi^2$ 统计量。对于平均 $\chi^2$ 统计量，通过使用已知的抽样分布近似值，可以得到一个基因P值[20,21]。对于顶级 $\chi^2$ 统计量来说，这样的近似值是不可用的，因此要用自适应的置换程序来获得经验基因P值。首先为参考数据生成一个随机表型，从标准正态分布中提取。然后对其进行置换，并对每次置换计算每个基因的顶级 $\chi^2$ 统计量。然后计算一个基因的经验P值，即该基因的permuted top  $\chi^2$ 统计量高于其观察的top  $\chi^2$ 统计量的比例。在分析过程中，为提高计算效率，每个基因所需的排列组合数是自适应确定的。进一步的细节可以在 “补充方法-SNP-wise基因分析 “中找到。</p>
<p>MAGMA的SNP-wise模型也可用于分析原始基因型数据，在这种情况下，原始基因型数据代替了参考数据，SNP的p值在内部计算。基于这些SNP-wise模型的基因组分析与基于多元回归基因分析模型的基因组分析的方式相同。分析得出的基因P值以同样的方式转换为Z值，作为基因组分析的输入。同样，基因-基因相关矩阵R也是用与多元回归模型相同的公式得到的，但使用参考数据来计算。</p>
</blockquote>
</blockquote>
<h2><span id="wei-lai-yan-jiu-ji-hua-chu-bu">未来研究计划（初步）</span><a href="#wei-lai-yan-jiu-ji-hua-chu-bu" class="header-anchor">#</a></h2><ol>
<li>重新进行此前的工作流程，并参考其他统计资料为PASCAL mapping到的基因界定筛选p值，对pipeline进行改进。</li>
<li>申请获得PGC及ATLAS GWAS原始数据的使用许可，并调研数据可用性。</li>
<li>考虑将X染色体纳入ASD GWAS研究范围，并在前人研究的基础上，将特殊的遗传情况通过合理选择调用、归因和关联算法来处理。</li>
<li>下载PGC数据库中有关ASD共病的GWAS summary statistics，根据此前的pipeline筛选PASCAL得分较高的基因，并对潜在的共病相关基因进行基因组分析/基因网络分析。</li>
</ol>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/LEARNING-RECORDS/">LEARNING RECORDS</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/talk-meeting/">talk&meeting</a>
                    
                      <a class="hover-with-bg" href="/tags/ASD/">ASD</a>
                    
                      <a class="hover-with-bg" href="/tags/MY-PROJECT/">MY PROJECT</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/11/08/20211108ao3_data_scraping&amp;visualising/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">AO3 data scraping and visualising</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/10/29/20211029%E7%A0%94%E7%A9%B6%E7%94%9F%E5%BC%80%E9%A2%98%E8%AE%BA%E6%96%87/">
                        <span class="hidden-mobile">2021.10.29 SIBS研究生开题文件</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                  
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script>
      Fluid.utils.waitElementVisible('disqus_thread', function() {
        Fluid.utils.createCssLink('https://cdn.jsdelivr.net/npm/disqusjs@1.0/dist/disqusjs.css');
        Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/disqusjs@1.0/dist/disqus.js', function () {
          new DisqusJS({
            shortname: 'fluid',
            apikey: ''
          });
        });
      });
    </script>
    <noscript>Please enable JavaScript to view the
      <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener noopener">comments powered by Disqus.</a>
    </noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js" ></script>

  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>

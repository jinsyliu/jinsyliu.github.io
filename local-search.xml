<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2021.9.10-9.16实验记录:GWAS analysis in R</title>
    <link href="/2021/09/16/20210910to0916gwasanalysisinr/"/>
    <url>/2021/09/16/20210910to0916gwasanalysisinr/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-9-10-9-16实验记录-GWAS-analysis-in-R"><a href="#2021-9-10-9-16实验记录-GWAS-analysis-in-R" class="headerlink" title="2021.9.10-9.16实验记录: GWAS analysis in R"></a>2021.9.10-9.16实验记录: GWAS analysis in R</h1><p>[toc]</p><h2 id="R代码教程"><a href="#R代码教程" class="headerlink" title="R代码教程"></a>R代码教程</h2><p>全基因组关联分析策略通常包括四个广泛定义的部分。(i) 数据预处理data pre‐processing；(ii) 新数据生成new data generation；(iii) 统计分析statistical analysis；和(iv) 分析后询问post‐analytic interrogation。这些调查的一个主要目标是识别和描述SNPs与疾病进展或疾病结果措施之间的关联。</p><p>根据这四个阶段产生的十个步骤如下：</p><ol><li>将数据读入R，创建R对象 reading data into R to create an R object</li><li>SNP级过滤（第一部分）SNP‐level filtering (part 1)</li><li>样本级过滤 sample‐level filtering</li><li>SNP级过滤（第二部分）SNP‐level filtering (part 2)</li><li>主成分分析（PCA）principal component analysis (PCA)</li><li>非类型基因型的归因 imputation of non‐typed genotypes</li><li>类型SNP的关联分析 association analysis of typed SNPs</li><li>归因数据的关联分析 association analysis of imputed data</li><li>归因和类型SNP结果的整合 integration of imputed and typed SNP results</li><li>关联结果的可视化和质量控制 visualization and quality control of association findings</li></ol><p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5019244/bin/SIM-34-3769-g001.jpg" alt="An external file that holds a picture, illustration, etc. Object name is SIM-34-3769-g001.jpg"></p><blockquote><p>Substructure 亚结构，也称为群体混合和群体分层，是指群体遗传历史(例如，迁徙、选择和/或种族融合)导致群体内存在遗传多样性(例如，不同等位基因频率)。</p></blockquote><h3 id="数据预处理data-pre‐processing"><a href="#数据预处理data-pre‐processing" class="headerlink" title="数据预处理data pre‐processing"></a>数据预处理data pre‐processing</h3><p>在本例中，样本使用Affymetrix 6.0 GeneChip进行基因分型，并以.CEL格式提供给用户。</p><blockquote><p>基于期望最大化类型算法的Birdseed调用算法被应用于生成每个样本在每个SNP上的基因型和置信度分数。</p><p>反过来，PERL和unix脚本被用来将这些转换成.ped和.map文件。</p><p>注意，虽然R可以读取.ped和.map文件，但通常最好先将这两个文件转换为.bim、.bed和.fam文件。将文本文件转化成二进制文件，可以大大缩减文件大小。</p></blockquote><p>本教程主要利用了几个R包（来自Bioconductor）</p><p>snpStats</p><blockquote><p>具有以各种格式读取基因型数据并进行质量控制、估算和关联分析的功能</p></blockquote><p>SNPRelate</p><blockquote><p>包括样本级质量控制和计算效率高的主成分(PC)计算的功能</p></blockquote><p>其他软件包包括数据可视化/代码的功能(ggplot2、 LDheatmap、 postgwas)、数据操作(plyr)和并行处理(doparlel) ，以及它们的依赖关系。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs R">setwd(<span class="hljs-string">&quot;/Users/keqinliu/Downloads/GWASTutorial_Files&quot;</span>) <span class="hljs-comment">#先设置工作目录</span><br>getwd() <span class="hljs-comment">#检查工作目录</span><br><span class="hljs-comment">## [1] &quot;/Users/keqinliu/Downloads/GWASTutorial_Files&quot;</span><br><br>BiocManager::install(<span class="hljs-string">&quot;snpStats&quot;</span>) <span class="hljs-comment">#安装snpStats</span><br><span class="hljs-comment">#注意，R版本＞3.5，应使用BiocManager进行安装</span><br><span class="hljs-comment">#R版本＜3.5，则可使用bioconductor安装</span><br>BiocManager::install(<span class="hljs-string">&quot;SNPRelate&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;rtracklayer&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;biomaRt&quot;</span>)<br>install.packages(<span class="hljs-string">&quot;GenABEL&quot;</span>, <span class="hljs-string">&quot;LDheatmap&quot;</span>, <span class="hljs-string">&quot;doParallel&quot;</span>, <span class="hljs-string">&quot;coin&quot;</span>, <span class="hljs-string">&quot;igraph&quot;</span>) <span class="hljs-comment">#安装所需的R包</span><br>library(devtools)<br><br>data.dir &lt;- <span class="hljs-string">&quot;/Users/keqinliu/Downloads/GWAS&quot;</span><br>out.dir &lt;- data.dir <span class="hljs-comment">#设置不同的输出文件目录，以防与工作目录冲突</span><br><br><span class="hljs-comment">#以下代码用于设定输入文件</span><br>gwas.fn &lt;- lapply(<span class="hljs-built_in">c</span>(bed=<span class="hljs-string">&#x27;bed&#x27;</span>, bim=<span class="hljs-string">&quot;bim&quot;</span>, fam=<span class="hljs-string">&quot;fam&quot;</span>, gds=<span class="hljs-string">&quot;gds&quot;</span>),<span class="hljs-keyword">function</span>(n) sprintf(<span class="hljs-string">&quot;%s/GWASTutorial.%s&quot;</span>, data.dir, n))<br>clinical.fn &lt;- sprintf(<span class="hljs-string">&quot;%s/GWASTutorial_clinical.csv&quot;</span>, data.dir) <span class="hljs-comment">#sprintf函数用于把格式化的数据写入某个字符串缓冲区。</span><br>onethou.fn &lt;- lapply(<span class="hljs-built_in">c</span>(info=<span class="hljs-string">&quot;info&quot;</span>, ped=<span class="hljs-string">&quot;ped&quot;</span>), <span class="hljs-keyword">function</span>(n) sprintf(<span class="hljs-string">&quot;%s/chr16_1000g_CEU.%s&quot;</span>, data.dir, n))<br>protein.coding.coords.fnamo &lt;- sprintf(<span class="hljs-string">&quot;%s/ProCodgene_doords.csv&quot;</span>, out.dir)<br>                     <br><span class="hljs-comment">#以下代码用于设定输出文件</span><br>gwaa.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/GWAStutorialout.txt&quot;</span>, out.dir)<br>gwaa.unadj.fname &lt;- sprintf(<span class="hljs-string">&quot;%sGWAStutorialoutUnadj.txt&quot;</span>, out.dir)<br>input.out.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/GWAStutorial_inputationOut.csv&quot;</span>, out.dir)<br>CEPT.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/CEPT_GWASour.csv&quot;</span>, out.dir)    <br><span class="hljs-comment">#gwaa.fname等value都是文件目录（地址）                     </span><br>                    <br></code></pre></td></tr></table></figure><h4 id="在R中读取和格式化数据"><a href="#在R中读取和格式化数据" class="headerlink" title="在R中读取和格式化数据"></a>在R中读取和格式化数据</h4><p>为了阅读.fam .bim和.bed 文件，可以使用 Bioconductor snpStats 包中的 read.plink () 函数。</p><blockquote><p>结果列表的基因型位置包含一个 SnpMatrix 对象，它是基因型数据的矩阵，每个 SNP 有一列，每个研究参与者有一行。</p><p>临床数据(gwastufactorial clinical. csv)可以用我们熟悉的方式读取，即read.csv()。</p><p>最后，我们在这个阶段的数据子集只包括在基因型和表型文件中都有数据的个体。</p></blockquote><p>一旦我们读取了基因型和临床信息，我们就可以开始 GWA 数据预处理的下一步了。这涉及到两个过滤数据的阶段，分别在 SNP 和样本级别。</p><p>不过，在不同的情况中，分析的顺序可能会有所不同，这取决于是进行单一GWA分析(如本文所述) ，还是分析人员准备将结果纳入需要跨多项研究协调数据的更大的meta‐analysis。在后一种情况下，以下过滤步骤可能在分析之后被排除或集中执行，因为总结级数据是跨研究合并的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#reading data into r</span><br>library(snpStats)<br><span class="hljs-comment">#read in PLINK files to create list</span><br>geno &lt;- read.plink(gwas.fn$bed, gwas.fn$bim, gwas.fn$fam, na.strings = (<span class="hljs-string">&quot;-9&quot;</span>))<br><br><span class="hljs-comment">#-step1-</span><br><span class="hljs-comment">#reading data into r</span><br><br><span class="hljs-comment">#-step1a-</span><br>library(snpStats)<br><span class="hljs-comment">#read in PLINK files to create list</span><br>geno &lt;- read.plink(gwas.fn$bed, gwas.fn$bim, gwas.fn$fam, na.strings = (<span class="hljs-string">&quot;-9&quot;</span>))<br><br><span class="hljs-comment">#-step1b-</span><br><span class="hljs-comment">#obtain the genotype snpmatrix object from generated list</span><br>genotype &lt;- geno$genotypes<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  861473 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs10458597 ... rs5970564</span><br><span class="hljs-comment">#obtain teh snp info table from the list</span><br>genobim &lt;- geno$map<br>colnames(genobim) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;gen.dist&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;A1&quot;</span>, <span class="hljs-string">&quot;A2&quot;</span>)<br>print(head(genobim))<br><span class="hljs-comment">##            chr        SNP gen.dist position   A1 A2</span><br><span class="hljs-comment">## rs10458597   1 rs10458597        0   564621 &lt;NA&gt;  C</span><br><span class="hljs-comment">## rs12565286   1 rs12565286        0   721290    G  C</span><br><span class="hljs-comment">## rs12082473   1 rs12082473        0   740857    T  C</span><br><span class="hljs-comment">## rs3094315    1  rs3094315        0   752566    C  T</span><br><span class="hljs-comment">## rs2286139    1  rs2286139        0   761732    C  T</span><br><span class="hljs-comment">## rs11240776   1 rs11240776        0   765269    G  A</span><br><br><span class="hljs-comment">#remove raw file to open up memory</span><br>rm(geno)<br><br><span class="hljs-comment">#-step1c-</span><br><span class="hljs-comment">#read in clinical file</span><br>clinical &lt;- read.csv(clinical.fn, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>, <span class="hljs-string">&quot;factor&quot;</span>, <span class="hljs-string">&quot;factor&quot;</span>, <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br>rownames(clinical) &lt;- clinical$FamID<br>print(head(clinical))<br><span class="hljs-comment">##       FamID CAD sex age  tg hdl ldl</span><br><span class="hljs-comment">## 10002 10002   1   1  60  NA  NA  NA</span><br><span class="hljs-comment">## 10004 10004   1   2  50  55  23  75</span><br><span class="hljs-comment">## 10005 10005   1   1  55 105  37  69</span><br><span class="hljs-comment">## 10007 10007   1   1  52 314  54 108</span><br><span class="hljs-comment">## 10008 10008   1   1  58 161  40  94</span><br><span class="hljs-comment">## 10009 10009   1   1  59 171  46  92</span><br><br><span class="hljs-comment">#-step1d-</span><br><span class="hljs-comment">#subset genotype for individuals with clinical data</span><br>genotype &lt;- genotype[clinical$FamID, ]<br>print(genotypes)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  861473 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs10458597 ... rs5970564 </span><br><span class="hljs-comment">#在提供的数据示例中，基因型信息可用于n=1401个有可用表型数据的861473个类型SNPs</span><br></code></pre></td></tr></table></figure><h4 id="单核苷酸多态性级过滤-part1"><a href="#单核苷酸多态性级过滤-part1" class="headerlink" title="单核苷酸多态性级过滤(part1)"></a>单核苷酸多态性级过滤(part1)</h4><p>这一步涉及删除(也称为“过滤”)不包括分析的 SNPs。这种排除的原因包括大量的缺失数据、低变异性和基因分型错误。通常，首先执行基于大量缺失数据和较低可变性的 SNP 级过滤。然后是样本级过滤 ，最后是基于可能的基因分型错误的 SNP 级过滤</p><blockquote><p>这样做的理由是，样本级的关联性和亚结构都会影响用于根据基因分型错误过滤SNP的Hardy-Weinberg平衡（HWE）标准。重复SNP和样本级过滤的迭代程序也很常见，直到没有额外的样本被删除。</p><p>然而，在这个教程中，没有样本被过滤，认为这个循环是不必要的。</p></blockquote><h5 id="SNP‐level-filtering-call-rate"><a href="#SNP‐level-filtering-call-rate" class="headerlink" title="SNP‐level filtering: call rate"></a>SNP‐level filtering: call rate</h5><p>call rate被定义为研究中相应SNP信息没有缺失的个体比例。</p><blockquote><p>在本教程中，我们使用95%的调用率进行过滤，这意味着我们保留数据缺失少于5%的SNP。在较小的样本环境中，可以采用更严格的切点（例如，小于5%）。</p></blockquote><h5 id="SNP‐level-filtering-minor-allele-frequency-MAF"><a href="#SNP‐level-filtering-minor-allele-frequency-MAF" class="headerlink" title="SNP‐level filtering: minor allele frequency (MAF)"></a>SNP‐level filtering: minor allele frequency (MAF)</h5><p>在研究参与者中，如果某个SNP有很大程度的同质性，通常会导致推断该SNP与所研究性状之间的统计学意义的力量不足。当我们有一个非常小的MAF，使大多数个体有两个主要等位基因的拷贝时，就会发生这种情况。这里，我们删除了MAF小于1%的SNP（MAF &lt;0.01）。在某些情况下，特别是小样本环境下，采用5%的切割点。</p><blockquote><p>这是说，比如，99%以上的研究者都有一个相同的SNP，那么这个SNP就失去了统计学上的意义（即在参与者中，这个SNP有很大程度上的同质性）。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#使用以下脚本同时对call rate和MAF进行过滤</span><br><span class="hljs-comment">#-step2-</span><br><span class="hljs-comment">#snp-level filtering</span><br><br><span class="hljs-comment">#-step2a-</span><br><span class="hljs-comment">#create snp summary statistics (MAF, call rate, etc.)</span><br>snpsum.col &lt;- col.summary(genotype)<br>print(head(snpsum.col))<br><br><span class="hljs-comment">#-step2b-</span><br><span class="hljs-comment">#setting thresholds</span><br>call &lt;- 0.95<br>minor &lt;- 0.01<br><br><span class="hljs-comment">#filter on MAF and call rate</span><br>use &lt;- with(snpsum.col, (!<span class="hljs-built_in">is.na</span>(MAF) &amp; MAF &gt; minor) &amp; Call.rate &gt;= <span class="hljs-built_in">call</span>)<br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><br><span class="hljs-comment">#subset genotype and snp summary data for snps that pass call rate and MAF critoria</span><br>genotype &lt;- genotype[,use]<br><span class="hljs-comment">## 出现报错</span><br><span class="hljs-comment">## Error in .local(x, i, j, ..., drop) : </span><br><span class="hljs-comment">##   logical column selection vector is wrong length</span><br><span class="hljs-built_in">sum</span>(use)<br><span class="hljs-comment">## [1] 0</span><br>ncol(genotype)<br><span class="hljs-comment">## [1] 861473</span><br><span class="hljs-comment">#显然，设置的threshold根本没起作用，但不明白原因。</span><br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><span class="hljs-comment">## 861473 SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.</span><br><br><span class="hljs-comment">## 解决方案如下：it worked！</span><br><span class="hljs-comment">#filter on MAF and call rate</span><br>use &lt;- with(snpsum.col, (!<span class="hljs-built_in">is.na</span>(MAF) &amp; MAF &gt; <span class="hljs-number">0.01</span>) &amp; Call.rate &gt;= <span class="hljs-number">0.95</span>) <span class="hljs-comment">#直接把threshold改成了数值</span><br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br><br><span class="hljs-built_in">sum</span>(use)<br><span class="hljs-comment">## [1] 658186</span><br><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><span class="hljs-comment">## 203287 SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.</span><br><br><span class="hljs-comment">#subset genotype and snp summary data for snps that pass call rate and MAF critoria</span><br>genotype &lt;- genotype[,use]<br>snpsum.col &lt;- snpsum.col[use,]<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  658186 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs5970564    </span><br></code></pre></td></tr></table></figure><h4 id="样本级别过滤"><a href="#样本级别过滤" class="headerlink" title="样本级别过滤"></a>样本级别过滤</h4><p>数据预处理的第三阶段涉及过滤样本，也就是说，删除我们选择的被排除在分析之外的个体。样本级过滤的标准通常基于缺失数据、样本污染、相关性(用于基于人口的调查)以及种族、民族或性别的模糊性或不一致性。</p><h5 id="Sample‐level-filtering-call-rate"><a href="#Sample‐level-filtering-call-rate" class="headerlink" title="Sample‐level filtering: call rate"></a>Sample‐level filtering: call rate</h5><p>与基于call rate的SNP级过滤类似，我们排除那些在超过预先定义的百分比的分型SNP中缺失基因型数据的个体。这个跨SNP的缺失比例被称为sample call rate，我们采用95%的阈值。也就是说，缺失基因型数据超过5%的类型SNPs的个体将被删除。一个新的减维SnpMatrix基因型对象被创建，它包含了这个filter。</p><h5 id="Sample‐level-filtering-heterozygosity"><a href="#Sample‐level-filtering-heterozygosity" class="headerlink" title="Sample‐level filtering: heterozygosity"></a>Sample‐level filtering: heterozygosity</h5><p>杂合度是指在一个个体内，在一个给定的SNP上存在两个等位基因中的每一个。这在HWE下预计会以 $2<em>p</em>(1-p)$ 的概率出现，其中p是该SNP的显性等位基因频率（假设是双等位SNP）。一个人体内跨类型SNP的杂合度过高可能是样本质量差的表现，而杂合度不足则表明该人有近亲繁殖或其他亚结构。因此，近亲繁殖系数 $|F|=（1-O/E）&gt;0.10$ 的样本被剔除，其中O和E分别是个体内杂合SNP的观察数和预期数。请注意，我们是根据每个个体的观察到的SNP来计算该个体的预期计数的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3-</span><br><span class="hljs-comment">#sample-level filtering</span><br><br><span class="hljs-comment">#-step3a-</span><br>library(SNPRelate) <span class="hljs-comment">#estimating LD, relatedness, PCA</span><br>library(plyr)<br><br><span class="hljs-comment">#create sample statistic (call rate, heterozygosity)</span><br>snpsum.row &lt;- row.summary(genotype)<br><br><span class="hljs-comment">#add the f stat (inbreeding coefficient) to snpsum.row</span><br>MAF &lt;- snpsum.col$MAF<br>callmatrix &lt;- !<span class="hljs-built_in">is.na</span>(genotype)<br>hetExp &lt;- callmatrix %*% (<span class="hljs-number">2</span>*MAF*(<span class="hljs-number">1</span>-MAF))<br>hetObs &lt;- with(snpsum.row, Heterozygosity*(ncol(genotype))*Call.rate)<br>snpsum.row$hetF &lt;- 1-(hetObs/hetExp)<br><br>head(snpsum.row)<br><span class="hljs-comment">##       Call.rate Certain.calls Heterozygosity          hetF</span><br><span class="hljs-comment">## 10002 0.9826554             1      0.3289825 -0.0247708291</span><br><span class="hljs-comment">## 10004 0.9891581             1      0.3242931 -0.0103236529</span><br><span class="hljs-comment">## 10005 0.9918427             1      0.3231825 -0.0062550972</span><br><span class="hljs-comment">## 10007 0.9861027             1      0.3241469 -0.0098475016</span><br><span class="hljs-comment">## 10008 0.9823333             1      0.3228218 -0.0075941985</span><br><span class="hljs-comment">## 10009 0.9913034             1      0.3213658 -0.0002633189</span><br><br><span class="hljs-comment">#-step3b-</span><br><span class="hljs-comment">#setting thresholds</span><br>sampcall &lt;- 0.95 <span class="hljs-comment">#sample call rate cut-off</span><br>hetcutoff &lt;- 0.1 <span class="hljs-comment">#inbreeding coefficient cut-off</span><br><br>sampleuse &lt;- with(snpsum.row, !<span class="hljs-built_in">is.na</span>(Call.rate) &amp; Call.rate &gt; <span class="hljs-number">0.95</span> &amp; <span class="hljs-built_in">abs</span>(hetF) &lt;= <span class="hljs-number">0.1</span>)<br>sampleuse[<span class="hljs-built_in">is.na</span>(sampleuse)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(nrow(genotype)-<span class="hljs-built_in">sum</span>(sampleuse), <span class="hljs-string">&quot;subject will be removed due to low sample call rate or inbredding coefficient.\n&quot;</span>)<br><span class="hljs-comment">## 0 subject will be removed due to low sample call rate or inbredding coefficient.</span><br><br><span class="hljs-comment">#subset genotype and clinical data for subjects who pass call rate and heterozygosity crtieria</span><br>genotype &lt;- genotype[sampleuse, ]<br>clinical &lt;- clinical[rownames(genotype), ]<br></code></pre></td></tr></table></figure><p>由于提供的 PennCATH 数据是预过滤的，因此不会根据近亲繁殖系数 | f | &gt; 0.10来过滤额外的样本。</p><h5 id="Sample‐level-filtering-cryptic-relatedness-duplicates-and-gender-identity"><a href="#Sample‐level-filtering-cryptic-relatedness-duplicates-and-gender-identity" class="headerlink" title="Sample‐level filtering: cryptic relatedness, duplicates, and gender identity."></a>Sample‐level filtering: cryptic relatedness, duplicates, and gender identity.</h5><p>样本级过滤：隐性关联性、重复和性别确认。</p><p>基于人群的队列研究通常仅限于无亲缘关系的个体，而后面分型SNP的关联分析中描述的广义线性建模方法假定了个体间的独立性。但是，在复杂疾病的区域性队列研究（如基于医院的队列研究）中，来自同一家庭的个体可能会被无意中招募到。衡量一对样本之间的亲缘关系（或重复）的常用方法是基于血缘关系的认同（IBD）。IBD的亲缘关系系数大于0.10，可能表明有亲缘关系、重复或样本混合。通常情况下，具有较低基因型调用率的相关对的个体被移除。我们注意到，在这个阶段也可以检查性别确认，以确认自我报告的性别与观察到的X和Y染色体一致。</p><blockquote><p>但是，在本例所提供的数据例子中，性染色体不可用，因此，没有提供关于性别认同的过滤例子。</p></blockquote><p>我们首先应用linkage disequilibrium (LD)修剪，使用0.2的阈值，这消除了数据中很大程度的冗余，减少了染色体假象chromosomal artifacts的影响。这种降维步骤通常在IBD分析和PCA之前应用，在后面的文本中应用于ancestry filtering，并导致大量的计算节省。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3c-</span><br><span class="hljs-comment">#checking for relatedness</span><br>ld.thresh &lt;- 0.2 <span class="hljs-comment">#LD cut-off</span><br>kin.thresh &lt;- 0.1 <span class="hljs-comment">#kinship cut-off</span><br><span class="hljs-comment">#create gds file, required for SNPRelate functions</span><br>snpgdsBED2GDS(gwas.fn$bed, gwas.fn$fam, gwas.fn$bim, gwas.fn$gds)<br><span class="hljs-comment">## Start file conversion from PLINK BED to SNP GDS ...</span><br><span class="hljs-comment">##     BED file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.bed&#x27;</span><br><span class="hljs-comment">##         SNP-major mode (Sample X SNP), 288.4M</span><br><span class="hljs-comment">##     FAM file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.fam&#x27;</span><br><span class="hljs-comment">##     BIM file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.bim&#x27;</span><br><span class="hljs-comment">## Mon Sep 13 15:43:32 2021     (store sample id, snp id, position, and chromosome)</span><br><span class="hljs-comment">##     start writing: 1401 samples, 861473 SNPs ...</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 8s  </span><br><span class="hljs-comment">## Mon Sep 13 15:43:40 2021 Done.</span><br><span class="hljs-comment">## Optimize the access efficiency ...</span><br><span class="hljs-comment">## Clean up the fragments of GDS file:</span><br><span class="hljs-comment">##     open the file &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds&#x27; (292.4M)</span><br><span class="hljs-comment">##     # of fragments: 39</span><br><span class="hljs-comment">##     save to &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds.tmp&#x27;</span><br><span class="hljs-comment">##     rename &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds.tmp&#x27; (292.4M, reduced: 252B)</span><br><span class="hljs-comment">##     # of fragments: 18</span><br>genofile &lt;- openfn.gds(gwas.fn$gds, readonly = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#automatically added &quot;-1&quot; sample suffixes are removed</span><br>gds.ids &lt;- read.gdsn(index.gdsn(genofile, <span class="hljs-string">&quot;sample.id&quot;</span>))<br>gds.ids &lt;- sub(<span class="hljs-string">&quot;-1&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, gds.ids)<br>add.gdsn(genofile, <span class="hljs-string">&quot;sample.id&quot;</span>, gds.ids, replace = <span class="hljs-literal">TRUE</span>)<br><br><span class="hljs-comment">#prune SNPs for IBD analysis</span><br>set.seed(<span class="hljs-number">1000</span>)<br><br>geno.sample.ids &lt;- rownames(genotype)<br>snpSVB &lt;- snpgdsLDpruning(genofile, ld.threshold = <span class="hljs-number">0.2</span>, sample.id = geno.sample.ids, <span class="hljs-comment">#only analyze teh filtered samples</span><br>                          snp.id = colnames(genotype)) <span class="hljs-comment">#only analyze the filtered SNPs</span><br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## SNP pruning based on LD:</span><br><span class="hljs-comment">## Excluding 203,287 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 658,186</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     sliding window: 500,000 basepairs, Inf SNPs</span><br><span class="hljs-comment">##     |LD| threshold: 0.2</span><br><span class="hljs-comment">##     method: composite</span><br><span class="hljs-comment">## Chromosome 1: 8.24%, 5,856/71,038</span><br><span class="hljs-comment">## Chromosome 3: 8.16%, 4,943/60,565</span><br><span class="hljs-comment">## Chromosome 6: 8.05%, 4,362/54,176</span><br><span class="hljs-comment">## Chromosome 12: 8.60%, 3,621/42,124</span><br><span class="hljs-comment">## Chromosome 21: 9.44%, 1,176/12,463</span><br><span class="hljs-comment">## Chromosome 2: 7.69%, 5,669/73,717</span><br><span class="hljs-comment">## Chromosome 4: 8.27%, 4,603/55,675</span><br><span class="hljs-comment">## Chromosome 7: 8.47%, 3,928/46,391</span><br><span class="hljs-comment">## Chromosome 11: 7.89%, 3,490/44,213</span><br><span class="hljs-comment">## Chromosome 10: 8.01%, 3,838/47,930</span><br><span class="hljs-comment">## Chromosome 8: 7.69%, 3,716/48,299</span><br><span class="hljs-comment">## Chromosome 5: 8.10%, 4,549/56,178</span><br><span class="hljs-comment">## Chromosome 14: 8.80%, 2,470/28,054</span><br><span class="hljs-comment">## Chromosome 9: 8.23%, 3,385/41,110</span><br><span class="hljs-comment">## Chromosome 17: 11.13%, 2,220/19,939</span><br><span class="hljs-comment">## Chromosome 13: 8.40%, 2,878/34,262</span><br><span class="hljs-comment">## Chromosome 20: 9.39%, 2,137/22,753</span><br><span class="hljs-comment">## Chromosome 15: 9.23%, 2,391/25,900</span><br><span class="hljs-comment">## Chromosome 16: 9.17%, 2,529/27,591</span><br><span class="hljs-comment">## Chromosome 18: 9.00%, 2,361/26,231</span><br><span class="hljs-comment">## Chromosome 19: 12.99%, 1,492/11,482</span><br><span class="hljs-comment">## Chromosome 22: 11.21%, 1,276/11,382</span><br><span class="hljs-comment">## 72,890 markers are selected in total.</span><br>snpset.ibd &lt;- unlist(snpSVB, use.names = <span class="hljs-literal">FALSE</span>)<br>cat(<span class="hljs-built_in">length</span>(snpset.ibd), <span class="hljs-string">&quot;will be used in IBD analysis\n&quot;</span>)<br><span class="hljs-comment">## 72890 will be used in IBD analysis</span><br><span class="hljs-comment">#与tutorial中的 expect 72812 SNPs 相互冲突</span><br></code></pre></td></tr></table></figure><p>这使得SNP的数量从第2步结束时的658,186个减少到72890个。接下来，我们计算成对的IBD距离来搜索样本的关联性。采用的策略是迭代删除配对亲缘关系系数大于0.1的最高数量的主体。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3d-</span><br><span class="hljs-comment">#find IBD coefficients using method of moments procedure. include pairwise kinship</span><br>ibd &lt;- snpgdsIBDMoM(genofile, kinship = <span class="hljs-literal">TRUE</span>, sample.id = geno.sample.ids, snp.id = snpset.ibd, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## IBD analysis (PLINK method of moment) on genotypes:</span><br><span class="hljs-comment">## Excluding 788,583 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 72,890</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">## PLINK IBD:    the sum of all selected genotypes (0,1,2) = 32728566</span><br><span class="hljs-comment">## Mon Sep 13 16:05:05 2021    (internal increment: 8064)</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 7s  </span><br><span class="hljs-comment">## Mon Sep 13 16:05:13 2021    Done.</span><br>ibdcoeff &lt;- snpgdsIBDSelection(ibd) <span class="hljs-comment">#pairwise sample comparison</span><br>head(ibdcoeff)<br><span class="hljs-comment">##     ID1   ID2        k0         k1    kinship</span><br><span class="hljs-comment">## 1 10002 10004 0.9005063 0.09949372 0.02487343</span><br><span class="hljs-comment">## 2 10002 10005 0.9128056 0.08719439 0.02179860</span><br><span class="hljs-comment">## 3 10002 10007 0.9107539 0.08924614 0.02231153</span><br><span class="hljs-comment">## 4 10002 10008 0.9205765 0.07942348 0.01985587</span><br><span class="hljs-comment">## 5 10002 10009 0.9528404 0.04715958 0.01178989</span><br><span class="hljs-comment">## 6 10002 10010 0.8986051 0.10139486 0.02534872</span><br><br><span class="hljs-comment">#-step3e#</span><br><span class="hljs-comment">#check if there are any candidates for relatedness</span><br>ibdcoeff &lt;- ibdcoeff[ibdcoeff$kinship &gt;= <span class="hljs-number">0.1</span>]<br><br><span class="hljs-comment">#iteratively remove samples with high kinship </span><br>related.samples &lt;- <span class="hljs-literal">NULL</span><br><span class="hljs-keyword">while</span> (nrow(ibdcoeff)&gt;<span class="hljs-number">0</span>) &#123;<br>  <span class="hljs-comment">#count the number of occurrences of each and take the top one</span><br>  sample.counts &lt;- arrange(count(<span class="hljs-built_in">c</span>(ibdcoeff$ID1, ibdcoeff$ID2)), -freq)<br>  rm.sample &lt;- sample.counts[<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;x&#x27;</span>]<br>  cat(<span class="hljs-string">&quot;removeing sample&quot;</span>, <span class="hljs-built_in">as.character</span>(rm.sample), <span class="hljs-string">&#x27;too close related to&#x27;</span>, sample.counts[<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;freq&#x27;</span>],<span class="hljs-string">&#x27;other samples.\n&#x27;</span>)<br>  <span class="hljs-comment">#remove from ibdcoeff and add to list</span><br>  ibdcoeff &lt;- ibdcoeff[ibdcoeff$ID1 !=rm.sample &amp; ibdcoeff$ID2 != rm.sample,]<br>  related.samples &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-built_in">as.character</span>(rm.sample),related.samples)<br>&#125;<br><span class="hljs-comment">## removeing sample  too close related to NA other samples.</span><br><br><span class="hljs-comment">#filter genotype and clinical to include only unrelated samples</span><br>genotype &lt;- genotype[ !(rownames(genotype) %in% related.samples), ]<br>clinical &lt;- clinical[ !(clinical$FamID %in% related.samples), ]<br>geno.sample.ids &lt;- rownames(genotype)<br>cat(<span class="hljs-built_in">length</span>(related.samples), <span class="hljs-string">&quot;similar samples removed due to correlation coefficient &gt;= 0.1&quot;</span>, <span class="hljs-string">&quot;\n&quot;</span> )<br><span class="hljs-comment">## 0 similar samples removed due to correlation coefficient &gt;= 0.1 </span><br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  658186 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs5970564 </span><br></code></pre></td></tr></table></figure><p>在本示例中，没有任何样本是基于IBD亲属系数&gt;0.10而被过滤掉的。</p><h5 id="Sample‐level-filtering-ancestry"><a href="#Sample‐level-filtering-ancestry" class="headerlink" title="Sample‐level filtering: ancestry."></a>Sample‐level filtering: ancestry.</h5><p>PCA是一种根据观察到的基因构成将个体可视化并分类到祖先群体的方法。我们这样做有两个原因：</p><p>首先，自我报告的种族和民族可能与完全基于遗传信息的个体集群不同，</p><p>其次，出现一个似乎不属于种族/民族集群的个体可能暗示着样本级错误。</p><p>我们使用LD修剪后的72,812个SNPs子集（步骤3-c）作为PCA的输入。第一阶段LD剪枝的另一种策略是 “HapMap rooted “分析，它包括首先在一个reference panel上进行PCA，例如HapMap或1000 genome，然后将研究样本投射到所产生的空间。这种方法在此不作介绍，但可以用Kinship-based INference for Gwas（KING）软件的现有功能来实现。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3f-</span><br><span class="hljs-comment">#checking for ancestry</span><br><span class="hljs-comment">#find PCA matrix</span><br>pca &lt;- snpgdsPCA(genofile, sample.id = geno.sample.ids, snp.id = snpset.ibd, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">#creating data frame of first two principal components</span><br>pctab &lt;- data.frame(sample.id = pca$sample.id,<br>                    PC1 = pca$eigenvect[,<span class="hljs-number">1</span>], <span class="hljs-comment">#the first eigenvector</span><br>                    PC2 = pca$eigenvect[,<span class="hljs-number">2</span>], <span class="hljs-comment">#the second eigenvector</span><br>                    stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br><span class="hljs-comment">#plot the first two principle components</span><br>plot(pctab$PC2, pctab$PC1, xlab=<span class="hljs-string">&quot;principal component 2&quot;</span>, ylab=<span class="hljs-string">&quot;principal component 1&quot;</span>, main = <span class="hljs-string">&quot;ancestry plot&quot;</span>)<br><br></code></pre></td></tr></table></figure><p><img src="pcaplot.png" alt="pcaplot"></p><h4 id="单核苷酸多态性级过滤-part-2"><a href="#单核苷酸多态性级过滤-part-2" class="headerlink" title="单核苷酸多态性级过滤(part 2)"></a>单核苷酸多态性级过滤(part 2)</h4><h5 id="SNP‐level-filtering-HWE"><a href="#SNP‐level-filtering-HWE" class="headerlink" title="SNP‐level filtering: HWE."></a>SNP‐level filtering: HWE.</h5><p>违反HWE可以表明存在种群亚结构或发生基因分型错误。虽然它们并不总是可以区分的，但通常的做法是假设有基因分型错误，并删除违反HWE的SNP。如果有病例对照状态，我们将这种过滤限制在对对照组的分析上，因为病例中的违反可能是一种关联的迹象。在一个给定的SNP上，通常使用观察到的基因型和预期的基因型之间的 $X^2$ 拟合度测试来衡量对HWE的偏离。我们删除那些HWE测试统计量在对照组中的相应P值小于 $1×10^{-6}$ 的SNPs。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step4-</span><br><span class="hljs-comment">#hardy-weinberg snp filtering on cad controls</span><br>hardy &lt;- 10^-<span class="hljs-number">6</span> <span class="hljs-comment">#HWE cut-off</span><br>CADcontrols &lt;- clinical[ clinical$CAD==<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;FamID&#x27;</span> ]<br>snpsum.colCont &lt;- col.summary(genotype[CADcontrols,])<br>HWEuse &lt;- with(snpsum.colCont, !<span class="hljs-built_in">is.na</span>(z.HWE) &amp; (<span class="hljs-built_in">abs</span>(z.HWE) &lt; <span class="hljs-built_in">abs</span>(qnorm(<span class="hljs-number">0.5</span>*<span class="hljs-number">10</span>^-<span class="hljs-number">6</span>))))<br>rm(snpsum.colCont)<br><br>HWEuse[<span class="hljs-built_in">is.na</span>(HWEuse)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(HWEuse), <span class="hljs-string">&quot;SNP will be removed due to high HWE.\n&quot;</span>)<br><br><span class="hljs-comment">#subset genotype and SNP summary data for SNPs that pass HWE criteria</span><br>genotype &lt;- genotype[,HWEuse]<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  656890 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs28729663 </span><br></code></pre></td></tr></table></figure><p>在 CAD 控制中，我们根据 HWE $p &lt; 1 × 10^{-6}$ 筛选出额外的1,296个 SNPs。结果是656,890个单核苷酸多态性可以在关联分析中考虑。</p><h3 id="新数据生成"><a href="#新数据生成" class="headerlink" title="新数据生成"></a>新数据生成</h3><p>在完成SNP和样本级的过滤后，我们在进行统计分析之前产生两种新的数据：</p><p>第一种是PC，旨在捕捉潜在的人口亚结构的信息，这些信息通常在自我报告的种族和民族变量中是不存在的。</p><blockquote><p>这种数据用于进行主成分分析，创建捕获种群子结构的主要组成部分。</p></blockquote><p>第二种是未定型的SNP的基因型，可能与结果有功能关系，因此为识别关联提供额外的力量。</p><h4 id="主成分分析（PCA）principal-component-analysis-PCA"><a href="#主成分分析（PCA）principal-component-analysis-PCA" class="headerlink" title="主成分分析（PCA）principal component analysis (PCA)"></a>主成分分析（PCA）principal component analysis (PCA)</h4><p>Creating principal components for capturing population‐substructure 创建捕获种群子结构的主要组成部分</p><p>亚结构，也被称为种群混杂和种群分层，指的是在一个明显的同质种群中存在遗传多样性（如不同的等位基因频率），这是由于种群遗传历史（如迁移、选择和/或种族融合）造成的。基于观察到的基因型数据的PC可以捕捉到关于亚结构的信息，并且可以直接使用SNPRelate软件包中的snpgdsPCA()函数根据全基因型数据生成。</p><p>值得注意的是，我们在PCA之前再次应用LD修剪。通常情况下，前10个PC被认为是可能的混杂因素。这个数字是常规的，但也是任意的，一种选择是根据它们所解释的变异性的预设比例来选择PC的数量。λ统计量通常用于评估是否有必要纳入PC。这将在步骤10（量化-量化（Q-Q）图和λ-统计量）中进一步描述。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step5-</span><br><span class="hljs-comment">#generating principal components for modeling</span><br><br><span class="hljs-comment">#-step5a-</span><br><span class="hljs-comment">#set LD threshold to 0.2</span><br>ld.thresh &lt;- 0.2<br><br>set.seed(<span class="hljs-number">1000</span>)<br>geno.sample.ids &lt;- rownames(genotype)<br>snpSVB &lt;- snpgdsLDpruning(genofile, ld.threshold = <span class="hljs-number">0.2</span>,<br>                          sample.id = geno.sample.ids, <span class="hljs-comment">#only analyze the filtered samples</span><br>                          snp.id = colnames(genotype)) <span class="hljs-comment">#only analyze the filtered SNPs</span><br>snpset.pca &lt;- unlist(snpSVB, use.names = <span class="hljs-literal">FALSE</span>)<br>cat(<span class="hljs-built_in">length</span>(snpset.pca),<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## SNP pruning based on LD:</span><br><span class="hljs-comment">## Excluding 204,583 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 656,890</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     sliding window: 500,000 basepairs, Inf SNPs</span><br><span class="hljs-comment">##     |LD| threshold: 0.2</span><br><span class="hljs-comment">##     method: composite</span><br><span class="hljs-comment">## Chromosome 1: 8.21%, 5,834/71,038</span><br><span class="hljs-comment">## Chromosome 3: 8.14%, 4,933/60,565</span><br><span class="hljs-comment">## Chromosome 6: 8.03%, 4,350/54,176</span><br><span class="hljs-comment">## Chromosome 12: 8.57%, 3,609/42,124</span><br><span class="hljs-comment">## Chromosome 21: 9.44%, 1,177/12,463</span><br><span class="hljs-comment">## Chromosome 2: 7.68%, 5,658/73,717</span><br><span class="hljs-comment">## Chromosome 4: 8.24%, 4,590/55,675</span><br><span class="hljs-comment">## Chromosome 7: 8.45%, 3,922/46,391</span><br><span class="hljs-comment">## Chromosome 11: 7.88%, 3,485/44,213</span><br><span class="hljs-comment">## Chromosome 10: 7.96%, 3,817/47,930</span><br><span class="hljs-comment">## Chromosome 8: 7.67%, 3,704/48,299</span><br><span class="hljs-comment">## Chromosome 5: 8.06%, 4,526/56,178</span><br><span class="hljs-comment">## Chromosome 14: 8.78%, 2,464/28,054</span><br><span class="hljs-comment">## Chromosome 9: 8.20%, 3,370/41,110</span><br><span class="hljs-comment">## Chromosome 17: 11.12%, 2,217/19,939</span><br><span class="hljs-comment">## Chromosome 13: 8.34%, 2,857/34,262</span><br><span class="hljs-comment">## Chromosome 20: 9.38%, 2,135/22,753</span><br><span class="hljs-comment">## Chromosome 15: 9.20%, 2,384/25,900</span><br><span class="hljs-comment">## Chromosome 16: 9.13%, 2,519/27,591</span><br><span class="hljs-comment">## Chromosome 18: 8.97%, 2,353/26,231</span><br><span class="hljs-comment">## Chromosome 19: 12.97%, 1,489/11,482</span><br><span class="hljs-comment">## Chromosome 22: 11.18%, 1,272/11,382</span><br><span class="hljs-comment">## 72,665 markers are selected in total.</span><br>cat(<span class="hljs-built_in">length</span>(snpset.pca),<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">## 72665</span><br>pca &lt;- snpgdsPCA(genofile, sample.id = geno.sample.ids, snp.id = snpset.pca, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## Principal Component Analysis (PCA) on genotypes:</span><br><span class="hljs-comment">## Excluding 788,808 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 72,665</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     # of principal components: 32</span><br><span class="hljs-comment">## PCA:    the sum of all selected genotypes (0,1,2) = 32694833</span><br><span class="hljs-comment">## CPU capabilities: Double-Precision SSE2</span><br><span class="hljs-comment">## Tue Sep 14 13:32:27 2021    (internal increment: 252)</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 43s </span><br><span class="hljs-comment">## Tue Sep 14 13:33:10 2021    Begin (eigenvalues and eigenvectors)</span><br><span class="hljs-comment">## Tue Sep 14 13:33:11 2021    Done.</span><br><br><span class="hljs-comment"># find and record first 10 principal components</span><br><span class="hljs-comment"># pcs will be a N:10 matrix </span><br><span class="hljs-comment"># each column is a principal component</span><br>pcs &lt;- data.frame(FamID = pca$sample.id, pca$eigenvect[,<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],<br>                  stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br>colnames(pcs)[<span class="hljs-number">2</span>:<span class="hljs-number">11</span>] &lt;- paste(<span class="hljs-string">&quot;pc&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">10</span>,sep = <span class="hljs-string">&quot;&quot;</span>)<br>print(head(pcs))<br><span class="hljs-comment">##   FamID          pc1           pc2          pc3           pc4           pc5           pc6           pc7          pc8</span><br><span class="hljs-comment">## 1 10002  0.008136946  0.0102555005  0.004035296 -0.0067555328  0.0290486205 -0.0158332357 -0.0368010948  0.007497037</span><br><span class="hljs-comment">## 2 10004 -0.011771047 -0.0080186632  0.004526211  0.0137606581 -0.0005964856  0.0322921253 -0.0004926945 -0.001072583</span><br><span class="hljs-comment">## 3 10005 -0.016963522 -0.0051956716 -0.013847881  0.0112937916 -0.0330688171 -0.0326298549 -0.0113624994 -0.001566384</span><br><span class="hljs-comment">## 4 10007 -0.010673757  0.0037745524  0.004574423 -0.0015019307 -0.0127123211 -0.0007371223 -0.0048545424 -0.013640426</span><br><span class="hljs-comment">## 5 10008 -0.016487939  0.0012844871 -0.019463117 -0.0051653724  0.0074000952 -0.0024935274  0.0022416080  0.041584582</span><br><span class="hljs-comment">## 6 10009 -0.014734448  0.0007935566 -0.017633485 -0.0005575061 -0.0547999107 -0.0288053889 -0.0075189053  0.016484556</span><br><span class="hljs-comment">##            pc9          pc10</span><br><span class="hljs-comment">## 1 -0.006501613  0.0003016164</span><br><span class="hljs-comment">## 2  0.034174191 -0.0185128130</span><br><span class="hljs-comment">## 3  0.005833437 -0.0020015591</span><br><span class="hljs-comment">## 4 -0.015690254 -0.0190696938</span><br><span class="hljs-comment">## 5  0.027821854 -0.0104951963</span><br><span class="hljs-comment">## 6  0.028223932 -0.0144727186</span><br><br></code></pre></td></tr></table></figure><h4 id="非类型基因型的归因-imputation-of-non‐typed-genotypes"><a href="#非类型基因型的归因-imputation-of-non‐typed-genotypes" class="headerlink" title="非类型基因型的归因 imputation of non‐typed genotypes"></a>非类型基因型的归因 imputation of non‐typed genotypes</h4><p>Imputing non‐typed single nucleotide polymorphisms using 1000 Genomes data </p><p>使用芯片阵列技术测量的类型SNPs通常捕获了大约100万个多态性，这些多态性在一般人群中至少有1%的变化。更为普遍的是，由于功能（因果）变体可能没有被测量到，所以人们对分析非类型SNPs的基因型与疾病结果的关联感兴趣。利用广泛的关于参考单倍型及其LD结构的外部资源，如HapMap和1000基因组数据，我们可以估算出未测量的基因型数据。三个精心描述并推荐的用于SNP水平归因的独立软件包是IMPUTE2、MACH和BEAGLE。归入的基因型可以报告为 “最佳猜测 “的基因型，或报告为基因组上某一位置的每个基因型的后验概率。重要的是，这种估计过程中的不确定性需要在关联分析中加以考虑，因此，我们从此区分了基因型和估算的数据。后面的步骤8中描述了专门考虑归入的SNP数据的不确定性的方法。</p><p>在归纳之后，要进行质量控制步骤，以过滤具有高度不确定性的归纳数据。常见的不确定性的衡量标准是信息含量和$R^2$ 。我们将$R^2$ 的阈值定为0.7，以纳入关联分析，在这种情况下，$R^2$ 是将每个归入的SNP回归到区域类型的SNP的线性模型的关联值。这在snpStats软件包的文档中有进一步描述。此外，我们在这个阶段排除了MAF（分配最高后验概率基因型后）小于0.01的SNPs。为了说明问题，我们使用R软件包snpStats中的snp.imputation()和impute.snps()函数，对同一染色体（16号染色体）上的1000个基因组SNP的有限集合进行归因，这些SNP在GWA关联分析（步骤7）中被确定为全基因组显著的基因分型。在实践中，通常在所有的染色体上进行归因，从而产生多达1250万个分型和归因的SNPs，可以对其进行关联分析。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#-step6-</span><br><span class="hljs-comment">#genotype imputation</span><br><br><span class="hljs-comment">#-step6a-</span><br><span class="hljs-comment">#read in 1000g data for given chromosome 16</span><br>thougeno &lt;- read.pedfile(onethou.fn$ped, snps = onethou.fn$info, which = <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># obtain genotype data for given chromosome</span><br>genoMatrix &lt;- thougeno$genotypes<br><br><span class="hljs-comment"># obtain the chromosome position for each SNP</span><br>support &lt;- thougeno$map<br>colnames(support) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;A1&quot;</span>, <span class="hljs-string">&quot;A2&quot;</span>)<br>head(support)<br><span class="hljs-comment">##           SNP position A1 A2</span><br><span class="hljs-comment">## 1 rs140769322    60180  3  2</span><br><span class="hljs-comment">## 2 rs188810967    60288  2  1</span><br><span class="hljs-comment">## 3  rs76368850    60291  2  4</span><br><span class="hljs-comment">## 4 rs185537431    60778  3  1</span><br><span class="hljs-comment">## 5 rs542544747    60842  2  1</span><br><span class="hljs-comment">## 6   rs4021615    61349  1  3</span><br><br><span class="hljs-comment">#imputation of non-typed 1000g SNPs</span><br>presSnps &lt;- colnames(genotype)<br><br><span class="hljs-comment">#subset for SNPs on given chromosome</span><br>presDatChr &lt;- genobim[genobim$SNP %in% presSnps &amp; genobim$chr==<span class="hljs-number">16</span>, ]<br>targetSnps &lt;- presDatChr$SNP<br><br><span class="hljs-comment">#subset 1000g data for our SNPs</span><br><span class="hljs-comment">#&quot;missing&quot; and &quot;present&quot; are snpMatrix objects needed for imputation rules</span><br>is.present &lt;- colnames(genoMatrix) %in% targetSnps<br>missing &lt;- genoMatrix[,!is.present]<br>print(<span class="hljs-built_in">missing</span>)<br><span class="hljs-comment">## A SnpMatrix with  99 rows and  377819 columns</span><br><span class="hljs-comment">## Row names:  CEU_1 ... CEU_99 </span><br><span class="hljs-comment">## Col names:  rs140769322 ... rs111706106 </span><br><br>present &lt;- genoMatrix[,is.present]<br>print(present)<br><span class="hljs-comment">## A SnpMatrix with  99 rows and  20632 columns</span><br><span class="hljs-comment">## Row names:  CEU_1 ... CEU_99 </span><br><span class="hljs-comment">## Col names:  rs41340949 ... rs4785775</span><br><br><span class="hljs-comment">#obtain position of SNPs to be used for imputation rules</span><br>pos.pres &lt;- support$position[is.present]<br>pos.mis &lt;- support$position[!is.present]<br><br><span class="hljs-comment">#calculate and store imputation rules using snp.imputation()</span><br>rules &lt;- snp.imputation(present, <span class="hljs-built_in">missing</span>, pos.pres, pos.mis)<br><span class="hljs-comment">## SNPs tagged by a single SNP: 82119</span><br><span class="hljs-comment">## SNPs tagged by multiple tag haplotypes (saturated model): 115769</span><br></code></pre></td></tr></table></figure><p>然后去掉failed imputation，输入相关不确定度高的SNPs，并且输入低估计MAF的SNPs。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step6b-</span><br><span class="hljs-comment">#remove failed imputations</span><br>rules &lt;- rules[can.impute(rules)]<br>cat(<span class="hljs-string">&quot;imputation rules for&quot;</span>, <span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;SNPs were estimated\n&quot;</span>) <br><span class="hljs-comment">## imputation rules for 197888 SNPs were estimated</span><br><br><span class="hljs-comment">#quality control for imputation certainty and MAF</span><br><span class="hljs-comment">#set thresholds</span><br>r2threshold &lt;- 0.7<br>minor &lt;- 0.01<br><br><span class="hljs-comment">#filter on imputation certainty and MAF</span><br>rules &lt;- rules[imputation.r2(rules) &gt;= <span class="hljs-number">0.7</span>]<br>cat(<span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;imputation rules remain after uncertain imputation were removed\n&quot;</span>)<br><span class="hljs-comment">## 162565 imputation rules remain after uncertain imputation were removed</span><br><br>rules &lt;- rules[imputation.maf(rules) &gt;= <span class="hljs-number">0.01</span>]<br>cat(<span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;imputation rules remain after MAF filtering\n&quot;</span>)<br><span class="hljs-comment">## 162565 imputation rules remain after MAF filtering</span><br><br><span class="hljs-comment">#obtain posterior expectation of genotypes of imputed snps</span><br>target &lt;- genotype[,targetSnps]<br>imputed &lt;- impute.snps(rules, target, <span class="hljs-built_in">as.numeric</span> = <span class="hljs-literal">FALSE</span>)<br>print(imputed)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  162565 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs560777354;rs80001234 ... rs62053708 </span><br></code></pre></td></tr></table></figure><p>这一步的分析结果：在16号染色体上的162565个基因组设定的SNPs被带到步骤8中进行关联分析。</p><p>需要强调的是，在关联分析（association analysis）的背景下，需要考虑归属的不确定性（the uncertainty in imputation），因此这些SNPs与下一步中分析的类型SNPs是分开考虑的。</p><h3 id="全基因组关联分析-Genome-wide-association-analysis"><a href="#全基因组关联分析-Genome-wide-association-analysis" class="headerlink" title="全基因组关联分析 Genome-wide association analysis"></a>全基因组关联分析 Genome-wide association analysis</h3><h4 id="类型SNP的关联分析-association-analysis-of-typed-SNPs"><a href="#类型SNP的关联分析-association-analysis-of-typed-SNPs" class="headerlink" title="类型SNP的关联分析 association analysis of typed SNPs"></a>类型SNP的关联分析 association analysis of typed SNPs</h4><p>关联分析通常涉及将每个SNP单独回归到一个给定的性状上，并根据病人层面的临床、人口和环境因素进行调整。假设每个SNP的基础遗传模型（如显性、隐性或加性）将影响结果；然而，由于大量的SNP和与结果的关系通常不确定，通常会选择一个单一的加性模型。在这种情况下，如所提供的代码所示，每个SNP被表示为相应的小等位基因数（0、1或2）。</p><p>值得注意的是，基于替代模型（如显性或隐性）的SNP变量的编码是直接的，所描述的关联分析也是如此。在实践中，Bonferonni校正的全基因组显著性阈值为 $5×10^{-8}$，用于控制家族性的错误率。这个临界值是基于研究，表明整个基因组大约有100万个独立的SNPs，所以不管调查中实际的 typed 或 imputed 的SNPs数量如何，都要应用。</p><p>在我们的数据例子中，我们使用反正态转换的高密度脂蛋白胆固醇作为响应，调整了年龄、性别和前10个PC。高密度脂蛋白胆固醇是一个与心血管疾病相关的复杂特征，年龄和性别是其既定的风险因素。这两个协变量和任意选择的10个PC是心血管疾病性状关联研究的惯例。重要的是，在任何模型拟合过程中，必须评估模型假设的适当性，特别是所研究性状的正态性。对高密度脂蛋白胆固醇直方图的目视检查显示了一些极端值，因此，选择了反正态转换。其他转换，如对数转换，也可能是合理的，并具有保持观测值之间相对距离的优势。我们在本教程中不强调这一点，因为可以应用标准的统计建模实践。下面的代码为分析准备了表型数据。</p><blockquote><p>本教程需要GenABEL包，但该包已被从CRAN上移除，故只能使用下载压缩包然后本地安装的方法。</p><p>步骤如下：</p><ol><li><p>在terminal中</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -O https://cran.r-project.org/src/contrib/Archive/GenABEL/GenABEL_1.8-0.tar.gz<br>curl -O https://cran.r-project.org/src/contrib/Archive/GenABEL.data/GenABEL.data_1.0.0.tar.gz<br></code></pre></td></tr></table></figure></li><li><p>RStudio - Tools - Install Packages - Install from: Package Archive File</p></li></ol></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step7-</span><br><span class="hljs-comment">#association analysis of typed SNPs</span><br>library(GenABEL)<br><br><span class="hljs-comment">#-step7a-</span><br><span class="hljs-comment">#merge clinical data and principal components to create phenotype table</span><br>phenoSub &lt;- merge(clinical, pcs) <span class="hljs-comment"># data.frame =&gt; [FamID CAD sex age hdl pc1 pc2 ... pc10]</span><br><br><span class="hljs-comment">#we will do a rank-based inverse normal transformation of hdl</span><br>phenoSub$phenotype &lt;- rntransform(phenoSub$hdl, family = gaussian)<br><br><span class="hljs-comment">#show that the assumption of normality met after transformation</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))<br>hist(phenoSub$hdl, main=<span class="hljs-string">&quot;histogram of HDL&quot;</span>, xlab = <span class="hljs-string">&quot;HDL&quot;</span>)<br>hist(phenoSub$phenotype, main=<span class="hljs-string">&quot;histogram of tranformed HDL&quot;</span>, xlab = <span class="hljs-string">&quot;transformed HDL&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="hist.png" alt="hist"></p><blockquote><p>转换为了正态分布</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#remove unnecessary columns from table</span><br>phenoSub$hdl &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$ldl &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$tg &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$CAD &lt;- <span class="hljs-literal">NULL</span><br><br><span class="hljs-comment">#remove columns to match names necessary for GWAS() function</span><br>phenoSub &lt;- rename(phenoSub, replace = <span class="hljs-built_in">c</span>(FamID=<span class="hljs-string">&quot;id&quot;</span>))<br><br><span class="hljs-comment">#include only subjects with hdl data</span><br>phenoSub &lt;- phenoSub[!<span class="hljs-built_in">is.na</span>(phenoSub$phenotype),]<br><br>print(head(phenoSub))<br><span class="hljs-comment">##      id sex age         pc1           pc2          pc3           pc4           pc5           pc6           pc7</span><br><span class="hljs-comment">## 2 10004   2  50 -0.01177105 -0.0080186632  0.004526211  0.0137606581 -0.0005964856  0.0322921253 -0.0004926945</span><br><span class="hljs-comment">## 3 10005   1  55 -0.01696352 -0.0051956716 -0.013847881  0.0112937916 -0.0330688171 -0.0326298549 -0.0113624994</span><br><span class="hljs-comment">## 4 10007   1  52 -0.01067376  0.0037745524  0.004574423 -0.0015019307 -0.0127123211 -0.0007371223 -0.0048545424</span><br><span class="hljs-comment">## 5 10008   1  58 -0.01648794  0.0012844871 -0.019463117 -0.0051653724  0.0074000952 -0.0024935274  0.0022416080</span><br><span class="hljs-comment">## 6 10009   1  59 -0.01473445  0.0007935566 -0.017633485 -0.0005575061 -0.0547999107 -0.0288053889 -0.0075189053</span><br><span class="hljs-comment">## 7 10010   1  54 -0.01427468  0.0052373331 -0.014937383  0.0313489032  0.0104569709  0.0104441393 -0.0111072206</span><br><span class="hljs-comment">##            pc8          pc9         pc10  phenotype</span><br><span class="hljs-comment">## 2 -0.001072583  0.034174191 -0.018512813 -2.2877117</span><br><span class="hljs-comment">## 3 -0.001566384  0.005833437 -0.002001559 -0.4749316</span><br><span class="hljs-comment">## 4 -0.013640426 -0.015690254 -0.019069694  0.8855512</span><br><span class="hljs-comment">## 5  0.041584582  0.027821854 -0.010495196 -0.1644639</span><br><span class="hljs-comment">## 6  0.016484556  0.028223932 -0.014472719  0.3938940</span><br><span class="hljs-comment">## 7 -0.014092489 -0.020411854  0.017169084  1.7109552</span><br></code></pre></td></tr></table></figure><p>由于需要拟合的模型较多，建议并行运行GWA分析，即在几个核心中同时进行。每个核心对SNP的一个子集进行GWA分析，当所有核心的计算完成后，输出被返回到原来的顺序。</p><p>在接下来的文字中，我们描述了一种在MAC、Unix和Windows操作系统上并行运行分析的跨平台方法。detectCores()函数可以用来确定可用的工作者数量。为了并行地运行分析，我们使用doParallel包中的dopar()函数，表示工作器的数量。doPar()的输出是一个ascii文本文件。这些都包含在我们开发的GWAA()函数中，可在本稿件的补充信息B中找到。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step7b-</span><br><span class="hljs-comment">#run GWAS analysis (using parallel processing)</span><br>library(plyr)<br>source(<span class="hljs-string">&quot;GWAA.R&quot;</span>)<br></code></pre></td></tr></table></figure><p>出现报错，显示无法加载函数。</p><p>解决方案：使用全局自定义函数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ---- gwaa ----</span><br><br><span class="hljs-comment"># Genome-wide Association Analysis</span><br><span class="hljs-comment"># Parallel implementation of linear model fitting on each SNP</span><br><br>GWAA &lt;- <span class="hljs-keyword">function</span>(genodata=genotypes,  phenodata=phenotypes, family = gaussian, filename=<span class="hljs-literal">NULL</span>,<br>                 append=<span class="hljs-literal">FALSE</span>, workers=getOption(<span class="hljs-string">&quot;mc.cores&quot;</span>,<span class="hljs-number">2L</span>), flip=<span class="hljs-literal">TRUE</span>,<br>                 select.snps=<span class="hljs-literal">NULL</span>, hosts=<span class="hljs-literal">NULL</span>, nSplits=<span class="hljs-number">10</span>)<br>&#123;<br>    <span class="hljs-keyword">if</span> (!require(doParallel)) &#123; stop(<span class="hljs-string">&quot;Missing doParallel package&quot;</span>) &#125;<br>    <br>    <span class="hljs-comment">#Check that a filename was specified</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">is.null</span>(filename)) stop(<span class="hljs-string">&quot;Must specify a filename for output.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that the genotype data is of class &#x27;SnpMatrix&#x27;</span><br>    <span class="hljs-keyword">if</span>( <span class="hljs-built_in">class</span>(genodata)!=<span class="hljs-string">&quot;SnpMatrix&quot;</span>) stop(<span class="hljs-string">&quot;Genotype data must of class &#x27;SnpMatrix&#x27;.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that there is a variable named &#x27;phenotype&#x27; in phenodata table</span><br>    <span class="hljs-keyword">if</span>( !<span class="hljs-string">&quot;phenotype&quot;</span> %in% colnames(phenodata))  stop(<span class="hljs-string">&quot;Phenotype data must have column named &#x27;phenotype&#x27;&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that there is a variable named &#x27;id&#x27; in phenodata table</span><br>    <span class="hljs-keyword">if</span>( !<span class="hljs-string">&quot;id&quot;</span> %in% colnames(phenodata)) stop(<span class="hljs-string">&quot;Phenotype data must have column named &#x27;id&#x27;.&quot;</span>)<br>    <br>    <span class="hljs-comment">#If a vector of SNPs is given, subset genotype data for these SNPs</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">is.null</span>(select.snps)) genodata&lt;-genodata[,which(colnames(genodata)%in%select.snps)]<br>    <br>    <span class="hljs-comment">#Check that there are still SNPs in &#x27;SnpMatrix&#x27; object</span><br>    <span class="hljs-keyword">if</span>(ncol(genodata)==<span class="hljs-number">0</span>) stop(<span class="hljs-string">&quot;There are no SNPs in the &#x27;SnpMatrix&#x27; object.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Print the number of SNPs to be checked</span><br>    cat(paste(ncol(genodata), <span class="hljs-string">&quot; SNPs included in analysis.\n&quot;</span>))<br>    <br>    <span class="hljs-comment">#If append=FALSE than we will overwrite file with column names</span><br>    <span class="hljs-keyword">if</span>(!isTRUE(append)) &#123;<br>        columns&lt;-<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;Estimate&quot;</span>, <span class="hljs-string">&quot;Std.Error&quot;</span>, <span class="hljs-string">&quot;t-value&quot;</span>, <span class="hljs-string">&quot;p-value&quot;</span>)<br>        write.table(t(columns), filename, row.names=<span class="hljs-literal">FALSE</span>, col.names=<span class="hljs-literal">FALSE</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-literal">FALSE</span>)<br>    &#125;<br><br>    <span class="hljs-comment"># Check sample counts</span><br>    <span class="hljs-keyword">if</span> (nrow(phenodata) != nrow(genodata)) &#123;<br>        warning(<span class="hljs-string">&quot;Number of samples mismatch.  Using subset found in phenodata.&quot;</span>)<br>    &#125;<br><br>    <span class="hljs-comment"># Order genodata rows to be the same as phenodata</span><br>    genodata &lt;- genodata[phenodata$id,]<br><br>    cat(nrow(genodata), <span class="hljs-string">&quot;samples included in analysis.\n&quot;</span>)<br><br>    <span class="hljs-comment"># Change which allele is counted (major or minor)</span><br>    flip.matrix&lt;-<span class="hljs-keyword">function</span>(x) &#123;<br>        zero2 &lt;- which(x==<span class="hljs-number">0</span>)<br>        two0 &lt;- which(x==<span class="hljs-number">2</span>)<br>        x[zero2] &lt;- <span class="hljs-number">2</span><br>        x[two0] &lt;- <span class="hljs-number">0</span><br>        <span class="hljs-built_in">return</span>(x)<br>    &#125;<br><br>    nSNPs &lt;- ncol(genodata)<br>    genosplit &lt;- <span class="hljs-built_in">ceiling</span>(nSNPs/nSplits) <span class="hljs-comment"># number of SNPs in each subset</span><br><br>    snp.start &lt;- seq(<span class="hljs-number">1</span>, nSNPs, genosplit) <span class="hljs-comment"># index of first SNP in group</span><br>    snp.stop &lt;- pmin(snp.start+genosplit-<span class="hljs-number">1</span>, nSNPs) <span class="hljs-comment"># index of last SNP in group</span><br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is.null</span>(hosts)) &#123;<br>        <span class="hljs-comment"># On Unix this will use fork and mclapply.  On Windows it</span><br>        <span class="hljs-comment"># will create multiple processes on localhost.</span><br>        cl &lt;- makeCluster(workers)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment"># The listed hosts must be accessible by the current user using</span><br>        <span class="hljs-comment"># password-less ssh with R installed on all hosts, all </span><br>        <span class="hljs-comment"># packages installed, and &quot;rscript&quot; is in the default PATH.</span><br>        <span class="hljs-comment"># See docs for makeCluster() for more information.</span><br>        cl &lt;- makeCluster(hosts, <span class="hljs-string">&quot;PSOCK&quot;</span>)<br>    &#125;<br>    show(cl)                            <span class="hljs-comment"># report number of workers and type of parallel implementation</span><br>    registerDoParallel(cl)<br><br>    foreach (part=<span class="hljs-number">1</span>:nSplits) %do% &#123;<br>        <span class="hljs-comment"># Returns a standar matrix of the alleles encoded as 0, 1 or 2</span><br>        genoNum &lt;- as(genodata[,snp.start[part]:snp.stop[part]], <span class="hljs-string">&quot;numeric&quot;</span>)<br><br>        <span class="hljs-comment"># Flip the numeric values of genotypes to count minor allele</span><br>        <span class="hljs-keyword">if</span> (isTRUE(flip)) genoNum &lt;- flip.matrix(genoNum)<br><br>        <span class="hljs-comment"># For each SNP, concatenate the genotype column to the</span><br>        <span class="hljs-comment"># phenodata and fit a generalized linear model</span><br>        rsVec &lt;- colnames(genoNum)<br>        res &lt;- foreach(snp.name=rsVec, .combine=<span class="hljs-string">&#x27;rbind&#x27;</span>) %dopar% &#123;<br>            a &lt;- summary(glm(phenotype~ . - id, family=family, data=cbind(phenodata, snp=genoNum[,snp.name])))<br>            a$coefficients[<span class="hljs-string">&#x27;snp&#x27;</span>,]<br>        &#125;<br><br>        <span class="hljs-comment"># write results so far to a file</span><br>        write.table(cbind(rsVec,res), filename, append=<span class="hljs-literal">TRUE</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-literal">FALSE</span>, col.names=<span class="hljs-literal">FALSE</span>, row.names=<span class="hljs-literal">FALSE</span>)<br><br>        cat(sprintf(<span class="hljs-string">&quot;GWAS SNPs %s-%s (%s%% finished)\n&quot;</span>, snp.start[part], snp.stop[part], <span class="hljs-number">100</span>*part/nSplits))<br>    &#125;<br><br>    stopCluster(cl)<br>  <br>    <span class="hljs-built_in">return</span>(print(<span class="hljs-string">&quot;Done.&quot;</span>))<br>&#125;<br><span class="hljs-comment">#自定义GWAA函数</span><br><br><span class="hljs-comment">#note: this function writes a file, but does not produce a r project</span><br>start &lt;- Sys.time()<br>GWAA(genodata=genotype, phenodata=phenoSub, filename=gwaa.fname)<br><span class="hljs-comment">## [1] &quot;Done.&quot;</span><br><span class="hljs-comment">## Warning message:</span><br><span class="hljs-comment">## In GWAA(genodata = genotype, phenodata = phenoSub, filename = gwaa.fname) :</span><br><span class="hljs-comment">##   Number of samples mismatch.  Using subset found in phenodata.</span><br><br>end &lt;- Sys.time()<br>print(end-start)<br><span class="hljs-comment">## Time difference of 2.043743 hours</span><br></code></pre></td></tr></table></figure><h4 id="归因数据的关联分析-association-analysis-of-imputed-data"><a href="#归因数据的关联分析-association-analysis-of-imputed-data" class="headerlink" title="归因数据的关联分析 association analysis of imputed data"></a>归因数据的关联分析 association analysis of imputed data</h4><p>应用snpStats使用相应的后验概率进行估算 SNPs 的关联分析</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step8-</span><br><span class="hljs-comment">#association analysis of imputed SNPs</span><br><br><span class="hljs-comment">#-step8a-</span><br><span class="hljs-comment">#carry out associate testing for imputed SNPs using snp.rhs.tests()</span><br>rownames(phenoSub) &lt;- phenoSub$id<br>imp &lt;- snp.rhs.tests(phenotype ~ sex + age + pc1 + pc2 + pc3 + pc4 + pc5 + pc6 + pc7 + pc8 + pc9 + pc10,<br>                     family = <span class="hljs-string">&quot;Gaussian&quot;</span>,<br>                     data = phenoSub,<br>                     snp.data = target,<br>                     rules = rules)<br><br><span class="hljs-comment">#obtain p values for imputed SNPs by calling methods on the returned GlmTests object</span><br>results &lt;- data.frame(SNP = imp@snp.names, p.value = p.value(imp), stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br>results &lt;- results[!<span class="hljs-built_in">is.na</span>(results$p.value),]<br><br><span class="hljs-comment">#write a file containing the results</span><br>write.csv(results, input.out.fname, row.names = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#merge imputation testing results with support to obtain coordinates</span><br>imputeOut &lt;- merge(results, support[, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>)])<br>imputeOut$chr &lt;- 16<br>imputeOut$type &lt;- <span class="hljs-string">&quot;imputed&quot;</span><br><br><span class="hljs-comment">#find the -log_10 of the p-value</span><br>imputeOut$Neg_logP &lt;- -log10(imputeOut$p.value)<br><br><span class="hljs-comment">#order by p-value</span><br>imputeOut &lt;- arrange(imputeOut, p.value)<br>print(head(imputeOut))<br><span class="hljs-comment">##          SNP      p.value position chr    type Neg_logP</span><br><span class="hljs-comment">## 1  rs1532624 1.036455e-07 57005479  16 imputed 6.984449</span><br><span class="hljs-comment">## 2  rs7205804 1.036455e-07 57004889  16 imputed 6.984449</span><br><span class="hljs-comment">## 3 rs12446515 1.746000e-07 56987015  16 imputed 6.757956</span><br><span class="hljs-comment">## 4 rs17231506 1.746000e-07 56994528  16 imputed 6.757956</span><br><span class="hljs-comment">## 5   rs173539 1.746000e-07 56988044  16 imputed 6.757956</span><br><span class="hljs-comment">## 6   rs183130 1.746000e-07 56991363  16 imputed 6.757956</span><br></code></pre></td></tr></table></figure><p>现在，我们在16号染色体上总共确定了22个推算的SNPs，这些SNPs在 $5×10^{-6}$ 的暗示性关联阈值下是显著的。</p><p>接下来，我们只选择CETP区域内（±5Kb）的SNPs进行报告。在此，我们使用自开发的map2gene()函数，，它可以确定属于指定基因区域的SNPs集合。这个函数使用基于基因组参考联盟GRCh37（hg19）的基因坐标，在文件ProCodgene_coords.csv中提供。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step8b-</span><br><span class="hljs-comment"># ---- map2gene ----</span><br><span class="hljs-comment"># Returns the subset of SNPs that are within extend.boundary of gene</span><br><span class="hljs-comment"># using the coords table of gene locations.</span><br>map2gene &lt;- <span class="hljs-keyword">function</span>(gene, coords, SNPs, extend.boundary = <span class="hljs-number">5000</span>) &#123;<br>  coordsSub &lt;- coords[coords$gene == gene,] <span class="hljs-comment">#Subset coordinate file for spcified gene</span><br>  <br>  coordsSub$start &lt;- coordsSub$start - extend.boundary <span class="hljs-comment"># Extend gene boundaries</span><br>  coordsSub$stop &lt;- coordsSub$stop + extend.boundary<br>  <br>  SNPsub &lt;- SNPs[SNPs$position &gt;= coordsSub$start &amp; SNPs$position &lt;= coordsSub$stop &amp;<br>                   SNPs$chr == coordsSub$chr,] <span class="hljs-comment">#Subset for SNPs in gene</span><br>  <br>  <span class="hljs-built_in">return</span>(data.frame(SNPsub, gene = gene, stringsAsFactors = <span class="hljs-literal">FALSE</span>))<br>&#125;<br><br><span class="hljs-comment">#read in file containing protein coding genes coords</span><br>genes &lt;- read.csv(protein.coding.coords.fnamo, stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#subset for CETP SNPs</span><br>impCETP &lt;- map2gene(<span class="hljs-string">&quot;CETP&quot;</span>, coords = genes, SNPs = imputeOut)<br><br><span class="hljs-comment">#filter only the imputed CETP SNP genotypes</span><br>impCETPgeno &lt;- imputed[,impCETP$SNP]<br></code></pre></td></tr></table></figure><p>在这个阶段，我们将70个归纳的SNPs映射到CETP区域，其中16个在 $5×10^{-6}$ 的提示性关联阈值上是显著的。</p><h3 id="Post‐analytic-visualization-and-genomic-interrogation-后分析可视化和基因组审查"><a href="#Post‐analytic-visualization-and-genomic-interrogation-后分析可视化和基因组审查" class="headerlink" title="Post‐analytic visualization and genomic interrogation 后分析可视化和基因组审查"></a>Post‐analytic visualization and genomic interrogation 后分析可视化和基因组审查</h3><h4 id="归因和类型SNP结果的整合-integration-of-imputed-and-typed-SNP-results"><a href="#归因和类型SNP结果的整合-integration-of-imputed-and-typed-SNP-results" class="headerlink" title="归因和类型SNP结果的整合 integration of imputed and typed SNP results"></a>归因和类型SNP结果的整合 integration of imputed and typed SNP results</h4><p>在这个阶段，将SNPs归属到基因座上并报告染色体和碱基对的位置，也被称为坐标或位置，也是很常见的。</p><p>值得注意的是，SNP的坐标取决于基因组的构建，在我们的数据例子中，我们使用基因组参考联盟GRCh37（hg19）构建。典型的结果展示包括基因和基因座名称；SNP名称；染色体编号；碱基对位置，根据指定的构建；来自模型拟合程序的系数估计（或赔率）；相应的标准误差；和相关的P值。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#-step9-</span><br><span class="hljs-comment">#data integration</span><br><br><span class="hljs-comment">#-step9a-</span><br><span class="hljs-comment">#read in GWAS output that was produced by GWAA function</span><br>GWASout &lt;- read.table(gwaa.fname, header = <span class="hljs-literal">TRUE</span>, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>, <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br><br><span class="hljs-comment">#find the -log_10 of the p-value</span><br>GWASout$Neg_logP &lt;- -log10(GWASout$p.value)<br><br><span class="hljs-comment">#merge output with genobim by SNP name to add position and chromosome number</span><br>GWASout &lt;- merge(GWASout, genobim[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>,<span class="hljs-string">&quot;chr&quot;</span>,<span class="hljs-string">&quot;position&quot;</span>)])<br><br><span class="hljs-comment">#order SNPs by significance</span><br>GWASout &lt;- arrange(GWASout, -Neg_logP)<br>print(head(GWASout))<br><span class="hljs-comment">##          SNP   Estimate  Std.Error   t.value      p.value Neg_logP chr  position</span><br><span class="hljs-comment">## 1  rs1532625  0.2015758 0.03748045  5.378159 8.944627e-08 7.048438  16  57005301</span><br><span class="hljs-comment">## 2   rs247617  0.2100771 0.03979461  5.279034 1.524209e-07 6.816955  16  56990716</span><br><span class="hljs-comment">## 3 rs10945761  0.1868139 0.04087883  4.569942 5.344253e-06 5.272113   6 162065367</span><br><span class="hljs-comment">## 4  rs9647610  0.1840277 0.04066594  4.525353 6.586987e-06 5.181313   6 162066421</span><br><span class="hljs-comment">## 5  rs3803768 -0.3048526 0.06755966 -4.512346 6.993775e-06 5.155288  17  80872028</span><br><span class="hljs-comment">## 6  rs4821708 -0.1808045 0.04018791 -4.498978 7.456555e-06 5.127462  22  38164106</span><br></code></pre></td></tr></table></figure><p>现在还需要一个额外的步骤来结合估算的数据结果和类型的SNP结果。值得注意的是，基因型推算可以涉及推算所有的SNPs，包括未观察到的和已分型的SNPs。因此，分析者可以选择从归因结果中只选择未分型或未通过SNP级过滤的SNP。在我们的例子中（第6步），我们归集了未分型的SNP以及未通过SNP水平过滤的SNP（第2和第4步）。然后，这个组合中的GWA重要SNPs可以进一步可视化，并按照步骤10的描述进行询问。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step9b-</span><br><span class="hljs-comment">#combine typed and imputed</span><br>GWASout$type &lt;- <span class="hljs-string">&quot;typed&quot;</span><br><br>GWAScomb &lt;- rbind.fill(GWASout, imputeOut)<br>head(GWAScomb)<br><span class="hljs-comment">##          SNP   Estimate  Std.Error   t.value      p.value Neg_logP chr  position  type</span><br><span class="hljs-comment">## 1  rs1532625  0.2015758 0.03748045  5.378159 8.944627e-08 7.048438  16  57005301 typed</span><br><span class="hljs-comment">## 2   rs247617  0.2100771 0.03979461  5.279034 1.524209e-07 6.816955  16  56990716 typed</span><br><span class="hljs-comment">## 3 rs10945761  0.1868139 0.04087883  4.569942 5.344253e-06 5.272113   6 162065367 typed</span><br><span class="hljs-comment">## 4  rs9647610  0.1840277 0.04066594  4.525353 6.586987e-06 5.181313   6 162066421 typed</span><br><span class="hljs-comment">## 5  rs3803768 -0.3048526 0.06755966 -4.512346 6.993775e-06 5.155288  17  80872028 typed</span><br><span class="hljs-comment">## 6  rs4821708 -0.1808045 0.04018791 -4.498978 7.456555e-06 5.127462  22  38164106 typed</span><br><br>tail(GWAScomb)<br><span class="hljs-comment">##              SNP Estimate Std.Error t.value   p.value     Neg_logP chr position    type</span><br><span class="hljs-comment">## 818527 rs7201255       NA        NA      NA 0.9999695 1.325135e-05  16 53869223 imputed</span><br><span class="hljs-comment">## 818528 rs7203572       NA        NA      NA 0.9999695 1.325135e-05  16 53869366 imputed</span><br><span class="hljs-comment">## 818529  rs257500       NA        NA      NA 0.9999870 5.647027e-06  16 64971479 imputed</span><br><span class="hljs-comment">## 818530  rs369139       NA        NA      NA 0.9999870 5.647027e-06  16 64968347 imputed</span><br><span class="hljs-comment">## 818531   rs40327       NA        NA      NA 0.9999870 5.647027e-06  16 64978301 imputed</span><br><span class="hljs-comment">## 818532  rs466296       NA        NA      NA 0.9999870 5.647027e-06  16 64962442 imputed</span><br><br><span class="hljs-comment">#subset for CETP SNPs</span><br>typCETP &lt;- map2gene(<span class="hljs-string">&quot;CETP&quot;</span>, coords = genes, SNPs = GWASout)<br><br><span class="hljs-comment">#combine CETP SNPs from imputed and typed analysis</span><br>CETP &lt;- rbind.fill(typCETP, impCETP)[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;p.value&quot;</span>, <span class="hljs-string">&quot;Neg_logP&quot;</span>, <span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>, <span class="hljs-string">&quot;gene&quot;</span>)]<br>print(CETP)<br><span class="hljs-comment">##            SNP      p.value   Neg_logP chr position    type gene</span><br><span class="hljs-comment">## 1    rs1532625 8.944627e-08 7.04843778  16 57005301   typed CETP</span><br><span class="hljs-comment">## 2     rs289742 4.257667e-04 3.37082835  16 57017762   typed CETP</span><br><span class="hljs-comment">## 3     rs289715 4.740815e-03 2.32414700  16 57008508   typed CETP</span><br><span class="hljs-comment">## 4    rs6499863 1.394646e-02 1.85553612  16 56992017   typed CETP</span><br><span class="hljs-comment">## 5    rs4783962 1.011933e-01 0.99484809  16 56995038   typed CETP</span><br><span class="hljs-comment">## 6    rs1800777 1.083617e-01 0.96512430  16 57017319   typed CETP</span><br><span class="hljs-comment">## 7   rs12708980 6.331485e-01 0.19849440  16 57012379   typed CETP</span><br><span class="hljs-comment">## 8    rs1532624 1.036455e-07 6.98444942  16 57005479 imputed CETP</span><br><span class="hljs-comment">## 9    rs7205804 1.036455e-07 6.98444942  16 57004889 imputed CETP</span><br><span class="hljs-comment">## 10  rs17231506 1.746000e-07 6.75795566  16 56994528 imputed CETP</span><br><span class="hljs-comment">## 11    rs183130 1.746000e-07 6.75795566  16 56991363 imputed CETP</span><br><span class="hljs-comment">## 12   rs3764261 1.746000e-07 6.75795566  16 56993324 imputed CETP</span><br><span class="hljs-comment">## 13    rs821840 1.746000e-07 6.75795566  16 56993886 imputed CETP</span><br><span class="hljs-comment">## 14  rs11508026 1.174797e-06 5.93003733  16 56999328 imputed CETP</span><br><span class="hljs-comment">## 15  rs12444012 1.174797e-06 5.93003733  16 57001438 imputed CETP</span><br><span class="hljs-comment">## 16  rs12720926 1.174797e-06 5.93003733  16 56998918 imputed CETP</span><br><span class="hljs-comment">## 17   rs4784741 1.174797e-06 5.93003733  16 57001216 imputed CETP</span><br><span class="hljs-comment">## 18  rs34620476 1.177972e-06 5.92886509  16 56996649 imputed CETP</span><br><span class="hljs-comment">## 19    rs708272 1.177972e-06 5.92886509  16 56996288 imputed CETP</span><br><span class="hljs-comment">## 20    rs711752 1.177972e-06 5.92886509  16 56996211 imputed CETP</span><br><span class="hljs-comment">## 21  rs12720922 3.392213e-06 5.46951693  16 57000885 imputed CETP</span><br><span class="hljs-comment">## 22   rs8045855 3.392213e-06 5.46951693  16 57000696 imputed CETP</span><br><span class="hljs-comment">## 23  rs12149545 3.692106e-06 5.43272585  16 56993161 imputed CETP</span><br><span class="hljs-comment">## 24   rs1800775 1.423952e-05 4.84650452  16 56995236 imputed CETP</span><br><span class="hljs-comment">## 25   rs3816117 1.423952e-05 4.84650452  16 56996158 imputed CETP</span><br><span class="hljs-comment">## 26  rs11076175 1.431416e-05 4.84423402  16 57006378 imputed CETP</span><br><span class="hljs-comment">## 27   rs7499892 1.431416e-05 4.84423402  16 57006590 imputed CETP</span><br><span class="hljs-comment">## 28  rs11076176 1.100766e-04 3.95830512  16 57007446 imputed CETP</span><br><span class="hljs-comment">## 29    rs289714 1.123948e-04 3.94925380  16 57007451 imputed CETP</span><br><span class="hljs-comment">## 30    rs158478 1.958087e-04 3.70816791  16 57007734 imputed CETP</span><br><span class="hljs-comment">## 31   rs9939224 3.075278e-04 3.51211557  16 57002732 imputed CETP</span><br><span class="hljs-comment">## 32  rs12447620 4.344681e-04 3.36204212  16 57014319 imputed CETP</span><br><span class="hljs-comment">## 33    rs158480 4.344681e-04 3.36204212  16 57008227 imputed CETP</span><br><span class="hljs-comment">## 34    rs158617 4.344681e-04 3.36204212  16 57008287 imputed CETP</span><br><span class="hljs-comment">## 35  rs11076174 4.293928e-03 2.36714525  16 57003146 imputed CETP</span><br><span class="hljs-comment">## 36 rs112039804 4.742793e-03 2.32396582  16 57018856 imputed CETP</span><br><span class="hljs-comment">## 37  rs12708985 4.742793e-03 2.32396582  16 57014610 imputed CETP</span><br><span class="hljs-comment">## 38    rs736274 4.742793e-03 2.32396582  16 57009769 imputed CETP</span><br><span class="hljs-comment">## 39 rs201825234 1.403181e-02 1.85288617  16 56991948 imputed CETP</span><br><span class="hljs-comment">## 40   rs2115429 1.403181e-02 1.85288617  16 56992842 imputed CETP</span><br><span class="hljs-comment">## 41   rs6499861 1.403181e-02 1.85288617  16 56991495 imputed CETP</span><br><span class="hljs-comment">## 42   rs6499862 1.403181e-02 1.85288617  16 56991524 imputed CETP</span><br><span class="hljs-comment">## 43    rs158479 1.764815e-02 1.75330083  16 57008048 imputed CETP</span><br><span class="hljs-comment">## 44    rs289713 1.848673e-02 1.73313993  16 57006829 imputed CETP</span><br><span class="hljs-comment">## 45  rs12720918 2.690313e-02 1.57019722  16 56994212 imputed CETP</span><br><span class="hljs-comment">## 46  rs12920974 2.690313e-02 1.57019722  16 56993025 imputed CETP</span><br><span class="hljs-comment">## 47  rs36229787 3.284685e-02 1.48350624  16 56993897 imputed CETP</span><br><span class="hljs-comment">## 48    rs289712 4.630073e-02 1.33441214  16 57006305 imputed CETP</span><br><span class="hljs-comment">## 49    rs820299 5.313036e-02 1.27465724  16 57000284 imputed CETP</span><br><span class="hljs-comment">## 50  rs34946873 5.924969e-02 1.22731392  16 56991143 imputed CETP</span><br><span class="hljs-comment">## 51  rs12597002 6.482442e-02 1.18826138  16 57002404 imputed CETP</span><br><span class="hljs-comment">## 52  rs60545348 6.482442e-02 1.18826138  16 57001985 imputed CETP</span><br><span class="hljs-comment">## 53    rs708273 6.482442e-02 1.18826138  16 56999949 imputed CETP</span><br><span class="hljs-comment">## 54   rs4369653 6.674449e-02 1.17558455  16 56997551 imputed CETP</span><br><span class="hljs-comment">## 55   rs4587963 7.720580e-02 1.11235007  16 56997369 imputed CETP</span><br><span class="hljs-comment">## 56      rs5880 8.144506e-02 1.08913528  16 57015091 imputed CETP</span><br><span class="hljs-comment">## 57   rs1800776 9.403016e-02 1.02673283  16 56995234 imputed CETP</span><br><span class="hljs-comment">## 58    rs289746 9.558715e-02 1.01960051  16 57020205 imputed CETP</span><br><span class="hljs-comment">## 59  rs12447839 1.014589e-01 0.99370984  16 56993935 imputed CETP</span><br><span class="hljs-comment">## 60  rs12447924 1.014589e-01 0.99370984  16 56994192 imputed CETP</span><br><span class="hljs-comment">## 61    rs158477 1.602619e-01 0.79516962  16 57007610 imputed CETP</span><br><span class="hljs-comment">## 62  rs12708983 2.717574e-01 0.56581860  16 57014411 imputed CETP</span><br><span class="hljs-comment">## 63  rs66495554 2.827752e-01 0.54855862  16 57018636 imputed CETP</span><br><span class="hljs-comment">## 64  rs12720889 2.857284e-01 0.54404657  16 57012563 imputed CETP</span><br><span class="hljs-comment">## 65  rs12934552 3.188555e-01 0.49640603  16 57021433 imputed CETP</span><br><span class="hljs-comment">## 66  rs12708968 3.476125e-01 0.45890456  16 56994819 imputed CETP</span><br><span class="hljs-comment">## 67  rs17245715 3.476125e-01 0.45890456  16 56994990 imputed CETP</span><br><span class="hljs-comment">## 68   rs4783961 4.661962e-01 0.33143130  16 56994894 imputed CETP</span><br><span class="hljs-comment">## 69  rs12598522 4.853361e-01 0.31395741  16 57022352 imputed CETP</span><br><span class="hljs-comment">## 70  rs56315364 4.853361e-01 0.31395741  16 57021524 imputed CETP</span><br><span class="hljs-comment">## 71 rs117427818 5.101389e-01 0.29231153  16 57010486 imputed CETP</span><br><span class="hljs-comment">## 72  rs11860407 5.935059e-01 0.22657493  16 57010828 imputed CETP</span><br><span class="hljs-comment">## 73   rs2033254 5.935059e-01 0.22657493  16 57009985 imputed CETP</span><br><span class="hljs-comment">## 74   rs7405284 6.134481e-01 0.21222214  16 57001275 imputed CETP</span><br><span class="hljs-comment">## 75   rs1800774 6.200971e-01 0.20754027  16 57015545 imputed CETP</span><br><span class="hljs-comment">## 76  rs36229786 6.227677e-01 0.20567392  16 56993901 imputed CETP</span><br><span class="hljs-comment">## 77  rs12708974 8.568509e-01 0.06709476  16 57005550 imputed CETP</span><br></code></pre></td></tr></table></figure><h4 id="关联结果的可视化和质量控制-visualization-and-quality-control-of-association-findings"><a href="#关联结果的可视化和质量控制-visualization-and-quality-control-of-association-findings" class="headerlink" title="关联结果的可视化和质量控制 visualization and quality control of association findings"></a>关联结果的可视化和质量控制 visualization and quality control of association findings</h4><p>这里描述了三种可视化工具。除了这些可视化方法，使用其他基因模型进行关联分析也是一个有用的敏感度分析。</p><h5 id="Manhattan-plots-曼哈顿图"><a href="#Manhattan-plots-曼哈顿图" class="headerlink" title="Manhattan plots 曼哈顿图"></a>Manhattan plots 曼哈顿图</h5><p>曼哈顿图被用来按染色体位置直观地显示GWA的显著性水平。在曼哈顿图中，每个点对应于一个SNP。X轴代表基因坐标，显示的数字对应于染色体编号。y轴是对数p值的负值，所以大的值对应小的p值。实心横线表示Bonferonni校正的显著性阈值（$- log(5 × 10^{-8})$）。</p><p>虚线是一个不太严格的暗示性关联阈值（$- log(5 × 10^{-6})$），我们将其作为暗示性关联的指标，需要进一步验证。</p><p>通过对该图的目视检查，可以识别出P值相对较小的SNP，这些SNP位于P值相对较大且不显著的区域，表明有可能是虚假的发现。CETP区域的多个信号表明，这可能是一个真实的信号。该图是用我们开发的GWAS_Manhattan()生成的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10-</span><br><span class="hljs-comment">#visualizing and QC of GWA findings</span><br><span class="hljs-comment"># ---- manhattan ----</span><br><span class="hljs-comment"># Receives a data.frame of SNPs with Neg_logP, chr, position, and type.</span><br><span class="hljs-comment"># Plots Manhattan plot with significant SNPs highlighted.</span><br>GWAS_Manhattan &lt;- <span class="hljs-keyword">function</span>(GWAS, col.snps=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;black&quot;</span>,<span class="hljs-string">&quot;gray&quot;</span>),<br>                           col.detected=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;black&quot;</span>), col.imputed=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;blue&quot;</span>), col.text=<span class="hljs-string">&quot;black&quot;</span>,<br>                           title=<span class="hljs-string">&quot;GWAS Tutorial Manhattan Plot&quot;</span>, display.text=<span class="hljs-literal">TRUE</span>,<br>                           bonferroni.alpha=<span class="hljs-number">0.05</span>, bonferroni.adjustment=<span class="hljs-number">1000000</span>,<br>                           Lstringent.adjustment=<span class="hljs-number">10000</span>) &#123;<br>  <br>  bonferroni.thresh &lt;- -log10(bonferroni.alpha / bonferroni.adjustment)<br>  Lstringent.thresh &lt;- -log10(bonferroni.alpha / Lstringent.adjustment)<br>  xscale &lt;- 1000000<br>  <br>  manhat &lt;- GWAS[!grepl(<span class="hljs-string">&quot;[A-z]&quot;</span>,GWAS$chr),]<br>  <br>  <span class="hljs-comment">#sort the data by chromosome and then location</span><br>  manhat.ord &lt;- manhat[order(<span class="hljs-built_in">as.numeric</span>(manhat$chr),manhat$position),]<br>  manhat.ord &lt;- manhat.ord[!<span class="hljs-built_in">is.na</span>(manhat.ord$position),]<br>  <br>  <span class="hljs-comment">##Finding the maximum position for each chromosome</span><br>  max.pos &lt;- sapply(<span class="hljs-number">1</span>:<span class="hljs-number">21</span>, <span class="hljs-keyword">function</span>(i) &#123; <span class="hljs-built_in">max</span>(manhat.ord$position[manhat.ord$chr==i],<span class="hljs-number">0</span>) &#125;)<br>  max.pos2 &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">cumsum</span>(max.pos))                  <br>  <br>  <span class="hljs-comment">#Add spacing between chromosomes</span><br>  max.pos2 &lt;- max.pos2 + <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>:<span class="hljs-number">21</span>) * xscale * <span class="hljs-number">10</span><br>  <br>  <span class="hljs-comment">#defining the positions of each snp in the plot</span><br>  manhat.ord$pos &lt;- manhat.ord$position + max.pos2[<span class="hljs-built_in">as.numeric</span>(manhat.ord$chr)]<br>  <br>  <span class="hljs-comment"># alternate coloring of chromosomes</span><br>  manhat.ord$col &lt;- col.snps[<span class="hljs-number">1</span> + <span class="hljs-built_in">as.numeric</span>(manhat.ord$chr) %% <span class="hljs-number">2</span>]<br>  <br>  <span class="hljs-comment"># draw the chromosome label roughly in the middle of each chromosome band</span><br>  text.pos &lt;- sapply(<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>:<span class="hljs-number">22</span>), <span class="hljs-keyword">function</span>(i) &#123; mean(manhat.ord$pos[manhat.ord$chr==i]) &#125;)<br>  <br>  <span class="hljs-comment"># Plot the data</span><br>  plot(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>],<br>       pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.3</span>, col= manhat.ord$col[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>], xlab=<span class="hljs-literal">NA</span>,<br>       ylab=<span class="hljs-string">&quot;Negative Log P-value&quot;</span>, axes=<span class="hljs-built_in">F</span>, ylim=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">max</span>(manhat$Neg_logP)+<span class="hljs-number">1</span>))<br>  <span class="hljs-comment">#Add x-label so that it is close to axis</span><br>  mtext(side = <span class="hljs-number">1</span>, <span class="hljs-string">&quot;Chromosome&quot;</span>, line = <span class="hljs-number">1.25</span>)<br>  <br>  points(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;imputed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;imputed&quot;</span>],<br>         pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.4</span>, col = col.imputed)<br>  <br>  points(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>],<br>         pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.3</span>, col = manhat.ord$col[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>])<br>  <br>  axis(<span class="hljs-number">2</span>)<br>  abline(h=<span class="hljs-number">0</span>)<br>  <br>  SigNifSNPs &lt;- <span class="hljs-built_in">as.character</span>(GWAS[GWAS$Neg_logP &gt; Lstringent.thresh &amp; GWAS$type==<span class="hljs-string">&quot;typed&quot;</span>, <span class="hljs-string">&quot;SNP&quot;</span>])<br>  <br>  <span class="hljs-comment">#Add legend</span><br>  legend(<span class="hljs-string">&quot;topright&quot;</span>,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;Bonferroni corrected threshold (p = 5E-8)&quot;</span>, <span class="hljs-string">&quot;Candidate threshold (p = 5E-6)&quot;</span>),<br>         border=<span class="hljs-string">&quot;black&quot;</span>, col=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;gray60&quot;</span>, <span class="hljs-string">&quot;gray60&quot;</span>), pch=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), lwd=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<br>         lty=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>), pt.cex=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), bty=<span class="hljs-string">&quot;o&quot;</span>, cex=<span class="hljs-number">0.6</span>)<br>  <br>  <span class="hljs-comment">#Add chromosome number</span><br>  text(text.pos/xscale, -<span class="hljs-number">.3</span>, seq(<span class="hljs-number">1</span>,<span class="hljs-number">22</span>,by=<span class="hljs-number">1</span>), xpd=<span class="hljs-literal">TRUE</span>, cex=<span class="hljs-number">.8</span>)<br>  <br>  <span class="hljs-comment">#Add bonferroni line</span><br>  abline(h=bonferroni.thresh, untf = <span class="hljs-literal">FALSE</span>, col = <span class="hljs-string">&quot;gray60&quot;</span>)<br>  <br>  <span class="hljs-comment">#Add &quot;less stringent&quot; line</span><br>  abline(h=Lstringent.thresh, untf = <span class="hljs-literal">FALSE</span>, col = <span class="hljs-string">&quot;gray60&quot;</span>, lty = <span class="hljs-number">2</span> )<br>  <br>  <span class="hljs-comment">#Plotting detected genes</span><br>  <span class="hljs-comment">#Were any genes detected?</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">length</span>(SigNifSNPs)&gt;<span class="hljs-number">0</span>)&#123;<br>    <br>    sig.snps &lt;- manhat.ord[,<span class="hljs-string">&#x27;SNP&#x27;</span>] %in% SigNifSNPs<br>    <br>    points(manhat.ord$pos[sig.snps]/xscale,<br>           manhat.ord$Neg_logP[sig.snps],<br>           pch=<span class="hljs-number">20</span>,col=col.detected, bg=col.detected,cex=<span class="hljs-number">0.5</span>)<br>    <br>    text(manhat.ord$pos[sig.snps]/xscale,<br>         manhat.ord$Neg_logP[sig.snps],<br>         <span class="hljs-built_in">as.character</span>(manhat.ord[sig.snps,<span class="hljs-number">1</span>]), col=col.text, offset=<span class="hljs-number">1</span>, adj=-<span class="hljs-number">.1</span>, cex=<span class="hljs-number">.5</span>)<br>  &#125;<br>&#125;<br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<br><br><span class="hljs-comment">#-step10a-</span><br><span class="hljs-comment">#create manhattan plot</span><br>GWAS_Manhattan(GWAScomb)<br></code></pre></td></tr></table></figure><p><img src="manhattan_plot.png" alt="manhattan_plot"></p><h5 id="Q–Q-plots-and-the-λ‐statistic-QQ图和λ统计量"><a href="#Q–Q-plots-and-the-λ‐statistic-QQ图和λ统计量" class="headerlink" title="Q–Q plots and the λ‐statistic QQ图和λ统计量"></a>Q–Q plots and the <em>λ</em>‐statistic QQ图和λ统计量</h5><p>Q-Q图用于可视化SNP水平测试统计量的预期分布和观察分布之间的关系。在考虑了建模框架中人口亚结构的潜在混杂因素后，分布的尾部被拉近到y=x线。如果该图中的数据从y = x线上移或下移，那么我们将考虑可能的系统性偏差。最后，右上角尾部与y = x线的轻微偏差粗略地表明，数据中存在着某种形式的关联。</p><p>偏离这条路线的程度由λ统计量来正式衡量，其中接近1的数值表明对潜在的子结构进行了适当的调整。虽然在对PC进行调整后，λ得到了改善（从λ=1.014到λ=1.0032），但由于这个PennCATH样本来自一个相对同质的人群，所以没有观察到数值上的巨大差异。一般来说，目标是使λ值接近于1；λ&gt;1.2表明有分层，通常在这种情况下会包括额外的PC，在某些情况下，该研究会被排除在随后的荟萃分析中。计算一个考虑到样本量的标准化λ，在不同研究的数值对比中特别有用，以便纳入荟萃分析。我们应用以下代码为未调整和调整模型生成标准化的λ，结果是未调整和调整模型的λ分别为1.0108和1.000632。对于二元性状，可以应用标准化方法。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10b-</span><br><span class="hljs-comment">#return the GWAS using unadjusted model</span><br>phenoSub2 &lt;- phenoSub[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;phenotype&quot;</span>)] <span class="hljs-comment">#remove all extra fators, leave only phenotype</span><br><br>GWAA(genodata = genotype, phenodata = phenoSub2, filename = gwaa.unadj.fname)<br>GWASoutUnadj &lt;- read.table(gwaa.unadj.fname, head=<span class="hljs-literal">TRUE</span>, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>,<span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br><br><span class="hljs-comment">#create QQ plots for adjusted and unadjusted model outputs</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))<br>lambdaAdj &lt;- estlambda(GWASout$t.value^<span class="hljs-number">2</span>, plot = <span class="hljs-literal">TRUE</span>, method = <span class="hljs-string">&quot;median&quot;</span>)<br>lambdaUnadj &lt;- estlambda(GWASoutUnadj$t.value^<span class="hljs-number">2</span>, plot = <span class="hljs-literal">TRUE</span>, method = <span class="hljs-string">&quot;median&quot;</span>)<br>cat(sprintf(<span class="hljs-string">&quot;Unadjusted lambda: %s\nAdjusted lambda: %s\n&quot;</span>, lambdaUnadj$estimate, lambdaAdj$estimate))<br><span class="hljs-comment">## Unadjusted lambda: 1.01417377078806</span><br><span class="hljs-comment">## Adjusted lambda: 1.00056081659278</span><br><br><span class="hljs-comment">#-step10c-</span><br><span class="hljs-comment">#calculate standardized lambda</span><br>lambdaAdj_1000 &lt;- 1+(lambdaAdj$estimate-<span class="hljs-number">1</span>)/nrow(phenoSub)*<span class="hljs-number">1000</span><br>lambdaUnadj_1000 &lt;- 1+(lambdaUnadj$estimate-<span class="hljs-number">1</span>)/nrow(phenoSub)*<span class="hljs-number">1000</span><br>cat(sprintf(<span class="hljs-string">&quot;standardized unadjusted lambda: %s\nstandard adjusted lambda: %s\n&quot;</span>, lambdaUnadj_1000, lambdaAdj_1000))<br><span class="hljs-comment">## standardized unadjusted lambda: 1.0108279379588</span><br><span class="hljs-comment">## standard adjusted lambda: 1.0004284313161</span><br></code></pre></td></tr></table></figure><p><img src="qqplot.png" alt="qqplot"></p><h5 id="Heatmaps-and-regional-association-plots-热图和区域关联图"><a href="#Heatmaps-and-regional-association-plots-热图和区域关联图" class="headerlink" title="Heatmaps and regional association plots 热图和区域关联图"></a>Heatmaps and regional association plots 热图和区域关联图</h5><p>热图和区域关联图通常在GWA分析的背景下使用，以可视化GWA显著SNPs和附近区域SNPs之间的LD模式，LD通常用 $r^2$ 或 $D′$ 来衡量，它们都是标量D的转化，定义为两个主要等位基因的联合概率与两个边际概率的乘积之间的差异，其中调整是基于等位基因频率。</p><p>阴影的程度表示LD的数量，因此较深的方块表示较高的LD。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10d-</span><br>install.packages(<span class="hljs-string">&quot;LDheatmap&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;rtracklayer&quot;</span>)<br><br><span class="hljs-comment">#add &quot;rs247671&quot; to CETP</span><br>CETP &lt;- rbind.fill(GWASout[GWASout$SNP == <span class="hljs-string">&quot;rs247617&quot;</span>,],CETP)<br><br><span class="hljs-comment">#combine genotype and imputed genotypes for CETP region</span><br>subgen &lt;- cbind(genotype[,colnames(genotype) %in% CETP$SNP], impCETPgeno) <span class="hljs-comment">#CETP subsets from typed and imputed SNPs</span><br><br><span class="hljs-comment">#subset SNPs for only certain genptypes</span><br>certain &lt;- apply(as(subgen,<span class="hljs-string">&#x27;numeric&#x27;</span>), <span class="hljs-number">2</span>, <span class="hljs-keyword">function</span>(x) &#123;<span class="hljs-built_in">all</span>(x %in% <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-literal">NA</span>))&#125;)<br>subgen &lt;- subgen[,certain]<br><br><span class="hljs-comment">#subset and order CETP SNPs by position</span><br>CETP &lt;- CETP[CETP$SNP %in% colnames(subgen),]<br>CETP &lt;- arrange(CETP, position)<br>subgen &lt;- subgen[, order(match(colnames(subgen),CETP$SNP)) ]<br><br><span class="hljs-comment"># Create LDheatmap</span><br>ld &lt;- ld(subgen, subgen, stats=<span class="hljs-string">&quot;R.squared&quot;</span>) <span class="hljs-comment"># Find LD map of CETP SNPs</span><br><br>ll &lt;- LDheatmap(ld, CETP$position, flip=<span class="hljs-literal">TRUE</span>, name=<span class="hljs-string">&quot;myLDgrob&quot;</span>, title=<span class="hljs-literal">NULL</span>)<br><br><span class="hljs-comment"># Add genes, recombination</span><br>llplusgenes &lt;- LDheatmap.addGenes(ll, chr = <span class="hljs-string">&quot;chr16&quot;</span>, genome = <span class="hljs-string">&quot;hg19&quot;</span>, genesLocation = <span class="hljs-number">0.01</span>)<br><br><span class="hljs-comment"># Add plot of -log(p)</span><br>library(ggplot2)<br>library(grid)<br><br>plot.new()<br>llQplot2&lt;-LDheatmap.addGrob(llplusgenes, rectGrob(gp = gpar(col = <span class="hljs-string">&quot;white&quot;</span>)),height = <span class="hljs-number">.34</span>)<br>pushViewport(viewport(x = <span class="hljs-number">0.483</span>, y= <span class="hljs-number">0.76</span>, width = <span class="hljs-number">.91</span> ,height = <span class="hljs-number">.4</span>))<br></code></pre></td></tr></table></figure><p><img src="ldheatmap.png" alt="ldheatmap"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.draw(ggplotGrob(&#123;<br>  qplot(position, Neg_logP, data = CETP, xlab=<span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;Negative Log P-value&quot;</span>, xlim = <span class="hljs-built_in">range</span>(CETP$position),<br>        asp = <span class="hljs-number">1</span>/<span class="hljs-number">10</span>, color = factor(type), colour=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;#000000&quot;</span>, <span class="hljs-string">&quot;#D55E00&quot;</span>)) + <br>    theme(axis.text.x = element_blank(),<br>          axis.title.y = element_text(size = rel(<span class="hljs-number">0.75</span>)), legend.position = <span class="hljs-string">&quot;none&quot;</span>, <br>          panel.background = element_blank(), <br>          axis.line = element_line(colour = <span class="hljs-string">&quot;black&quot;</span>)) +<br>    scale_color_manual(values = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;red&quot;</span>, <span class="hljs-string">&quot;black&quot;</span>))<br>&#125;))<br></code></pre></td></tr></table></figure><p><img src="ldheatmap_new.png" alt="ldheatmap_new"></p><h5 id="使用外部资源的额外数据查询Additional-data-interrogation-using-external-resources"><a href="#使用外部资源的额外数据查询Additional-data-interrogation-using-external-resources" class="headerlink" title="使用外部资源的额外数据查询Additional data interrogation using external resources"></a>使用外部资源的额外数据查询Additional data interrogation using external resources</h5><p>如果能提供研究结果的背景，报告SNP级别的关联分析结果会更有意义。例如，研究者可能想知道一个有统计学意义的SNP是否在一个蛋白质编码基因内、基因间、或接近与被调查疾病相关的特定组织或细胞类型中的调控元素（如甲基化标记）。</p><p>可能相关的外部数据类型见下表。</p><p>这些数据分为八大类，大致按照代表从DNA信息到调节到表达的过程的顺序。</p><ol><li>SNP；</li><li>基因元件；</li><li>染色质状态；</li><li>表观遗传标记；</li><li>转录因子结合；</li><li>RNA表达；</li><li>SNP-mRNA关联；</li><li>其他组学数据。</li></ol><p>我们强调，这个表格并不全面，而是提供了一个可利用的大量外部数据资源的一瞥。与列出的每个类别相关的数据都有广泛的来源。UCSC基因组浏览器提供了一套精心设计的综合生物信息学工具和数据库，包括许多来自补充信息C，表1中所列的资源，可以进一步审视GWA的结果。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># -step10d-</span><br><span class="hljs-comment"># Create regional association plot</span><br><span class="hljs-comment"># Create data.frame of most significant SNP only</span><br>install.packages(<span class="hljs-string">&quot;coin&quot;</span>)<br>install.packages(<span class="hljs-string">&quot;~/postgwas_1.11.tar.gz&quot;</span>, repos = <span class="hljs-literal">NULL</span>, type = <span class="hljs-string">&quot;source&quot;</span>)<br>library(postgwas)<br><br>snps&lt;-data.frame(SNP=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>))<br><br><span class="hljs-comment"># Change column names necessary to run regionalplot function</span><br>GWAScomb &lt;- rename(GWAScomb, <span class="hljs-built_in">c</span>(p.value=<span class="hljs-string">&quot;P&quot;</span>, chr=<span class="hljs-string">&quot;CHR&quot;</span>, position=<span class="hljs-string">&quot;BP&quot;</span>))<br><br><br><span class="hljs-comment"># Edit biomartConfigs so regionalplot function</span><br><span class="hljs-comment"># pulls from human genome build 37/hg19</span><br><br>myconfig &lt;- biomartConfigs$hsapiens<br>myconfig$hsapiens$gene$host &lt;- <span class="hljs-string">&quot;grch37.ensembl.org&quot;</span><br>myconfig$hsapiens$gene$mart &lt;- <span class="hljs-string">&quot;ENSEMBL_MART_ENSEMBL&quot;</span><br>myconfig$hsapiens$snp$host &lt;- <span class="hljs-string">&quot;grch37.ensembl.org&quot;</span><br>myconfig$hsapiens$snp$mart &lt;- <span class="hljs-string">&quot;ENSEMBL_MART_SNP&quot;</span><br><br><br><span class="hljs-comment"># Run regionalplot using HAPMAP data (pop = CEU)</span><br>regionalplot(snps, GWAScomb, biomart.config = myconfig, window.size = <span class="hljs-number">400000</span>, draw.snpname = data.frame(<br>  snps = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>, <span class="hljs-string">&quot;rs247617&quot;</span>), <br>  text = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>, <span class="hljs-string">&quot;rs247617&quot;</span>),<br>  angle = <span class="hljs-built_in">c</span>(<span class="hljs-number">20</span>, <span class="hljs-number">160</span>),<br>  <span class="hljs-built_in">length</span> = <span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), <br>  cex = <span class="hljs-built_in">c</span>(<span class="hljs-number">0.8</span>)<br>),<br>ld.options = <span class="hljs-built_in">list</span>(<br>  gts.source = <span class="hljs-number">2</span>, <br>  max.snps.per.window = <span class="hljs-number">2000</span>, <br>  rsquare.min = <span class="hljs-number">0.8</span>, <br>  show.rsquare.text = <span class="hljs-literal">FALSE</span><br>),<br>out.format = <span class="hljs-built_in">list</span>(file = <span class="hljs-literal">NULL</span>, panels.per.page = <span class="hljs-number">2</span>))<br><span class="hljs-comment">## Reading GWAS datasets ...</span><br><span class="hljs-comment">## PLINK format detected</span><br><span class="hljs-comment">## Assembling regions...</span><br><span class="hljs-comment">## Initializing biomart connection (SNPs)...</span><br><span class="hljs-comment">## Error in bmRequest(request = request, verbose = verbose) : </span><br><span class="hljs-comment">##   Not Found (HTTP 404).</span><br><span class="hljs-comment"># 尚未解决</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2021/09/16/hello-world/"/>
    <url>/2021/09/16/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序-V5-step2:Post GEM-RT Cleanup</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2/</url>
    
    <content type="html"><![CDATA[<h1 id="10×单细胞测序-V5-step2-Post-GEM-RT-Cleanup"><a href="#10×单细胞测序-V5-step2-Post-GEM-RT-Cleanup" class="headerlink" title="10×单细胞测序    V5-step2: Post GEM-RT Cleanup"></a>10×单细胞测序    V5-step2: Post GEM-RT Cleanup</h1><p><em>整理人：刘可钦</em></p><p><strong>pdf版</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2.pdf" width="100%" height="550" type="application/pdf"></div><br><h2 id="2-0-Post-GEM-RT-Cleanup"><a href="#2-0-Post-GEM-RT-Cleanup" class="headerlink" title="2.0 Post GEM-RT Cleanup"></a>2.0 Post GEM-RT Cleanup</h2><p>【试剂准备】</p><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>Additive A</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220074</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Dynabeads MyOne SILANE</td><td>实验台冰箱上层</td><td>室温放置</td><td>2000048</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>4℃存储</td></tr><tr><td>Buffer Sample Clean Up 1</td><td>-20℃冰箱下部中层试剂盒内</td><td>水浴加热至65℃</td><td>220020</td><td>在65℃水浴锅上温浴十分钟，确认无肉眼可见的结晶物，冷却至室温。</td><td>-20℃存储</td></tr><tr><td>Recovery Agent</td><td>实验台</td><td>室温放置</td><td>220016</td><td>/</td><td>室温存储</td></tr><tr><td>Qiagen Bugger EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>Bio-Rad 10% Tween 20</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配。</td><td>室温存储</td></tr></tbody></table><h2 id="2-1-Post-GEM-RT-Cleanup-Dynabeads"><a href="#2-1-Post-GEM-RT-Cleanup-Dynabeads" class="headerlink" title="2.1 Post GEM-RT Cleanup-Dynabeads"></a>2.1 Post GEM-RT Cleanup-Dynabeads</h2><ol><li><p>在室温下向每个样本中加入 125μl Recovery Agent，然后静置等待 2min。 </p><blockquote><p><strong>需要</strong>：用移液枪头沿管壁旋转并缓慢滴加。</p><p><strong>避免</strong>：震荡混匀或吹打混匀。</p><p><strong>正确操作后的样品外观</strong>：![截屏2021-09-01 下午12.56.24](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午12.56.24.png)</p><p><em>此时中可开始制备Dynabeads Cleanup Mix。</em></p></blockquote></li><li><p>用移液枪从底部缓慢吸除 125μl Recovery Agent。</p><blockquote><p><strong>注意</strong>：出现分层现象，上层为水状液体，下层为油状液体。</p><p><strong>需要</strong>：将移液枪枪头伸入PCR管底部。</p><p><strong>避免</strong>：吸入上层水状液体；使样品从PCR管内溢出。</p><p><strong>正确操作后的样品外观</strong>：![截屏2021-09-01 下午1.09.52](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午1.09.52.png)</p></blockquote></li><li><p>配置 Dynabeads Cleanup Mix</p><blockquote><table><thead><tr><th></th><th>Nuclease-free water</th><th>Buffer Sample Clean Up 1</th><th>Dynabeads MyOne SILANE</th><th>Additive A</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220020</td><td>2000048</td><td>220074</td><td>/</td></tr><tr><td>1x(μl)</td><td>5</td><td>182</td><td>8</td><td>5</td><td>200</td></tr><tr><td>2x(μl)</td><td>11</td><td>400.4</td><td>17.6</td><td>11</td><td>440</td></tr><tr><td>3x(μl)</td><td>16.5</td><td>600.6</td><td>16.4</td><td>16.5</td><td>660</td></tr><tr><td>4x(μl)</td><td>22</td><td>801</td><td>35</td><td>22</td><td>880</td></tr><tr><td>5x(μl)</td><td>27.5</td><td>1001</td><td>44</td><td>27.5</td><td>1100</td></tr><tr><td>6x(μl)</td><td>33</td><td>1201.2</td><td>52.8</td><td>33</td><td>1320</td></tr><tr><td>7x(μl)</td><td>38.5</td><td>1401.4</td><td>61.6</td><td>38.5</td><td>1540</td></tr><tr><td>8x(μl)</td><td>44</td><td>1602</td><td>70</td><td>44</td><td>1760</td></tr><tr><td>9x(μl)</td><td>49.5</td><td>1801.8</td><td>79.2</td><td>49.5</td><td>1980</td></tr><tr><td>10x(μl)</td><td>55</td><td>2002</td><td>88</td><td>55</td><td>2200</td></tr><tr><td>11x(μl)</td><td>60.5</td><td>2</td><td>96.8</td><td>60.5</td><td>1420</td></tr><tr><td>12x(μl)</td><td>66</td><td>2402.4</td><td>105.6</td><td>66</td><td>1640</td></tr></tbody></table></blockquote></li><li><p>将 Dynabeads Cleanup Mix 涡旋震荡，向每管样品中加入 200μl，用 200μl 移液枪吹打混匀 5 次。</p></li><li><p>在室温下静置 10min。</p><blockquote><p><strong>正确操作后的样品外观</strong>：![截屏2021-09-01 下午2.37.35](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午2.37.35.png)</p><p><em>此时可以开始制备Elution Solution I，并准备 80% 乙醇加样槽。可将适量 80% 乙醇倒入加样槽中，暂时不用时应将加样槽放在塑料袋中防止污染。</em></p></blockquote></li><li><p>配置 Elution Solution I。</p><blockquote><table><thead><tr><th></th><th>Buffer EB</th><th>10% Tween 20</th><th>Additive A</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>/</td><td>220074</td><td>/</td></tr><tr><td>1x(μl)</td><td>98</td><td>1</td><td>1</td><td>100</td></tr><tr><td>2x(μl)</td><td>196</td><td>2</td><td>2</td><td>200</td></tr><tr><td>3x(μl)</td><td>294</td><td>3</td><td>3</td><td>300</td></tr><tr><td>4x(μl)</td><td>392</td><td>4</td><td>4</td><td>400</td></tr><tr><td>5x(μl)</td><td>490</td><td>5</td><td>5</td><td>500</td></tr><tr><td>6x(μl)</td><td>588</td><td>6</td><td>6</td><td>600</td></tr><tr><td>7x(μl)</td><td>686</td><td>7</td><td>7</td><td>700</td></tr><tr><td>8x(μl)</td><td>784</td><td>8</td><td>8</td><td>800</td></tr><tr><td>9x(μl)</td><td>882</td><td>9</td><td>9</td><td>900</td></tr><tr><td>10x(μl)</td><td>980</td><td>10</td><td>10</td><td>1000</td></tr><tr><td>11x(μl)</td><td>1078</td><td>11</td><td>11</td><td>1100</td></tr><tr><td>12x(μl)</td><td>1176</td><td>12</td><td>12</td><td>1200</td></tr></tbody></table></blockquote></li><li><p>样品静置结束后，放置于 10× Magnetic Separator high 上，直到样本澄清。</p><blockquote><p><strong>需要</strong>：在 10× Magnetic Separator 上放置 2min，使 beads 充分吸附在管壁上。</p><p><strong>注意</strong>：PCR管内的水油分层是正常现象。</p></blockquote></li><li><p>将PCR管内的液体移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 300μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，然后敞开管盖，在空气中晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Elution Solution I，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl Elution Solution I。</p></li><li><p>移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>室温下静置 1min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 35μl 澄清液体，转移至新管。</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序	V5-step3:DNA Amplification &amp; QC</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3/</url>
    
    <content type="html"><![CDATA[<h1 id="10×单细胞测序-V5-step3-DNA-Amplification-amp-QC"><a href="#10×单细胞测序-V5-step3-DNA-Amplification-amp-QC" class="headerlink" title="10×单细胞测序    V5-step3:DNA Amplification &amp; QC"></a>10×单细胞测序    V5-step3:DNA Amplification &amp; QC</h1><p><em>整理人：刘可钦</em></p><h2 id="3-0-cDNA-Amplification-amp-QC"><a href="#3-0-cDNA-Amplification-amp-QC" class="headerlink" title="3.0 cDNA Amplification &amp; QC"></a>3.0 cDNA Amplification &amp; QC</h2><p>【试剂准备】</p><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>cDNA Additive</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220067</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>cDNA Primer Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td></td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Beckman Coulter SPRIselect Reagent</td><td>实验台</td><td>室温放置</td><td>/</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>室温存储</td></tr><tr><td>Amplification Master Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220125</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Equalbit dsDNA HS Assay Kit</td><td>实验台冰箱上层</td><td>室温放置</td><td>/</td><td>现用现配</td><td>4℃存储</td></tr><tr><td>Qiagen Bugger EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配。</td><td>室温存储</td></tr></tbody></table><p><strong>注意，标注测量浓度的试剂盒</strong></p><h2 id="3-1-cDNA-Amplification"><a href="#3-1-cDNA-Amplification" class="headerlink" title="3.1 cDNA Amplification"></a>3.1 cDNA Amplification</h2><ol><li><p>在冰上配置 cDNA Amplification mix，将 mix 涡旋震荡并快速离心。</p><blockquote><table><thead><tr><th></th><th>Nuclease-free water</th><th>Amplification Master Mix</th><th>cDNA Additive</th><th>cDNA Primer Mix</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220125</td><td>220067</td><td>220106</td><td>/</td></tr><tr><td>1x(μl)</td><td>8</td><td>50</td><td>5</td><td>2</td><td>65</td></tr><tr><td>2x(μl)</td><td>17.6</td><td>110</td><td>11</td><td>4.4</td><td>143</td></tr><tr><td>3x(μl)</td><td>26.4</td><td>165</td><td>16.5</td><td>6.6</td><td>214.5</td></tr><tr><td>4x(μl)</td><td>35</td><td>220</td><td>22</td><td>9</td><td>286</td></tr><tr><td>5x(μl)</td><td>44</td><td>275</td><td>27.5</td><td>11</td><td>357.5</td></tr><tr><td>6x(μl)</td><td>52.8</td><td>330</td><td>33</td><td>13.2</td><td>429</td></tr><tr><td>7x(μl)</td><td>58.8</td><td>385</td><td>38.5</td><td>14.7</td><td>497</td></tr><tr><td>8x(μl)</td><td>70</td><td>440</td><td>44</td><td>18</td><td>572</td></tr><tr><td>9x(μl)</td><td>75.6</td><td>495</td><td>49.5</td><td>18.9</td><td>643.5</td></tr><tr><td>10x(μl)</td><td>88</td><td>550</td><td>55</td><td>22</td><td>715</td></tr><tr><td>11x(μl)</td><td>96.8</td><td>605</td><td>60.5</td><td>24.2</td><td>786.5</td></tr><tr><td>12x(μl)</td><td>105.6</td><td>660</td><td>66</td><td>26.4</td><td>858</td></tr></tbody></table></blockquote></li><li><p>向每管样品（35μl）中加入 65μl 的 cDNA Amplification mix。</p></li><li><p>将移液枪量程调至 90μl，吹打混匀 5 次；然后快速离心。</p></li><li><p>在 PCR仪 上选择【10x5amp】程序，将样品放入 PCR仪，然后开始程序。</p><blockquote><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>105℃</td><td>100μl</td><td>25-50min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>1</td><td>98℃</td><td>00:00:40</td></tr><tr><td>2</td><td>98℃</td><td>00:00:20</td></tr><tr><td>3</td><td>67℃</td><td>00:00:30</td></tr><tr><td>4</td><td>72℃</td><td>00:01:00</td></tr><tr><td>5</td><td>go to step2, see table below for total # of cycles</td><td>/</td></tr><tr><td>6</td><td>72℃</td><td>00:01:00</td></tr><tr><td>7</td><td>4℃</td><td>hold</td></tr></tbody></table><p><strong>附注</strong>：【cycle数的选择】</p><table><thead><tr><th>Targeted Cell Recovery</th><th>Primary Cells Total Cycles</th><th>Cell Lines Total Cycles</th></tr></thead><tbody><tr><td>100-500</td><td>18</td><td>16</td></tr><tr><td>501-2000</td><td>16</td><td>14</td></tr><tr><td>2001-6000</td><td>14</td><td>12</td></tr><tr><td>6001-10000</td><td>13</td><td>11</td></tr></tbody></table><blockquote><p><strong>注意</strong>：tageted cell 一般为 PBMC，故 cycle 数一般设置为 14 ，即总 PCR 反应时长约为 34min。</p></blockquote><p>本步骤结束后可将样本储存于 4℃ 冰箱中，保存 72h，以待进行下一步实验。</p></blockquote></li></ol><h2 id="3-2-cDNA-Cleanup-SPRIselect"><a href="#3-2-cDNA-Cleanup-SPRIselect" class="headerlink" title="3.2 cDNA Cleanup-SPRIselect"></a>3.2 cDNA Cleanup-SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent &gt; 30s，使管内无块状沉淀，然后吸取 60μl SPRIselect Reagent(0.6x)，加入样本。再将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>样本在室温下静置 5min。</p><blockquote><p><em>此时可以开始准备 80% 乙醇加样槽。可将适量 80% 乙醇倒入加样槽中，暂时不用时应将加样槽放在塑料袋中防止污染。</em></p></blockquote></li><li><p>放在 10× Magnetic Separator high 上，直到样本澄清。</p><blockquote><p><strong>需要</strong>：在 10× Magnetic Separator high 上放置 2min，使 beads 充分吸附在管壁上。</p></blockquote></li><li><p>移除上清。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li></ol><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote><ol start="7"><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，然后敞开管盖，在空气中晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Elution Solution I，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 45.5μl Buffer EB。</p></li><li><p>移液枪量程调制 45μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>室温下静置 2min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品PCR管放在 10× Magnetic Separator high 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 45μl 澄清液体，转移至新管。</p></li><li><p>此后可将样本在 4℃ 冰箱中储存 72h，或在 -20℃ 冰箱中储存 7d，然后进行下一步操作。</p></li></ol><h2 id="3-3-cDNA-QC-amp-Quantification"><a href="#3-3-cDNA-QC-amp-Quantification" class="headerlink" title="3.3 cDNA QC &amp; Quantification"></a>3.3 cDNA QC &amp; Quantification</h2><p>【使用 Equalbit dsDNA HS Assay Kit 对样品进行浓度测定】</p><ol><li><p>按照 Equalbit Reagent 和 Equalbit Buffer 1:200 的比例配置工作液。</p></li><li><p>配置标准品：准备好标有“1”和“2”的 0.6ml EP 管，每管加入 190μl 工作液，然后分别吸取 10μl Equalbit Standard # 1 和 Equalbit Standard # 2，加入管中。</p></li><li><p>配置样品：准备好标有样品标签的 0.6ml EP 管，每管加入 199μl 工作液，然后分别吸取 1μl 样品溶液，加入管中。</p></li><li><p>将按照以上步骤配置的标准品和样品涡旋震荡，然后避光反应 2min。</p></li><li><p>通过 Qubit 荧光仪检测浓度。</p><blockquote><p><em>将每个样品的浓度记录在试验台的实验记录本上，作为 V5 step 6 的参考。</em> </p></blockquote></li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序 V5-step6:5‘ Gene Expression（GEX）Library Construction</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6/</url>
    
    <content type="html"><![CDATA[<h1 id="10×单细胞测序-V5-step6-5‘-Gene-Expression（GEX）Library-Construction"><a href="#10×单细胞测序-V5-step6-5‘-Gene-Expression（GEX）Library-Construction" class="headerlink" title="10×单细胞测序    V5-step6:5‘ Gene Expression（GEX）Library Construction"></a>10×单细胞测序    V5-step6:5‘ Gene Expression（GEX）Library Construction</h1><p><em>整理人：刘可钦</em></p><h2 id="6-0-5‘-Gene-Expression（GEX）Library-Construction"><a href="#6-0-5‘-Gene-Expression（GEX）Library-Construction" class="headerlink" title="6.0 5‘ Gene Expression（GEX）Library Construction"></a>6.0 5‘ Gene Expression（GEX）Library Construction</h2><p>【试剂准备】</p><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>Fragmentation Bufffer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220108</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Adaptor Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220026</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Ligation Buffer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220109</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>SI-PCR Primer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220111</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Chromium i7 Sample Index Plate</td><td>实验台冰箱下层</td><td>室温放置</td><td>220103</td><td>解冻</td><td>-20℃存储</td></tr><tr><td>Equalbit dsDNA HS Assay Kit</td><td>实验台冰箱上层</td><td>室温放置</td><td>/</td><td>现用现配</td><td>4℃存储</td></tr><tr><td>Beckman Coulter SPRIselect Reagent</td><td>实验台</td><td>室温放置</td><td>/</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>室温存储</td></tr><tr><td>Fragmentation Enzyme Blend</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220107 /220130</td><td>快速离心</td><td>-20℃存储</td></tr><tr><td>DNA Ligase</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220110 /220131</td><td>快速离心</td><td>-20℃存储</td></tr><tr><td>Amplification Master Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220125</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Qiagen Buffer EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配</td><td>室温存储</td></tr></tbody></table><h2 id="6-1-GEX-Fragmentation-End-Repair-amp-A-tailing"><a href="#6-1-GEX-Fragmentation-End-Repair-amp-A-tailing" class="headerlink" title="6.1 GEX Fragmentation, End Repair &amp; A-tailing"></a>6.1 GEX Fragmentation, End Repair &amp; A-tailing</h2><ol><li><p>将样品和写好标签的新PCR管放置在冰上。根据【3.3】测量得到的样品浓度，计算相应样品体积，使吸取的样品达到 50ng，然后将吸取的样品转移到新管内，并用 nuclease-free water 将其补足至 20μl。</p><p> 如果样品不足 50ng，则吸取 20μl 样品用于 library construction。</p><blockquote><p>此时可将 PCR仪 开始预冷。</p></blockquote></li><li><p>按照如下程序设置 PCR仪。</p><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>65℃</td><td>50μl</td><td>~35min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>Pre-cool block</td><td>4℃</td><td>Hold</td></tr><tr><td>Fragmentation</td><td>32℃</td><td>00:05:00</td></tr><tr><td>End Repair &amp; A-tailing</td><td>65℃</td><td>00:30:00</td></tr><tr><td>Hold</td><td>4℃</td><td>Hold</td></tr></tbody></table><blockquote><p>此程序名为【10xPRA】</p></blockquote></li><li><p>涡旋震荡 Fragmentation Bufffer，确认无沉淀。</p></li><li><p>在冰上配置 Fragmentation Mix，用移液枪吹打混匀，并快速离心。</p><table><thead><tr><th></th><th>Nuclease-free Water</th><th>Fragmentation Bufffer</th><th>Fragmentation Enzyme Blend</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220108</td><td>220107 / 220130</td><td>/</td></tr><tr><td>1x(μl)</td><td>15</td><td>5</td><td>10</td><td>30</td></tr><tr><td>2x(μl)</td><td>33</td><td>11</td><td>22</td><td>66</td></tr><tr><td>3x(μl)</td><td>49.5</td><td>16.5</td><td>33</td><td>99</td></tr><tr><td>4x(μl)</td><td>66</td><td>22</td><td>44</td><td>132</td></tr><tr><td>5x(μl)</td><td>82.5</td><td>27.5</td><td>55</td><td>165</td></tr><tr><td>6x(μl)</td><td>99</td><td>33</td><td>66</td><td>198</td></tr><tr><td>7x(μl)</td><td>110.25</td><td>36.75</td><td>73.5</td><td>231</td></tr><tr><td>8x(μl)</td><td>126</td><td>42</td><td>84</td><td>264</td></tr><tr><td>9x(μl)</td><td>141.75</td><td>47.25</td><td>94.5</td><td>297</td></tr><tr><td>10x(μl)</td><td>165</td><td>55</td><td>110</td><td>330</td></tr><tr><td>11x(μl)</td><td>181.5</td><td>60.5</td><td>121</td><td>363</td></tr><tr><td>12x(μl)</td><td>198</td><td>66</td><td>132</td><td>396</td></tr></tbody></table></li><li><p>向每个 20μl 的样本中加入 30μl Fragmentation Mix。</p></li><li><p>将移液枪的量程调至 30μl，然后吹打混匀 15 次，快速离心。</p></li><li><p>将样本放入预冷的 PCR仪 中（4℃），然后按下“skip”开始 PCR 程序。</p></li></ol><h2 id="6-2-GEX-Post-Fragmentation-End-Repair-amp-A-tailing-Double-Sided-Size-Selection-SPRIselect"><a href="#6-2-GEX-Post-Fragmentation-End-Repair-amp-A-tailing-Double-Sided-Size-Selection-SPRIselect" class="headerlink" title="6.2 GEX Post Fragmentation, End Repair &amp; A-tailing Double Sided Size Selection - SPRIselect"></a>6.2 GEX Post Fragmentation, End Repair &amp; A-tailing Double Sided Size Selection - SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 30μl 0.6x SPRIselect Reagent，然后将移液枪量程调至 75μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>从每管中吸取 75μl 澄清液体，转移至新管。</p></li><li><p>向每管样品加入 10μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 75μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 125μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 125μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，但不要使 beads 过干。</p><blockquote><p><strong>需要</strong>：（若样品量较多）应立刻加入50.5μl Buffer EB，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 50.5μl Buffer EB。移液枪量程调制 50μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator high 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 50μl 澄清液体，转移至新管。</p></li></ol><h2 id="6-3-GEX-Adaptor-Ligation"><a href="#6-3-GEX-Adaptor-Ligation" class="headerlink" title="6.3 GEX Adaptor Ligation"></a>6.3 GEX Adaptor Ligation</h2><ol><li><p>配置 Adaptor Ligation Mix，用移液枪吹打混匀，并快速离心。</p><table><thead><tr><th></th><th>Nuclease-free Water</th><th>Ligation Buffer</th><th>DNA ligase</th><th>Adaptor Mix</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220109</td><td>220110 / 220131</td><td>220026</td><td>/</td></tr><tr><td>1x(μl)</td><td>17.5</td><td>20</td><td>10</td><td>2.5</td><td>50</td></tr><tr><td>2x(μl)</td><td>38.5</td><td>44</td><td>22</td><td>5.5</td><td>110</td></tr><tr><td>3x(μl)</td><td>58</td><td>66</td><td>33</td><td>8</td><td>165</td></tr><tr><td>4x(μl)</td><td>77</td><td>88</td><td>44</td><td>11</td><td>220</td></tr><tr><td>5x(μl)</td><td>96.25</td><td>110</td><td>55</td><td>13.75</td><td>275</td></tr><tr><td>6x(μl)</td><td>116</td><td>132</td><td>66</td><td>16</td><td>330</td></tr><tr><td>7x(μl)</td><td>134.75</td><td>154</td><td>77</td><td>19.25</td><td>385</td></tr><tr><td>8x(μl)</td><td>154</td><td>176</td><td>88</td><td>22</td><td>440</td></tr><tr><td>9x(μl)</td><td>173.25</td><td>198</td><td>99</td><td>24.75</td><td>495</td></tr><tr><td>10x(μl)</td><td>192.5</td><td>220</td><td>110</td><td>27.5</td><td>550</td></tr><tr><td>11x(μl)</td><td>211.75</td><td>242</td><td>121</td><td>30.25</td><td>605</td></tr><tr><td>12x(μl)</td><td>224.4</td><td>264</td><td>132</td><td>33</td><td>660</td></tr></tbody></table><ol start="2"><li><p>向每个 50μl 的样本中加入 50μl Adaptor Ligation Mix，将移液枪量程调至 90μl，然后吹打混匀 15次，快速离心。</p></li><li><p>按照如下程序设置 PCR仪。</p><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>30℃</td><td>100μl</td><td>15min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>1</td><td>20℃</td><td>00:15:00</td></tr><tr><td>2</td><td>4℃</td><td>Hold</td></tr></tbody></table><blockquote><p>此程序名为【ada】</p></blockquote></li></ol></li></ol><h2 id="6-4-GEX-Post-Ligation-Cleanup-SPRIselect"><a href="#6-4-GEX-Post-Ligation-Cleanup-SPRIselect" class="headerlink" title="6.4 GEX Post Ligation Cleanup -SPRIselect"></a>6.4 GEX Post Ligation Cleanup -SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 80μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Buffer EB，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl Buffer EB。移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 30μl 澄清液体，转移至新管。</p></li></ol><h2 id="6-5-GEX-Sample-Index-PCR"><a href="#6-5-GEX-Sample-Index-PCR" class="headerlink" title="6.5 GEX Sample Index PCR"></a>6.5 GEX Sample Index PCR</h2><ol><li><p>为每个样本选择唯一一个确定的 sample index，不能出现同一个样本加入了两个不同的 sample index 的情况。</p></li><li><p>记录样本与 sample index 之间的对应情况。</p><blockquote><p><em>记录在实验台的实验记录本上，同时将样本与sample index之间的对应记录抄写在纸上，之后随样本一起放在塑封袋中。</em></p></blockquote></li><li><p>制备 Sample Index PCR Mix，吹打混匀并快速离心。</p><table><thead><tr><th></th><th>Nuclear-free Water</th><th>Amplification Master Mix</th><th>SI-PCR Primer</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220125</td><td>220111</td><td>/</td></tr><tr><td>1x(μl)</td><td>8</td><td>50</td><td>2</td><td>60</td></tr><tr><td>2x(μl)</td><td>17.6</td><td>110</td><td>9</td><td>264</td></tr><tr><td>3x(μl)</td><td>26.4</td><td>165</td><td>6.6</td><td>198</td></tr><tr><td>4x(μl)</td><td>35</td><td>220</td><td>9</td><td>264</td></tr><tr><td>5x(μl)</td><td>44</td><td>275</td><td>11</td><td>330</td></tr><tr><td>6x(μl)</td><td>52.8</td><td>330</td><td>13.2</td><td>396</td></tr><tr><td>7x(μl)</td><td>61.6</td><td>385</td><td>15.4</td><td>462</td></tr><tr><td>8x(μl)</td><td>70</td><td>440</td><td>18</td><td>528</td></tr><tr><td>9x(μl)</td><td>79.2</td><td>495</td><td>19.8</td><td>594</td></tr><tr><td>10x(μl)</td><td>88</td><td>550</td><td>22</td><td>660</td></tr><tr><td>11x(μl)</td><td>96.8</td><td>605</td><td>24.2</td><td>726</td></tr><tr><td>12x(μl)</td><td>105.6</td><td>660</td><td>26.4</td><td>792</td></tr></tbody></table></li><li><p>向每个 60μl 的样本中加入 30μl Sample Index PCR Mix。</p></li><li><p>向每个样本中加入 10μl 确定且唯一的 Chromium i7 Sample Index，将移液枪量程调至 90μl，然后吹打混匀 5次，快速离心。</p></li><li><p>按照如下程序设置 PCR仪。</p><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>105℃</td><td>100μl</td><td>~40min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>1</td><td>98℃</td><td>00:00:45</td></tr><tr><td>2</td><td>98℃</td><td>00:00:20</td></tr><tr><td>3</td><td>54℃</td><td>00:00:30</td></tr><tr><td>4</td><td>72℃</td><td>00:00:20</td></tr><tr><td>5</td><td>Go to step 2, see table below for # cycles</td><td>/</td></tr><tr><td>6</td><td>72℃</td><td>00:01:00</td></tr><tr><td>7</td><td>4℃</td><td>Hold</td></tr></tbody></table><blockquote><p><em>cycle数可按每管样品中含量计算</em></p><table><thead><tr><th>Input into Library Construction</th><th>Total Sample Index Cycles</th></tr></thead><tbody><tr><td>1-25 ng</td><td>16</td></tr><tr><td>26-50 ng</td><td>14</td></tr></tbody></table></blockquote></li><li><p>PCR 完成后，样本可储存在 4℃ 冰箱内 72h，然后进行下一步。</p></li></ol><h2 id="6-6-GEX-Post-Sample-Index-Double-Sided-Size-Selection-SPRIselect"><a href="#6-6-GEX-Post-Sample-Index-Double-Sided-Size-Selection-SPRIselect" class="headerlink" title="6.6 GEX Post Sample Index Double Sided Size Selection - SPRIselect"></a>6.6 GEX Post Sample Index Double Sided Size Selection - SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 60μl 0.6x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的 PCR 管和新的 0.6ml EP 管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>从每管中吸取 150μl 澄清液体，转移至新管。</p></li><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 20μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，但不要使 beads 过干。</p></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl EB。移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 35μl 澄清液体，转移至写好标签的 0.6ml EP 管。</p></li><li><p>样本可在 4℃ 冰箱里储存 72h，或放在 -20℃ 冰箱中长期储存。</p><blockquote><p>若要送测序，则放在实验台冰箱下层 -20℃ 暂存。</p></blockquote></li></ol><h2 id="6-7-GEX-Post-Library-Construction-QC"><a href="#6-7-GEX-Post-Library-Construction-QC" class="headerlink" title="6.7 GEX Post Library Construction QC"></a>6.7 GEX Post Library Construction QC</h2><p>【使用 Equalbit dsDNA HS Assay Kit 对样品进行浓度测定】</p><ol><li>按照 Equalbit Reagent 和 Equalbit Buffer 1:200 的比例配置工作液。</li><li>配置标准品：准备好标有“1”和“2”的 0.6ml EP 管，每管加入 190μl 工作液，然后分别吸取 10μl Equalbit Standard # 1 和 Equalbit Standard # 2，加入管中。</li><li>配置样品：准备好标有样品标签的 0.6ml EP 管，每管加入 199μl 工作液，然后分别吸取 1μl 样品溶液，加入管中。</li><li>将按照以上步骤配置的标准品和样品涡旋震荡，然后避光反应 2min。</li><li>通过 Qubit 荧光仪检测浓度。</li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes</title>
    <link href="/2021/09/03/20210903%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95Transcriptome-wide%20association%20study%20of%20coronary%20artery%20disease%20identifies%20novel%20susceptibility%20genes/"/>
    <url>/2021/09/03/20210903%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95Transcriptome-wide%20association%20study%20of%20coronary%20artery%20disease%20identifies%20novel%20susceptibility%20genes/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-9-3-文献阅读记录：Transcriptome-wide-association-study-of-coronary-artery-disease-identifies-novel-susceptibility-genes"><a href="#2021-9-3-文献阅读记录：Transcriptome-wide-association-study-of-coronary-artery-disease-identifies-novel-susceptibility-genes" class="headerlink" title="2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes"></a>2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes</h1><p>EpiXcan</p><p>Stockholm-Tartu Atherosclerosis Reverse Network Engineering Task (STARNET) </p><p>Genotype-Tissue Expression (GTEx)</p><p>Transcriptome-wide association studies (TWAS) </p><blockquote><p>【转录组全关联研究】</p><p>用于鉴定CAD（coronary artery disease）风险基因座</p><p>GWAS 已经有力地将成千上万个基因座与复杂性状联系起来。尽管取得了这样的成功，GWAS 基因座却常常难以解释: 连锁不平衡通常模糊了驱动这种联系的因果变异，而且从 GWAS 的数据中很难确定对性状起作用的因果基因。</p><p>而TWAS可以解决上述问题。它利用expression reference panels（具有表达和基因型数据的eQTL队列）从GWAS数据集中发现基因-性状关联。首先，通过使用基因附近（通常在500千字节或1兆字节内）的等位基因变异数，表达参考板被用来学习每个基因的表达变化预测模型。这些模型被用来预测GWAS队列中每个人的基因表达。最后，对预测的基因表达和性状之间的统计关联进行估计。表达预测和关联可与个体水平的GWAS数据（PrediXcan）或与汇总水平的GWAS数据（Fusion和S-PrediXcan）同时进行。密切相关的方法包括SMR/HEIDI，它执行从基因表达到性状的孟德尔随机化（MR），以及GWAS-eQTL colocalization方法，如Sherlock、coloc、QTLMatch、eCaviar、 enloc和RTC，这些方法发现其表达受支撑GWAS命中的相同因果变异所调节的基因。</p></blockquote><p>TWAS的主要流程</p><blockquote><p>以Gong, Weiming, et al. “Integrative Analysis of Transcriptome-Wide Association Study and mRNA Expression Profiles Identifies Candidate Genes Associated With Idiopathic Pulmonary Fibrosis.” <em>Frontiers in genetics</em> 11 (2020).为例，疾病为Idiopathic pulmonary fibrosis (IPF) 。</p><p>需要：不同组织中的基因表达权重（gene expression weights of three tissues）和GWAS数据集（a large-scale genome-wide association study (GWAS) dataset）；涉及2668个IPF病例和8591个control组</p><p>【主要用于鉴定疾病的候选基因】</p><p>使用3个组织的基因表达权重和一个大规模的数据集(GWAS)进行 IPF 的转录组范围关联研究(TWAS) ，共涉及2,668个 IPF 病例和8,591个对照组。然后对 TWAS 鉴定的重要基因进行基因本体(GO)和通路富集分析。在 IPF 全基因组 mRNA 表达谱中，TWAS 重要基因的富集分析和差异表达基因(DEGs)之间的 GO 项和通路也有重叠。对 TWAS 重要基因进行蛋白质-蛋白质相互作用(PPI)网络和聚类模块分析。总的来说，TWAS 在 Bonferroni 校正 p 值阈值(0.05/14929 = 3.35 × 10-6)下鉴定了一组 IPF 候选基因，如 DSP (肺组织 PTWAS = 1.35 × 10-29)、 MUC5B (肺组织 PTWAS = 1.09 × 10-28)和 TOLLIP (全血 PTWAS = 1.41 × 10-15)。通</p><p>【通路富集分析确定多个候选通路】</p><p>通路富集分析确定了多个候选通路，如单纯疱疹病毒感染(p 值为7.93 × 10-5)和抗原加工提呈(p 值为6.55 × 10-5)。通过对 TWAS 显著基因和 DEGs 的富集分析，鉴定出38个共有的 GO 基因和8个 KEGG 通路。在 PPI 网络中，14个基因(DYNLL1、 DYNC1LI1、 DYNLL2、 HLA-DRB5、 HLA-DPB1、 HLA-DQB2、 HLA-DQA2、 HLA-DQB1、 HLA-DQB1、 HLA-DRB1、 POLR2L、 CENPP、 CENPK、 NUP133和 NUP107)同时被 hub 基因和模块分析检测到。</p></blockquote><p>Expression quantitative traits loci (eQTLs) </p><blockquote><p>用于解释GWAS信号</p></blockquote><p>studied tissues：</p><p>mammary artery (MAM)</p><p>liver (LIV)</p><p>blood (BLD)</p><p>subcutaneous fat (SF)</p><p>visceral abdominal fat (VAF)</p><p>skeletal muscle (SKLM)</p><p>coronary (COR)</p><p>tibial (TIB) arteries</p><h2 id="研究步骤"><a href="#研究步骤" class="headerlink" title="研究步骤"></a>研究步骤</h2><p>从CAD relevant tissue中获得predicted model</p><p>cross-validated prediction R2 &gt; 0.01的基因被保留</p><p>基于STARNET建立的模型允许将12995个独特的基因表达信号归咎于7种组织</p><p>基于GTEx建立的模型允许将12964个独特的基因表达信号归咎于8种组织</p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.31-B16F1给药配置表(150只小鼠)</title>
    <link href="/2021/08/31/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8/"/>
    <url>/2021/08/31/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-31-B16F1给药配置表-150只小鼠"><a href="#2021-8-31-B16F1给药配置表-150只小鼠" class="headerlink" title="2021.8.31-B16F1给药配置表(150只小鼠)"></a>2021.8.31-B16F1给药配置表(150只小鼠)</h1><h2 id="1-实验设计方案"><a href="#1-实验设计方案" class="headerlink" title="1.实验设计方案"></a>1.实验设计方案</h2><p>多肽混合NH组含有编号为1，3，25的肽段，共3条肽。分为低、中、高三个剂量组，低剂量组5.8ug/肽，中剂量组29ug/肽，高剂量组58ug/肽。</p><p>多肽混合TH组含有编号为1，3，25的肽段，共3条肽。分为低、中、高三个剂量组，低剂量组5.8ug/肽，中剂量组29ug/肽，高剂量组58ug/肽。</p><h2 id="2-多肽和佐剂选择"><a href="#2-多肽和佐剂选择" class="headerlink" title="2.多肽和佐剂选择"></a>2.多肽和佐剂选择</h2><p>多肽：每瓶300ug，300uL生理盐水溶解，母液浓度1ug/uL。 </p><p>佐剂：PolyICLC，每瓶250uL，佐剂浓度2ug/uL。 </p><p>用量：计划每组10只小鼠，每只100uL注射液，每次注射1000ul, 注射7次。 </p><p>按每组照150只小鼠量来配制，即15000 uL </p><h2 id="3-抗原肽配置表"><a href="#3-抗原肽配置表" class="headerlink" title="3.抗原肽配置表"></a>3.抗原肽配置表</h2><p>【多肽用量取整前】</p><table><thead><tr><th>组别</th><th>多肽用量</th><th>佐剂用量</th><th>生理盐水</th><th>总量</th></tr></thead><tbody><tr><td>对照组</td><td>/</td><td>/</td><td>15000 uL</td><td>15000 uL</td></tr><tr><td>溶媒组</td><td>/</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液14.5瓶，共需43.5瓶多肽母液，总计13050 uL</td><td>150ug， 75uL</td><td>1875 uL</td><td>15000 uL</td></tr><tr><td>TH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液2.9瓶， 共需8.7瓶多肽母液，总计2610 uL</td><td>150ug， 75uL</td><td>12315 uL</td><td>15000 uL</td></tr><tr><td>NH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>NH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液14.5瓶，共需43.5瓶多肽母液，总计13050 uL</td><td>150ug， 75uL</td><td>1875 uL</td><td>15000 uL</td></tr><tr><td>NH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液2.9瓶， 共需8.7瓶多肽母液，总计2610 uL</td><td>150ug， 75uL</td><td>12315 uL</td><td>15000 uL</td></tr></tbody></table><p>【多肽用量取整后】</p><table><thead><tr><th>组别</th><th>多肽用量</th><th>佐剂用量</th><th>生理盐水</th><th>总量</th></tr></thead><tbody><tr><td>对照组</td><td>/</td><td>/</td><td>15000 uL</td><td>15000 uL</td></tr><tr><td>溶媒组</td><td>/</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液15(14.5)瓶，共需45瓶多肽母液，总计13500 uL</td><td>155.17ug， 77.59uL</td><td>1939.65 uL</td><td>15517.24 uL</td></tr><tr><td>TH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液3(2.9)瓶， 共需9瓶多肽母液，总计2700 uL</td><td>155.17ug， 77.59uL</td><td>12739.65 uL</td><td>15517.24 uL</td></tr><tr><td>NH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>NH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液15(14.5)瓶，共需45瓶多肽母液，总计13500 uL</td><td>155.17ug， 77.59uL</td><td>1939.65 uL</td><td>15517.24 uL</td></tr><tr><td>NH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液3(2.9)瓶， 共需9瓶多肽母液，总计2700 uL</td><td>155.17ug， 77.59uL</td><td>12739.65 uL</td><td>15517.24 uL</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>polypeptide vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析</title>
    <link href="/2021/08/31/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90/"/>
    <url>/2021/08/31/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-31-学习记录：仁科生物dCODE-Dextramer助力10×Genomics进行T-B细胞抗原特异性分析"><a href="#2021-8-31-学习记录：仁科生物dCODE-Dextramer助力10×Genomics进行T-B细胞抗原特异性分析" class="headerlink" title="2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析"></a>2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析</h1><p>![截屏2021-08-31 下午2.05.55 (2)](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.05.55 (2).png)</p><p>![截屏2021-08-31 下午2.06.24](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.06.24.png)</p><blockquote><p>MHC I</p><p>结合沟两端闭合，只能结合肽段长度&lt;10个氨基酸</p><p>呈递给CD8+T细胞</p><p>MHC II</p><p>结合沟两端开放，结合肽段长度平均约15个氨基酸</p><p>呈递给CD4+T细胞</p></blockquote><p>![截屏2021-08-31 下午2.08.06](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.08.06.png)</p><p>![截屏2021-08-31 下午2.08.37](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.08.37.png)</p><blockquote><p>TCR和MHC-肽段复合物结合时间很短，因此可以通过增加MHC-肽段复合物数量来提升结合时间</p></blockquote><p>![截屏2021-08-31 下午2.09.11](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.09.11.png)</p><blockquote><p>(左上角) 骨架上带有荧光基团，MHC分子-肽段复合物</p><p>因结合位点较多（10个以上的结合位点），优势：亲和力更大，灵敏度更高。有利于研究低亲和力TCR</p><p>也可进行NGS或流式进行分选。</p></blockquote><p>dextramer上连接bar code序列，从而与10x单细胞技术结合</p><p>![截屏2021-08-31 下午2.13.42](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.13.42.png)</p><blockquote><p>PCR handle：</p><p>feature barcode：用于确定连接的肽段</p><p>capture sequence：用于筛选结合了抗原的细胞</p></blockquote><p>![截屏2021-08-31 下午2.15.28](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.15.28.png)</p><blockquote><p>增加孵育——清洗步骤，筛选出结合的细胞。</p><p>（上清和磁珠可以用于构建出两种文库信息）</p></blockquote><p>【实例】</p><p>![截屏2021-08-31 下午2.17.31](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.17.31.png)</p><blockquote><p>样品：CMV病毒血清学反应为阳性和阴性的PBMC</p><blockquote><p>阳性可与CMV结合，阴性不可与CMV结合</p></blockquote><p>能够在CMV病毒血清学反应为阳性的PBMC中筛选出对CMV病毒有特异性的T细胞，并能看出T细胞的亚群与克隆型。</p><p>但在CMV病毒血清学反应为阴性的PBMC中无法筛选出CMV病毒有特异性的T细胞，但能找到对其他病毒有特异性的T细胞。（提示患者以前感染过相应病毒）</p></blockquote><p>可以获得4种结果：</p><p>4-表面蛋白——获得细胞表面蛋白表达情况</p><p>![截屏2021-08-31 下午2.21.49](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.21.49.png)</p><blockquote><p>与10x转录组结果一起分析，也可以获得中间灰色细胞群（未经注释的细胞）的具体信息。</p></blockquote><p>【要知道哪些信息，才能进行操作？】</p><p>![截屏2021-08-31 下午2.24.39](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.24.39.png)</p><blockquote><p>需要知道样本HLA的分型与病毒肽段的信息</p><p>可购买或定制</p></blockquote><p>【想要保密肽段该怎么办？】</p><blockquote><p>可以自己diy组装，只需要购买相应分型的MHC分子和骨架，然后和肽段一起进行装载</p></blockquote><p>![截屏2021-08-31 下午2.27.23](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.27.23.png)</p><blockquote><p>要和10x产品一起使用，必须选用带有barcode信息的骨架。</p><p>只进行流式分选，则可以使用带有荧光基团的骨架。</p><p>肽段要求：95%以上的纯度</p></blockquote><p>【如果不知道MHC分子的分型，怎么办？】</p><p>![截屏2021-08-31 下午2.29.22](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.29.22.png)</p><blockquote><p>骨架上换成了生物素受体，可以将目标小分子进行生物素化，即可与骨架结合。</p></blockquote><p>![截屏2021-08-31 下午2.30.35](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.30.35.png)</p><blockquote><p>然后通过barcode检测，可以确定与小分子结合的细胞有哪些。</p></blockquote><p>应用：【LIBRA-seq】用于大规模的抗体发现</p><p>![截屏2021-08-31 下午2.31.52](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.31.52.png)</p><p>应用：【Genentech】可以用于较大规模的抗体筛选</p><p>![截屏2021-08-31 下午2.32.47](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.32.47.png)</p><p>【总结】用途：</p><p>![截屏2021-08-31 下午2.33.41](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.33.41.png)</p>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Antigen specificity analysis</tag>
      
      <tag>dCODE Dextramer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ppp1r15A 临床试验开展情况</title>
    <link href="/2021/08/30/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5/"/>
    <url>/2021/08/30/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5/</url>
    
    <content type="html"><![CDATA[<h1 id="2-ppp1r15A-临床试验开展情况"><a href="#2-ppp1r15A-临床试验开展情况" class="headerlink" title="2.ppp1r15A 临床试验开展情况"></a>2.ppp1r15A 临床试验开展情况</h1><p>PPP1R15A (蛋白磷酸酶1调控亚基15A)是一种蛋白质编码基因。与 PPP1R15A 相关的疾病包括恶性胸膜间皮瘤和骨骺发育不良，多发性，早发性糖尿病。其相关途径包括 β- 肾上腺素能信号转导和 SMAD2/SMAD3-SMAD4异三聚体的转录活性。与该基因相关的基因本体(GO)注释包括蛋白激酶结合。该基因的一个重要旁系是 PPP1R15B。</p><p>PPP1R15A招募丝氨酸/苏氨酸蛋白磷酸酶PP1，形成PPP1R15A-PP1复合物，该复合物使翻译起始因子eIF-2A/EIF2S1去磷酸化，从而逆转由应激诱导激酶启动的蛋白质合成的关闭，促进细胞从应激中恢复。另外，PPP1R15A通过促进PP1对TGFB1的去磷酸化而下调TGF-beta信号通路，可能通过诱导TP53在 “Ser-15 “上的磷酸化而促进细胞凋亡。</p><p>目前，处于临床研究阶段的PPP1R15A相关药物主要与以上通路相关。Tsaytler等人报道，此前由美国FDC批准的抗高血压药物Guanabenz可通过 GADD34-PP1c 介导的 p-eif2α 的去磷酸化作用，增强综合应激反应(ISR)。ISR是一种细胞保护反应，由各种细胞毒性损伤激活，如活性氮氧化物、谷氨酸兴奋性和内质网压力，所有这些都与多发性硬化的发病机制有关。Way等人报告，用guanabenz治疗小鼠的EAE延迟了疾病的发生并抑制了临床症状：这些效果与少突胶质细胞中p-eIF2α水平的增加和少突胶质细胞的保护有关。这些有希望的结果已成为美国国立卫生研究院进行多发性硬化症临床试验的基础（ClinicalTrials.Gov: NCT02423083）。</p><p>不过，Guanabenz同时具有α2肾上腺素激动剂的功能，这导致Guanabenz可能导致嗜睡、嗜睡等副作用。一种名为 Sephin1的 Guanabenz 衍生物，最近被证明能够保留 GADD34-PP1c 特异性抑制活性，而不会在细胞或体内产生可测量的 α2肾上腺素副作用。Chen等人报告说，Sephin1对慢性自身免疫性脑脊髓炎(EAE)小鼠的治疗显著延迟了疾病的发生，这与少突胶质细胞减少、轴突和髓鞘丢失以及 ISR 延长有关。此外，Sephin 1可以减少炎症性 CD3+t 细胞的数量和中枢神经系统内炎症性细胞因子的产生，而不影响外周免疫反应。</p><p>以上提及的两种药物中，仅有Guanabenz已在开展临床试验，Guanabenz的衍生物Sephin1仍处于动物实验阶段。</p><blockquote><p>Tsaytler, Pavel, et al. “Selective inhibition of a regulatory subunit of protein phosphatase 1 restores proteostasis.” <em>Science</em> 332.6025 (2011): 91-94.</p><p>Mháille, Aoife Ní, et al. “Increased expression of endoplasmic reticulum stress-related signaling pathway molecules in multiple sclerosis lesions.” <em>Journal of Neuropathology &amp; Experimental Neurology</em> 67.3 (2008): 200-211.</p><p>Cunnea, Paula, et al. “Expression profiles of endoplasmic reticulum stress-related molecules in demyelinating lesions and multiple sclerosis.” <em>Multiple Sclerosis Journal</em> 17.7 (2011): 808-818.</p><p>Way, Sharon W., and Brian Popko. “Harnessing the integrated stress response for the treatment of multiple sclerosis.” <em>The Lancet Neurology</em> 15.4 (2016): 434-443.</p><p>Das, Indrajit, et al. “Preventing proteostasis diseases by selective inhibition of a phosphatase regulatory subunit.” <em>Science</em> 348.6231 (2015): 239-242.</p><p>Chen, Yanan, et al. “Sephin1, which prolongs the integrated stress response, is a promising therapeutic for multiple sclerosis.” <em>Brain</em> 142.2 (2019): 344-361.</p></blockquote><p>【简表】</p><table><thead><tr><th>药物</th><th>临床试验编号</th><th>临床试验适应症</th><th>临床试验开展年份</th><th>临床试验开展国家/地区</th><th>临床试验申办机构</th><th>临床试验阶段</th><th>副反应提及</th><th>参考文献</th></tr></thead><tbody><tr><td>Guanabenz</td><td>ClinicalTrials.gov Identifier: NCT02423083</td><td>multiple sclerosis (MS)</td><td>2015.4-2017.10</td><td>美国</td><td>National Institutes of Health Clinical Center (CC) ( National Institute of Neurological Disorders and Stroke (NINDS) )</td><td>Phase 1</td><td>因该药物同时具有作为 α2肾上腺素激动剂的功能，可导致嗜睡，口干，头晕，可能导致患者在服药过量时昏迷。较不常见的副作用包括：虚弱，胸痛，水肿，心悸，焦虑，失去协调性，抑郁，瘙痒，皮疹，男性乳房发育，腹痛，便秘，腹泻，恶心，呕吐，肌肉疼痛，视力模糊，呼吸困难，鼻腔充血</td><td>Tsaytler P, Harding HP, Ron D, Bertolotti A. Selective inhibition of a regulatory subunit of protein phosphatase 1 restores proteostasis. Science 2011; 332: 91–4.                                                                                Holmes B, Brogden RN, Heel RC, Speight TM, Avery GS. Guanabenz. A review of its pharmacodynamic properties and therapeutic efficacy in hypertension. Drugs 1983; 26: 212–29.</td></tr><tr><td>Guanabenz</td><td>ClinicalTrials.gov Identifier: NCT02443103</td><td>Bone Cancer Metastasis</td><td>2015.5-2016.2</td><td>美国</td><td>Kathy Miller, Indiana University School of Medicine</td><td>Not Applicable</td><td>/</td><td>/</td></tr></tbody></table><h2 id="2-1-临床试验年度趋势"><a href="#2-1-临床试验年度趋势" class="headerlink" title="2.1.临床试验年度趋势"></a>2.1.临床试验年度趋势</h2><p>2015.4-2017.10期间，Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02423083）主要探究药物Guanabenz对多发性硬化症患者是否安全和耐受性良好。</p><p>2015.5-2016.2期间，Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02443103）主要探究药物Guanabenz在减少有骨转移的实体瘤患者的骨质翻转方面的生物活性。</p><h2 id="2-2-临床试验国家与地区分布"><a href="#2-2-临床试验国家与地区分布" class="headerlink" title="2.2.临床试验国家与地区分布"></a>2.2.临床试验国家与地区分布</h2><p>Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02423083，ClinicalTrials.Gov: NCT02443103）仅在美国本土开展。</p><h2 id="2-3-临床试验申办机构分析"><a href="#2-3-临床试验申办机构分析" class="headerlink" title="2.3.临床试验申办机构分析"></a>2.3.临床试验申办机构分析</h2><p>登记号为ClinicalTrials.Gov: NCT02423083的临床试验由美国国立卫生研究院临床中心（CC）（国家神经疾病和中风研究所（NINDS））主持研究；</p><p>登记号为ClinicalTrials.Gov: NCT02443103的临床试验由印第安纳大学医学院主持研究。</p><h2 id="2-4-临床试验临床阶段及列表"><a href="#2-4-临床试验临床阶段及列表" class="headerlink" title="2.4.临床试验临床阶段及列表"></a>2.4.临床试验临床阶段及列表</h2><p>ClinicalTrials.Gov: NCT02423083处于临床试验Phase 1。</p><p>ClinicalTrials.Gov: NCT02443103临床试验阶段标记为不适用（ Not Applicable）。</p><h2 id="2-5-临床试验适应症分布"><a href="#2-5-临床试验适应症分布" class="headerlink" title="2.5.临床试验适应症分布"></a>2.5.临床试验适应症分布</h2><p>Guanabenz此前由美国FDC批准作为抗高血压药物使用，在登记号为NCT02423083的临床试验中被作为美国国立卫生研究院实验性治疗多发性硬化症临床试验的参考药物；在登记号为NCT02443103的临床试验中被印第安纳大学医学院用于作为减少患者骨癌转移的药物，并进行生物活性评估。</p>]]></content>
    
    
    <categories>
      
      <category>DATA COLLECTION</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ppp1r15A</tag>
      
      <tag>ClinicalTrials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.11-实验记录：CD4、CD8T细胞流式染色</title>
    <link href="/2021/08/11/20210811%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95CD4CD8T%E7%BB%86%E8%83%9E%E6%B5%81%E5%BC%8F%E6%9F%93%E8%89%B2/"/>
    <url>/2021/08/11/20210811%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95CD4CD8T%E7%BB%86%E8%83%9E%E6%B5%81%E5%BC%8F%E6%9F%93%E8%89%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-11-实验记录：CD4、CD8T细胞流式染色"><a href="#2021-8-11-实验记录：CD4、CD8T细胞流式染色" class="headerlink" title="2021.8.11-实验记录：CD4、CD8T细胞流式染色"></a>2021.8.11-实验记录：CD4、CD8T细胞流式染色</h1><blockquote><p>注意：每个样本应留下一个空白样本不做染色，用于校准基线。</p><p>在超净台操作时，应尽量避免开灯，防止荧光淬灭。</p></blockquote><p>配置染色工作液</p><p>染色CD4+ 1:200</p><blockquote><p>APC-eFluer 780</p></blockquote><p>染色CD8+ 1:200</p><blockquote><p>APC-FL6</p></blockquote><p>染色活细胞 1:500</p><blockquote><p>VD-FL9</p></blockquote><p>U型板每孔加入 50μl 染色工作液，暗处孵育 30min。</p><blockquote><p>这里用到的抗体自带荧光基团（是一抗），因此只需要孵育一次。</p></blockquote><p>然后 1500rpm 离心 10min，去上清。</p><p>染色胞内抗原需要进行破膜处理，然后再进行染色。</p><blockquote><p>正常情况下，荧光标记的流式抗体无法通过完整的细胞膜进入细胞内，用流式细胞仪测定细胞内抗原，需先利用破膜剂破坏细胞膜的完整性，产生可供抗体通过的小孔。破膜效果的好坏将直接影响荧光染色和结果分析。</p><p>若检测的胞内抗原带有自发荧光，这种情况下可以直接用流式细胞仪进行检测和分析，若检测需要荧光素偶联的抗体特异性结合细胞内抗原，此时需要用到破膜剂。</p></blockquote><p>U型板每孔加入 50μl 破膜液，暗处孵育 30min。</p><p>然后 1500rpm 离心 10min，去上清。</p><p>U型板每孔加入 100μl 破膜buffer，然后 1500rpm 离心 10min，去上清。</p><blockquote><p>破膜buffer原液为10x，需要稀释至1x。</p></blockquote><p>U型板每孔加入 50μl 胞内抗原染色工作液，暗处孵育 30min。</p><blockquote><p>CFFN </p><p>G2AM </p><p>MIX1</p></blockquote><p>然后 1500rpm 离心 10min，去上清，U型板每孔加入 100μl 加入破膜buffer。</p><blockquote><p>细胞多的时候可以洗一遍，少的时候可以不洗。</p></blockquote><p>然后 1500rpm 离心 10min，去上清，U型板每孔加入 100μl 破膜buffer配置的空白液。</p><blockquote><p>可以在-4℃冰箱里存放一天。</p></blockquote><p>流式细胞仪上样。</p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
      <tag>flow cytometry</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞</title>
    <link href="/2021/08/10/20210810%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84%E6%B7%8B%E5%B7%B4%E7%BB%86%E8%83%9E/"/>
    <url>/2021/08/10/20210810%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84%E6%B7%8B%E5%B7%B4%E7%BB%86%E8%83%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞"><a href="#2021-8-10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞" class="headerlink" title="2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞"></a>2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞</h1><p>（本次操作未进行裂红）</p><h2 id="分离骨髓中的DC细胞"><a href="#分离骨髓中的DC细胞" class="headerlink" title="分离骨髓中的DC细胞"></a>分离骨髓中的DC细胞</h2><p>准备：高温灭菌过的镊子、剪刀、一次性无菌注射器、1.5ml EP 管、15ml 离心管。</p><p>将新鲜小鼠后腿骨依次在 75%-80% 乙醇（EP管内）和 PBS （EP管内）中清洗。</p><p>将清洗过后的后腿骨置于细胞培养皿内，吸取适量 PBS 使后腿骨保持湿润。</p><p>用镊子夹取后腿骨中部，用剪刀剪去后腿骨两头。</p><p>用一次性无菌注射器吸取适量 PBS，然后插进大腿骨骨腔里，将骨髓冲洗出来。一根大腿骨的两头都需要冲洗，每头冲洗两次。</p><p>将 70μm 滤网放置在离心管上，将冲洗出来的骨髓悬液过滤。</p><p>用 PBS 将骨髓悬液补足至 15ml。</p><p>2000rps 离心 10min，获得沉淀在离心管底部的细胞。</p><blockquote><p>因未进行裂红，因此外观呈红色。</p></blockquote><h2 id="分离脾脏中的淋巴细胞"><a href="#分离脾脏中的淋巴细胞" class="headerlink" title="分离脾脏中的淋巴细胞"></a>分离脾脏中的淋巴细胞</h2><p>准备：高温灭菌过的镊子、剪刀、一次性无菌注射器、1.5ml EP 管、15ml 离心管。</p><p>将新鲜小鼠脾脏依次在 75%-80% 乙醇（EP管内）和 PBS （EP管内）中清洗。由于脾脏较为脆弱，用镊子夹取时需要特别注意。</p><p>将清洗过后的脾脏置于细胞培养皿内，吸取适量 PBS 使脾脏保持湿润，然后用一次性无菌注射器推注棒碾磨。</p><p>将 200μm 滤网放置在离心管上，将混有磨碎脾脏的 PBS 过滤。</p><p>用 PBS 将脾脏碾磨液补足至 10ml。</p><p>2000rps 离心 10min，获得沉淀在离心管底部的细胞。</p><blockquote><p>因未进行裂红，因此外观呈红色。</p></blockquote><h2 id="细胞培养"><a href="#细胞培养" class="headerlink" title="细胞培养"></a>细胞培养</h2><p>(培养DC细胞)</p><p>将离心管上清全部吸出，保留沉淀在离心管底部的细胞。</p><p>吸取 2ml 培养液，在离心管中吹打细胞进行重悬。</p><blockquote><p>培养液类型？</p></blockquote><p>将重悬后的细胞悬液分装到两个细胞培养皿中，每个培养皿分装 1ml。</p><p>在每个培养皿中再加入 10ml 培养液和集落刺激因子，混匀，在显微镜下镜检观察，然后放入细胞培养箱。</p><blockquote><p>集落刺激因子配置/浓度？</p></blockquote><h2 id="细胞冻存"><a href="#细胞冻存" class="headerlink" title="细胞冻存"></a>细胞冻存</h2><p>（冻存淋巴细胞）</p><p>胎牛血清与冻存液体按照 9:1 配置，细胞冻存管每管 1.5ml</p><p>一般将冻存管直接存入 -80℃ 液氮中，如果液氮罐已满，也可先放入 -20℃ 冰箱中过夜，第二天转移至液氮罐中。</p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生</title>
    <link href="/2021/07/08/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/07/08/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-7-8-文献阅读：mRNA-接种促进-SARS-CoV-2感染诱导的交叉变异中和抗体的产生"><a href="#2021-7-8-文献阅读：mRNA-接种促进-SARS-CoV-2感染诱导的交叉变异中和抗体的产生" class="headerlink" title="2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生"></a>2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生</h1><blockquote><p>Stamatatos, L., Czartoski, J., Wan, Y.H., Homad, L.J., Rubin, V., Glantz, H., Neradilek, M., Seydoux, E., Jennewein, M.F., MacCamy, A.J. and Feng, J., 2021. mRNA vaccination boosts cross-variant neutralizing antibodies elicited by SARS-CoV-2 infection.</p><p>(mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生)</p></blockquote><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>新型冠状病毒即严重急性呼吸系统综合症冠状病毒-2（SARS-CoV-2）betacoronavirus于2019年底在中国湖北省首次出现，此后在192个国家感染了超过1.15亿人，造成超过250万人死亡。感染是由病毒的spike protein（S）介导的，该蛋白的S1结构域包含N端结构域（NTD）、C端结构域（CTD）和受体结合结构域（RBD），负责介导与进入受体血管紧张素转换酶2（ACE2）的附着。</p><blockquote><p>S蛋白</p><p>大量的糖基化 S 蛋白覆盖在 SARS-CoV-2的表面，与宿主细胞受体血管紧张素转化酶2结合，介导病毒细胞进入。当 S 蛋白与受体结合时，位于宿主细胞膜上的 TM 蛋白酶2(TM protease serine 2，TMPRSS2)通过激活 S 蛋白促进病毒进入细胞。一旦病毒进入细胞，病毒 RNA 被释放，RNA 基因组中的多聚蛋白被翻译，病毒 RNA 基因组的复制和转录通过蛋白质切割和复制酶-转录酶复合体的组装进行。病毒 RNA 被复制，结构蛋白被合成、组装和包装在宿主细胞中，之后病毒颗粒被释放。</p><p><img src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41401-020-0485-4/MediaObjects/41401_2020_485_Fig1_HTML.png" alt="figure1"></p><p>这些蛋白质对病毒的生命周期至关重要，并为药物治疗提供了潜在的靶点。</p><p>S蛋白的大小为180-200kDa，由一个细胞外N端、一个固定在病毒膜上的跨膜（TM）结构域和一个短的细胞内C端部分组成。S通常以一种可转移的、融合前的构象存在；一旦病毒与宿主细胞相互作用，S蛋白就会发生广泛的结构重排，使病毒与宿主细胞膜融合。S蛋白上有多糖分子以进行伪装，在进入时可逃避宿主免疫系统的监视。</p><p>SARS-CoV-2 S的总长度为1273 aa，由位于N端的信号肽（1-13个氨基酸）、S1亚单位（14-685残基）和S2亚单位（686-1273残基）组成；后两个区域分别负责受体结合和膜融合。在S1亚单位中，有一个N端结构域（14-305残基）和一个受体结合结构域（RBD，319-541残基）；融合肽（FP）（788-806残基）、七肽重复序列1（HR1）（912-984残基）、HR2（1163-1213残基）、TM结构域（1213-1237残基）和细胞质结构域（1237-1273残基）组成了S2亚单位。</p><p>Huang, Y., Yang, C., Xu, X.F., Xu, W. and Liu, S.W., 2020. Structural and functional properties of SARS-CoV-2 spike protein: potential antivirus drug development for COVID-19. <em>Acta Pharmacologica Sinica</em>, <em>41</em>(9), pp.1141-1149.</p></blockquote><p>在人类与非灵长动物中，已经确定对SARS-CoV-2已有的免疫力与对再感染的保护有关，产生的中和抗体（nAbs）可能是机体对SARS-CoV-2的保护性免疫反应的重要组成部分，而且nAbs可能有助于保护人类免受再次感染。在此前已经发现，SARS-CoV-2感染迅速引起nAbs产生，并在几个月内下降，但仍可检测到。</p><blockquote><p>中和抗体 neutralizing antibody，NAb</p><p>是一种用于防止细胞被某种抗原或感染原侵害而具有保护力的抗体；其原理是通过抑制乃至中和它们的某种生化作用。</p><p>中和抗体可以导致对某些传染病的终身免疫力，并且可以用来观察一个人在从感染中恢复后是否对感染产生了免疫力。</p><p>中和抗体通过中和细胞在生物学上产生的任何效应，保护细胞免受病原体或传染性微粒的侵袭。中和使微粒不再具有传染性或致病性。中和抗体是后天免疫系统对病毒、细胞内细菌和微生物毒素的体液反应的一部分。中和抗体通过与传染性微粒表面结构(抗原)特异结合，防止微粒与宿主细胞相互作用，从而感染并破坏宿主细胞。由中和抗体引起的免疫也被称为杀菌免疫，因为免疫系统在任何感染发生之前就消除了感染性微粒。</p><p>为了进入细胞，病毒颗粒和细胞内的细菌利用其表面的分子与其目标细胞的细胞表面受体相互作用，使它们能够进入细胞并开始复制周期。中和抗体可以通过与病原体结合来抑制传染性，并阻断细胞进入所需的分子。这可能是由于抗体静态干扰附着在宿主细胞受体上的病原体或毒素。在病毒感染的情况下，单克隆抗体可以结合包膜病毒的糖蛋白或无包膜病毒的衣壳蛋白。此外，中和抗体可以通过阻止微粒经历细胞成功进入所需的结构变化来发挥作用。例如，中和抗体可以阻止病毒蛋白的构象变化，这些蛋白介导进入宿主细胞所需的膜融合。在某些情况下，即使抗体解离，病毒也无法感染。病原抗体复合物最终被巨噬细胞吸收和降解。</p><p>如新冠病毒靠刺突蛋白上的受体结合域（RBD）与人体细胞ACE2受体结合以进入细胞，若某抗体具有与此受体结合域正确位点结合，且使病毒无法进入细胞而失去感染力，则此抗体称为中和抗体，意味能中和病毒的毒力。</p><blockquote><p>中和抗体和结合抗体的区别：</p><p>并非所有结合病原微粒的抗体都是中和的。非中和性抗体（或结合性抗体），专门结合病原体，但不干扰其传染性。这可能是因为它们没有绑定到正确的区域。非中和性抗体对于标记免疫细胞的粒子非常重要，表明它已经成为目标，之后粒子被处理，因此被招募的免疫细胞破坏。</p><p>另一方面，中和抗体可以中和抗原的生物效应，而不需要免疫细胞。在某些情况下，一些病毒物种可利用非中和性抗体或与病毒颗粒结合的中和性抗体数量不足来促进其吸收进入宿主细胞。这种机制被称为抗体依赖性增强作用。已观察到登革热病毒和寨卡病毒。</p></blockquote></blockquote><p>病毒自然感染期间引起的大多数血清中和抗体反应是针对受体结合结构域RBD的。许多中和性抗RBD的单克隆抗体（mAbs）已经被确定，其中最有效的是阻断RBD-ACE2的相互作用。还发现了与病毒spike protein区域结合的中和mAbs。现在，两种基于mRNA的疫苗（Pfizer-BioNTech BNT162b2和Moderna mRNA-1273）已在几个国家开始紧急接种。这两种疫苗都编码了从2019年12月分离出的武汉-Hu-1变体中提取的稳定的S蛋白胞外域部分，在预防COVID-19方面显示出&gt;94%的效力，能够在人体中引起nAbs中和抗体的产生。</p><blockquote><p>单克隆抗体：仅识别一个抗原上的单一表位，仅由一种抗体亚型组成（例如IgG1，IgG2，IgG3）</p><p>多克隆抗体：识别任一抗原上的多个表位，主要由IgG亚类组成</p></blockquote><blockquote><p><strong>BNT162b2 vaccine</strong></p><p>BNT162b2是一种脂质纳米粒配方的核苷修饰 RNA 疫苗，编码一种预融合稳定的、膜锚定的 SARS-CoV-2全长spike protein，通过两个脯氨酸突变来锁定其前融合构象。</p><p><strong>mRNA-1273 vaccine</strong></p><p>mRNA-1273疫苗是一种脂质纳米粒包裹的 mrna 基疫苗，编码严重急性唿吸综合症冠状病毒2(SARS-CoV-2)的预融合稳定的全长spike protein</p></blockquote><p>但是，研究者们也在世界各地发现了新冠病毒进化后的变体。在英国、南非和巴西分别发现了新冠变种（B.1.1.7）、（B.1.351）和（P.1）。这些突变几乎都会增加病毒对ACE2受体的亲和力。这些突变降低了单克隆抗体、恢复期血浆和免疫者血清对中和的敏感性。因此，人们担心这些和其他新出现的病毒变异体可以逃避在感染期间产生的变异体 nAb 反应，而这些变异体在大流行早期流行，也可以逃避基于武汉 -hu-1变异体的 s 蛋白的疫苗引起的 nAb 反应。更令人担心的是，这些突变可能是在南非正在进行的 SARS-CoV-2疫苗试验中观察到的效力下降的原因。</p><p>而且，目前，研究者们对新冠病毒再感染的感染后免疫保护尚不清楚。如果一波又一波的新变种病毒不断出现，破坏人体的自然免疫保护，疫情将会变得难以控制。</p><p>因此，Stamatatos等研究者在这篇文章中调查了以前感染过新冠病毒的人在接种为新冠病毒原始武汉变体开发的基于信使RNA的疫苗4至8个月后的免疫反应性。这篇文章主要评估了受试者血清对病毒的中和敏感性，一共收集了15例 SARS-CoV-2感染者（previously infected donors ，PIDs）和13例未感染者（naïve donors ，NDs）的血清，前者在一次或两次接种前后分别接种 SARS-CoV-2疫苗，后者分别接种了两剂 SARS-CoV-2疫苗。</p><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>ELISA</p><p>抗体中和试验 Antibody neutralization experiments</p><blockquote><p>中和试验(neutralizationtest)是在体外适当条件下孵育病毒与特异性抗体的混合物，使病毒与抗体相互反应，再将混合物接种到敏感的宿主体内，然后测定残存的病毒感染力的一种方法。</p></blockquote><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><h3 id="fig-1"><a href="#fig-1" class="headerlink" title="fig.1"></a>fig.1</h3><p>用表达全长的wuhan-Hu-1 S或两个版本的B.1.351系S的假病毒进行抗体中和实验，其中一个版本在此称为B.1.351，包含定义S系的突变D80A、D215G、K417N、E484K、N501Y和D614G以及在该系中高度流行的A701V突变；第二个变体也包括一个Δ242-243缺失（B.1.351-Δ242-243）。</p><p>![F1.large (2)](/Users/keqinliu/Downloads/F1.large (2).jpg)</p><blockquote><p><strong>Fig. 1</strong>  <strong>B.1.351变异表明中和单克隆抗体的敏感性降低</strong></p><p>图中测量了所述的mAbs在293T-hACE2细胞中中和武汉-1、B.1.351和B.1.351-Δ242-243假病毒感染性的能力。括号内为每种mAb的表位特异性。EBV, Epstein-Barr病毒。数据点代表两个技术复制的平均值。数据是两个独立实验的代表。</p><p>横坐标轴是mAb的浓度（这里分为100，10，1，0.1和0.01一共五个滴度，纵坐标轴是中和效果，一般看50%血清中和终点）</p><p>A：mAb对B.1.351变体的中和效力要弱10倍左右。</p><p>B：非VH3-53 mAb CV3-1对B.1.351变体的效力降低了三到四倍。</p><p>C：CV2-75的效力略低。</p><p>D：相比之下，抗NTD的CV1 mAb无法中和B.1.351变体。</p><p>E：正如预期的那样，对照的anti–Epstein-Barr virus mAb AMMO1没有中和作用。</p><p>总之，这些数据表明，这里测试的B.1.351变体对从大流行早期的病毒变体感染者身上分离出来的mAb的中和作用更具抵抗力。</p><p>因此，研究者们继续调查了B.1.351变体是否对辉瑞-生物技术公司或Moderna mRNA疫苗在PID和NDS中引起的nAb反应有抵抗力。</p></blockquote><h3 id="fig-2"><a href="#fig-2" class="headerlink" title="fig.2"></a>fig.2</h3><p><img src="/Users/keqinliu/Downloads/F2.large.jpg" alt="F2.large"></p><blockquote><p>fig.2 <strong>单剂量的</strong>spike-derived mRNA<strong>疫苗会引起强烈的recall response</strong></p><p>A-C：通过ELISA方法，在辉瑞-生物技术公司或Moderna mRNA疫苗免疫前和免疫两次后收集的PID血清中测量特异于武汉-Hu-1变体RBD的IgG（A）、IgA（B）和IgM（C）终点抗体滴度，如所示。两次疫苗接种后在非传染性疾病患者血清中测得的终点滴度用于比较（灰色圆点）。</p><p><strong>A：三名PID经历了无症状的SARS-CoV-2感染（供体D、L和M），其中两人（L和M）在免疫前没有检测到抗RBD IgG抗体，而第三人（D）的血清抗RBD IgG抗体滴度低但可检测到。在接种前有RBD特异性IgG抗体的13个PID中，单剂量的任何一种疫苗都能使这些滴度提高~500倍。</strong></p><p><strong>B：在所有PID中，接种疫苗后RBD特异性IgA滴度的中位数增加了200倍。</strong></p><p><strong>C：总的来说，在PID中，与NDS的两次接种相比，单次接种的IgG和IgA滴度分别高出4.5倍和7.7倍。在PIDs中，RBD特异性IgM滴度通常较低，对疫苗接种的反应没有明显提高。</strong></p><p>D：在一次或两次免疫之前和之后，测量PIDs的外周血单核细胞（PBMCs）中武汉-Hu-1 RBD特异性IgG+记忆B细胞（活体、IgD-、CD19+、CD20+、CD3-、CD14、CD56-、单细胞和淋巴细胞）的频率。E和F）在一次或两次免疫之前和之后，测量PIDs的PBMCs中S6P特异性IgG+</p><p><strong>在PIDs中，接种疫苗后，RBD-（图2D）和S特异性IgG+（图2E）记忆B细胞的频率同时增加。免疫前缺乏RBD特异性IgG滴度的两个PID（供体L和M）也缺乏RBD特异性IgG+记忆B细胞（图2D），接种后S特异性IgG+记忆B细胞的频率较低。与血清学数据一致，观察到IgA+（图2F）而不是IgM+尖峰特异性记忆B细胞的频率增加（图S3）。疫苗接种还诱发了S特异性CD4+T细胞反应（图2G）。</strong></p><p>E-F：在一次或两次免疫之前和之后，测量PIDs的PBMCs中S6P特异性IgG+（E）和IgA+（F）记忆B细胞的频率。在(D)至(F)中显示了两剂疫苗后NDS的记忆B细胞的频率进行比较（灰色点）。</p><p>G：在一次或两次免疫之前和之后，测量PIDs的PBMCs中表达干扰素-γ（IFN-γ）和/或白细胞介素-2（IL-2）和/或CD40L的S特异性CD4+T细胞的频率。两次疫苗接种后，未感染供体的PBMC中S特异性CD4+T细胞的频率被显示出来进行比较（灰色圆点）。</p></blockquote><h3 id="fig-3"><a href="#fig-3" class="headerlink" title="fig.3"></a>fig.3</h3><p><img src="/Users/keqinliu/Downloads/F3.large.jpg" alt="F3.large"></p><blockquote><p>fig.3 <strong>早先存在的 SARS-CoV-2 nAb 反应是通过单剂量spike-derived mRNA疫苗加强的</strong></p><p>A至D：在使用辉瑞-生物技术公司或Moderna疫苗进行一次或两次免疫之前和之后的PID中，以及在使用两次疫苗之后的NDS中，测量导致50%中和的血清稀释度（ID50），如图所示。在（A）至（D）中，有症状和无症状的PID之间的数据点分别用实线和虚线连接。</p><p>E：辉瑞生物技术公司或Moderna公司针对wuhan-hu-1、B.1.351、B.1.351-Δ242-243和SARS-CoV-1假病毒的疫苗单次免疫之前（方块）和之后（圆圈）的PID的血清稀释导致50%的中和率（ID50），如所示。疫苗接种前无症状且抗IgG RBD抗体和RBD特异性IgG+记忆B细胞阴性的PID显示为开放圆圈。</p><p>F：用辉瑞-生物技术公司或Moderna公司的疫苗对指定的假病毒进行两次免疫后，NDS的血清的中和效力（ID50）。每个数据点代表一个不同的捐赠者，横线代表（E）和（F）中的中位数。虚线划定的是测试的最低血清稀释度。</p><p>在接种疫苗前取样的15名PID中，有12人的血清中和了武汉-Hu-1 SARS-CoV-2变体。不中和的血清来自三个无症状的PID，他们的抗RBD IgG滴度较低或无法检测，来自NDS的Pre-accine血清也没有中和作用。</p><p><strong>A：与预先存在RBD特异性IgG滴度的PID单次免疫后观察到的结合抗体的增加相一致，第一剂量后半最大中和滴度[半最大抑制稀释度（ID50）]被提高了约1000倍，而第二剂量没有影响。在接种前缺乏RBD特异性IgG滴度的两个PID中，第一剂疫苗引起了较低的中和滴度（捐赠者L的ID50=30 ，捐赠者M的ID50=200）。在NDS中，两剂疫苗引起的ID50滴度分别比PID中的一剂或两剂引起的滴度低10倍和5倍。总之，这些数据表明，在对RBD产生足够免疫记忆的PID中，单剂疫苗引起的无名反应导致RBD结合和nAb反应，优于未感染供体的两剂方案。在最近的两项研究中，在接受单一mRNA疫苗剂量的PID中也观察到了类似的结合和/或疫苗匹配的中和滴度的提高。</strong></p><p>接下来研究者评估了NDS和PID在免疫前后收集的血清中和更具抗性的B.1.351和B.1.351-Δ242-243假病毒的能力。这些变体与武汉-Hu-1变体之间有0.5和0.7%的区别。研究者还将 SARS-CoV-1假病毒作为一个与疫苗更不同的代表性变异包括在这项分析中。SARS-CoV-1和 SARS-CoV-2在总 S 蛋白、 RBD 和 RBM 中的区别分别为24%、26%和50% 。因此，一些单克隆抗体无法与 SARS-CoV-1结合而中和 SARS-CoV-2。</p><p>B.E. 接种疫苗前，15份PID的血清中有5份中和了B.1.351，只有3份的ID50滴度超过了100</p><p>C.E. 15份中有7份中和了B.1.351-Δ242-243，只有一份的滴度超过了100</p><p>E 前期疫苗血清对武汉-胡1变体的ID50中值明显高于对B.1.351或B.1.351-Δ242-243的ID50</p><p>D.E. 与高度的序列差异相一致的是，只有一个PID的血清在接种疫苗前对SARS-CoV-1表现出非常弱的中和活性</p><p>A.D.  在15名PID中的13名中，单次免疫可提高针对所有三种SARS-CoV-2变体和SARS-CoV-1的nAb滴度</p><p>E 然而，针对B.1.351的ID50滴度中值要比针对Wuhan-Hu-1的低3倍，针对B.1.351-Δ242-243的低10倍，针对SARS-CoV-1的低100倍</p><p>A-D.E 在两个缺乏RBD特异性IgG记忆的无症状供体（供体L和M）中，单次免疫并没有引起针对B.1.351变体或SARS-CoV-1的nAbs。</p><p>PID单次免疫引起的中和滴度明显高于NDS两次免疫引起的对所有测试的假病毒的中和滴度–对Wuhan-Hu-1高10倍（图3A），对B.1.351高20倍（图3B），对B.1.351-Δ242-243高30倍（图3C），而对SARS-CoV-1高7倍（图3D）。</p><p>13个接种的NDS中只有8个能达到对B.1.351-Δ242-243的80%中和，没有一个能达到对SARS-CoV-1的80%中和（图S7B）。</p></blockquote><p>B.1.351和B.1.351-Δ242-243变体包含三个RBD突变，影响了抗RBD mAbs的中和效力（fig.1）。</p><p>此外，预先存在的抗RBD IgG记忆似乎对疫苗接种的强烈回忆反应很重要。为了确定抗RBD抗体对血清中和的相对贡献，研究者在一次疫苗接种后从10个PID的血清中，以及在两次疫苗接种后从9个NDS的血清中，耗尽了RBD特异抗体。</p><h3 id="fig-4"><a href="#fig-4" class="headerlink" title="fig.4"></a>fig.4</h3><p><img src="/Users/keqinliu/Downloads/F4.large.jpg" alt="F4.large"></p><blockquote><p>fig.4 <strong>疫苗诱导的 nAbs 靶向 RBD</strong></p><p>使用固定在磁珠上的wuhan-Hu-1 RBD，从接受单一疫苗剂量后的PIDs血清或接受两个疫苗剂量后的NDS血清中吸附RBD结合的抗体。</p><p>A.B. 如图所示，通过ELISA法测量PIDs的未去除或已去除RBD的血清与1：500稀释度的RBD（A）和1：4500稀释度的S2P（B）的抗体结合。A450，450nM时的吸光度。</p><p>C 在(A)和(B)中的PIDs的未去除或RBD去除的血清中，测量导致武汉-Hu-1伪病毒50%中和的血清稀释度（ID50）</p><p>D.E. 通过ELISA法，测量未去除和RBD去除的NDS血清中与1：500稀释度的RBD（D）和1：500稀释度的S2P（E）的抗体结合。</p><p>(F)测量(D)和(E)中供体的未去除或RBD去除血清的1:120稀释度对武汉-hu-1假病毒的中和率。</p><p>通过酶联免疫吸附试验（ELISA），这种方法有效地从血清中去除RBD特异性抗体（图4，A和C），而不是抗S2P特异性抗体（图4，B和D）。这种耗竭削弱了wuhan-Hu-1病毒的血清中和作用（图4，C和F），这表明大多数由疫苗接种引起或增强的nAbs都是针对这个亚域的。</p></blockquote><p>上述结果表明，在NDS中，无论是辉瑞生物技术公司还是Moderna公司的两剂疫苗都能引起针对疫苗匹配的武汉-Hu-1的nAb滴度，针对B.1.351的滴度较低，而针对B.1.351-Δ242-243的滴度甚至更低。其他B.1.351变体对疫苗诱导的nAbs的敏感性降低也有报道。</p><p>同样，来自经历过SARS-CoV-2感染的PID的血清，在接种疫苗前有可检测到的抗RBD IgG滴度，在感染后1至9个月，对Wuhan-Hu-1的nAb滴度普遍较弱，对B.1.351变体的滴度较低或不存在，与另一项研究一致。</p><p>然而，只要在感染期间产生了RBD特异性IgG+记忆B细胞和抗体反应，用任一mRNA疫苗进行单次免疫就会引起强烈的回忆反应，使自体中和滴度提高约1000倍，这些抗体反应可交叉中和B.1.351变体，但滴度较低。在大多数先前感染的疫苗接种者中，抗B.1.351-Δ242-243的中和滴度与未感染的疫苗接种者中抗疫苗匹配的Wuhan-Hu-1的滴度相当。这是值得注意的，因为在3期试验中，这些滴度与COVID-19的95%保护率有关。此外，疫苗激发的抗体反应也能中和SARS-CoV-1，但其效力要低得多。总之，我们的数据表明，基于wuhan-hu-1变体的两种mRNA疫苗可以引起和/或增强nAb反应，但它们对不同变体的效力会降低。</p><p>研究者发现，以前感染的受试者在免疫后产生的交叉nAb反应是抗RBD抗体的结果。结合观察，疫苗引起的nAb反应对NTD有Δ242-243缺失的B.1.351变体的效力较低，这表明NTD变异可以调节新出现的变体对抗RBD nAbs的敏感性。相比之下，NTD区域本身似乎可以容忍SARS-CoV-2和其他冠状病毒的抗原性变异，它似乎不是感染或疫苗接种引起的交叉nAbs的目标。我们注意到，还有其他与这一品系相关的不太常见的突变，如L18F、Δ244、L244H和R246I，这些突变在这里没有被研究，它们可能会进一步增加对疫苗激发的抗体的抵抗力。在这项研究中，使用了一种假病毒检测方法来测量nAbs。现在有几项研究表明，真病毒和假病毒的中和作用有相当好的相关性。尽管真实病毒和假病毒检测的绝对敏感性可能不同，但我们预计我们在此报告的相对差异不会在两者之间发生变化。</p><p>尽管SARS-CoV-2疫苗的保护作用尚未确定，但在非人灵长类动物中的研究表明，即使是低滴度的nAbs也足以预防实验性SARS-CoV-2感染，特别是如果CD8+T细胞反应被启动的话。研究者们发现，大多数先前感染的受试者将从辉瑞生物技术公司或Moderna疫苗的单次免疫中受益，因为它将导致针对疫苗匹配和新出现的变体的血清nAb反应的显著增加。</p><p>观察到在第一剂疫苗接种后3至4周再接种第二剂疫苗并不能进一步提高PID的中和滴度，这些PID在接种前有明显的RBD导向的免疫记忆证据，这表明对于一些以前感染过SARS-CoV-2的人，可以推迟第二剂mRNA疫苗的接种。对第一剂疫苗前后的nAb滴度的纵向监测应被用来确定在以前感染的情况下第二剂疫苗的必要性或最佳时机。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>在接种疫苗之前，感染后的血清对病毒变体的抗体中和反应是可变的和弱的。疫苗接种使感染后血清对武汉-Hu-1和其他毒株的中和能力提高了约1000倍，对变种B.1.351的血清中和能力也有所提高。虽然对变异株的反应相对较弱，但仍显示出特有的记忆反应。</p><p>因此，接种武汉-湖北1号变种疫苗可能会对机体以后感染变种病毒所产生的的保护性反应提供促进作用。</p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SARS-CoV-2</tag>
      
      <tag>vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>

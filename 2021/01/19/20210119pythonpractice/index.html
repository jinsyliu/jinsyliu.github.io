

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  
    <meta name="description" content="">
  
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
  <title>2021.1.19 python practice - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Liu Keqin</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="2021.1.19 python practice">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-01-19 17:18" pubdate>
        2021年1月19日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      10k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      199
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2021.1.19 python practice</h1>
            
            <div class="markdown-body">
              <h1><span id="python-practice">python practice</span><a href="#python-practice" class="header-anchor">#</a></h1><p>python practice</p>
<p>python version: 2.7</p>
<p>tutorial: Python生物信息学数据管理</p>
<h2><span id="lesson4">lesson4</span><a href="#lesson4" class="header-anchor">#</a></h2><h3><span id="count">count</span><a href="#count" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">seq =<span class="hljs-string">&#x27;&#x27;&#x27;MDDREDLVYQAKLAEQAERYDEMVESMKKVAGMDVELTVEERNLLSVAYKNVIGARRASW</span><br><span class="hljs-string">RIISSIEQKEENKGGEDKLKMIREYRQMVETELKLICCDILDVLDKHLIPAANTGESKVF</span><br><span class="hljs-string">YYKMKGDYHRYLAEFATGNDRKEAAENSLVAYKAASDIAMTELPPTHPIRLGLALNFSVF</span><br><span class="hljs-string">YYEILNSPDRACRLAKAAFDDAIAELDTLSEESYKDSTLIMQLLRDNLTLWTSDMQGDGE</span><br><span class="hljs-string">EQNKEALQDVEDENQ&#x27;&#x27;&#x27;</span><br>number = seq.count(<span class="hljs-string">&#x27;W&#x27;</span>)<br><span class="hljs-built_in">print</span> number<br></code></pre></td></tr></table></figure>
<h3><span id="fasta-filter">fasta filter</span><a href="#fasta-filter" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.2</span><br><span class="hljs-keyword">import</span> os<br>path_1= os.path.abspath(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;fasta_filter.fasta&#x27;</span>)<br>file_new = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">if</span> seq[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq.count(<span class="hljs-string">&#x27;W&#x27;</span>) &gt; <span class="hljs-number">1</span>:<br>            file_new.write(header + seq)<br>            seq = <span class="hljs-string">&#x27;&#x27;</span><br>            header = line<br><span class="hljs-keyword">if</span> seq[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq.count(<span class="hljs-string">&#x27;W&#x27;</span>) &gt;= <span class="hljs-number">2</span>:<br>    file_new.write(header + seq)<br>file_new.close()<br>file_read.close()<br></code></pre></td></tr></table></figure>
<h3><span id="calculate-ratio">calculate ratio</span><a href="#calculate-ratio" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.3</span><br><span class="hljs-keyword">import</span> os<br>path = (os.path.abspath(<span class="hljs-string">&#x27;multiple_DNA.fasta&#x27;</span>))<br>file_read = <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        head = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = line + seq<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-built_in">print</span> head,a,g,c,t<br>        head = line<br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-built_in">print</span> head,a,g,c,t<br>file_read.close()<br></code></pre></td></tr></table></figure>
<h3><span id="calculate-ratio-from-gb-file">calculate ratio from gb file</span><a href="#calculate-ratio-from-gb-file" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#homework for 4.5.5</span><br><span class="hljs-keyword">import</span> os<br>path = (<span class="hljs-string">&#x27;AY810830.GB&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_gb&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>] == <span class="hljs-string">&#x27;ACCESSION&#x27;</span>:<br>        AC = line.split()[<span class="hljs-number">1</span>].strip()<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;ORIGIN&#x27;</span>:<br>        flag = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> flag == <span class="hljs-number">1</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">if</span> fields != <span class="hljs-string">&#x27;&#x27;</span>:<br>            seq = <span class="hljs-string">&#x27;&#x27;</span>.join(fields[<span class="hljs-number">1</span>:])<br>            seq = seq.upper()<br>            file_write.write(seq)<br><br>file_read.close()<br>file_write.close()<br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_gb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = file.read()<br>a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br><span class="hljs-built_in">print</span> a,g,c,t<br>    <br>file.close<br></code></pre></td></tr></table></figure>
<h3><span id="read-ac-from-gb-file-and-write-into-fasta-file">read ac from gb.file and write into fasta.file</span><a href="#read-ac-from-gb-file-and-write-into-fasta-file" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#read ac from gb.file and write into fasta.file</span><br><span class="hljs-keyword">import</span> os<br>path_1 = os.path.abspath(<span class="hljs-string">&#x27;AY810830.gb&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;AY810830.fasta&#x27;</span>)<br>file_gb = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_fasta = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_gb:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>] == <span class="hljs-string">&#x27;ACCESSION&#x27;</span>:<br>        AC = line.split()[<span class="hljs-number">1</span>].strip()<br>        file_fasta.write(<span class="hljs-string">&#x27;&gt;&#x27;</span>+<span class="hljs-string">&#x27;|&#x27;</span>+AC+<span class="hljs-string">&#x27;|&#x27;</span>+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;ORIGIN&#x27;</span>:<br>        flag = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> flag == <span class="hljs-number">1</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">if</span> fields != []:<br>            seq = <span class="hljs-string">&#x27;&#x27;</span>.join(fields[<span class="hljs-number">1</span>:])<br>            file_fasta.write(seq.upper()+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            <span class="hljs-built_in">print</span> seq<br>file_gb.close()<br>file_fasta.close()<br></code></pre></td></tr></table></figure>
<h3><span id="read-fasta-and-write-homo-sapien-to-a-new-fasta">read fasta and write homo sapien to a new fasta</span><a href="#read-fasta-and-write-homo-sapien-to-a-new-fasta" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#read fasta and write homo sapien to a new fasta</span><br><span class="hljs-keyword">import</span> os<br>path_1 = os.path.abspath(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_write = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Homo sapiens&#x27;</span> <span class="hljs-keyword">in</span> header:<br>            file_write.write(header + seq)<br>            seq = <span class="hljs-string">&#x27;&#x27;</span><br>            header = line<br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">in</span> header:<br>    file_write.write(header + seq)<br>file_write.close()<br></code></pre></td></tr></table></figure>
<h3><span id="save-multiple-fasta-from-fasta">save multiple fasta from fasta</span><a href="#save-multiple-fasta-from-fasta" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.1</span><br><span class="hljs-keyword">import</span> os<br>path = os.path.abspath(<span class="hljs-string">&#x27;Swissprot.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        file_write = <span class="hljs-built_in">open</span>(<span class="hljs-built_in">str</span>(header.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]), <span class="hljs-string">&#x27;w&#x27;</span>)<br>        file_write.write(header + seq.upper())<br>        header = line<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> header:<br>    AC = header.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    file_write = <span class="hljs-built_in">open</span>(<span class="hljs-built_in">str</span>(AC), <span class="hljs-string">&#x27;w&#x27;</span>)<br>    file_write.write(header + seq.upper())<br>        <br>file_write.close()<br>file_read.close()<br></code></pre></td></tr></table></figure>
<h2><span id="lesson5">lesson5</span><a href="#lesson5" class="header-anchor">#</a></h2><h3><span id="4-5-1-dictionary">4.5.1 dictionary</span><a href="#4-5-1-dictionary" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">dic = &#123;<span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;START&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;Glycin&#x27;</span> &#125;<br><span class="hljs-built_in">print</span> dic.keys()<br><span class="hljs-built_in">print</span> dic.values()<br><span class="hljs-built_in">print</span> dic<br></code></pre></td></tr></table></figure>
<h3><span id="4-5-2">4.5.2</span><a href="#4-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br>number_start = <span class="hljs-number">0</span><br>number_stop = <span class="hljs-number">0</span><br>rna_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        rna_seq = rna_seq + line.strip()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(rna_seq), <span class="hljs-number">3</span>):<br>    codon = rna_seq[i:i+<span class="hljs-number">3</span>]<br>    <span class="hljs-keyword">if</span> codon == <span class="hljs-string">&#x27;AUG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;GUG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;AUA&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UUG&#x27;</span>:<br>        number_start = number_start + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> codon == <span class="hljs-string">&#x27;UAG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UGA&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UAA&#x27;</span>:<br>        number_stop = number_stop + <span class="hljs-number">1</span><br>    <br><span class="hljs-built_in">print</span> number_start,number_stop<br></code></pre></td></tr></table></figure>
<h3><span id="4-5-2-2">4.5.2(2)</span><a href="#4-5-2-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>text = <span class="hljs-string">&#x27;&#x27;</span><br>check = &#123;<span class="hljs-string">&#x27;(MMPs)&#x27;</span>:<span class="hljs-string">&#x27;(MMPs) found&#x27;</span>, <span class="hljs-string">&#x27;cells&#x27;</span>:<span class="hljs-string">&#x27;cells found&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;abstract.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    text += line<br>    columns = line.split()<br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> columns:<br>        <span class="hljs-keyword">if</span> word <span class="hljs-keyword">in</span> check:<br>            <span class="hljs-built_in">print</span> check[word]<br>      <br><span class="hljs-built_in">print</span> text<br></code></pre></td></tr></table></figure>
<h3><span id="4-5-4">4.5.4</span><a href="#4-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">aa_seq = <span class="hljs-string">&#x27;MVDREQLVQKARLAEQAERYDDMAAAMKNVTELNEPLSNEERNLLSVAYKNVVGARRSSW\</span><br><span class="hljs-string">RVISSIEQKTSADGNEKKIEMVRAYREKIEKELEAVCQDVLSLLDNYLIKNCSETQYESK\</span><br><span class="hljs-string">VFYLKMKGDYYRYLAEVATGEKRATVVESSEKAYSEAHEISKEHMQPTHPIRLGLALNYS\</span><br><span class="hljs-string">VFYYEIQNAPEQACHLAKTAFDDAIAELDTLNEDSYKDSTLIMQLLRDNLTLWTSDQQDD\</span><br><span class="hljs-string">DGGEGNN&#x27;</span><br><span class="hljs-built_in">print</span> aa_seq<br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>pref_E = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br>pref_H = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;0.97&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;1.30&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.80&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;0.26&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.28&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.81&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;0.71&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.60&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;0.74&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.22&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.67&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.62&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.63&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.90&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.72&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.19&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;1.29&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> aa_seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> pref_H <span class="hljs-keyword">and</span> res <span class="hljs-keyword">in</span> pref_E:<br>        <span class="hljs-keyword">if</span> pref_H[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_E[res] &lt; pref_H[res]:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;H&#x27;</span><br>        <span class="hljs-keyword">elif</span> pref_E[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_H[res] &lt; pref_E[res]:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;E&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;L&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure>
<h3><span id="4-5-5">4.5.5</span><a href="#4-5-5" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">seq = <span class="hljs-string">&#x27;MVDREQLVQKARLAEQAERYDDMAAAMKNVTELNEPLSNEERNLLSVAYKNVVGARRSSW\</span><br><span class="hljs-string">RVISSIEQKTSADGNEKKIEMVRAYREKIEKELEAVCQDVLSLLDNYLIKNCSETQYESK\</span><br><span class="hljs-string">VFYLKMKGDYYRYLAEVATGEKRATVVESSEKAYSEAHEISKEHMQPTHPIRLGLALNYS\</span><br><span class="hljs-string">VFYYEIQNAPEQACHLAKTAFDDAIAELDTLNEDSYKDSTLIMQLLRDNLTLWTSDQQDD\</span><br><span class="hljs-string">DGGEGNN&#x27;</span><br><br>aa_table = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br><br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> aa_table:<br>        <span class="hljs-keyword">if</span> aa_table[res] &gt; <span class="hljs-string">&#x27;1.00&#x27;</span>:<br>            output_seq += res.upper()<br>        <span class="hljs-keyword">else</span>:<br>            output_seq += res.lower()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br>        <span class="hljs-keyword">break</span><br>    <br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure>
<h3><span id="find-mmp-and-cell-in-abstract">find “MMP” and “cell” in abstract</span><a href="#find-mmp-and-cell-in-abstract" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>number_1 = <span class="hljs-number">0</span><br>number_2 = <span class="hljs-number">0</span><br>abstract = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;abstract.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    abstract = abstract + line.strip()<br><span class="hljs-built_in">print</span> abstract<br><br>number_1 = abstract.count(<span class="hljs-string">&#x27;MMPs&#x27;</span>)<br>number_2 = abstract.count(<span class="hljs-string">&#x27;cell&#x27;</span>)<br><br><span class="hljs-keyword">if</span> number_1 &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;MMPs found&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;MMPs not found&#x27;</span><br><span class="hljs-keyword">if</span> number_2 &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;cell found&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;cell not found&#x27;</span><br></code></pre></td></tr></table></figure>
<h3><span id="protein-disorder-prediction">protein disorder prediction</span><a href="#protein-disorder-prediction" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>propensities = &#123;<br>   <span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-number">0.2299</span>, <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-number">0.5523</span>, <span class="hljs-string">&#x27;Q&#x27;</span>:-<span class="hljs-number">0.18770</span>, <span class="hljs-string">&#x27;A&#x27;</span>:-<span class="hljs-number">0.2615</span>,<br>   <span class="hljs-string">&#x27;R&#x27;</span>:-<span class="hljs-number">0.1766</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0.1429</span>, <span class="hljs-string">&#x27;C&#x27;</span>:-<span class="hljs-number">0.01515</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-number">0.0089</span>,<br>   <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">0.2276</span>, <span class="hljs-string">&#x27;E&#x27;</span>:-<span class="hljs-number">0.2047</span>, <span class="hljs-string">&#x27;V&#x27;</span>:-<span class="hljs-number">0.38620</span>, <span class="hljs-string">&#x27;F&#x27;</span>:-<span class="hljs-number">0.2256</span>,<br>   <span class="hljs-string">&#x27;W&#x27;</span>:-<span class="hljs-number">0.2434</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-number">0.4332</span>, <span class="hljs-string">&#x27;H&#x27;</span>:-<span class="hljs-number">0.00120</span>, <span class="hljs-string">&#x27;Y&#x27;</span>:-<span class="hljs-number">0.2075</span>,<br>   <span class="hljs-string">&#x27;I&#x27;</span>:-<span class="hljs-number">0.4222</span>, <span class="hljs-string">&#x27;K&#x27;</span>:-<span class="hljs-number">0.1001</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">0.33793</span>, <span class="hljs-string">&#x27;M&#x27;</span>:-<span class="hljs-number">0.2259</span><br>   &#125;<br>input_seq = <span class="hljs-string">&quot;IVGGYTCGANTVPYQVSLNSGYHFCGGSLINSQWVVSAAHCYKSG\</span><br><span class="hljs-string">IQVRLGEDNINVVEGNEQFISASKSIVHPSYNSNTLNNDIMLIKLKSAASLNSR\</span><br><span class="hljs-string">VASISLPTSCASAGTQCLISGWGNTKSSGTSYPDVLKCLKAPILSDSSCKSAYP\</span><br><span class="hljs-string">GQITSNMFCAGYLEGGKDSCQGDSGGPVVCSGKLQGIVSWGSGCAQKNKPGVYT\</span><br><span class="hljs-string">KVCNYVSWIKQTIASN&quot;</span><br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>threshod = <span class="hljs-number">0.3</span><br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> propensities:<br>        <span class="hljs-keyword">if</span> propensities[res] &gt;= threshod:<br>            output_seq = output_seq + res.upper()<br>        <span class="hljs-keyword">else</span>:<br>            output_seq = output_seq + res.lower()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized charachter:&#x27;</span> , res<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure>
<h3><span id="read-from-a-pdb-file-and-write-into-a-amino-acid-form">read from a pdb file and write into a amino-acid form</span><a href="#read-from-a-pdb-file-and-write-into-a-amino-acid-form" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>aa_codes = &#123;<br>     <span class="hljs-string">&#x27;ALA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CYS&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;ASP&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GLU&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br>     <span class="hljs-string">&#x27;PHE&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;GLY&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;HIS&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;LYS&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>     <span class="hljs-string">&#x27;ILE&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;LEU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;MET&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;ASN&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>     <span class="hljs-string">&#x27;PRO&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;GLN&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;ARG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;SER&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>     <span class="hljs-string">&#x27;THR&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;VAL&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;TYR&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;TRP&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>&#125;<br>aa_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;SEQRES&#x27;</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">for</span> resname <span class="hljs-keyword">in</span> fields[<span class="hljs-number">4</span>:]:<br>           aa_seq = aa_seq + aa_codes[resname]<br>i = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;1TLD&#x27;</span><br><span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(aa_seq):<br>    <span class="hljs-built_in">print</span> aa_seq[i:i+<span class="hljs-number">48</span>]<br>    i = i+<span class="hljs-number">48</span><br></code></pre></td></tr></table></figure>
<h3><span id="translate-rna-into-amino-acid-input-is-rna-seq">translate RNA into amino-acid (input is RNA-seq)</span><a href="#translate-rna-into-amino-acid-input-is-rna-seq" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br><br><span class="hljs-comment"># read the RNA sequence into a single string</span><br>rna = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>): <br>        rna = rna + line.strip()<br><br><span class="hljs-comment"># translate one frame at a time</span><br><span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    prot = <span class="hljs-string">&#x27;&#x27;</span> <br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Reading frame &#x27;</span> + <span class="hljs-built_in">str</span>(frame + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(frame, <span class="hljs-built_in">len</span>(rna), <span class="hljs-number">3</span>):<br>        codon = rna[i:i + <span class="hljs-number">3</span>]<br>        <span class="hljs-keyword">if</span> codon <span class="hljs-keyword">in</span> codon_table:<br>            <span class="hljs-keyword">if</span> codon_table[codon] == <span class="hljs-string">&#x27;STOP&#x27;</span>:<br>                prot = prot + <span class="hljs-string">&#x27;*&#x27;</span><br>            <span class="hljs-keyword">else</span>: <br>                prot = prot + codon_table[codon]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># handle too short codons</span><br>            prot = prot + <span class="hljs-string">&#x27;-&#x27;</span> 	<br><br>    <span class="hljs-comment"># format to blocks of 48 columns</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(prot):<br>        <span class="hljs-built_in">print</span> prot[i:i + <span class="hljs-number">48</span>]<br>        i = i + <span class="hljs-number">48</span><br></code></pre></td></tr></table></figure>
<h3><span id="translate-rna-into-amino-acid-input-is-rna-file">translate RNA into amino-acid (input is RNA-file)</span><a href="#translate-rna-into-amino-acid-input-is-rna-file" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#translate rna to amino_acid</span><br><span class="hljs-keyword">import</span> os<br>file_read = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br>rna = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>):<br>        rna = rna + line.strip()<br><span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    prot = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;read frame&#x27;</span> + <span class="hljs-built_in">str</span>(frame + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(frame, <span class="hljs-built_in">len</span>(rna), <span class="hljs-number">3</span>):<br>        codon = rna[i:i + <span class="hljs-number">3</span>]<br>        <span class="hljs-keyword">if</span> codon <span class="hljs-keyword">in</span> codon_table:<br>            <span class="hljs-keyword">if</span> codon_table[codon] == <span class="hljs-string">&#x27;STOP&#x27;</span>:<br>                prot = prot + <span class="hljs-string">&#x27;*&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                prot = prot + codon_table[codon]<br>        <span class="hljs-keyword">else</span>:<br>            prot = prot + <span class="hljs-string">&#x27;-&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(prot):<br>        <span class="hljs-built_in">print</span> prot[i:i + <span class="hljs-number">48</span>]<br>        i = i + <span class="hljs-number">48</span><br><br>file_read.close()<br></code></pre></td></tr></table></figure>
<h2><span id="lesson6">lesson6</span><a href="#lesson6" class="header-anchor">#</a></h2><h3><span id="6-5-1">6.5.1</span><a href="#6-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new_swissprot.fasta&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>ac = <span class="hljs-string">&#x27;&#x27;</span><br>AC = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> ac == <span class="hljs-string">&#x27;&#x27;</span>:<br>        ac = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>].strip()<br>        <span class="hljs-built_in">print</span> ac<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>        file_write.write(ac + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        ac = <span class="hljs-string">&#x27;&#x27;</span><br><br>file_write.close()<br></code></pre></td></tr></table></figure>
<h3><span id="6-5-2">6.5.2</span><a href="#6-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>index = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    index += <span class="hljs-number">1</span><br>    number = index%<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> number == <span class="hljs-number">0</span>:<br>        file_write.write(line)<br>        <span class="hljs-built_in">print</span> line<br>        <br>file_write.close()<br></code></pre></td></tr></table></figure>
<h3><span id="6-5-3">6.5.3</span><a href="#6-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>list_1 = []<br>list_2 = []<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_1:<br>    list_1.append(line)<br>    <br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_2:<br>    list_2.append(line)<br><br><br>set_1 = <span class="hljs-built_in">set</span>(list_1)<br>set_2 = <span class="hljs-built_in">set</span>(list_2)<br>dif = set_1.symmetric_difference(set_2)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;dif&quot;</span>, <span class="hljs-built_in">list</span>(dif)<br></code></pre></td></tr></table></figure>
<h3><span id="6-5-4">6.5.4</span><a href="#6-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>list_1 = []<br>list_2 = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_1:<br>    list_1.append(line)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_2:<br>    list_2.append(line)<br><br>set_1 = <span class="hljs-built_in">set</span>(list_1)<br>set_2 = <span class="hljs-built_in">set</span>(list_2)<br>set_unique1 = set_1.difference(set_2)<br>set_unique2 = set_2.difference(set_1)<br>set_same1 = set_1.intersection(set_2)<br><br>write_1 = []<br>write_2 = []<br>write_3 = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_unique1:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        write_1.append(line.strip())<br><span class="hljs-built_in">print</span> write_1<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_unique2:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&lt;&#x27;</span>:<br>        write_2.append(line.strip())<br><span class="hljs-built_in">print</span> write_2<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_same1:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;#&#x27;</span>:<br>        write_3.append(line.strip())<br><span class="hljs-built_in">print</span> write_3<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br></code></pre></td></tr></table></figure>
<h3><span id="6-5-5">6.5.5</span><a href="#6-5-5" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>tracking = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts.tracking&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts_filtered.tracking&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> tracking:<br>    columns = track.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    wildtype = columns[<span class="hljs-number">4</span>:<span class="hljs-number">7</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    treatment = columns[<span class="hljs-number">7</span>:<span class="hljs-number">10</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    <span class="hljs-keyword">if</span> wildtype &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> treatment &lt; <span class="hljs-number">1</span>:<br>        output_file.write(track)<br>tracking.close()<br>output_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="find-different-number-from-2-list">find different number from 2 list</span><a href="#find-different-number-from-2-list" class="header-anchor">#</a></h3><p>solution 1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>data_b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>]<br>data_a_not_b = []<br>data_b_not_a = []<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_a:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data_b:<br>        data_a_not_b.append(number)<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_b:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data_a:<br>        data_b_not_a.append(number)<br><span class="hljs-built_in">print</span> data_a_not_b, data_b_not_a<br></code></pre></td></tr></table></figure>
<p>solution 2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])<br>data_b = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>])d<br>data1 = data_a.difference(data_b)<br>data2 = data_b.difference(data_a)<br><span class="hljs-built_in">print</span> data1, data2<br></code></pre></td></tr></table></figure>
<h3><span id="save-same-number-from-2-list">save same number from 2 list</span><a href="#save-same-number-from-2-list" class="header-anchor">#</a></h3><p>solution1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>data_b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>]<br>data = []<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_a:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">in</span> data_b:<br>        data.append(number)<br><span class="hljs-built_in">print</span> data<br></code></pre></td></tr></table></figure>
<p>solution2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])<br>data_b1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>])   <br>data_1 = data_a1.intersection(data_b1)<br><span class="hljs-built_in">print</span> data_1<br></code></pre></td></tr></table></figure>
<h3><span id="remove-element-from-set">remove element from set</span><a href="#remove-element-from-set" class="header-anchor">#</a></h3><p>remove function</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.remove(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure>
<p>pop function</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.pop()<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure>
<p>discard function</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.discard(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure>
<h3><span id="transcript-ilter">transcript ilter</span><a href="#transcript-ilter" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">fimport os<br>tracking = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts.tracking&#x27;</span>)<br>out_put = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> tracking:<br>    columns = track.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    wildtype = columns[<span class="hljs-number">4</span>:<span class="hljs-number">7</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    treatment = columns[<span class="hljs-number">7</span>:<span class="hljs-number">10</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    <span class="hljs-keyword">if</span> wildtype &lt; <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> treatment &lt; <span class="hljs-number">2</span>:<br>        out_put += track<br><span class="hljs-built_in">print</span> out_put<br></code></pre></td></tr></table></figure>
<h2><span id="lesson7">lesson7</span><a href="#lesson7" class="header-anchor">#</a></h2><h3><span id="turn-table-into-dict">turn table into dict</span><a href="#turn-table-into-dict" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>table = [[<span class="hljs-string">&#x27;protein&#x27;</span>,<span class="hljs-string">&#x27;ext1&#x27;</span>,<span class="hljs-string">&#x27;ext2&#x27;</span>,<span class="hljs-string">&#x27;ext3&#x27;</span>],<br>         [<span class="hljs-number">0.16</span>, <span class="hljs-number">0.038</span>, <span class="hljs-number">0.044</span>, <span class="hljs-number">0.040</span>],<br>         [<span class="hljs-number">0.33</span>, <span class="hljs-number">0.089</span>, <span class="hljs-number">0.095</span>, <span class="hljs-number">0.091</span>],<br>         [<span class="hljs-number">0.66</span>, <span class="hljs-number">0.184</span>, <span class="hljs-number">0.191</span>, <span class="hljs-number">0.191</span>],<br>         [<span class="hljs-number">1.00</span>, <span class="hljs-number">0.280</span>, <span class="hljs-number">0.292</span>, <span class="hljs-number">0.283</span>],<br>         [<span class="hljs-number">1.32</span>, <span class="hljs-number">0.365</span>, <span class="hljs-number">0.367</span>, <span class="hljs-number">0.365</span>],<br>         [<span class="hljs-number">1.66</span>, <span class="hljs-number">0.444</span>, <span class="hljs-number">0.441</span>, <span class="hljs-number">0.444</span>]]<br><span class="hljs-built_in">dict</span> = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    n = n + <span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">0</span>], key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">1</span>], key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">2</span>], key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">3</span>]&#125;<br>    <span class="hljs-built_in">dict</span>[<span class="hljs-string">&#x27;row&#x27;</span> + <span class="hljs-built_in">str</span>(n)] = entry<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">dict</span><br>    <br><br>list_1 = []<br><span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> <span class="hljs-built_in">dict</span>:<br>    key = <span class="hljs-built_in">dict</span>[entry]<br>    list_1.append([key[<span class="hljs-string">&#x27;protein&#x27;</span>], key[<span class="hljs-string">&#x27;ext1&#x27;</span>], key[<span class="hljs-string">&#x27;ext2&#x27;</span>], key[<span class="hljs-string">&#x27;ext3&#x27;</span>]])<br><span class="hljs-built_in">print</span> list_1<br><br>out = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table:<br>    line = [<span class="hljs-built_in">str</span>(cell) <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row]<br>    out = out + <span class="hljs-string">&#x27;\t&#x27;</span>.join(line) + <span class="hljs-string">&#x27;\n&#x27;</span><br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>).write(out)<br></code></pre></td></tr></table></figure>
<h3><span id="7-5-1">7.5.1</span><a href="#7-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> table<br><br>ext1 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext1.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">1</span>]))<br><br>ext2 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext2.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">2</span>]))<br><br>ext3 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext3.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">3</span>]))<br><br>ave1 = <span class="hljs-built_in">sum</span>(ext1)/<span class="hljs-built_in">len</span>(ext1)<br>ave2 = <span class="hljs-built_in">sum</span>(ext2)/<span class="hljs-built_in">len</span>(ext2)<br>ave3 = <span class="hljs-built_in">sum</span>(ext3)/<span class="hljs-built_in">len</span>(ext3)<br>ave_all = [<span class="hljs-string">&#x27;average&#x27;</span>, ave1, ave2, ave3]<br><br>table.insert(<span class="hljs-number">7</span>, ave_all)<br><span class="hljs-built_in">print</span> table<br></code></pre></td></tr></table></figure>
<h3><span id="7-5-2">7.5.2</span><a href="#7-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-built_in">dict</span> = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    n = n+<span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">0</span>], key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">1</span>], key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">2</span>], key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">3</span>]&#125;<br>    <span class="hljs-built_in">dict</span>[<span class="hljs-string">&#x27;row&#x27;</span>+<span class="hljs-built_in">str</span>(n)] = entry<br><br><span class="hljs-built_in">print</span> <span class="hljs-built_in">dict</span><br></code></pre></td></tr></table></figure>
<h3><span id="7-5-3">7.5.3</span><a href="#7-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>RNA_table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;RNA_table.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    RNA_table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> RNA_table<br></code></pre></td></tr></table></figure>
<h3><span id="7-5-4">7.5.4</span><a href="#7-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>RNA_table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;RNA_table.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    RNA_table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><br><span class="hljs-built_in">print</span> RNA_table<br><br>RNA_dic = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = RNA_table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> RNA_table[<span class="hljs-number">1</span>:]:<br>    n = n+<span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">1</span>],key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">2</span>],key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">3</span>],key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">4</span>]&#125;<br>    RNA_dic[n] = entry<br><span class="hljs-built_in">print</span> RNA_dic<br>                    <br>seq1 = <span class="hljs-string">&#x27;AGCAUCUA&#x27;</span><br>seq2 = <span class="hljs-string">&#x27;ACCGUUCU&#x27;</span><br><br>seq_dic = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;U&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>&#125;<br><br>score = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> base1, base2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(seq1,seq2):<br>    entry = RNA_dic[<span class="hljs-built_in">float</span>(seq_dic[base1])]<br>    score = score + <span class="hljs-built_in">float</span>(entry[base2])<br><span class="hljs-built_in">print</span> score<br></code></pre></td></tr></table></figure>
<h3><span id="7-5-5">7.5.5</span><a href="#7-5-5" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>lowry_data = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lowry_data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    lowry_data.append(line.strip().split())<br><span class="hljs-built_in">print</span> lowry_data[<span class="hljs-number">1</span>]<br><br>    <br>lowry_table = lowry_data[<span class="hljs-number">1</span>:]<br>protein, ext1, ext2, ext3 = <span class="hljs-built_in">zip</span>(*lowry_table)<br>new_table = <span class="hljs-built_in">zip</span>(protein)<br><span class="hljs-keyword">for</span> prot <span class="hljs-keyword">in</span> new_table:<br>    <span class="hljs-built_in">print</span> prot<br><br>lowry_dic = &#123;&#125;<br>n = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> lowry_data[<span class="hljs-number">1</span>:]:<br>    key = &#123;<span class="hljs-string">&#x27;ext1&#x27;</span>:row[<span class="hljs-number">1</span>],<span class="hljs-string">&#x27;ext2&#x27;</span>:row[<span class="hljs-number">2</span>],<span class="hljs-string">&#x27;ext3&#x27;</span>:row[<span class="hljs-number">3</span>]&#125;<br>    lowry_dic[row[n]] = key<br><span class="hljs-built_in">print</span> lowry_dic<br>    <br>    <br><span class="hljs-built_in">print</span> lowry_dic[<span class="hljs-string">&#x27;0.16&#x27;</span>]    <br><br><span class="hljs-built_in">print</span> lowry_dic.keys()<br></code></pre></td></tr></table></figure>
<h2><span id="lesson8">lesson8</span><a href="#lesson8" class="header-anchor">#</a></h2><h3><span id="8-5-1">8.5.1</span><a href="#8-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lowry_data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new_lowry_data&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br>header = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>        columns = line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>        table.append(columns)<br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    columns = line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    columns[<span class="hljs-number">1</span>] = <span class="hljs-built_in">float</span>(columns[<span class="hljs-number">1</span>])<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">1</span>))<br><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">3</span>:<br>        row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>        output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        i = i+<span class="hljs-number">1</span><br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="8-5-2">8.5.2</span><a href="#8-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_by_length_Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br>length = <span class="hljs-number">0</span><br>header = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        length = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line.strip()<br>        length += <span class="hljs-built_in">len</span>(line)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        row = [header, seq, length]<br>        table.append(row)<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> header != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    row = [header, seq, length]<br>    table.append(row)<br><br><br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table:<br>    row[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(row[<span class="hljs-number">2</span>])<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">2</span>))<br><br>output_file.write(<span class="hljs-string">&#x27;Gene ID&#x27;</span> +<span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;sequence&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;seq length&#x27;</span> + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>output_file.close()<br>input_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="8-5-3">8.5.3</span><a href="#8-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;excel_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_excel_file.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    row = line.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    table.append(row)<br><span class="hljs-built_in">print</span> table<br><br>table_new = []<br><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    col[<span class="hljs-number">3</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">3</span>])<br>    col[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">2</span>])<br>    col[<span class="hljs-number">1</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">1</span>])<br>    col[<span class="hljs-number">0</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">0</span>])<br>    table_new.append(col)<br>table_new_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>))<br><br><span class="hljs-built_in">print</span> table_new_sorted<br><br>output_file.write(<span class="hljs-string">&#x27;protein&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;ext1&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;ext2&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> +<span class="hljs-string">&#x27;ext3&#x27;</span> + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_new_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="8-5-4">8.5.4</span><a href="#8-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>dic = &#123;&#125;<br>header = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line.strip()<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        dic[header] = seq<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    dic[header] = seq<br><br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(dic):<br>    <span class="hljs-built_in">print</span> key, dic[key]<br><br>input_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="8-5-5">8.5.5</span><a href="#8-5-5" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;BlastOut.csv&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_blastout.csv&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    col = line.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    col[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">2</span>])<br>    table.append(col)<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">2</span>),reverse = <span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="sort-table">sort table</span><a href="#sort-table" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;random_distribution.tsv&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    columns = line.split()<br>    columns = [<span class="hljs-built_in">float</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> columns]<br>    table.append(columns)<br><br>column = <span class="hljs-number">1</span><br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(column))<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\t&#x27;</span>.join(row)<br></code></pre></td></tr></table></figure>
<h2><span id="lesson9">lesson9</span><a href="#lesson9" class="header-anchor">#</a></h2><h3><span id="9-5-1">9.5.1</span><a href="#9-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>pro_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    pro_seq += line<br><span class="hljs-keyword">for</span> base <span class="hljs-keyword">in</span> pro_seq:<br>    motif = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;C(.&#123;1,4&#125;)C&#x27;</span>)<br>    all_matches = motif.findall(pro_seq)<br>    matches = motif.finditer(pro_seq)<br><span class="hljs-keyword">if</span> all_matches:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;motif matched:&#x27;</span><br>    <span class="hljs-keyword">for</span> motif <span class="hljs-keyword">in</span> matches:<br>        <span class="hljs-built_in">print</span> motif.group()<br>input_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="9-5-2">9.5.2</span><a href="#9-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;multiple abstracts.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>text = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    text += line<br>word1 = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;[Ii][Nn]&#x27;</span>)<br>word2 = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;[In][Ss]&#x27;</span>)<br><br><br>word1_matches = word1.findall(text)<br>word2_matches = word2.findall(text)<br><br>number1 = <span class="hljs-number">0</span><br>number2 = <span class="hljs-number">0</span><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;in:&#x27;</span>,<span class="hljs-built_in">len</span>(word1_matches)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;is&#x27;</span>,<span class="hljs-built_in">len</span>(word2_matches)<br><br>input_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="9-5-3">9.5.3</span><a href="#9-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>header = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br>Homo_kinase_seq = <span class="hljs-string">&#x27;&#x27;</span><br>motif = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;R.[ST][^P]&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;kinase&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq = line<br>        Homo_kinase_seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>        Homo_kinase_seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;kinase&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><br>motif_match = motif.findall(Homo_kinase_seq)<br><span class="hljs-built_in">print</span> motif_match<br></code></pre></td></tr></table></figure>
<h3><span id="9-5-4">9.5.4</span><a href="#9-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br><br>url = <span class="hljs-string">&#x27;https://pubmed.ncbi.nlm.nih.gov/18235848/&#x27;</span><br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><br><br>author_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;data-ga-label=&quot;(.&#123;10,40&#125;)&lt;&#x27;</span>)<br>author_text = author_regexp.finditer(html)<br><br><br><span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> author_text:<br>    <span class="hljs-built_in">print</span> name.group(<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span> name.start()<br>    <span class="hljs-built_in">print</span> name.end()<br></code></pre></td></tr></table></figure>
<h3><span id="find-tfbs-matches-in-genome">find TFBS matches in genome</span><a href="#find-tfbs-matches-in-genome" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br>genome_seq = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;genome.txt&#x27;</span>).read()<br>sites = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;TFBS.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    fields = line.split()<br>    site = fields[<span class="hljs-number">1</span>]<br>    tf = fields[<span class="hljs-number">0</span>]<br>    sites.append((tf,site))<br><br><span class="hljs-keyword">for</span> tf,site <span class="hljs-keyword">in</span> sites:<br>    tfsite = re.<span class="hljs-built_in">compile</span>(site)<br>    all_matches = tfsite.findall(genome_seq)<br>    matches = tfsite.finditer(genome_seq)<br>    <span class="hljs-keyword">if</span> all_matches:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;tf&#x27;</span>,<span class="hljs-string">&#x27;:&#x27;</span><br>        <span class="hljs-keyword">for</span> tfbs <span class="hljs-keyword">in</span> matches:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\t&#x27;</span>,tfbs.group(),tfbs.start(),tfbs.end()<br></code></pre></td></tr></table></figure>
<h3><span id="read-html">read html</span><a href="#read-html" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br>pmid = <span class="hljs-string">&#x27;18235848&#x27;</span><br>url = <span class="hljs-string">&#x27;http://www.ncbi.nlm.nih.gov/pubmed?term=%s&#x27;</span> % pmid<br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><span class="hljs-built_in">print</span> html<br>title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>title_text = title_regexp.search(html)<br>abstract_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&quot;S.&#123;20,3000&#125;\.&quot;&#x27;</span>)<br>abstract_text = abstract_regexp.search(html)<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;ABSTRACT:&#x27;</span>, abstract_text.group()<br></code></pre></td></tr></table></figure>
<h3><span id="read-multiple-html">read multiple html</span><a href="#read-multiple-html" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br>pmid = [<span class="hljs-string">&#x27;18235848&#x27;</span>,<span class="hljs-string">&#x27;22607149&#x27;</span>,<span class="hljs-string">&#x27;2405002&#x27;</span>,<span class="hljs-string">&#x27;21630672&#x27;</span>]<br><span class="hljs-keyword">for</span> pmid <span class="hljs-keyword">in</span> pmid:<br>    url = <span class="hljs-string">&#x27;http://www.ncbi.nlm.nih.gov/pubmed?term=%s&#x27;</span> % pmid<br>    <span class="hljs-keyword">import</span> ssl<br>    ssl._create_default_https_context = ssl._create_unverified_context<br>    handler = urllib2.urlopen(url)<br>    html = handler.read()<br>    title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>    title_text = title_regexp.search(html)<br>    abstract_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&quot;S.&#123;20,3000&#125;\.&quot;&#x27;</span>)<br>    abstract_text = abstract_regexp.search(html)<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;ABSTRACT:&#x27;</span>, abstract_text.group()<br></code></pre></td></tr></table></figure>
<h3><span id="read-title-from-ao3-html">read title from AO3 html</span><a href="#read-title-from-ao3-html" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br><br>url = <span class="hljs-string">&#x27;https://archiveofourown.org/works/7289389&#x27;</span><br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><span class="hljs-built_in">print</span> html<br>title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>title_text = title_regexp.search(html)<br><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br></code></pre></td></tr></table></figure>
<h2><span id="lesson10">lesson10</span><a href="#lesson10" class="header-anchor">#</a></h2><h3><span id="10-5-1">10.5.1</span><a href="#10-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> struct<br><br>seq = []<br>header = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">turn_pdb_to_fasta</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read a pdb file and turn to fasta file&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">global</span> header,seq<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(pdb_file):<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;DBREF&#x27;</span>):<br>            header = line.split()[<span class="hljs-number">6</span>]<br>        <span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;SEQRES&#x27;</span>):<br>            seq.append(line.split()[<span class="hljs-number">4</span>:])<br>    <span class="hljs-keyword">return</span> header, seq<br><br><br>header, seq = turn_pdb_to_fasta(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>)<br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;&gt;&#x27;</span> + header + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>proseq = <span class="hljs-string">&#x27;&#x27;</span><br>aa_codes = &#123;<br>     <span class="hljs-string">&#x27;ALA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CYS&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;ASP&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GLU&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br>     <span class="hljs-string">&#x27;PHE&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;GLY&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;HIS&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;LYS&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>     <span class="hljs-string">&#x27;ILE&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;LEU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;MET&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;ASN&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>     <span class="hljs-string">&#x27;PRO&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;GLN&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;ARG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;SER&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>     <span class="hljs-string">&#x27;THR&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;VAL&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;TYR&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;TRP&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> seq:<br>    <span class="hljs-keyword">for</span> aa <span class="hljs-keyword">in</span> row:<br>        aa_name = aa_codes[aa]<br>        proseq += aa_name<br><span class="hljs-built_in">print</span> proseq<br></code></pre></td></tr></table></figure>
<h3><span id="10-5-2">10.5.2</span><a href="#10-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> save_multiple_fasta_from_fasta <span class="hljs-keyword">import</span> save_ac_and_seq_from_fasta<br>AC = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>) <span class="hljs-keyword">and</span> AC == <span class="hljs-string">&#x27;&#x27;</span>:<br>        AC = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> AC != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>    <span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>) <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        save_ac_and_seq_from_fasta(AC, seq)<br>        AC = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">if</span> AC != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    save_ac_and_seq_from_fasta(AC, seq)<br></code></pre></td></tr></table></figure>
<h3><span id="10-5-3">10.5.3</span><a href="#10-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> calculate_atom_distance <span class="hljs-keyword">import</span> calculate_distance<br><span class="hljs-keyword">from</span> get_main_residues_from_1TLD_pdb <span class="hljs-keyword">import</span> parse_atom_line<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_3_result.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_ca_atoms</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;get all ca atom data from pdb&#x27;&#x27;&#x27;</span><br>    pdb = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>    ca_list = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> pdb:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;ATOM&#x27;</span>):<br>            data = parse_atom_line(line)<br>            chain, res_type, res_num, atom, x, y, z = data<br>            <span class="hljs-keyword">if</span> atom == <span class="hljs-string">&#x27;CA&#x27;</span> <span class="hljs-keyword">and</span> chain == <span class="hljs-string">&#x27;A&#x27;</span>:<br>                ca_list.append(data)<br>    pdb.close()<br>    <span class="hljs-keyword">return</span> ca_list<br><br>ca_atoms = get_ca_atoms(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>)<br><span class="hljs-keyword">for</span> i, atom1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ca_atoms):<br>    name1 = atom1[<span class="hljs-number">1</span>] + atom1[<span class="hljs-number">2</span>]<br>    coord1 = atom1[<span class="hljs-number">4</span>:]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(ca_atoms)):<br>        atom2 = ca_atoms[j]<br>        name2 = atom2[<span class="hljs-number">1</span>] + atom2[<span class="hljs-number">2</span>]<br>        coord2 = atom2[<span class="hljs-number">4</span>:]<br>        dist = calculate_distance(coord1, coord2)<br>        output_file.write(name1 + <span class="hljs-string">&#x27;\t&#x27;</span> + name2 + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-built_in">str</span>(dist) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output_file.close()<br>            <br><span class="hljs-built_in">input</span> = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_3_result.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>all_distance = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>:<br>    distance = <span class="hljs-built_in">float</span>(line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)[<span class="hljs-number">2</span>])<br>    all_distance.append(distance)<br><br><span class="hljs-built_in">min</span>(all_distance)<br></code></pre></td></tr></table></figure>
<h3><span id="10-5-4">10.5.4</span><a href="#10-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> calculate_atom_distance <span class="hljs-keyword">import</span> calculate_distance<br><span class="hljs-keyword">from</span> get_main_residues_from_1TLD_pdb <span class="hljs-keyword">import</span> parse_atom_line<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_4_result.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_ca_atoms</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;get all ca atom data from pdb&#x27;&#x27;&#x27;</span><br>    pdb = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;3G5U.pdb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>    list_A = []<br>    list_B = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> pdb:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;ATOM&#x27;</span>):<br>            data = parse_atom_line(line)<br>            chain, res_type, res_num, atom, x, y, z = data<br>            <span class="hljs-keyword">if</span> chain == <span class="hljs-string">&#x27;A&#x27;</span>:<br>                list_A.append(data)<br>            <span class="hljs-keyword">elif</span> chain == <span class="hljs-string">&#x27;B&#x27;</span>:<br>                list_B.append(data)<br>                <br>    pdb.close()<br>    <span class="hljs-keyword">return</span> list_A, list_B<br><br>A_atoms, B_atoms = get_ca_atoms(<span class="hljs-string">&#x27;3G5U.pdb&#x27;</span>)<br><span class="hljs-keyword">for</span> i, atom1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(A_atoms):<br>    name1 = atom1[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;\t&#x27;</span> + atom1[<span class="hljs-number">1</span>] + atom1[<span class="hljs-number">2</span>]<br>    coord1 = atom1[<span class="hljs-number">4</span>:]<br>    <span class="hljs-keyword">for</span> j, atom2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(B_atoms):<br>        atom2 = B_atoms[j]<br>        name2 = atom1[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;\t&#x27;</span> + atom2[<span class="hljs-number">1</span>] + atom2[<span class="hljs-number">2</span>]<br>        coord2 = atom2[<span class="hljs-number">4</span>:]<br>        dist = calculate_distance(coord1, coord2)<br>        <span class="hljs-keyword">if</span> dist &lt; <span class="hljs-number">6</span>:<br>            output_file.write(name1 + <span class="hljs-string">&#x27;\t&#x27;</span> + name2 + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-built_in">str</span>(dist) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="10-5-5">10.5.5</span><a href="#10-5-5" class="header-anchor">#</a></h3><p>protein_accessibility_prediction.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">accessibility</span>(<span class="hljs-params">input_seq</span>):</span><br>    output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>    pref_E = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br>    pref_H = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;0.97&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;1.30&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.80&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;0.26&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.28&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.81&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;0.71&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.60&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;0.74&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.22&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.67&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.62&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.63&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.90&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.72&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.19&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;1.29&#x27;</span>&#125;<br>    <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>        <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> pref_H <span class="hljs-keyword">and</span> res <span class="hljs-keyword">in</span> pref_E:<br>            <span class="hljs-keyword">if</span> pref_H[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_E[res] &lt; pref_H[res]:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;H&#x27;</span><br>            <span class="hljs-keyword">elif</span> pref_E[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_H[res] &lt; pref_E[res]:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;E&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;L&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br>    <span class="hljs-keyword">return</span> output_seq<br></code></pre></td></tr></table></figure>
<p>protein_disorder_predict.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">protein_disorder_predict</span>(<span class="hljs-params">input_seq</span>):</span><br>    propensities = &#123;<span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-number">0.2299</span>, <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-number">0.5523</span>, <span class="hljs-string">&#x27;Q&#x27;</span>:-<span class="hljs-number">0.18770</span>, <span class="hljs-string">&#x27;A&#x27;</span>:-<span class="hljs-number">0.2615</span>,<br>    <span class="hljs-string">&#x27;R&#x27;</span>:-<span class="hljs-number">0.1766</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0.1429</span>, <span class="hljs-string">&#x27;C&#x27;</span>:-<span class="hljs-number">0.01515</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-number">0.0089</span>,<br>    <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">0.2276</span>, <span class="hljs-string">&#x27;E&#x27;</span>:-<span class="hljs-number">0.2047</span>, <span class="hljs-string">&#x27;V&#x27;</span>:-<span class="hljs-number">0.38620</span>, <span class="hljs-string">&#x27;F&#x27;</span>:-<span class="hljs-number">0.2256</span>,<br>    <span class="hljs-string">&#x27;W&#x27;</span>:-<span class="hljs-number">0.2434</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-number">0.4332</span>, <span class="hljs-string">&#x27;H&#x27;</span>:-<span class="hljs-number">0.00120</span>, <span class="hljs-string">&#x27;Y&#x27;</span>:-<span class="hljs-number">0.2075</span>,<br>    <span class="hljs-string">&#x27;I&#x27;</span>:-<span class="hljs-number">0.4222</span>, <span class="hljs-string">&#x27;K&#x27;</span>:-<span class="hljs-number">0.1001</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">0.33793</span>, <span class="hljs-string">&#x27;M&#x27;</span>:-<span class="hljs-number">0.2259</span>&#125;<br>    output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>    threshod = <span class="hljs-number">0.3</span><br>    <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>        <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> propensities:<br>            <span class="hljs-keyword">if</span> propensities[res] &gt;= threshod:<br>                output_seq = output_seq + res.upper()<br>            <span class="hljs-keyword">else</span>:<br>                output_seq = output_seq + res.lower()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized charachter:&#x27;</span> , res<br>    <span class="hljs-keyword">return</span> output_seq<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> protein_disorder_predict <span class="hljs-keyword">import</span> protein_disorder_predict<br><span class="hljs-keyword">from</span> protein_accessibility_predict <span class="hljs-keyword">import</span> accessibility<br><br>input_seq = <span class="hljs-string">&#x27;MTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLLSVAYKNVVGARRSS\</span><br><span class="hljs-string">WRVISSIEQKTERNEKKQQMGKEYREKIEAELQDICNDVLELLDKYLIPNATQPESKVFY\</span><br><span class="hljs-string">LKMKGDYFRYLSEVASGDNKQTTVSNSQQAYQEAFEISKKEMQPTHPIRLGLALNFSVFY\</span><br><span class="hljs-string">YEILNSPEKACSLAKTAFDEAIAELDTLNEESYKDSTLIMQLLRDNLTLWTSENQGDEGD\</span><br><span class="hljs-string">AGEGEN&#x27;</span><br><br>predictor = <span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-keyword">if</span> predictor == <span class="hljs-string">&#x27;1&#x27;</span>:<br>    prediction = protein_disorder_predict(input_seq)<br>    <span class="hljs-built_in">print</span> prediction<br><span class="hljs-keyword">elif</span> predictor == <span class="hljs-string">&#x27;2&#x27;</span>:<br>    prediction = accessibility(input_seq)<br>    <span class="hljs-built_in">print</span> prediction<br></code></pre></td></tr></table></figure>
<h2><span id="lesson11">lesson11</span><a href="#lesson11" class="header-anchor">#</a></h2><h3><span id="11-5-1-11-5-2">11.5.1+11.5.2</span><a href="#11-5-1-11-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + self.get_PDB_code() + self.get_angle1() + self.get_angle2()<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure>
<h3><span id="11-5-3">11.5.3</span><a href="#11-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + <span class="hljs-string">&#x27;\t&#x27;</span> +\<br>               self.get_PDB_code() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle1() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle2()<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure>
<h3><span id="11-5-4-module">11.5.4_module</span><a href="#11-5-4-module" class="header-anchor">#</a></h3><p>TRANSMEMBRANE_HELICES</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + <span class="hljs-string">&#x27;\t&#x27;</span> +\<br>               self.get_PDB_code() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle1() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle2()<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> TRANSMEMBRANE_HELICES <span class="hljs-keyword">import</span> transmembrane_helices<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure>
<h3><span id="11-5-5">11.5.5</span><a href="#11-5-5" class="header-anchor">#</a></h3><p>neurons</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">neuron_data = []<br><span class="hljs-keyword">import</span> math<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DentriticLengths</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, filename</span>):</span><br>        self.filename = filename<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_data</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        <span class="hljs-keyword">return</span> neuron_data<br>        <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_average</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        average = <span class="hljs-built_in">sum</span>(neuron_data)/<span class="hljs-built_in">len</span>(neuron_data)<br>        <span class="hljs-keyword">return</span> average<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_sttddev</span>(<span class="hljs-params">self</span>):</span><br>        square = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        average = <span class="hljs-built_in">sum</span>(neuron_data)/<span class="hljs-built_in">len</span>(neuron_data)<br>        <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_data:<br>            n = length - average<br>            square += n**<span class="hljs-number">2</span><br>        sttddev = math.sqrt(square / <span class="hljs-built_in">len</span>(neuron_data))<br>        <span class="hljs-keyword">return</span> sttddev<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(neuron_data), <span class="hljs-built_in">str</span>(self.get_average()), <span class="hljs-built_in">str</span>(self.get_sttddev())<br><br><br>n = DentriticLengths(<span class="hljs-string">&quot;neuron_data.txt&quot;</span>)<br><span class="hljs-built_in">print</span> n.get_data()<br><span class="hljs-built_in">print</span> n.get_average()<br><span class="hljs-built_in">print</span> n.get_sttddev()<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> neurons <span class="hljs-keyword">import</span> DentriticLengths<br><br>n = Dentriticlengths(<span class="hljs-string">&quot;neuron_data.txt&quot;</span>)<br><span class="hljs-built_in">print</span> n<br></code></pre></td></tr></table></figure>
<h2><span id="lesson12">lesson12</span><a href="#lesson12" class="header-anchor">#</a></h2><h3><span id="12-5-1">12.5.1</span><a href="#12-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = bigger + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondary = [], []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span>:<br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br>primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.txt&#x27;</span>)<br>count_pri = evaluate_data(primary)<br>count_sec = evaluate_data(secondary)<br>write_output(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br></code></pre></td></tr></table></figure>
<h3><span id="12-5-2">12.5.2</span><a href="#12-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = bigger + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondary = [], []<br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span>:<br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br><span class="hljs-keyword">try</span>:<br>    primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.xls&#x27;</span>)<br>    count_pri = evaluate_data(primary)<br>    count_sec = evaluate_data(secondary)<br>    write_output(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br><span class="hljs-keyword">except</span> IOError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;You have input a wrong file name&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure>
<h3><span id="12-5-3">12.5.3</span><a href="#12-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_input_file</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read input file and turn it to data&#x27;&#x27;&#x27;</span><br>    neuron_length = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        length = <span class="hljs-built_in">float</span>(line.split()[<span class="hljs-number">1</span>])<br>        neuron_length.append(length)<br>    <span class="hljs-keyword">return</span> neuron_length<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br><span class="hljs-keyword">try</span>:<br>    filename = <span class="hljs-string">&quot;12_5_3_test.txt&quot;</span><br>    neuron_length = read_input_file(filename)<br>    <span class="hljs-built_in">print</span> calculate_average(neuron_length)<br>    <span class="hljs-built_in">print</span> calculate_stdev(neuron_length)<br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;could not convert string to float: -&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure>
<h3><span id="12-5-4">12.5.4</span><a href="#12-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_input_file</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read input file and turn it to data&#x27;&#x27;&#x27;</span><br>    neuron_length = []<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>            <span class="hljs-keyword">try</span>:<br>                length = <span class="hljs-built_in">float</span>(line.split()[<span class="hljs-number">1</span>])<br>                neuron_length.append(length)<br>            <span class="hljs-keyword">except</span> ValueError:<br>                <span class="hljs-built_in">print</span> <span class="hljs-string">&quot; - can not be transformed into float&quot;</span><br>                <span class="hljs-keyword">raise</span> SystemExit       <br>        <span class="hljs-keyword">return</span> neuron_length<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;could not convert string to float: -&quot;</span><br>        <span class="hljs-keyword">raise</span> SystemExit<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br><br>filename = <span class="hljs-string">&quot;12_5_3_test.txt&quot;</span><br>neuron_length = read_input_file(filename)<br><span class="hljs-built_in">print</span> calculate_average(neuron_length)<br><span class="hljs-built_in">print</span> calculate_stdev(neuron_length)<br></code></pre></td></tr></table></figure>
<h3><span id="12-5-5">12.5.5</span><a href="#12-5-5" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br>        <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">float_neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(float_neuron_length)/<span class="hljs-built_in">len</span>(float_neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">float_neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(float_neuron_length)/<span class="hljs-built_in">len</span>(float_neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> float_neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(float_neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br>raw_neuron_length = []<br>float_neuron_length = []<br>number = <span class="hljs-literal">None</span><br><span class="hljs-keyword">while</span> number != <span class="hljs-string">&#x27;q&#x27;</span>:<br>    number = raw_input(<span class="hljs-string">&quot;Insert a number: &quot;</span>)<br>    raw_neuron_length.append(number)<br><span class="hljs-built_in">print</span> raw_neuron_length<br><span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> raw_neuron_length:<br>    <span class="hljs-keyword">if</span> length != <span class="hljs-string">&#x27;q&#x27;</span>:<br>        float_neuron_length.append(<span class="hljs-built_in">float</span>(length))<br><span class="hljs-built_in">print</span> float_neuron_length<br>   <br><span class="hljs-built_in">print</span> calculate_average(float_neuron_length)<br><span class="hljs-built_in">print</span> calculate_stdev(float_neuron_length)<br></code></pre></td></tr></table></figure>
<h3><span id="handling-exceptions">handling exceptions</span><a href="#handling-exceptions" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Catching errors with try.. except</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.3.3 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">try</span>:<br>    a = <span class="hljs-built_in">float</span>(raw_input(<span class="hljs-string">&quot;Insert a number:&quot;</span>))<br>    <span class="hljs-built_in">print</span> a<br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;You haven&#x27;t inserted a number. Please retry.&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure>
<h3><span id="handling-exceptions-else">handling exceptions else</span><a href="#handling-exceptions-else" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Catching errors with try.. except.. else</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.3.3 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">try</span>:<br>    filename = raw_input(<span class="hljs-string">&quot;Insert a filename:&quot;</span>)<br>    in_file = <span class="hljs-built_in">open</span>(filename)<br><span class="hljs-keyword">except</span> IOError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;The filename %s has not been found.&quot;</span> % filename<br>    <span class="hljs-keyword">raise</span> SystemExit<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> in_file:<br>        <span class="hljs-built_in">print</span> line<br>        in_file.close()<br></code></pre></td></tr></table></figure>
<h3><span id="programs-with-bugs">programs with bugs</span><a href="#programs-with-bugs" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">A program with bugs. Try to fix them all!</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.2.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondry = [], []<br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span><br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br>primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.xls&#x27;</span>)<br>count_pri = evaluate_data(primary)<br>count_sec = evaluate_data(secondary)<br>write_output_file(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br></code></pre></td></tr></table></figure>
<h2><span id="lesson13">lesson13</span><a href="#lesson13" class="header-anchor">#</a></h2><h3><span id="13-5-1">13.5.1</span><a href="#13-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rpy2.robjects <span class="hljs-keyword">as</span> robjects<br>r = robjects.r<br>table = r(<span class="hljs-string">&quot;read.table(&#x27;data_for_practice_1.txt&#x27;, sep = &#x27;\t&#x27;)&quot;</span>)<br>m = r.mean(table[<span class="hljs-number">1</span>], trim = <span class="hljs-number">0</span>, na_rm = <span class="hljs-string">&#x27;FALSE&#x27;</span>)<br>sdev = r.sd(table[<span class="hljs-number">1</span>])<br>value = <span class="hljs-number">0.01844</span><br>zscore = (m[<span class="hljs-number">0</span>] - value)/sdev[<span class="hljs-number">0</span>]<br>x = r.<span class="hljs-built_in">abs</span>(zscore)<br>pvalue = r.pnorm(-x[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span> m[<span class="hljs-number">0</span>], sdev[<span class="hljs-number">0</span>], zscore, pvalue[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure>
<h3><span id="arguments">arguments</span><a href="#arguments" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-built_in">print</span> sys.argv<br></code></pre></td></tr></table></figure>
<h3><span id> </span><a href="#" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rpy2.robjects <span class="hljs-keyword">as</span> robjects<br>r = robjects.r<br>table = r(<span class="hljs-string">&quot;read.table(&#x27;Chi-square_input.txt&#x27;,header = TRUE, sep = &#x27;\t&#x27;)&quot;</span>)<br>cont_table = r.table(table[<span class="hljs-number">1</span>],table[<span class="hljs-number">2</span>])<br>chitest = r(<span class="hljs-string">&#x27;chisq.test&#x27;</span>)<br><span class="hljs-built_in">print</span> chitest(table[<span class="hljs-number">1</span>],table[<span class="hljs-number">2</span>])<br></code></pre></td></tr></table></figure>
<h3><span id="os-listdir-test">os_listdir_test</span><a href="#os-listdir-test" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(<span class="hljs-string">&#x27;/Users/keqinliu/studying document/bioinfo/python/practice/chapter13-practice&#x27;</span>):<br>    os.system(<span class="hljs-string">&#x27;&lt;my_program&gt;%s&#x27;</span>%(filename))<br></code></pre></td></tr></table></figure>
<h2><span id="lesson14">lesson14</span><a href="#lesson14" class="header-anchor">#</a></h2><h3><span id="14-5-4">14.5.4</span><a href="#14-5-4" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>dir_list = os.listdir(<span class="hljs-string">&#x27;/Users/keqinliu/studying_document/bioinfo/python_practice/chapter14-practice/&#x27;</span>)<br><span class="hljs-built_in">print</span> dir_list<br>dir_count = <span class="hljs-built_in">len</span>(dir_list)<br><span class="hljs-built_in">print</span> dir_count<br></code></pre></td></tr></table></figure>
<h3><span id="avoid-file-closing-lag">avoid_file_closing_lag</span><a href="#avoid-file-closing-lag" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Avoid the lag when applications share files.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 14.3.5 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br>sys.path.append(<span class="hljs-string">&#x27;/home/RNA-seq/&#x27;</span>)<br><span class="hljs-keyword">from</span> pathvariables <span class="hljs-keyword">import</span> tophat_dir, index_dir, cufflinks_dir<br><br><span class="hljs-comment"># the tophat program creates a file </span><br>os.system(<span class="hljs-string">&#x27;tophat -o &#x27;</span> + tophat_dir + <span class="hljs-string">&#x27; &#x27;</span> + index_dir + <span class="hljs-string">&#x27;sample.fastq&#x27;</span>)<br><br><span class="hljs-comment"># here we don&#x27;t know whether the tophat output file is already finished</span><br><span class="hljs-comment"># we open and close a dummy file, so the operating system catches up</span><br>lag_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dummy.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>lag_file.write(<span class="hljs-string">&#x27;tophat completed&#x27;</span>)<br>lag_file.close()<br><br><span class="hljs-comment"># read the output file</span><br><span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">&#x27;/home/RNA-seq/dummy.txt&#x27;</span>):	<br>    os.system(<span class="hljs-string">&#x27;cufflinks -o &#x27;</span> + cufflinks_dir + <span class="hljs-string">&#x27; &#x27;</span><br>              + tophat_dir + <span class="hljs-string">&#x27;/accepted_hits.bam&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h3><span id="bl2seq-wrapper">bl2seq_wrapper</span><a href="#bl2seq-wrapper" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Python wrapper for the bl2seq program.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 15.4.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> urllib2<br><br>sys.path.append(<span class="hljs-string">&#x27;pathmodules/&#x27;</span>)<br><span class="hljs-keyword">from</span> blastvariables <span class="hljs-keyword">import</span> *<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_bl2seq</span>(<span class="hljs-params">seq1, seq2</span>):</span><br>    os.system(<span class="hljs-string">&quot;bl2seq -p blastp -i &quot;</span> + input_seq + seq1 + <span class="hljs-string">&quot;.fasta -j &quot;</span><br>              + input_seq + seq2 + <span class="hljs-string">&quot;.fasta -o &quot;</span> + blast_out + seq1<br>              + <span class="hljs-string">&quot;-&quot;</span> + seq2 + <span class="hljs-string">&quot;.aln&quot;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_seq</span>(<span class="hljs-params">seq1, seq2</span>):</span><br>    <span class="hljs-keyword">for</span> seq <span class="hljs-keyword">in</span> (seq1, seq2):<br>        url = <span class="hljs-string">&#x27;http://www.uniprot.org/uniprot/&#x27;</span> + seq + <span class="hljs-string">&#x27;.fasta&#x27;</span><br>        handler = urllib2.urlopen(url)<br>        fasta = handler.read()<br>        out = <span class="hljs-built_in">open</span>(input_seq + seq + <span class="hljs-string">&#x27;.fasta&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>        out.write(fasta)<br>        out.close()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">try</span>:<br>        seq1 = sys.argv[<span class="hljs-number">1</span>]<br>        seq2 = sys.argv[<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;usage: Bl2seqWrapper.py seq1-UniprotAC seq2-UniprotAC&#x27;</span><br>        <span class="hljs-keyword">raise</span> SystemExit<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> os.path.exists(input_seq + seq1 + <span class="hljs-string">&#x27;.fasta&#x27;</span>) <span class="hljs-keyword">and</span> os.path.exists(input_seq + seq2 + <span class="hljs-string">&#x27;.fasta&#x27;</span>):<br>            run_bl2seq(seq1, seq2)<br>        <span class="hljs-keyword">else</span>:<br>            get_seq(seq1, seq2)<br>            run_bl2seq(seq1, seq2)<br></code></pre></td></tr></table></figure>
<h3><span id="cuffcompare-pipeline">cuffcompare_pipeline</span><a href="#cuffcompare-pipeline" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Run two external programs from one Python script.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 14.2.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> os<br><br>tophat_output_dir = <span class="hljs-string">&#x27;/home/RNA-seq/tophat&#x27;</span><br>tophat_output_file = <span class="hljs-string">&#x27;accepted_hits.bam&#x27;</span><br>bowtie_index_dir = <span class="hljs-string">&#x27;/home/RNA-seq/index&#x27;</span><br>cufflinks_output_dir = <span class="hljs-string">&#x27;/home/RNA-seq/cufflinks&#x27;</span><br>cufflinks_output_file = <span class="hljs-string">&#x27;transcripts.gtf&#x27;</span><br>illumina_output_file = <span class="hljs-string">&#x27;sample.fastq&#x27;</span><br><br>tophat_command = <span class="hljs-string">&#x27;tophat -o %s %s %s&#x27;</span> % (tophat_output_dir, bowtie_index_dir, illumina_output_file)<br>os.system(tophat_command)<br><br>cufflinks_command = <span class="hljs-string">&#x27;cufflinks -o %s %s%s%s&#x27;</span> % (cufflinks_output_dir, tophat_output_dir, os.sep, tophat_output_file)<br>os.system(cufflinks_command)<br></code></pre></td></tr></table></figure>
<h2><span id="lesson16">lesson16</span><a href="#lesson16" class="header-anchor">#</a></h2><h3><span id="16-2">16.2</span><a href="#16-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> pie, title, figure, savefig<br>nucleotides = <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;U&#x27;</span><br>count = [<span class="hljs-number">1024</span>, <span class="hljs-number">759</span>, <span class="hljs-number">606</span>, <span class="hljs-number">398</span>]<br>explode = [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.05</span>, <span class="hljs-number">0.05</span>]<br><br>colors = [<span class="hljs-string">&#x27;#f0f0f0&#x27;</span>, <span class="hljs-string">&#x27;#dddddd&#x27;</span>, <span class="hljs-string">&#x27;#bbbbbb&#x27;</span>, <span class="hljs-string">&#x27;#999999&#x27;</span>]<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_percent</span>(<span class="hljs-params">value</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;FORMATS FLOAT VALUES IN PIE SLICES TO PERCENT&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;%4.1f%%&quot;</span> % (value)<br><br>figure(<span class="hljs-number">1</span>)<br>title(<span class="hljs-string">&#x27;Nucleotides in 23s RNA from T.thermophilus&#x27;</span>)<br>pie(count, explode=explode, labels=nucleotides, shadow=<span class="hljs-literal">None</span>, colors=colors, autopct=get_percent)<br>savefig(<span class="hljs-string">&#x27;figure3&#x27;</span>, dpi=<span class="hljs-number">300</span>)<br></code></pre></td></tr></table></figure>
<h3><span id="16-3-1">16.3.1</span><a href="#16-3-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, plot, savefig<br>xdata = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>ydata = [<span class="hljs-number">1.25</span>, <span class="hljs-number">2.33</span>, <span class="hljs-number">4.3</span>, <span class="hljs-number">9.00</span>]<br>figure()<br>plot(xdata, ydata)<br>savefig(<span class="hljs-string">&#x27;figure1.png&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h3><span id="16-4-1">16.4.1</span><a href="#16-4-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, plot, text, axis, savefig, title<br><span class="hljs-keyword">import</span> math<br><br>figure()<br>xdata = [<span class="hljs-number">0.1</span> * i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)]<br>ydata = [math.sin(y) <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> xdata]<br><br>plot(xdata, ydata, <span class="hljs-string">&#x27;kd&#x27;</span>, linewidth = <span class="hljs-number">1</span>)<br>axis([<span class="hljs-number">0</span>, <span class="hljs-number">3</span> * math.pi, -<span class="hljs-number">1.2</span>, <span class="hljs-number">1.2</span>])<br>title(<span class="hljs-string">&#x27;y=sin(x)&#x27;</span>)<br>savefig(<span class="hljs-string">&#x27;figure2.png&#x27;</span>, dpi = <span class="hljs-number">300</span>) <br></code></pre></td></tr></table></figure>
<h3><span id="16-5-1">16.5.1</span><a href="#16-5-1" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, title, xlabel, ylabel, yticks, barh, axis, savefig<br>length = [<span class="hljs-number">16.38</span><br>, <span class="hljs-number">139.90</span><br>, <span class="hljs-number">441.46</span><br>, <span class="hljs-number">29.03</span><br>, <span class="hljs-number">40.93</span><br>, <span class="hljs-number">202.07</span><br>, <span class="hljs-number">142.30</span><br>, <span class="hljs-number">346.00</span><br>, <span class="hljs-number">300.00</span>]<br>neuron = [<span class="hljs-string">&quot;neuron1&quot;</span>,<span class="hljs-string">&quot;neuron2&quot;</span>,<span class="hljs-string">&quot;neuron3&quot;</span>,<span class="hljs-string">&quot;neuron4&quot;</span>,<span class="hljs-string">&quot;neuron5&quot;</span>,<span class="hljs-string">&quot;neuron6&quot;</span>,<span class="hljs-string">&quot;neuron7&quot;</span>\<br>          ,<span class="hljs-string">&quot;neuron8&quot;</span>,<span class="hljs-string">&quot;neuron9&quot;</span>]<br><br>figure()<br>title(<span class="hljs-string">&quot;Lengths of neoron&quot;</span>)<br>xlabel(<span class="hljs-string">&quot;length&quot;</span>)<br>ylabel(<span class="hljs-string">&quot;neuron&quot;</span>)<br>barh(neuron, length)<br><br>savefig(<span class="hljs-string">&quot;16.5.1.png&quot;</span>)<br></code></pre></td></tr></table></figure>
<h3><span id="16-5-2">16.5.2</span><a href="#16-5-2" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> title, xlabel, ylabel, figure, plot, savefig, errorbar, xticks<br>figure()<br><br>t_data = [<span class="hljs-number">606</span>, <span class="hljs-number">759</span>, <span class="hljs-number">1024</span>, <span class="hljs-number">398</span>]<br>x1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>err1 = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>errorbar(x1, t_data, err1, fmt=<span class="hljs-string">&quot;ro&quot;</span>)<br>e_data = [<span class="hljs-number">762</span>, <span class="hljs-number">639</span>, <span class="hljs-number">912</span>, <span class="hljs-number">591</span>]<br>x2 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>err2 = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>errorbar(x2, e_data, err2, fmt=<span class="hljs-string">&quot;rs&quot;</span>)<br><br><br>ylabel(<span class="hljs-string">&quot;Ratio of base count&quot;</span>)<br>xlabel(<span class="hljs-string">&quot;Base&quot;</span>)<br>xticks(x1, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;U&quot;</span>))<br>title(<span class="hljs-string">&quot;T.thermophiles / E.coli&quot;</span>)<br>savefig(<span class="hljs-string">&quot;16.5.2.png&quot;</span>)<br></code></pre></td></tr></table></figure>
<h3><span id="16-5-3">16.5.3</span><a href="#16-5-3" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, title, xlabel, ylabel, hist, axis, grid, savefig<br>seqlength = []<br>seq = <span class="hljs-string">&quot;&quot;</span><br>title = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SwissProt.fasta&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> title == <span class="hljs-string">&quot;&quot;</span>:<br>        title = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> title != <span class="hljs-string">&quot;&quot;</span>:<br>        seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&quot;&quot;</span>:<br>        length = <span class="hljs-built_in">len</span>(seq)<br>        seqlength.append(length)<br>        seq = <span class="hljs-string">&quot;&quot;</span><br>        title = line<br>length = <span class="hljs-built_in">len</span>(seq)<br>seqlength.append(length)<br><br><span class="hljs-built_in">print</span> seqlength<br>        <br>n_bin = <span class="hljs-number">2</span><br>figure()<br>num, bins, patches = hist(seqlength, n_bin, density = <span class="hljs-number">1.0</span>, histtype = <span class="hljs-string">&quot;bar&quot;</span>, \<br>                          facecolor = <span class="hljs-string">&quot;green&quot;</span>, alpha = <span class="hljs-number">0.7</span>,rwidth = <span class="hljs-number">0.85</span>)<br><br>xlabel(<span class="hljs-string">&quot;seqlength&quot;</span>)<br>ylabel(<span class="hljs-string">&quot;frequence&quot;</span>)<br>axis()<br>grid(<span class="hljs-literal">True</span>)<br>savefig(<span class="hljs-string">&quot;16.5.3.png&quot;</span>)<br></code></pre></td></tr></table></figure>
<h3><span id="draw-comparison-of-test-and-train-accuracy">draw comparison of test and train accuracy</span><a href="#draw-comparison-of-test-and-train-accuracy" class="header-anchor">#</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#use n_neighbors as independent variable,</span><br><span class="hljs-comment">#get comparison of train_data accuracy and test_data accuracy</span><br><span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<br><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>cancer = load_breast_cancer()<br>X_train, X_test, y_train, y_test = train_test_split(cancer.data, cancer.target,<br>                                                    stratify=cancer.target,<br>                                                    random_state = <span class="hljs-number">66</span> )<br>training_accuracy=[]<br>test_accuracy=[]<br>neighbors_setting=<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">11</span>)<br><br><span class="hljs-keyword">for</span> n_neighbors <span class="hljs-keyword">in</span> neighbors_setting:<br>    clf = KNeighborsClassifier(n_neighbors = n_neighbors)<br>    clf.fit(X_train, y_train)<br>    training_accuracy.append(clf.score(X_train, y_train))<br>    test_accuracy.append(clf.score(X_test, y_test))<br><br>plt.plot(neighbors_setting, training_accuracy, label=<span class="hljs-string">&quot;training_accuracy&quot;</span>)<br>plt.plot(neighbors_setting, test_accuracy, label=<span class="hljs-string">&quot;test_accuracy&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;accuracy&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;n_neighbors&quot;</span>)<br>plt.legend()<br>plt.show()<br></code></pre></td></tr></table></figure>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/LEARNING-RECORDS/">LEARNING RECORDS</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/PYTHON/">PYTHON</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/01/19/20210119UCSD_Bioinfomatics/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">UCSD Bioinfomatics</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/12/16/20201216%E5%BE%AE%E5%8D%AB%E6%98%9F%E5%BA%8F%E5%88%97/">
                        <span class="hidden-mobile">微卫星序列资料准备</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                  
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script>
      Fluid.utils.waitElementVisible('disqus_thread', function() {
        Fluid.utils.createCssLink('https://cdn.jsdelivr.net/npm/disqusjs@1.0/dist/disqusjs.css');
        Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/disqusjs@1.0/dist/disqus.js', function () {
          new DisqusJS({
            shortname: 'fluid',
            apikey: ''
          });
        });
      });
    </script>
    <noscript>Please enable JavaScript to view the
      <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener noopener">comments powered by Disqus.</a>
    </noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js" ></script>

  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>

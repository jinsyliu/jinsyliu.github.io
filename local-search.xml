<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2021.9.10-9.16实验记录:GWAS analysis in R</title>
    <link href="/2021/09/16/20210910to0916gwasanalysisinr/"/>
    <url>/2021/09/16/20210910to0916gwasanalysisinr/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-9-10-9-16实验记录-GWAS-analysis-in-R"><a href="#2021-9-10-9-16实验记录-GWAS-analysis-in-R" class="headerlink" title="2021.9.10-9.16实验记录: GWAS analysis in R"></a>2021.9.10-9.16实验记录: GWAS analysis in R</h1><p>[toc]</p><h2 id="R代码教程"><a href="#R代码教程" class="headerlink" title="R代码教程"></a>R代码教程</h2><p>全基因组关联分析策略通常包括四个广泛定义的部分。(i) 数据预处理data pre‐processing；(ii) 新数据生成new data generation；(iii) 统计分析statistical analysis；和(iv) 分析后询问post‐analytic interrogation。这些调查的一个主要目标是识别和描述SNPs与疾病进展或疾病结果措施之间的关联。</p><p>根据这四个阶段产生的十个步骤如下：</p><ol><li>将数据读入R，创建R对象 reading data into R to create an R object</li><li>SNP级过滤（第一部分）SNP‐level filtering (part 1)</li><li>样本级过滤 sample‐level filtering</li><li>SNP级过滤（第二部分）SNP‐level filtering (part 2)</li><li>主成分分析（PCA）principal component analysis (PCA)</li><li>非类型基因型的归因 imputation of non‐typed genotypes</li><li>类型SNP的关联分析 association analysis of typed SNPs</li><li>归因数据的关联分析 association analysis of imputed data</li><li>归因和类型SNP结果的整合 integration of imputed and typed SNP results</li><li>关联结果的可视化和质量控制 visualization and quality control of association findings</li></ol><p><img src="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5019244/bin/SIM-34-3769-g001.jpg" alt="An external file that holds a picture, illustration, etc. Object name is SIM-34-3769-g001.jpg"></p><blockquote><p>Substructure 亚结构，也称为群体混合和群体分层，是指群体遗传历史(例如，迁徙、选择和/或种族融合)导致群体内存在遗传多样性(例如，不同等位基因频率)。</p></blockquote><h3 id="数据预处理data-pre‐processing"><a href="#数据预处理data-pre‐processing" class="headerlink" title="数据预处理data pre‐processing"></a>数据预处理data pre‐processing</h3><p>在本例中，样本使用Affymetrix 6.0 GeneChip进行基因分型，并以.CEL格式提供给用户。</p><blockquote><p>基于期望最大化类型算法的Birdseed调用算法被应用于生成每个样本在每个SNP上的基因型和置信度分数。</p><p>反过来，PERL和unix脚本被用来将这些转换成.ped和.map文件。</p><p>注意，虽然R可以读取.ped和.map文件，但通常最好先将这两个文件转换为.bim、.bed和.fam文件。将文本文件转化成二进制文件，可以大大缩减文件大小。</p></blockquote><p>本教程主要利用了几个R包（来自Bioconductor）</p><p>snpStats</p><blockquote><p>具有以各种格式读取基因型数据并进行质量控制、估算和关联分析的功能</p></blockquote><p>SNPRelate</p><blockquote><p>包括样本级质量控制和计算效率高的主成分(PC)计算的功能</p></blockquote><p>其他软件包包括数据可视化/代码的功能(ggplot2、 LDheatmap、 postgwas)、数据操作(plyr)和并行处理(doparlel) ，以及它们的依赖关系。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs R">setwd(<span class="hljs-string">&quot;/Users/keqinliu/Downloads/GWASTutorial_Files&quot;</span>) <span class="hljs-comment">#先设置工作目录</span><br>getwd() <span class="hljs-comment">#检查工作目录</span><br><span class="hljs-comment">## [1] &quot;/Users/keqinliu/Downloads/GWASTutorial_Files&quot;</span><br><br>BiocManager::install(<span class="hljs-string">&quot;snpStats&quot;</span>) <span class="hljs-comment">#安装snpStats</span><br><span class="hljs-comment">#注意，R版本＞3.5，应使用BiocManager进行安装</span><br><span class="hljs-comment">#R版本＜3.5，则可使用bioconductor安装</span><br>BiocManager::install(<span class="hljs-string">&quot;SNPRelate&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;rtracklayer&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;biomaRt&quot;</span>)<br>install.packages(<span class="hljs-string">&quot;GenABEL&quot;</span>, <span class="hljs-string">&quot;LDheatmap&quot;</span>, <span class="hljs-string">&quot;doParallel&quot;</span>, <span class="hljs-string">&quot;coin&quot;</span>, <span class="hljs-string">&quot;igraph&quot;</span>) <span class="hljs-comment">#安装所需的R包</span><br>library(devtools)<br><br>data.dir &lt;- <span class="hljs-string">&quot;/Users/keqinliu/Downloads/GWAS&quot;</span><br>out.dir &lt;- data.dir <span class="hljs-comment">#设置不同的输出文件目录，以防与工作目录冲突</span><br><br><span class="hljs-comment">#以下代码用于设定输入文件</span><br>gwas.fn &lt;- lapply(<span class="hljs-built_in">c</span>(bed=<span class="hljs-string">&#x27;bed&#x27;</span>, bim=<span class="hljs-string">&quot;bim&quot;</span>, fam=<span class="hljs-string">&quot;fam&quot;</span>, gds=<span class="hljs-string">&quot;gds&quot;</span>),<span class="hljs-keyword">function</span>(n) sprintf(<span class="hljs-string">&quot;%s/GWASTutorial.%s&quot;</span>, data.dir, n))<br>clinical.fn &lt;- sprintf(<span class="hljs-string">&quot;%s/GWASTutorial_clinical.csv&quot;</span>, data.dir) <span class="hljs-comment">#sprintf函数用于把格式化的数据写入某个字符串缓冲区。</span><br>onethou.fn &lt;- lapply(<span class="hljs-built_in">c</span>(info=<span class="hljs-string">&quot;info&quot;</span>, ped=<span class="hljs-string">&quot;ped&quot;</span>), <span class="hljs-keyword">function</span>(n) sprintf(<span class="hljs-string">&quot;%s/chr16_1000g_CEU.%s&quot;</span>, data.dir, n))<br>protein.coding.coords.fnamo &lt;- sprintf(<span class="hljs-string">&quot;%s/ProCodgene_doords.csv&quot;</span>, out.dir)<br>                     <br><span class="hljs-comment">#以下代码用于设定输出文件</span><br>gwaa.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/GWAStutorialout.txt&quot;</span>, out.dir)<br>gwaa.unadj.fname &lt;- sprintf(<span class="hljs-string">&quot;%sGWAStutorialoutUnadj.txt&quot;</span>, out.dir)<br>input.out.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/GWAStutorial_inputationOut.csv&quot;</span>, out.dir)<br>CEPT.fname &lt;- sprintf(<span class="hljs-string">&quot;%s/CEPT_GWASour.csv&quot;</span>, out.dir)    <br><span class="hljs-comment">#gwaa.fname等value都是文件目录（地址）                     </span><br>                    <br></code></pre></td></tr></table></figure><h4 id="在R中读取和格式化数据"><a href="#在R中读取和格式化数据" class="headerlink" title="在R中读取和格式化数据"></a>在R中读取和格式化数据</h4><p>为了阅读.fam .bim和.bed 文件，可以使用 Bioconductor snpStats 包中的 read.plink () 函数。</p><blockquote><p>结果列表的基因型位置包含一个 SnpMatrix 对象，它是基因型数据的矩阵，每个 SNP 有一列，每个研究参与者有一行。</p><p>临床数据(gwastufactorial clinical. csv)可以用我们熟悉的方式读取，即read.csv()。</p><p>最后，我们在这个阶段的数据子集只包括在基因型和表型文件中都有数据的个体。</p></blockquote><p>一旦我们读取了基因型和临床信息，我们就可以开始 GWA 数据预处理的下一步了。这涉及到两个过滤数据的阶段，分别在 SNP 和样本级别。</p><p>不过，在不同的情况中，分析的顺序可能会有所不同，这取决于是进行单一GWA分析(如本文所述) ，还是分析人员准备将结果纳入需要跨多项研究协调数据的更大的meta‐analysis。在后一种情况下，以下过滤步骤可能在分析之后被排除或集中执行，因为总结级数据是跨研究合并的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#reading data into r</span><br>library(snpStats)<br><span class="hljs-comment">#read in PLINK files to create list</span><br>geno &lt;- read.plink(gwas.fn$bed, gwas.fn$bim, gwas.fn$fam, na.strings = (<span class="hljs-string">&quot;-9&quot;</span>))<br><br><span class="hljs-comment">#-step1-</span><br><span class="hljs-comment">#reading data into r</span><br><br><span class="hljs-comment">#-step1a-</span><br>library(snpStats)<br><span class="hljs-comment">#read in PLINK files to create list</span><br>geno &lt;- read.plink(gwas.fn$bed, gwas.fn$bim, gwas.fn$fam, na.strings = (<span class="hljs-string">&quot;-9&quot;</span>))<br><br><span class="hljs-comment">#-step1b-</span><br><span class="hljs-comment">#obtain the genotype snpmatrix object from generated list</span><br>genotype &lt;- geno$genotypes<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  861473 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs10458597 ... rs5970564</span><br><span class="hljs-comment">#obtain teh snp info table from the list</span><br>genobim &lt;- geno$map<br>colnames(genobim) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;gen.dist&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;A1&quot;</span>, <span class="hljs-string">&quot;A2&quot;</span>)<br>print(head(genobim))<br><span class="hljs-comment">##            chr        SNP gen.dist position   A1 A2</span><br><span class="hljs-comment">## rs10458597   1 rs10458597        0   564621 &lt;NA&gt;  C</span><br><span class="hljs-comment">## rs12565286   1 rs12565286        0   721290    G  C</span><br><span class="hljs-comment">## rs12082473   1 rs12082473        0   740857    T  C</span><br><span class="hljs-comment">## rs3094315    1  rs3094315        0   752566    C  T</span><br><span class="hljs-comment">## rs2286139    1  rs2286139        0   761732    C  T</span><br><span class="hljs-comment">## rs11240776   1 rs11240776        0   765269    G  A</span><br><br><span class="hljs-comment">#remove raw file to open up memory</span><br>rm(geno)<br><br><span class="hljs-comment">#-step1c-</span><br><span class="hljs-comment">#read in clinical file</span><br>clinical &lt;- read.csv(clinical.fn, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>, <span class="hljs-string">&quot;factor&quot;</span>, <span class="hljs-string">&quot;factor&quot;</span>, <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br>rownames(clinical) &lt;- clinical$FamID<br>print(head(clinical))<br><span class="hljs-comment">##       FamID CAD sex age  tg hdl ldl</span><br><span class="hljs-comment">## 10002 10002   1   1  60  NA  NA  NA</span><br><span class="hljs-comment">## 10004 10004   1   2  50  55  23  75</span><br><span class="hljs-comment">## 10005 10005   1   1  55 105  37  69</span><br><span class="hljs-comment">## 10007 10007   1   1  52 314  54 108</span><br><span class="hljs-comment">## 10008 10008   1   1  58 161  40  94</span><br><span class="hljs-comment">## 10009 10009   1   1  59 171  46  92</span><br><br><span class="hljs-comment">#-step1d-</span><br><span class="hljs-comment">#subset genotype for individuals with clinical data</span><br>genotype &lt;- genotype[clinical$FamID, ]<br>print(genotypes)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  861473 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs10458597 ... rs5970564 </span><br><span class="hljs-comment">#在提供的数据示例中，基因型信息可用于n=1401个有可用表型数据的861473个类型SNPs</span><br></code></pre></td></tr></table></figure><h4 id="单核苷酸多态性级过滤-part1"><a href="#单核苷酸多态性级过滤-part1" class="headerlink" title="单核苷酸多态性级过滤(part1)"></a>单核苷酸多态性级过滤(part1)</h4><p>这一步涉及删除(也称为“过滤”)不包括分析的 SNPs。这种排除的原因包括大量的缺失数据、低变异性和基因分型错误。通常，首先执行基于大量缺失数据和较低可变性的 SNP 级过滤。然后是样本级过滤 ，最后是基于可能的基因分型错误的 SNP 级过滤</p><blockquote><p>这样做的理由是，样本级的关联性和亚结构都会影响用于根据基因分型错误过滤SNP的Hardy-Weinberg平衡（HWE）标准。重复SNP和样本级过滤的迭代程序也很常见，直到没有额外的样本被删除。</p><p>然而，在这个教程中，没有样本被过滤，认为这个循环是不必要的。</p></blockquote><h5 id="SNP‐level-filtering-call-rate"><a href="#SNP‐level-filtering-call-rate" class="headerlink" title="SNP‐level filtering: call rate"></a>SNP‐level filtering: call rate</h5><p>call rate被定义为研究中相应SNP信息没有缺失的个体比例。</p><blockquote><p>在本教程中，我们使用95%的调用率进行过滤，这意味着我们保留数据缺失少于5%的SNP。在较小的样本环境中，可以采用更严格的切点（例如，小于5%）。</p></blockquote><h5 id="SNP‐level-filtering-minor-allele-frequency-MAF"><a href="#SNP‐level-filtering-minor-allele-frequency-MAF" class="headerlink" title="SNP‐level filtering: minor allele frequency (MAF)"></a>SNP‐level filtering: minor allele frequency (MAF)</h5><p>在研究参与者中，如果某个SNP有很大程度的同质性，通常会导致推断该SNP与所研究性状之间的统计学意义的力量不足。当我们有一个非常小的MAF，使大多数个体有两个主要等位基因的拷贝时，就会发生这种情况。这里，我们删除了MAF小于1%的SNP（MAF &lt;0.01）。在某些情况下，特别是小样本环境下，采用5%的切割点。</p><blockquote><p>这是说，比如，99%以上的研究者都有一个相同的SNP，那么这个SNP就失去了统计学上的意义（即在参与者中，这个SNP有很大程度上的同质性）。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#使用以下脚本同时对call rate和MAF进行过滤</span><br><span class="hljs-comment">#-step2-</span><br><span class="hljs-comment">#snp-level filtering</span><br><br><span class="hljs-comment">#-step2a-</span><br><span class="hljs-comment">#create snp summary statistics (MAF, call rate, etc.)</span><br>snpsum.col &lt;- col.summary(genotype)<br>print(head(snpsum.col))<br><br><span class="hljs-comment">#-step2b-</span><br><span class="hljs-comment">#setting thresholds</span><br>call &lt;- 0.95<br>minor &lt;- 0.01<br><br><span class="hljs-comment">#filter on MAF and call rate</span><br>use &lt;- with(snpsum.col, (!<span class="hljs-built_in">is.na</span>(MAF) &amp; MAF &gt; minor) &amp; Call.rate &gt;= <span class="hljs-built_in">call</span>)<br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><br><span class="hljs-comment">#subset genotype and snp summary data for snps that pass call rate and MAF critoria</span><br>genotype &lt;- genotype[,use]<br><span class="hljs-comment">## 出现报错</span><br><span class="hljs-comment">## Error in .local(x, i, j, ..., drop) : </span><br><span class="hljs-comment">##   logical column selection vector is wrong length</span><br><span class="hljs-built_in">sum</span>(use)<br><span class="hljs-comment">## [1] 0</span><br>ncol(genotype)<br><span class="hljs-comment">## [1] 861473</span><br><span class="hljs-comment">#显然，设置的threshold根本没起作用，但不明白原因。</span><br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><span class="hljs-comment">## 861473 SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.</span><br><br><span class="hljs-comment">## 解决方案如下：it worked！</span><br><span class="hljs-comment">#filter on MAF and call rate</span><br>use &lt;- with(snpsum.col, (!<span class="hljs-built_in">is.na</span>(MAF) &amp; MAF &gt; <span class="hljs-number">0.01</span>) &amp; Call.rate &gt;= <span class="hljs-number">0.95</span>) <span class="hljs-comment">#直接把threshold改成了数值</span><br>use[<span class="hljs-built_in">is.na</span>(use)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br><br><span class="hljs-built_in">sum</span>(use)<br><span class="hljs-comment">## [1] 658186</span><br><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(use), <span class="hljs-string">&quot;SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.\n&quot;</span>)<br><span class="hljs-comment">## 203287 SNPS WILL BE REMOVED DUE TO LOW MAF OR CALL RATE.</span><br><br><span class="hljs-comment">#subset genotype and snp summary data for snps that pass call rate and MAF critoria</span><br>genotype &lt;- genotype[,use]<br>snpsum.col &lt;- snpsum.col[use,]<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  658186 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs5970564    </span><br></code></pre></td></tr></table></figure><h4 id="样本级别过滤"><a href="#样本级别过滤" class="headerlink" title="样本级别过滤"></a>样本级别过滤</h4><p>数据预处理的第三阶段涉及过滤样本，也就是说，删除我们选择的被排除在分析之外的个体。样本级过滤的标准通常基于缺失数据、样本污染、相关性(用于基于人口的调查)以及种族、民族或性别的模糊性或不一致性。</p><h5 id="Sample‐level-filtering-call-rate"><a href="#Sample‐level-filtering-call-rate" class="headerlink" title="Sample‐level filtering: call rate"></a>Sample‐level filtering: call rate</h5><p>与基于call rate的SNP级过滤类似，我们排除那些在超过预先定义的百分比的分型SNP中缺失基因型数据的个体。这个跨SNP的缺失比例被称为sample call rate，我们采用95%的阈值。也就是说，缺失基因型数据超过5%的类型SNPs的个体将被删除。一个新的减维SnpMatrix基因型对象被创建，它包含了这个filter。</p><h5 id="Sample‐level-filtering-heterozygosity"><a href="#Sample‐level-filtering-heterozygosity" class="headerlink" title="Sample‐level filtering: heterozygosity"></a>Sample‐level filtering: heterozygosity</h5><p>杂合度是指在一个个体内，在一个给定的SNP上存在两个等位基因中的每一个。这在HWE下预计会以 $2<em>p</em>(1-p)$ 的概率出现，其中p是该SNP的显性等位基因频率（假设是双等位SNP）。一个人体内跨类型SNP的杂合度过高可能是样本质量差的表现，而杂合度不足则表明该人有近亲繁殖或其他亚结构。因此，近亲繁殖系数 $|F|=（1-O/E）&gt;0.10$ 的样本被剔除，其中O和E分别是个体内杂合SNP的观察数和预期数。请注意，我们是根据每个个体的观察到的SNP来计算该个体的预期计数的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3-</span><br><span class="hljs-comment">#sample-level filtering</span><br><br><span class="hljs-comment">#-step3a-</span><br>library(SNPRelate) <span class="hljs-comment">#estimating LD, relatedness, PCA</span><br>library(plyr)<br><br><span class="hljs-comment">#create sample statistic (call rate, heterozygosity)</span><br>snpsum.row &lt;- row.summary(genotype)<br><br><span class="hljs-comment">#add the f stat (inbreeding coefficient) to snpsum.row</span><br>MAF &lt;- snpsum.col$MAF<br>callmatrix &lt;- !<span class="hljs-built_in">is.na</span>(genotype)<br>hetExp &lt;- callmatrix %*% (<span class="hljs-number">2</span>*MAF*(<span class="hljs-number">1</span>-MAF))<br>hetObs &lt;- with(snpsum.row, Heterozygosity*(ncol(genotype))*Call.rate)<br>snpsum.row$hetF &lt;- 1-(hetObs/hetExp)<br><br>head(snpsum.row)<br><span class="hljs-comment">##       Call.rate Certain.calls Heterozygosity          hetF</span><br><span class="hljs-comment">## 10002 0.9826554             1      0.3289825 -0.0247708291</span><br><span class="hljs-comment">## 10004 0.9891581             1      0.3242931 -0.0103236529</span><br><span class="hljs-comment">## 10005 0.9918427             1      0.3231825 -0.0062550972</span><br><span class="hljs-comment">## 10007 0.9861027             1      0.3241469 -0.0098475016</span><br><span class="hljs-comment">## 10008 0.9823333             1      0.3228218 -0.0075941985</span><br><span class="hljs-comment">## 10009 0.9913034             1      0.3213658 -0.0002633189</span><br><br><span class="hljs-comment">#-step3b-</span><br><span class="hljs-comment">#setting thresholds</span><br>sampcall &lt;- 0.95 <span class="hljs-comment">#sample call rate cut-off</span><br>hetcutoff &lt;- 0.1 <span class="hljs-comment">#inbreeding coefficient cut-off</span><br><br>sampleuse &lt;- with(snpsum.row, !<span class="hljs-built_in">is.na</span>(Call.rate) &amp; Call.rate &gt; <span class="hljs-number">0.95</span> &amp; <span class="hljs-built_in">abs</span>(hetF) &lt;= <span class="hljs-number">0.1</span>)<br>sampleuse[<span class="hljs-built_in">is.na</span>(sampleuse)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(nrow(genotype)-<span class="hljs-built_in">sum</span>(sampleuse), <span class="hljs-string">&quot;subject will be removed due to low sample call rate or inbredding coefficient.\n&quot;</span>)<br><span class="hljs-comment">## 0 subject will be removed due to low sample call rate or inbredding coefficient.</span><br><br><span class="hljs-comment">#subset genotype and clinical data for subjects who pass call rate and heterozygosity crtieria</span><br>genotype &lt;- genotype[sampleuse, ]<br>clinical &lt;- clinical[rownames(genotype), ]<br></code></pre></td></tr></table></figure><p>由于提供的 PennCATH 数据是预过滤的，因此不会根据近亲繁殖系数 | f | &gt; 0.10来过滤额外的样本。</p><h5 id="Sample‐level-filtering-cryptic-relatedness-duplicates-and-gender-identity"><a href="#Sample‐level-filtering-cryptic-relatedness-duplicates-and-gender-identity" class="headerlink" title="Sample‐level filtering: cryptic relatedness, duplicates, and gender identity."></a>Sample‐level filtering: cryptic relatedness, duplicates, and gender identity.</h5><p>样本级过滤：隐性关联性、重复和性别确认。</p><p>基于人群的队列研究通常仅限于无亲缘关系的个体，而后面分型SNP的关联分析中描述的广义线性建模方法假定了个体间的独立性。但是，在复杂疾病的区域性队列研究（如基于医院的队列研究）中，来自同一家庭的个体可能会被无意中招募到。衡量一对样本之间的亲缘关系（或重复）的常用方法是基于血缘关系的认同（IBD）。IBD的亲缘关系系数大于0.10，可能表明有亲缘关系、重复或样本混合。通常情况下，具有较低基因型调用率的相关对的个体被移除。我们注意到，在这个阶段也可以检查性别确认，以确认自我报告的性别与观察到的X和Y染色体一致。</p><blockquote><p>但是，在本例所提供的数据例子中，性染色体不可用，因此，没有提供关于性别认同的过滤例子。</p></blockquote><p>我们首先应用linkage disequilibrium (LD)修剪，使用0.2的阈值，这消除了数据中很大程度的冗余，减少了染色体假象chromosomal artifacts的影响。这种降维步骤通常在IBD分析和PCA之前应用，在后面的文本中应用于ancestry filtering，并导致大量的计算节省。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3c-</span><br><span class="hljs-comment">#checking for relatedness</span><br>ld.thresh &lt;- 0.2 <span class="hljs-comment">#LD cut-off</span><br>kin.thresh &lt;- 0.1 <span class="hljs-comment">#kinship cut-off</span><br><span class="hljs-comment">#create gds file, required for SNPRelate functions</span><br>snpgdsBED2GDS(gwas.fn$bed, gwas.fn$fam, gwas.fn$bim, gwas.fn$gds)<br><span class="hljs-comment">## Start file conversion from PLINK BED to SNP GDS ...</span><br><span class="hljs-comment">##     BED file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.bed&#x27;</span><br><span class="hljs-comment">##         SNP-major mode (Sample X SNP), 288.4M</span><br><span class="hljs-comment">##     FAM file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.fam&#x27;</span><br><span class="hljs-comment">##     BIM file: &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.bim&#x27;</span><br><span class="hljs-comment">## Mon Sep 13 15:43:32 2021     (store sample id, snp id, position, and chromosome)</span><br><span class="hljs-comment">##     start writing: 1401 samples, 861473 SNPs ...</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 8s  </span><br><span class="hljs-comment">## Mon Sep 13 15:43:40 2021 Done.</span><br><span class="hljs-comment">## Optimize the access efficiency ...</span><br><span class="hljs-comment">## Clean up the fragments of GDS file:</span><br><span class="hljs-comment">##     open the file &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds&#x27; (292.4M)</span><br><span class="hljs-comment">##     # of fragments: 39</span><br><span class="hljs-comment">##     save to &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds.tmp&#x27;</span><br><span class="hljs-comment">##     rename &#x27;/Users/keqinliu/Downloads/GWAS/GWASTutorial.gds.tmp&#x27; (292.4M, reduced: 252B)</span><br><span class="hljs-comment">##     # of fragments: 18</span><br>genofile &lt;- openfn.gds(gwas.fn$gds, readonly = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#automatically added &quot;-1&quot; sample suffixes are removed</span><br>gds.ids &lt;- read.gdsn(index.gdsn(genofile, <span class="hljs-string">&quot;sample.id&quot;</span>))<br>gds.ids &lt;- sub(<span class="hljs-string">&quot;-1&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, gds.ids)<br>add.gdsn(genofile, <span class="hljs-string">&quot;sample.id&quot;</span>, gds.ids, replace = <span class="hljs-literal">TRUE</span>)<br><br><span class="hljs-comment">#prune SNPs for IBD analysis</span><br>set.seed(<span class="hljs-number">1000</span>)<br><br>geno.sample.ids &lt;- rownames(genotype)<br>snpSVB &lt;- snpgdsLDpruning(genofile, ld.threshold = <span class="hljs-number">0.2</span>, sample.id = geno.sample.ids, <span class="hljs-comment">#only analyze teh filtered samples</span><br>                          snp.id = colnames(genotype)) <span class="hljs-comment">#only analyze the filtered SNPs</span><br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## SNP pruning based on LD:</span><br><span class="hljs-comment">## Excluding 203,287 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 658,186</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     sliding window: 500,000 basepairs, Inf SNPs</span><br><span class="hljs-comment">##     |LD| threshold: 0.2</span><br><span class="hljs-comment">##     method: composite</span><br><span class="hljs-comment">## Chromosome 1: 8.24%, 5,856/71,038</span><br><span class="hljs-comment">## Chromosome 3: 8.16%, 4,943/60,565</span><br><span class="hljs-comment">## Chromosome 6: 8.05%, 4,362/54,176</span><br><span class="hljs-comment">## Chromosome 12: 8.60%, 3,621/42,124</span><br><span class="hljs-comment">## Chromosome 21: 9.44%, 1,176/12,463</span><br><span class="hljs-comment">## Chromosome 2: 7.69%, 5,669/73,717</span><br><span class="hljs-comment">## Chromosome 4: 8.27%, 4,603/55,675</span><br><span class="hljs-comment">## Chromosome 7: 8.47%, 3,928/46,391</span><br><span class="hljs-comment">## Chromosome 11: 7.89%, 3,490/44,213</span><br><span class="hljs-comment">## Chromosome 10: 8.01%, 3,838/47,930</span><br><span class="hljs-comment">## Chromosome 8: 7.69%, 3,716/48,299</span><br><span class="hljs-comment">## Chromosome 5: 8.10%, 4,549/56,178</span><br><span class="hljs-comment">## Chromosome 14: 8.80%, 2,470/28,054</span><br><span class="hljs-comment">## Chromosome 9: 8.23%, 3,385/41,110</span><br><span class="hljs-comment">## Chromosome 17: 11.13%, 2,220/19,939</span><br><span class="hljs-comment">## Chromosome 13: 8.40%, 2,878/34,262</span><br><span class="hljs-comment">## Chromosome 20: 9.39%, 2,137/22,753</span><br><span class="hljs-comment">## Chromosome 15: 9.23%, 2,391/25,900</span><br><span class="hljs-comment">## Chromosome 16: 9.17%, 2,529/27,591</span><br><span class="hljs-comment">## Chromosome 18: 9.00%, 2,361/26,231</span><br><span class="hljs-comment">## Chromosome 19: 12.99%, 1,492/11,482</span><br><span class="hljs-comment">## Chromosome 22: 11.21%, 1,276/11,382</span><br><span class="hljs-comment">## 72,890 markers are selected in total.</span><br>snpset.ibd &lt;- unlist(snpSVB, use.names = <span class="hljs-literal">FALSE</span>)<br>cat(<span class="hljs-built_in">length</span>(snpset.ibd), <span class="hljs-string">&quot;will be used in IBD analysis\n&quot;</span>)<br><span class="hljs-comment">## 72890 will be used in IBD analysis</span><br><span class="hljs-comment">#与tutorial中的 expect 72812 SNPs 相互冲突</span><br></code></pre></td></tr></table></figure><p>这使得SNP的数量从第2步结束时的658,186个减少到72890个。接下来，我们计算成对的IBD距离来搜索样本的关联性。采用的策略是迭代删除配对亲缘关系系数大于0.1的最高数量的主体。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3d-</span><br><span class="hljs-comment">#find IBD coefficients using method of moments procedure. include pairwise kinship</span><br>ibd &lt;- snpgdsIBDMoM(genofile, kinship = <span class="hljs-literal">TRUE</span>, sample.id = geno.sample.ids, snp.id = snpset.ibd, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## IBD analysis (PLINK method of moment) on genotypes:</span><br><span class="hljs-comment">## Excluding 788,583 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 72,890</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">## PLINK IBD:    the sum of all selected genotypes (0,1,2) = 32728566</span><br><span class="hljs-comment">## Mon Sep 13 16:05:05 2021    (internal increment: 8064)</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 7s  </span><br><span class="hljs-comment">## Mon Sep 13 16:05:13 2021    Done.</span><br>ibdcoeff &lt;- snpgdsIBDSelection(ibd) <span class="hljs-comment">#pairwise sample comparison</span><br>head(ibdcoeff)<br><span class="hljs-comment">##     ID1   ID2        k0         k1    kinship</span><br><span class="hljs-comment">## 1 10002 10004 0.9005063 0.09949372 0.02487343</span><br><span class="hljs-comment">## 2 10002 10005 0.9128056 0.08719439 0.02179860</span><br><span class="hljs-comment">## 3 10002 10007 0.9107539 0.08924614 0.02231153</span><br><span class="hljs-comment">## 4 10002 10008 0.9205765 0.07942348 0.01985587</span><br><span class="hljs-comment">## 5 10002 10009 0.9528404 0.04715958 0.01178989</span><br><span class="hljs-comment">## 6 10002 10010 0.8986051 0.10139486 0.02534872</span><br><br><span class="hljs-comment">#-step3e#</span><br><span class="hljs-comment">#check if there are any candidates for relatedness</span><br>ibdcoeff &lt;- ibdcoeff[ibdcoeff$kinship &gt;= <span class="hljs-number">0.1</span>]<br><br><span class="hljs-comment">#iteratively remove samples with high kinship </span><br>related.samples &lt;- <span class="hljs-literal">NULL</span><br><span class="hljs-keyword">while</span> (nrow(ibdcoeff)&gt;<span class="hljs-number">0</span>) &#123;<br>  <span class="hljs-comment">#count the number of occurrences of each and take the top one</span><br>  sample.counts &lt;- arrange(count(<span class="hljs-built_in">c</span>(ibdcoeff$ID1, ibdcoeff$ID2)), -freq)<br>  rm.sample &lt;- sample.counts[<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;x&#x27;</span>]<br>  cat(<span class="hljs-string">&quot;removeing sample&quot;</span>, <span class="hljs-built_in">as.character</span>(rm.sample), <span class="hljs-string">&#x27;too close related to&#x27;</span>, sample.counts[<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;freq&#x27;</span>],<span class="hljs-string">&#x27;other samples.\n&#x27;</span>)<br>  <span class="hljs-comment">#remove from ibdcoeff and add to list</span><br>  ibdcoeff &lt;- ibdcoeff[ibdcoeff$ID1 !=rm.sample &amp; ibdcoeff$ID2 != rm.sample,]<br>  related.samples &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-built_in">as.character</span>(rm.sample),related.samples)<br>&#125;<br><span class="hljs-comment">## removeing sample  too close related to NA other samples.</span><br><br><span class="hljs-comment">#filter genotype and clinical to include only unrelated samples</span><br>genotype &lt;- genotype[ !(rownames(genotype) %in% related.samples), ]<br>clinical &lt;- clinical[ !(clinical$FamID %in% related.samples), ]<br>geno.sample.ids &lt;- rownames(genotype)<br>cat(<span class="hljs-built_in">length</span>(related.samples), <span class="hljs-string">&quot;similar samples removed due to correlation coefficient &gt;= 0.1&quot;</span>, <span class="hljs-string">&quot;\n&quot;</span> )<br><span class="hljs-comment">## 0 similar samples removed due to correlation coefficient &gt;= 0.1 </span><br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  658186 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs5970564 </span><br></code></pre></td></tr></table></figure><p>在本示例中，没有任何样本是基于IBD亲属系数&gt;0.10而被过滤掉的。</p><h5 id="Sample‐level-filtering-ancestry"><a href="#Sample‐level-filtering-ancestry" class="headerlink" title="Sample‐level filtering: ancestry."></a>Sample‐level filtering: ancestry.</h5><p>PCA是一种根据观察到的基因构成将个体可视化并分类到祖先群体的方法。我们这样做有两个原因：</p><p>首先，自我报告的种族和民族可能与完全基于遗传信息的个体集群不同，</p><p>其次，出现一个似乎不属于种族/民族集群的个体可能暗示着样本级错误。</p><p>我们使用LD修剪后的72,812个SNPs子集（步骤3-c）作为PCA的输入。第一阶段LD剪枝的另一种策略是 “HapMap rooted “分析，它包括首先在一个reference panel上进行PCA，例如HapMap或1000 genome，然后将研究样本投射到所产生的空间。这种方法在此不作介绍，但可以用Kinship-based INference for Gwas（KING）软件的现有功能来实现。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step3f-</span><br><span class="hljs-comment">#checking for ancestry</span><br><span class="hljs-comment">#find PCA matrix</span><br>pca &lt;- snpgdsPCA(genofile, sample.id = geno.sample.ids, snp.id = snpset.ibd, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">#creating data frame of first two principal components</span><br>pctab &lt;- data.frame(sample.id = pca$sample.id,<br>                    PC1 = pca$eigenvect[,<span class="hljs-number">1</span>], <span class="hljs-comment">#the first eigenvector</span><br>                    PC2 = pca$eigenvect[,<span class="hljs-number">2</span>], <span class="hljs-comment">#the second eigenvector</span><br>                    stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br><span class="hljs-comment">#plot the first two principle components</span><br>plot(pctab$PC2, pctab$PC1, xlab=<span class="hljs-string">&quot;principal component 2&quot;</span>, ylab=<span class="hljs-string">&quot;principal component 1&quot;</span>, main = <span class="hljs-string">&quot;ancestry plot&quot;</span>)<br><br></code></pre></td></tr></table></figure><p><img src="pcaplot.png" alt="pcaplot"></p><h4 id="单核苷酸多态性级过滤-part-2"><a href="#单核苷酸多态性级过滤-part-2" class="headerlink" title="单核苷酸多态性级过滤(part 2)"></a>单核苷酸多态性级过滤(part 2)</h4><h5 id="SNP‐level-filtering-HWE"><a href="#SNP‐level-filtering-HWE" class="headerlink" title="SNP‐level filtering: HWE."></a>SNP‐level filtering: HWE.</h5><p>违反HWE可以表明存在种群亚结构或发生基因分型错误。虽然它们并不总是可以区分的，但通常的做法是假设有基因分型错误，并删除违反HWE的SNP。如果有病例对照状态，我们将这种过滤限制在对对照组的分析上，因为病例中的违反可能是一种关联的迹象。在一个给定的SNP上，通常使用观察到的基因型和预期的基因型之间的 $X^2$ 拟合度测试来衡量对HWE的偏离。我们删除那些HWE测试统计量在对照组中的相应P值小于 $1×10^{-6}$ 的SNPs。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step4-</span><br><span class="hljs-comment">#hardy-weinberg snp filtering on cad controls</span><br>hardy &lt;- 10^-<span class="hljs-number">6</span> <span class="hljs-comment">#HWE cut-off</span><br>CADcontrols &lt;- clinical[ clinical$CAD==<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;FamID&#x27;</span> ]<br>snpsum.colCont &lt;- col.summary(genotype[CADcontrols,])<br>HWEuse &lt;- with(snpsum.colCont, !<span class="hljs-built_in">is.na</span>(z.HWE) &amp; (<span class="hljs-built_in">abs</span>(z.HWE) &lt; <span class="hljs-built_in">abs</span>(qnorm(<span class="hljs-number">0.5</span>*<span class="hljs-number">10</span>^-<span class="hljs-number">6</span>))))<br>rm(snpsum.colCont)<br><br>HWEuse[<span class="hljs-built_in">is.na</span>(HWEuse)] &lt;- <span class="hljs-literal">FALSE</span> <span class="hljs-comment">#remove NA&#x27;s as well</span><br>cat(ncol(genotype)-<span class="hljs-built_in">sum</span>(HWEuse), <span class="hljs-string">&quot;SNP will be removed due to high HWE.\n&quot;</span>)<br><br><span class="hljs-comment">#subset genotype and SNP summary data for SNPs that pass HWE criteria</span><br>genotype &lt;- genotype[,HWEuse]<br>print(genotype)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  656890 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs12565286 ... rs28729663 </span><br></code></pre></td></tr></table></figure><p>在 CAD 控制中，我们根据 HWE $p &lt; 1 × 10^{-6}$ 筛选出额外的1,296个 SNPs。结果是656,890个单核苷酸多态性可以在关联分析中考虑。</p><h3 id="新数据生成"><a href="#新数据生成" class="headerlink" title="新数据生成"></a>新数据生成</h3><p>在完成SNP和样本级的过滤后，我们在进行统计分析之前产生两种新的数据：</p><p>第一种是PC，旨在捕捉潜在的人口亚结构的信息，这些信息通常在自我报告的种族和民族变量中是不存在的。</p><blockquote><p>这种数据用于进行主成分分析，创建捕获种群子结构的主要组成部分。</p></blockquote><p>第二种是未定型的SNP的基因型，可能与结果有功能关系，因此为识别关联提供额外的力量。</p><h4 id="主成分分析（PCA）principal-component-analysis-PCA"><a href="#主成分分析（PCA）principal-component-analysis-PCA" class="headerlink" title="主成分分析（PCA）principal component analysis (PCA)"></a>主成分分析（PCA）principal component analysis (PCA)</h4><p>Creating principal components for capturing population‐substructure 创建捕获种群子结构的主要组成部分</p><p>亚结构，也被称为种群混杂和种群分层，指的是在一个明显的同质种群中存在遗传多样性（如不同的等位基因频率），这是由于种群遗传历史（如迁移、选择和/或种族融合）造成的。基于观察到的基因型数据的PC可以捕捉到关于亚结构的信息，并且可以直接使用SNPRelate软件包中的snpgdsPCA()函数根据全基因型数据生成。</p><p>值得注意的是，我们在PCA之前再次应用LD修剪。通常情况下，前10个PC被认为是可能的混杂因素。这个数字是常规的，但也是任意的，一种选择是根据它们所解释的变异性的预设比例来选择PC的数量。λ统计量通常用于评估是否有必要纳入PC。这将在步骤10（量化-量化（Q-Q）图和λ-统计量）中进一步描述。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step5-</span><br><span class="hljs-comment">#generating principal components for modeling</span><br><br><span class="hljs-comment">#-step5a-</span><br><span class="hljs-comment">#set LD threshold to 0.2</span><br>ld.thresh &lt;- 0.2<br><br>set.seed(<span class="hljs-number">1000</span>)<br>geno.sample.ids &lt;- rownames(genotype)<br>snpSVB &lt;- snpgdsLDpruning(genofile, ld.threshold = <span class="hljs-number">0.2</span>,<br>                          sample.id = geno.sample.ids, <span class="hljs-comment">#only analyze the filtered samples</span><br>                          snp.id = colnames(genotype)) <span class="hljs-comment">#only analyze the filtered SNPs</span><br>snpset.pca &lt;- unlist(snpSVB, use.names = <span class="hljs-literal">FALSE</span>)<br>cat(<span class="hljs-built_in">length</span>(snpset.pca),<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## SNP pruning based on LD:</span><br><span class="hljs-comment">## Excluding 204,583 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 656,890</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     sliding window: 500,000 basepairs, Inf SNPs</span><br><span class="hljs-comment">##     |LD| threshold: 0.2</span><br><span class="hljs-comment">##     method: composite</span><br><span class="hljs-comment">## Chromosome 1: 8.21%, 5,834/71,038</span><br><span class="hljs-comment">## Chromosome 3: 8.14%, 4,933/60,565</span><br><span class="hljs-comment">## Chromosome 6: 8.03%, 4,350/54,176</span><br><span class="hljs-comment">## Chromosome 12: 8.57%, 3,609/42,124</span><br><span class="hljs-comment">## Chromosome 21: 9.44%, 1,177/12,463</span><br><span class="hljs-comment">## Chromosome 2: 7.68%, 5,658/73,717</span><br><span class="hljs-comment">## Chromosome 4: 8.24%, 4,590/55,675</span><br><span class="hljs-comment">## Chromosome 7: 8.45%, 3,922/46,391</span><br><span class="hljs-comment">## Chromosome 11: 7.88%, 3,485/44,213</span><br><span class="hljs-comment">## Chromosome 10: 7.96%, 3,817/47,930</span><br><span class="hljs-comment">## Chromosome 8: 7.67%, 3,704/48,299</span><br><span class="hljs-comment">## Chromosome 5: 8.06%, 4,526/56,178</span><br><span class="hljs-comment">## Chromosome 14: 8.78%, 2,464/28,054</span><br><span class="hljs-comment">## Chromosome 9: 8.20%, 3,370/41,110</span><br><span class="hljs-comment">## Chromosome 17: 11.12%, 2,217/19,939</span><br><span class="hljs-comment">## Chromosome 13: 8.34%, 2,857/34,262</span><br><span class="hljs-comment">## Chromosome 20: 9.38%, 2,135/22,753</span><br><span class="hljs-comment">## Chromosome 15: 9.20%, 2,384/25,900</span><br><span class="hljs-comment">## Chromosome 16: 9.13%, 2,519/27,591</span><br><span class="hljs-comment">## Chromosome 18: 8.97%, 2,353/26,231</span><br><span class="hljs-comment">## Chromosome 19: 12.97%, 1,489/11,482</span><br><span class="hljs-comment">## Chromosome 22: 11.18%, 1,272/11,382</span><br><span class="hljs-comment">## 72,665 markers are selected in total.</span><br>cat(<span class="hljs-built_in">length</span>(snpset.pca),<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment">## 72665</span><br>pca &lt;- snpgdsPCA(genofile, sample.id = geno.sample.ids, snp.id = snpset.pca, num.thread = <span class="hljs-number">1</span>)<br><span class="hljs-comment">## Hint: it is suggested to call `snpgdsOpen&#x27; to open a SNP GDS file instead of `openfn.gds&#x27;.</span><br><span class="hljs-comment">## Principal Component Analysis (PCA) on genotypes:</span><br><span class="hljs-comment">## Excluding 788,808 SNPs (non-autosomes or non-selection)</span><br><span class="hljs-comment">## Excluding 0 SNP (monomorphic: TRUE, MAF: NaN, missing rate: NaN)</span><br><span class="hljs-comment">##     # of samples: 1,401</span><br><span class="hljs-comment">##     # of SNPs: 72,665</span><br><span class="hljs-comment">##     using 1 thread</span><br><span class="hljs-comment">##     # of principal components: 32</span><br><span class="hljs-comment">## PCA:    the sum of all selected genotypes (0,1,2) = 32694833</span><br><span class="hljs-comment">## CPU capabilities: Double-Precision SSE2</span><br><span class="hljs-comment">## Tue Sep 14 13:32:27 2021    (internal increment: 252)</span><br><span class="hljs-comment">## [==================================================] 100%, completed, 43s </span><br><span class="hljs-comment">## Tue Sep 14 13:33:10 2021    Begin (eigenvalues and eigenvectors)</span><br><span class="hljs-comment">## Tue Sep 14 13:33:11 2021    Done.</span><br><br><span class="hljs-comment"># find and record first 10 principal components</span><br><span class="hljs-comment"># pcs will be a N:10 matrix </span><br><span class="hljs-comment"># each column is a principal component</span><br>pcs &lt;- data.frame(FamID = pca$sample.id, pca$eigenvect[,<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],<br>                  stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br>colnames(pcs)[<span class="hljs-number">2</span>:<span class="hljs-number">11</span>] &lt;- paste(<span class="hljs-string">&quot;pc&quot;</span>,<span class="hljs-number">1</span>:<span class="hljs-number">10</span>,sep = <span class="hljs-string">&quot;&quot;</span>)<br>print(head(pcs))<br><span class="hljs-comment">##   FamID          pc1           pc2          pc3           pc4           pc5           pc6           pc7          pc8</span><br><span class="hljs-comment">## 1 10002  0.008136946  0.0102555005  0.004035296 -0.0067555328  0.0290486205 -0.0158332357 -0.0368010948  0.007497037</span><br><span class="hljs-comment">## 2 10004 -0.011771047 -0.0080186632  0.004526211  0.0137606581 -0.0005964856  0.0322921253 -0.0004926945 -0.001072583</span><br><span class="hljs-comment">## 3 10005 -0.016963522 -0.0051956716 -0.013847881  0.0112937916 -0.0330688171 -0.0326298549 -0.0113624994 -0.001566384</span><br><span class="hljs-comment">## 4 10007 -0.010673757  0.0037745524  0.004574423 -0.0015019307 -0.0127123211 -0.0007371223 -0.0048545424 -0.013640426</span><br><span class="hljs-comment">## 5 10008 -0.016487939  0.0012844871 -0.019463117 -0.0051653724  0.0074000952 -0.0024935274  0.0022416080  0.041584582</span><br><span class="hljs-comment">## 6 10009 -0.014734448  0.0007935566 -0.017633485 -0.0005575061 -0.0547999107 -0.0288053889 -0.0075189053  0.016484556</span><br><span class="hljs-comment">##            pc9          pc10</span><br><span class="hljs-comment">## 1 -0.006501613  0.0003016164</span><br><span class="hljs-comment">## 2  0.034174191 -0.0185128130</span><br><span class="hljs-comment">## 3  0.005833437 -0.0020015591</span><br><span class="hljs-comment">## 4 -0.015690254 -0.0190696938</span><br><span class="hljs-comment">## 5  0.027821854 -0.0104951963</span><br><span class="hljs-comment">## 6  0.028223932 -0.0144727186</span><br><br></code></pre></td></tr></table></figure><h4 id="非类型基因型的归因-imputation-of-non‐typed-genotypes"><a href="#非类型基因型的归因-imputation-of-non‐typed-genotypes" class="headerlink" title="非类型基因型的归因 imputation of non‐typed genotypes"></a>非类型基因型的归因 imputation of non‐typed genotypes</h4><p>Imputing non‐typed single nucleotide polymorphisms using 1000 Genomes data </p><p>使用芯片阵列技术测量的类型SNPs通常捕获了大约100万个多态性，这些多态性在一般人群中至少有1%的变化。更为普遍的是，由于功能（因果）变体可能没有被测量到，所以人们对分析非类型SNPs的基因型与疾病结果的关联感兴趣。利用广泛的关于参考单倍型及其LD结构的外部资源，如HapMap和1000基因组数据，我们可以估算出未测量的基因型数据。三个精心描述并推荐的用于SNP水平归因的独立软件包是IMPUTE2、MACH和BEAGLE。归入的基因型可以报告为 “最佳猜测 “的基因型，或报告为基因组上某一位置的每个基因型的后验概率。重要的是，这种估计过程中的不确定性需要在关联分析中加以考虑，因此，我们从此区分了基因型和估算的数据。后面的步骤8中描述了专门考虑归入的SNP数据的不确定性的方法。</p><p>在归纳之后，要进行质量控制步骤，以过滤具有高度不确定性的归纳数据。常见的不确定性的衡量标准是信息含量和$R^2$ 。我们将$R^2$ 的阈值定为0.7，以纳入关联分析，在这种情况下，$R^2$ 是将每个归入的SNP回归到区域类型的SNP的线性模型的关联值。这在snpStats软件包的文档中有进一步描述。此外，我们在这个阶段排除了MAF（分配最高后验概率基因型后）小于0.01的SNPs。为了说明问题，我们使用R软件包snpStats中的snp.imputation()和impute.snps()函数，对同一染色体（16号染色体）上的1000个基因组SNP的有限集合进行归因，这些SNP在GWA关联分析（步骤7）中被确定为全基因组显著的基因分型。在实践中，通常在所有的染色体上进行归因，从而产生多达1250万个分型和归因的SNPs，可以对其进行关联分析。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#-step6-</span><br><span class="hljs-comment">#genotype imputation</span><br><br><span class="hljs-comment">#-step6a-</span><br><span class="hljs-comment">#read in 1000g data for given chromosome 16</span><br>thougeno &lt;- read.pedfile(onethou.fn$ped, snps = onethou.fn$info, which = <span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># obtain genotype data for given chromosome</span><br>genoMatrix &lt;- thougeno$genotypes<br><br><span class="hljs-comment"># obtain the chromosome position for each SNP</span><br>support &lt;- thougeno$map<br>colnames(support) &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;A1&quot;</span>, <span class="hljs-string">&quot;A2&quot;</span>)<br>head(support)<br><span class="hljs-comment">##           SNP position A1 A2</span><br><span class="hljs-comment">## 1 rs140769322    60180  3  2</span><br><span class="hljs-comment">## 2 rs188810967    60288  2  1</span><br><span class="hljs-comment">## 3  rs76368850    60291  2  4</span><br><span class="hljs-comment">## 4 rs185537431    60778  3  1</span><br><span class="hljs-comment">## 5 rs542544747    60842  2  1</span><br><span class="hljs-comment">## 6   rs4021615    61349  1  3</span><br><br><span class="hljs-comment">#imputation of non-typed 1000g SNPs</span><br>presSnps &lt;- colnames(genotype)<br><br><span class="hljs-comment">#subset for SNPs on given chromosome</span><br>presDatChr &lt;- genobim[genobim$SNP %in% presSnps &amp; genobim$chr==<span class="hljs-number">16</span>, ]<br>targetSnps &lt;- presDatChr$SNP<br><br><span class="hljs-comment">#subset 1000g data for our SNPs</span><br><span class="hljs-comment">#&quot;missing&quot; and &quot;present&quot; are snpMatrix objects needed for imputation rules</span><br>is.present &lt;- colnames(genoMatrix) %in% targetSnps<br>missing &lt;- genoMatrix[,!is.present]<br>print(<span class="hljs-built_in">missing</span>)<br><span class="hljs-comment">## A SnpMatrix with  99 rows and  377819 columns</span><br><span class="hljs-comment">## Row names:  CEU_1 ... CEU_99 </span><br><span class="hljs-comment">## Col names:  rs140769322 ... rs111706106 </span><br><br>present &lt;- genoMatrix[,is.present]<br>print(present)<br><span class="hljs-comment">## A SnpMatrix with  99 rows and  20632 columns</span><br><span class="hljs-comment">## Row names:  CEU_1 ... CEU_99 </span><br><span class="hljs-comment">## Col names:  rs41340949 ... rs4785775</span><br><br><span class="hljs-comment">#obtain position of SNPs to be used for imputation rules</span><br>pos.pres &lt;- support$position[is.present]<br>pos.mis &lt;- support$position[!is.present]<br><br><span class="hljs-comment">#calculate and store imputation rules using snp.imputation()</span><br>rules &lt;- snp.imputation(present, <span class="hljs-built_in">missing</span>, pos.pres, pos.mis)<br><span class="hljs-comment">## SNPs tagged by a single SNP: 82119</span><br><span class="hljs-comment">## SNPs tagged by multiple tag haplotypes (saturated model): 115769</span><br></code></pre></td></tr></table></figure><p>然后去掉failed imputation，输入相关不确定度高的SNPs，并且输入低估计MAF的SNPs。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step6b-</span><br><span class="hljs-comment">#remove failed imputations</span><br>rules &lt;- rules[can.impute(rules)]<br>cat(<span class="hljs-string">&quot;imputation rules for&quot;</span>, <span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;SNPs were estimated\n&quot;</span>) <br><span class="hljs-comment">## imputation rules for 197888 SNPs were estimated</span><br><br><span class="hljs-comment">#quality control for imputation certainty and MAF</span><br><span class="hljs-comment">#set thresholds</span><br>r2threshold &lt;- 0.7<br>minor &lt;- 0.01<br><br><span class="hljs-comment">#filter on imputation certainty and MAF</span><br>rules &lt;- rules[imputation.r2(rules) &gt;= <span class="hljs-number">0.7</span>]<br>cat(<span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;imputation rules remain after uncertain imputation were removed\n&quot;</span>)<br><span class="hljs-comment">## 162565 imputation rules remain after uncertain imputation were removed</span><br><br>rules &lt;- rules[imputation.maf(rules) &gt;= <span class="hljs-number">0.01</span>]<br>cat(<span class="hljs-built_in">length</span>(rules), <span class="hljs-string">&quot;imputation rules remain after MAF filtering\n&quot;</span>)<br><span class="hljs-comment">## 162565 imputation rules remain after MAF filtering</span><br><br><span class="hljs-comment">#obtain posterior expectation of genotypes of imputed snps</span><br>target &lt;- genotype[,targetSnps]<br>imputed &lt;- impute.snps(rules, target, <span class="hljs-built_in">as.numeric</span> = <span class="hljs-literal">FALSE</span>)<br>print(imputed)<br><span class="hljs-comment">## A SnpMatrix with  1401 rows and  162565 columns</span><br><span class="hljs-comment">## Row names:  10002 ... 11596 </span><br><span class="hljs-comment">## Col names:  rs560777354;rs80001234 ... rs62053708 </span><br></code></pre></td></tr></table></figure><p>这一步的分析结果：在16号染色体上的162565个基因组设定的SNPs被带到步骤8中进行关联分析。</p><p>需要强调的是，在关联分析（association analysis）的背景下，需要考虑归属的不确定性（the uncertainty in imputation），因此这些SNPs与下一步中分析的类型SNPs是分开考虑的。</p><h3 id="全基因组关联分析-Genome-wide-association-analysis"><a href="#全基因组关联分析-Genome-wide-association-analysis" class="headerlink" title="全基因组关联分析 Genome-wide association analysis"></a>全基因组关联分析 Genome-wide association analysis</h3><h4 id="类型SNP的关联分析-association-analysis-of-typed-SNPs"><a href="#类型SNP的关联分析-association-analysis-of-typed-SNPs" class="headerlink" title="类型SNP的关联分析 association analysis of typed SNPs"></a>类型SNP的关联分析 association analysis of typed SNPs</h4><p>关联分析通常涉及将每个SNP单独回归到一个给定的性状上，并根据病人层面的临床、人口和环境因素进行调整。假设每个SNP的基础遗传模型（如显性、隐性或加性）将影响结果；然而，由于大量的SNP和与结果的关系通常不确定，通常会选择一个单一的加性模型。在这种情况下，如所提供的代码所示，每个SNP被表示为相应的小等位基因数（0、1或2）。</p><p>值得注意的是，基于替代模型（如显性或隐性）的SNP变量的编码是直接的，所描述的关联分析也是如此。在实践中，Bonferonni校正的全基因组显著性阈值为 $5×10^{-8}$，用于控制家族性的错误率。这个临界值是基于研究，表明整个基因组大约有100万个独立的SNPs，所以不管调查中实际的 typed 或 imputed 的SNPs数量如何，都要应用。</p><p>在我们的数据例子中，我们使用反正态转换的高密度脂蛋白胆固醇作为响应，调整了年龄、性别和前10个PC。高密度脂蛋白胆固醇是一个与心血管疾病相关的复杂特征，年龄和性别是其既定的风险因素。这两个协变量和任意选择的10个PC是心血管疾病性状关联研究的惯例。重要的是，在任何模型拟合过程中，必须评估模型假设的适当性，特别是所研究性状的正态性。对高密度脂蛋白胆固醇直方图的目视检查显示了一些极端值，因此，选择了反正态转换。其他转换，如对数转换，也可能是合理的，并具有保持观测值之间相对距离的优势。我们在本教程中不强调这一点，因为可以应用标准的统计建模实践。下面的代码为分析准备了表型数据。</p><blockquote><p>本教程需要GenABEL包，但该包已被从CRAN上移除，故只能使用下载压缩包然后本地安装的方法。</p><p>步骤如下：</p><ol><li><p>在terminal中</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -O https://cran.r-project.org/src/contrib/Archive/GenABEL/GenABEL_1.8-0.tar.gz<br>curl -O https://cran.r-project.org/src/contrib/Archive/GenABEL.data/GenABEL.data_1.0.0.tar.gz<br></code></pre></td></tr></table></figure></li><li><p>RStudio - Tools - Install Packages - Install from: Package Archive File</p></li></ol></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step7-</span><br><span class="hljs-comment">#association analysis of typed SNPs</span><br>library(GenABEL)<br><br><span class="hljs-comment">#-step7a-</span><br><span class="hljs-comment">#merge clinical data and principal components to create phenotype table</span><br>phenoSub &lt;- merge(clinical, pcs) <span class="hljs-comment"># data.frame =&gt; [FamID CAD sex age hdl pc1 pc2 ... pc10]</span><br><br><span class="hljs-comment">#we will do a rank-based inverse normal transformation of hdl</span><br>phenoSub$phenotype &lt;- rntransform(phenoSub$hdl, family = gaussian)<br><br><span class="hljs-comment">#show that the assumption of normality met after transformation</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))<br>hist(phenoSub$hdl, main=<span class="hljs-string">&quot;histogram of HDL&quot;</span>, xlab = <span class="hljs-string">&quot;HDL&quot;</span>)<br>hist(phenoSub$phenotype, main=<span class="hljs-string">&quot;histogram of tranformed HDL&quot;</span>, xlab = <span class="hljs-string">&quot;transformed HDL&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="hist.png" alt="hist"></p><blockquote><p>转换为了正态分布</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#remove unnecessary columns from table</span><br>phenoSub$hdl &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$ldl &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$tg &lt;- <span class="hljs-literal">NULL</span><br>phenoSub$CAD &lt;- <span class="hljs-literal">NULL</span><br><br><span class="hljs-comment">#remove columns to match names necessary for GWAS() function</span><br>phenoSub &lt;- rename(phenoSub, replace = <span class="hljs-built_in">c</span>(FamID=<span class="hljs-string">&quot;id&quot;</span>))<br><br><span class="hljs-comment">#include only subjects with hdl data</span><br>phenoSub &lt;- phenoSub[!<span class="hljs-built_in">is.na</span>(phenoSub$phenotype),]<br><br>print(head(phenoSub))<br><span class="hljs-comment">##      id sex age         pc1           pc2          pc3           pc4           pc5           pc6           pc7</span><br><span class="hljs-comment">## 2 10004   2  50 -0.01177105 -0.0080186632  0.004526211  0.0137606581 -0.0005964856  0.0322921253 -0.0004926945</span><br><span class="hljs-comment">## 3 10005   1  55 -0.01696352 -0.0051956716 -0.013847881  0.0112937916 -0.0330688171 -0.0326298549 -0.0113624994</span><br><span class="hljs-comment">## 4 10007   1  52 -0.01067376  0.0037745524  0.004574423 -0.0015019307 -0.0127123211 -0.0007371223 -0.0048545424</span><br><span class="hljs-comment">## 5 10008   1  58 -0.01648794  0.0012844871 -0.019463117 -0.0051653724  0.0074000952 -0.0024935274  0.0022416080</span><br><span class="hljs-comment">## 6 10009   1  59 -0.01473445  0.0007935566 -0.017633485 -0.0005575061 -0.0547999107 -0.0288053889 -0.0075189053</span><br><span class="hljs-comment">## 7 10010   1  54 -0.01427468  0.0052373331 -0.014937383  0.0313489032  0.0104569709  0.0104441393 -0.0111072206</span><br><span class="hljs-comment">##            pc8          pc9         pc10  phenotype</span><br><span class="hljs-comment">## 2 -0.001072583  0.034174191 -0.018512813 -2.2877117</span><br><span class="hljs-comment">## 3 -0.001566384  0.005833437 -0.002001559 -0.4749316</span><br><span class="hljs-comment">## 4 -0.013640426 -0.015690254 -0.019069694  0.8855512</span><br><span class="hljs-comment">## 5  0.041584582  0.027821854 -0.010495196 -0.1644639</span><br><span class="hljs-comment">## 6  0.016484556  0.028223932 -0.014472719  0.3938940</span><br><span class="hljs-comment">## 7 -0.014092489 -0.020411854  0.017169084  1.7109552</span><br></code></pre></td></tr></table></figure><p>由于需要拟合的模型较多，建议并行运行GWA分析，即在几个核心中同时进行。每个核心对SNP的一个子集进行GWA分析，当所有核心的计算完成后，输出被返回到原来的顺序。</p><p>在接下来的文字中，我们描述了一种在MAC、Unix和Windows操作系统上并行运行分析的跨平台方法。detectCores()函数可以用来确定可用的工作者数量。为了并行地运行分析，我们使用doParallel包中的dopar()函数，表示工作器的数量。doPar()的输出是一个ascii文本文件。这些都包含在我们开发的GWAA()函数中，可在本稿件的补充信息B中找到。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step7b-</span><br><span class="hljs-comment">#run GWAS analysis (using parallel processing)</span><br>library(plyr)<br>source(<span class="hljs-string">&quot;GWAA.R&quot;</span>)<br></code></pre></td></tr></table></figure><p>出现报错，显示无法加载函数。</p><p>解决方案：使用全局自定义函数。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># ---- gwaa ----</span><br><br><span class="hljs-comment"># Genome-wide Association Analysis</span><br><span class="hljs-comment"># Parallel implementation of linear model fitting on each SNP</span><br><br>GWAA &lt;- <span class="hljs-keyword">function</span>(genodata=genotypes,  phenodata=phenotypes, family = gaussian, filename=<span class="hljs-literal">NULL</span>,<br>                 append=<span class="hljs-literal">FALSE</span>, workers=getOption(<span class="hljs-string">&quot;mc.cores&quot;</span>,<span class="hljs-number">2L</span>), flip=<span class="hljs-literal">TRUE</span>,<br>                 select.snps=<span class="hljs-literal">NULL</span>, hosts=<span class="hljs-literal">NULL</span>, nSplits=<span class="hljs-number">10</span>)<br>&#123;<br>    <span class="hljs-keyword">if</span> (!require(doParallel)) &#123; stop(<span class="hljs-string">&quot;Missing doParallel package&quot;</span>) &#125;<br>    <br>    <span class="hljs-comment">#Check that a filename was specified</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">is.null</span>(filename)) stop(<span class="hljs-string">&quot;Must specify a filename for output.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that the genotype data is of class &#x27;SnpMatrix&#x27;</span><br>    <span class="hljs-keyword">if</span>( <span class="hljs-built_in">class</span>(genodata)!=<span class="hljs-string">&quot;SnpMatrix&quot;</span>) stop(<span class="hljs-string">&quot;Genotype data must of class &#x27;SnpMatrix&#x27;.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that there is a variable named &#x27;phenotype&#x27; in phenodata table</span><br>    <span class="hljs-keyword">if</span>( !<span class="hljs-string">&quot;phenotype&quot;</span> %in% colnames(phenodata))  stop(<span class="hljs-string">&quot;Phenotype data must have column named &#x27;phenotype&#x27;&quot;</span>)<br>    <br>    <span class="hljs-comment">#Check that there is a variable named &#x27;id&#x27; in phenodata table</span><br>    <span class="hljs-keyword">if</span>( !<span class="hljs-string">&quot;id&quot;</span> %in% colnames(phenodata)) stop(<span class="hljs-string">&quot;Phenotype data must have column named &#x27;id&#x27;.&quot;</span>)<br>    <br>    <span class="hljs-comment">#If a vector of SNPs is given, subset genotype data for these SNPs</span><br>    <span class="hljs-keyword">if</span>(!<span class="hljs-built_in">is.null</span>(select.snps)) genodata&lt;-genodata[,which(colnames(genodata)%in%select.snps)]<br>    <br>    <span class="hljs-comment">#Check that there are still SNPs in &#x27;SnpMatrix&#x27; object</span><br>    <span class="hljs-keyword">if</span>(ncol(genodata)==<span class="hljs-number">0</span>) stop(<span class="hljs-string">&quot;There are no SNPs in the &#x27;SnpMatrix&#x27; object.&quot;</span>)<br>    <br>    <span class="hljs-comment">#Print the number of SNPs to be checked</span><br>    cat(paste(ncol(genodata), <span class="hljs-string">&quot; SNPs included in analysis.\n&quot;</span>))<br>    <br>    <span class="hljs-comment">#If append=FALSE than we will overwrite file with column names</span><br>    <span class="hljs-keyword">if</span>(!isTRUE(append)) &#123;<br>        columns&lt;-<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;Estimate&quot;</span>, <span class="hljs-string">&quot;Std.Error&quot;</span>, <span class="hljs-string">&quot;t-value&quot;</span>, <span class="hljs-string">&quot;p-value&quot;</span>)<br>        write.table(t(columns), filename, row.names=<span class="hljs-literal">FALSE</span>, col.names=<span class="hljs-literal">FALSE</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-literal">FALSE</span>)<br>    &#125;<br><br>    <span class="hljs-comment"># Check sample counts</span><br>    <span class="hljs-keyword">if</span> (nrow(phenodata) != nrow(genodata)) &#123;<br>        warning(<span class="hljs-string">&quot;Number of samples mismatch.  Using subset found in phenodata.&quot;</span>)<br>    &#125;<br><br>    <span class="hljs-comment"># Order genodata rows to be the same as phenodata</span><br>    genodata &lt;- genodata[phenodata$id,]<br><br>    cat(nrow(genodata), <span class="hljs-string">&quot;samples included in analysis.\n&quot;</span>)<br><br>    <span class="hljs-comment"># Change which allele is counted (major or minor)</span><br>    flip.matrix&lt;-<span class="hljs-keyword">function</span>(x) &#123;<br>        zero2 &lt;- which(x==<span class="hljs-number">0</span>)<br>        two0 &lt;- which(x==<span class="hljs-number">2</span>)<br>        x[zero2] &lt;- <span class="hljs-number">2</span><br>        x[two0] &lt;- <span class="hljs-number">0</span><br>        <span class="hljs-built_in">return</span>(x)<br>    &#125;<br><br>    nSNPs &lt;- ncol(genodata)<br>    genosplit &lt;- <span class="hljs-built_in">ceiling</span>(nSNPs/nSplits) <span class="hljs-comment"># number of SNPs in each subset</span><br><br>    snp.start &lt;- seq(<span class="hljs-number">1</span>, nSNPs, genosplit) <span class="hljs-comment"># index of first SNP in group</span><br>    snp.stop &lt;- pmin(snp.start+genosplit-<span class="hljs-number">1</span>, nSNPs) <span class="hljs-comment"># index of last SNP in group</span><br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is.null</span>(hosts)) &#123;<br>        <span class="hljs-comment"># On Unix this will use fork and mclapply.  On Windows it</span><br>        <span class="hljs-comment"># will create multiple processes on localhost.</span><br>        cl &lt;- makeCluster(workers)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment"># The listed hosts must be accessible by the current user using</span><br>        <span class="hljs-comment"># password-less ssh with R installed on all hosts, all </span><br>        <span class="hljs-comment"># packages installed, and &quot;rscript&quot; is in the default PATH.</span><br>        <span class="hljs-comment"># See docs for makeCluster() for more information.</span><br>        cl &lt;- makeCluster(hosts, <span class="hljs-string">&quot;PSOCK&quot;</span>)<br>    &#125;<br>    show(cl)                            <span class="hljs-comment"># report number of workers and type of parallel implementation</span><br>    registerDoParallel(cl)<br><br>    foreach (part=<span class="hljs-number">1</span>:nSplits) %do% &#123;<br>        <span class="hljs-comment"># Returns a standar matrix of the alleles encoded as 0, 1 or 2</span><br>        genoNum &lt;- as(genodata[,snp.start[part]:snp.stop[part]], <span class="hljs-string">&quot;numeric&quot;</span>)<br><br>        <span class="hljs-comment"># Flip the numeric values of genotypes to count minor allele</span><br>        <span class="hljs-keyword">if</span> (isTRUE(flip)) genoNum &lt;- flip.matrix(genoNum)<br><br>        <span class="hljs-comment"># For each SNP, concatenate the genotype column to the</span><br>        <span class="hljs-comment"># phenodata and fit a generalized linear model</span><br>        rsVec &lt;- colnames(genoNum)<br>        res &lt;- foreach(snp.name=rsVec, .combine=<span class="hljs-string">&#x27;rbind&#x27;</span>) %dopar% &#123;<br>            a &lt;- summary(glm(phenotype~ . - id, family=family, data=cbind(phenodata, snp=genoNum[,snp.name])))<br>            a$coefficients[<span class="hljs-string">&#x27;snp&#x27;</span>,]<br>        &#125;<br><br>        <span class="hljs-comment"># write results so far to a file</span><br>        write.table(cbind(rsVec,res), filename, append=<span class="hljs-literal">TRUE</span>, <span class="hljs-built_in">quote</span>=<span class="hljs-literal">FALSE</span>, col.names=<span class="hljs-literal">FALSE</span>, row.names=<span class="hljs-literal">FALSE</span>)<br><br>        cat(sprintf(<span class="hljs-string">&quot;GWAS SNPs %s-%s (%s%% finished)\n&quot;</span>, snp.start[part], snp.stop[part], <span class="hljs-number">100</span>*part/nSplits))<br>    &#125;<br><br>    stopCluster(cl)<br>  <br>    <span class="hljs-built_in">return</span>(print(<span class="hljs-string">&quot;Done.&quot;</span>))<br>&#125;<br><span class="hljs-comment">#自定义GWAA函数</span><br><br><span class="hljs-comment">#note: this function writes a file, but does not produce a r project</span><br>start &lt;- Sys.time()<br>GWAA(genodata=genotype, phenodata=phenoSub, filename=gwaa.fname)<br><span class="hljs-comment">## [1] &quot;Done.&quot;</span><br><span class="hljs-comment">## Warning message:</span><br><span class="hljs-comment">## In GWAA(genodata = genotype, phenodata = phenoSub, filename = gwaa.fname) :</span><br><span class="hljs-comment">##   Number of samples mismatch.  Using subset found in phenodata.</span><br><br>end &lt;- Sys.time()<br>print(end-start)<br><span class="hljs-comment">## Time difference of 2.043743 hours</span><br></code></pre></td></tr></table></figure><h4 id="归因数据的关联分析-association-analysis-of-imputed-data"><a href="#归因数据的关联分析-association-analysis-of-imputed-data" class="headerlink" title="归因数据的关联分析 association analysis of imputed data"></a>归因数据的关联分析 association analysis of imputed data</h4><p>应用snpStats使用相应的后验概率进行估算 SNPs 的关联分析</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step8-</span><br><span class="hljs-comment">#association analysis of imputed SNPs</span><br><br><span class="hljs-comment">#-step8a-</span><br><span class="hljs-comment">#carry out associate testing for imputed SNPs using snp.rhs.tests()</span><br>rownames(phenoSub) &lt;- phenoSub$id<br>imp &lt;- snp.rhs.tests(phenotype ~ sex + age + pc1 + pc2 + pc3 + pc4 + pc5 + pc6 + pc7 + pc8 + pc9 + pc10,<br>                     family = <span class="hljs-string">&quot;Gaussian&quot;</span>,<br>                     data = phenoSub,<br>                     snp.data = target,<br>                     rules = rules)<br><br><span class="hljs-comment">#obtain p values for imputed SNPs by calling methods on the returned GlmTests object</span><br>results &lt;- data.frame(SNP = imp@snp.names, p.value = p.value(imp), stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br>results &lt;- results[!<span class="hljs-built_in">is.na</span>(results$p.value),]<br><br><span class="hljs-comment">#write a file containing the results</span><br>write.csv(results, input.out.fname, row.names = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#merge imputation testing results with support to obtain coordinates</span><br>imputeOut &lt;- merge(results, support[, <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>)])<br>imputeOut$chr &lt;- 16<br>imputeOut$type &lt;- <span class="hljs-string">&quot;imputed&quot;</span><br><br><span class="hljs-comment">#find the -log_10 of the p-value</span><br>imputeOut$Neg_logP &lt;- -log10(imputeOut$p.value)<br><br><span class="hljs-comment">#order by p-value</span><br>imputeOut &lt;- arrange(imputeOut, p.value)<br>print(head(imputeOut))<br><span class="hljs-comment">##          SNP      p.value position chr    type Neg_logP</span><br><span class="hljs-comment">## 1  rs1532624 1.036455e-07 57005479  16 imputed 6.984449</span><br><span class="hljs-comment">## 2  rs7205804 1.036455e-07 57004889  16 imputed 6.984449</span><br><span class="hljs-comment">## 3 rs12446515 1.746000e-07 56987015  16 imputed 6.757956</span><br><span class="hljs-comment">## 4 rs17231506 1.746000e-07 56994528  16 imputed 6.757956</span><br><span class="hljs-comment">## 5   rs173539 1.746000e-07 56988044  16 imputed 6.757956</span><br><span class="hljs-comment">## 6   rs183130 1.746000e-07 56991363  16 imputed 6.757956</span><br></code></pre></td></tr></table></figure><p>现在，我们在16号染色体上总共确定了22个推算的SNPs，这些SNPs在 $5×10^{-6}$ 的暗示性关联阈值下是显著的。</p><p>接下来，我们只选择CETP区域内（±5Kb）的SNPs进行报告。在此，我们使用自开发的map2gene()函数，，它可以确定属于指定基因区域的SNPs集合。这个函数使用基于基因组参考联盟GRCh37（hg19）的基因坐标，在文件ProCodgene_coords.csv中提供。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step8b-</span><br><span class="hljs-comment"># ---- map2gene ----</span><br><span class="hljs-comment"># Returns the subset of SNPs that are within extend.boundary of gene</span><br><span class="hljs-comment"># using the coords table of gene locations.</span><br>map2gene &lt;- <span class="hljs-keyword">function</span>(gene, coords, SNPs, extend.boundary = <span class="hljs-number">5000</span>) &#123;<br>  coordsSub &lt;- coords[coords$gene == gene,] <span class="hljs-comment">#Subset coordinate file for spcified gene</span><br>  <br>  coordsSub$start &lt;- coordsSub$start - extend.boundary <span class="hljs-comment"># Extend gene boundaries</span><br>  coordsSub$stop &lt;- coordsSub$stop + extend.boundary<br>  <br>  SNPsub &lt;- SNPs[SNPs$position &gt;= coordsSub$start &amp; SNPs$position &lt;= coordsSub$stop &amp;<br>                   SNPs$chr == coordsSub$chr,] <span class="hljs-comment">#Subset for SNPs in gene</span><br>  <br>  <span class="hljs-built_in">return</span>(data.frame(SNPsub, gene = gene, stringsAsFactors = <span class="hljs-literal">FALSE</span>))<br>&#125;<br><br><span class="hljs-comment">#read in file containing protein coding genes coords</span><br>genes &lt;- read.csv(protein.coding.coords.fnamo, stringsAsFactors = <span class="hljs-literal">FALSE</span>)<br><br><span class="hljs-comment">#subset for CETP SNPs</span><br>impCETP &lt;- map2gene(<span class="hljs-string">&quot;CETP&quot;</span>, coords = genes, SNPs = imputeOut)<br><br><span class="hljs-comment">#filter only the imputed CETP SNP genotypes</span><br>impCETPgeno &lt;- imputed[,impCETP$SNP]<br></code></pre></td></tr></table></figure><p>在这个阶段，我们将70个归纳的SNPs映射到CETP区域，其中16个在 $5×10^{-6}$ 的提示性关联阈值上是显著的。</p><h3 id="Post‐analytic-visualization-and-genomic-interrogation-后分析可视化和基因组审查"><a href="#Post‐analytic-visualization-and-genomic-interrogation-后分析可视化和基因组审查" class="headerlink" title="Post‐analytic visualization and genomic interrogation 后分析可视化和基因组审查"></a>Post‐analytic visualization and genomic interrogation 后分析可视化和基因组审查</h3><h4 id="归因和类型SNP结果的整合-integration-of-imputed-and-typed-SNP-results"><a href="#归因和类型SNP结果的整合-integration-of-imputed-and-typed-SNP-results" class="headerlink" title="归因和类型SNP结果的整合 integration of imputed and typed SNP results"></a>归因和类型SNP结果的整合 integration of imputed and typed SNP results</h4><p>在这个阶段，将SNPs归属到基因座上并报告染色体和碱基对的位置，也被称为坐标或位置，也是很常见的。</p><p>值得注意的是，SNP的坐标取决于基因组的构建，在我们的数据例子中，我们使用基因组参考联盟GRCh37（hg19）构建。典型的结果展示包括基因和基因座名称；SNP名称；染色体编号；碱基对位置，根据指定的构建；来自模型拟合程序的系数估计（或赔率）；相应的标准误差；和相关的P值。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs r"><span class="hljs-comment">#-step9-</span><br><span class="hljs-comment">#data integration</span><br><br><span class="hljs-comment">#-step9a-</span><br><span class="hljs-comment">#read in GWAS output that was produced by GWAA function</span><br>GWASout &lt;- read.table(gwaa.fname, header = <span class="hljs-literal">TRUE</span>, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>, <span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br><br><span class="hljs-comment">#find the -log_10 of the p-value</span><br>GWASout$Neg_logP &lt;- -log10(GWASout$p.value)<br><br><span class="hljs-comment">#merge output with genobim by SNP name to add position and chromosome number</span><br>GWASout &lt;- merge(GWASout, genobim[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>,<span class="hljs-string">&quot;chr&quot;</span>,<span class="hljs-string">&quot;position&quot;</span>)])<br><br><span class="hljs-comment">#order SNPs by significance</span><br>GWASout &lt;- arrange(GWASout, -Neg_logP)<br>print(head(GWASout))<br><span class="hljs-comment">##          SNP   Estimate  Std.Error   t.value      p.value Neg_logP chr  position</span><br><span class="hljs-comment">## 1  rs1532625  0.2015758 0.03748045  5.378159 8.944627e-08 7.048438  16  57005301</span><br><span class="hljs-comment">## 2   rs247617  0.2100771 0.03979461  5.279034 1.524209e-07 6.816955  16  56990716</span><br><span class="hljs-comment">## 3 rs10945761  0.1868139 0.04087883  4.569942 5.344253e-06 5.272113   6 162065367</span><br><span class="hljs-comment">## 4  rs9647610  0.1840277 0.04066594  4.525353 6.586987e-06 5.181313   6 162066421</span><br><span class="hljs-comment">## 5  rs3803768 -0.3048526 0.06755966 -4.512346 6.993775e-06 5.155288  17  80872028</span><br><span class="hljs-comment">## 6  rs4821708 -0.1808045 0.04018791 -4.498978 7.456555e-06 5.127462  22  38164106</span><br></code></pre></td></tr></table></figure><p>现在还需要一个额外的步骤来结合估算的数据结果和类型的SNP结果。值得注意的是，基因型推算可以涉及推算所有的SNPs，包括未观察到的和已分型的SNPs。因此，分析者可以选择从归因结果中只选择未分型或未通过SNP级过滤的SNP。在我们的例子中（第6步），我们归集了未分型的SNP以及未通过SNP水平过滤的SNP（第2和第4步）。然后，这个组合中的GWA重要SNPs可以进一步可视化，并按照步骤10的描述进行询问。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step9b-</span><br><span class="hljs-comment">#combine typed and imputed</span><br>GWASout$type &lt;- <span class="hljs-string">&quot;typed&quot;</span><br><br>GWAScomb &lt;- rbind.fill(GWASout, imputeOut)<br>head(GWAScomb)<br><span class="hljs-comment">##          SNP   Estimate  Std.Error   t.value      p.value Neg_logP chr  position  type</span><br><span class="hljs-comment">## 1  rs1532625  0.2015758 0.03748045  5.378159 8.944627e-08 7.048438  16  57005301 typed</span><br><span class="hljs-comment">## 2   rs247617  0.2100771 0.03979461  5.279034 1.524209e-07 6.816955  16  56990716 typed</span><br><span class="hljs-comment">## 3 rs10945761  0.1868139 0.04087883  4.569942 5.344253e-06 5.272113   6 162065367 typed</span><br><span class="hljs-comment">## 4  rs9647610  0.1840277 0.04066594  4.525353 6.586987e-06 5.181313   6 162066421 typed</span><br><span class="hljs-comment">## 5  rs3803768 -0.3048526 0.06755966 -4.512346 6.993775e-06 5.155288  17  80872028 typed</span><br><span class="hljs-comment">## 6  rs4821708 -0.1808045 0.04018791 -4.498978 7.456555e-06 5.127462  22  38164106 typed</span><br><br>tail(GWAScomb)<br><span class="hljs-comment">##              SNP Estimate Std.Error t.value   p.value     Neg_logP chr position    type</span><br><span class="hljs-comment">## 818527 rs7201255       NA        NA      NA 0.9999695 1.325135e-05  16 53869223 imputed</span><br><span class="hljs-comment">## 818528 rs7203572       NA        NA      NA 0.9999695 1.325135e-05  16 53869366 imputed</span><br><span class="hljs-comment">## 818529  rs257500       NA        NA      NA 0.9999870 5.647027e-06  16 64971479 imputed</span><br><span class="hljs-comment">## 818530  rs369139       NA        NA      NA 0.9999870 5.647027e-06  16 64968347 imputed</span><br><span class="hljs-comment">## 818531   rs40327       NA        NA      NA 0.9999870 5.647027e-06  16 64978301 imputed</span><br><span class="hljs-comment">## 818532  rs466296       NA        NA      NA 0.9999870 5.647027e-06  16 64962442 imputed</span><br><br><span class="hljs-comment">#subset for CETP SNPs</span><br>typCETP &lt;- map2gene(<span class="hljs-string">&quot;CETP&quot;</span>, coords = genes, SNPs = GWASout)<br><br><span class="hljs-comment">#combine CETP SNPs from imputed and typed analysis</span><br>CETP &lt;- rbind.fill(typCETP, impCETP)[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;SNP&quot;</span>, <span class="hljs-string">&quot;p.value&quot;</span>, <span class="hljs-string">&quot;Neg_logP&quot;</span>, <span class="hljs-string">&quot;chr&quot;</span>, <span class="hljs-string">&quot;position&quot;</span>, <span class="hljs-string">&quot;type&quot;</span>, <span class="hljs-string">&quot;gene&quot;</span>)]<br>print(CETP)<br><span class="hljs-comment">##            SNP      p.value   Neg_logP chr position    type gene</span><br><span class="hljs-comment">## 1    rs1532625 8.944627e-08 7.04843778  16 57005301   typed CETP</span><br><span class="hljs-comment">## 2     rs289742 4.257667e-04 3.37082835  16 57017762   typed CETP</span><br><span class="hljs-comment">## 3     rs289715 4.740815e-03 2.32414700  16 57008508   typed CETP</span><br><span class="hljs-comment">## 4    rs6499863 1.394646e-02 1.85553612  16 56992017   typed CETP</span><br><span class="hljs-comment">## 5    rs4783962 1.011933e-01 0.99484809  16 56995038   typed CETP</span><br><span class="hljs-comment">## 6    rs1800777 1.083617e-01 0.96512430  16 57017319   typed CETP</span><br><span class="hljs-comment">## 7   rs12708980 6.331485e-01 0.19849440  16 57012379   typed CETP</span><br><span class="hljs-comment">## 8    rs1532624 1.036455e-07 6.98444942  16 57005479 imputed CETP</span><br><span class="hljs-comment">## 9    rs7205804 1.036455e-07 6.98444942  16 57004889 imputed CETP</span><br><span class="hljs-comment">## 10  rs17231506 1.746000e-07 6.75795566  16 56994528 imputed CETP</span><br><span class="hljs-comment">## 11    rs183130 1.746000e-07 6.75795566  16 56991363 imputed CETP</span><br><span class="hljs-comment">## 12   rs3764261 1.746000e-07 6.75795566  16 56993324 imputed CETP</span><br><span class="hljs-comment">## 13    rs821840 1.746000e-07 6.75795566  16 56993886 imputed CETP</span><br><span class="hljs-comment">## 14  rs11508026 1.174797e-06 5.93003733  16 56999328 imputed CETP</span><br><span class="hljs-comment">## 15  rs12444012 1.174797e-06 5.93003733  16 57001438 imputed CETP</span><br><span class="hljs-comment">## 16  rs12720926 1.174797e-06 5.93003733  16 56998918 imputed CETP</span><br><span class="hljs-comment">## 17   rs4784741 1.174797e-06 5.93003733  16 57001216 imputed CETP</span><br><span class="hljs-comment">## 18  rs34620476 1.177972e-06 5.92886509  16 56996649 imputed CETP</span><br><span class="hljs-comment">## 19    rs708272 1.177972e-06 5.92886509  16 56996288 imputed CETP</span><br><span class="hljs-comment">## 20    rs711752 1.177972e-06 5.92886509  16 56996211 imputed CETP</span><br><span class="hljs-comment">## 21  rs12720922 3.392213e-06 5.46951693  16 57000885 imputed CETP</span><br><span class="hljs-comment">## 22   rs8045855 3.392213e-06 5.46951693  16 57000696 imputed CETP</span><br><span class="hljs-comment">## 23  rs12149545 3.692106e-06 5.43272585  16 56993161 imputed CETP</span><br><span class="hljs-comment">## 24   rs1800775 1.423952e-05 4.84650452  16 56995236 imputed CETP</span><br><span class="hljs-comment">## 25   rs3816117 1.423952e-05 4.84650452  16 56996158 imputed CETP</span><br><span class="hljs-comment">## 26  rs11076175 1.431416e-05 4.84423402  16 57006378 imputed CETP</span><br><span class="hljs-comment">## 27   rs7499892 1.431416e-05 4.84423402  16 57006590 imputed CETP</span><br><span class="hljs-comment">## 28  rs11076176 1.100766e-04 3.95830512  16 57007446 imputed CETP</span><br><span class="hljs-comment">## 29    rs289714 1.123948e-04 3.94925380  16 57007451 imputed CETP</span><br><span class="hljs-comment">## 30    rs158478 1.958087e-04 3.70816791  16 57007734 imputed CETP</span><br><span class="hljs-comment">## 31   rs9939224 3.075278e-04 3.51211557  16 57002732 imputed CETP</span><br><span class="hljs-comment">## 32  rs12447620 4.344681e-04 3.36204212  16 57014319 imputed CETP</span><br><span class="hljs-comment">## 33    rs158480 4.344681e-04 3.36204212  16 57008227 imputed CETP</span><br><span class="hljs-comment">## 34    rs158617 4.344681e-04 3.36204212  16 57008287 imputed CETP</span><br><span class="hljs-comment">## 35  rs11076174 4.293928e-03 2.36714525  16 57003146 imputed CETP</span><br><span class="hljs-comment">## 36 rs112039804 4.742793e-03 2.32396582  16 57018856 imputed CETP</span><br><span class="hljs-comment">## 37  rs12708985 4.742793e-03 2.32396582  16 57014610 imputed CETP</span><br><span class="hljs-comment">## 38    rs736274 4.742793e-03 2.32396582  16 57009769 imputed CETP</span><br><span class="hljs-comment">## 39 rs201825234 1.403181e-02 1.85288617  16 56991948 imputed CETP</span><br><span class="hljs-comment">## 40   rs2115429 1.403181e-02 1.85288617  16 56992842 imputed CETP</span><br><span class="hljs-comment">## 41   rs6499861 1.403181e-02 1.85288617  16 56991495 imputed CETP</span><br><span class="hljs-comment">## 42   rs6499862 1.403181e-02 1.85288617  16 56991524 imputed CETP</span><br><span class="hljs-comment">## 43    rs158479 1.764815e-02 1.75330083  16 57008048 imputed CETP</span><br><span class="hljs-comment">## 44    rs289713 1.848673e-02 1.73313993  16 57006829 imputed CETP</span><br><span class="hljs-comment">## 45  rs12720918 2.690313e-02 1.57019722  16 56994212 imputed CETP</span><br><span class="hljs-comment">## 46  rs12920974 2.690313e-02 1.57019722  16 56993025 imputed CETP</span><br><span class="hljs-comment">## 47  rs36229787 3.284685e-02 1.48350624  16 56993897 imputed CETP</span><br><span class="hljs-comment">## 48    rs289712 4.630073e-02 1.33441214  16 57006305 imputed CETP</span><br><span class="hljs-comment">## 49    rs820299 5.313036e-02 1.27465724  16 57000284 imputed CETP</span><br><span class="hljs-comment">## 50  rs34946873 5.924969e-02 1.22731392  16 56991143 imputed CETP</span><br><span class="hljs-comment">## 51  rs12597002 6.482442e-02 1.18826138  16 57002404 imputed CETP</span><br><span class="hljs-comment">## 52  rs60545348 6.482442e-02 1.18826138  16 57001985 imputed CETP</span><br><span class="hljs-comment">## 53    rs708273 6.482442e-02 1.18826138  16 56999949 imputed CETP</span><br><span class="hljs-comment">## 54   rs4369653 6.674449e-02 1.17558455  16 56997551 imputed CETP</span><br><span class="hljs-comment">## 55   rs4587963 7.720580e-02 1.11235007  16 56997369 imputed CETP</span><br><span class="hljs-comment">## 56      rs5880 8.144506e-02 1.08913528  16 57015091 imputed CETP</span><br><span class="hljs-comment">## 57   rs1800776 9.403016e-02 1.02673283  16 56995234 imputed CETP</span><br><span class="hljs-comment">## 58    rs289746 9.558715e-02 1.01960051  16 57020205 imputed CETP</span><br><span class="hljs-comment">## 59  rs12447839 1.014589e-01 0.99370984  16 56993935 imputed CETP</span><br><span class="hljs-comment">## 60  rs12447924 1.014589e-01 0.99370984  16 56994192 imputed CETP</span><br><span class="hljs-comment">## 61    rs158477 1.602619e-01 0.79516962  16 57007610 imputed CETP</span><br><span class="hljs-comment">## 62  rs12708983 2.717574e-01 0.56581860  16 57014411 imputed CETP</span><br><span class="hljs-comment">## 63  rs66495554 2.827752e-01 0.54855862  16 57018636 imputed CETP</span><br><span class="hljs-comment">## 64  rs12720889 2.857284e-01 0.54404657  16 57012563 imputed CETP</span><br><span class="hljs-comment">## 65  rs12934552 3.188555e-01 0.49640603  16 57021433 imputed CETP</span><br><span class="hljs-comment">## 66  rs12708968 3.476125e-01 0.45890456  16 56994819 imputed CETP</span><br><span class="hljs-comment">## 67  rs17245715 3.476125e-01 0.45890456  16 56994990 imputed CETP</span><br><span class="hljs-comment">## 68   rs4783961 4.661962e-01 0.33143130  16 56994894 imputed CETP</span><br><span class="hljs-comment">## 69  rs12598522 4.853361e-01 0.31395741  16 57022352 imputed CETP</span><br><span class="hljs-comment">## 70  rs56315364 4.853361e-01 0.31395741  16 57021524 imputed CETP</span><br><span class="hljs-comment">## 71 rs117427818 5.101389e-01 0.29231153  16 57010486 imputed CETP</span><br><span class="hljs-comment">## 72  rs11860407 5.935059e-01 0.22657493  16 57010828 imputed CETP</span><br><span class="hljs-comment">## 73   rs2033254 5.935059e-01 0.22657493  16 57009985 imputed CETP</span><br><span class="hljs-comment">## 74   rs7405284 6.134481e-01 0.21222214  16 57001275 imputed CETP</span><br><span class="hljs-comment">## 75   rs1800774 6.200971e-01 0.20754027  16 57015545 imputed CETP</span><br><span class="hljs-comment">## 76  rs36229786 6.227677e-01 0.20567392  16 56993901 imputed CETP</span><br><span class="hljs-comment">## 77  rs12708974 8.568509e-01 0.06709476  16 57005550 imputed CETP</span><br></code></pre></td></tr></table></figure><h4 id="关联结果的可视化和质量控制-visualization-and-quality-control-of-association-findings"><a href="#关联结果的可视化和质量控制-visualization-and-quality-control-of-association-findings" class="headerlink" title="关联结果的可视化和质量控制 visualization and quality control of association findings"></a>关联结果的可视化和质量控制 visualization and quality control of association findings</h4><p>这里描述了三种可视化工具。除了这些可视化方法，使用其他基因模型进行关联分析也是一个有用的敏感度分析。</p><h5 id="Manhattan-plots-曼哈顿图"><a href="#Manhattan-plots-曼哈顿图" class="headerlink" title="Manhattan plots 曼哈顿图"></a>Manhattan plots 曼哈顿图</h5><p>曼哈顿图被用来按染色体位置直观地显示GWA的显著性水平。在曼哈顿图中，每个点对应于一个SNP。X轴代表基因坐标，显示的数字对应于染色体编号。y轴是对数p值的负值，所以大的值对应小的p值。实心横线表示Bonferonni校正的显著性阈值（$- log(5 × 10^{-8})$）。</p><p>虚线是一个不太严格的暗示性关联阈值（$- log(5 × 10^{-6})$），我们将其作为暗示性关联的指标，需要进一步验证。</p><p>通过对该图的目视检查，可以识别出P值相对较小的SNP，这些SNP位于P值相对较大且不显著的区域，表明有可能是虚假的发现。CETP区域的多个信号表明，这可能是一个真实的信号。该图是用我们开发的GWAS_Manhattan()生成的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10-</span><br><span class="hljs-comment">#visualizing and QC of GWA findings</span><br><span class="hljs-comment"># ---- manhattan ----</span><br><span class="hljs-comment"># Receives a data.frame of SNPs with Neg_logP, chr, position, and type.</span><br><span class="hljs-comment"># Plots Manhattan plot with significant SNPs highlighted.</span><br>GWAS_Manhattan &lt;- <span class="hljs-keyword">function</span>(GWAS, col.snps=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;black&quot;</span>,<span class="hljs-string">&quot;gray&quot;</span>),<br>                           col.detected=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;black&quot;</span>), col.imputed=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;blue&quot;</span>), col.text=<span class="hljs-string">&quot;black&quot;</span>,<br>                           title=<span class="hljs-string">&quot;GWAS Tutorial Manhattan Plot&quot;</span>, display.text=<span class="hljs-literal">TRUE</span>,<br>                           bonferroni.alpha=<span class="hljs-number">0.05</span>, bonferroni.adjustment=<span class="hljs-number">1000000</span>,<br>                           Lstringent.adjustment=<span class="hljs-number">10000</span>) &#123;<br>  <br>  bonferroni.thresh &lt;- -log10(bonferroni.alpha / bonferroni.adjustment)<br>  Lstringent.thresh &lt;- -log10(bonferroni.alpha / Lstringent.adjustment)<br>  xscale &lt;- 1000000<br>  <br>  manhat &lt;- GWAS[!grepl(<span class="hljs-string">&quot;[A-z]&quot;</span>,GWAS$chr),]<br>  <br>  <span class="hljs-comment">#sort the data by chromosome and then location</span><br>  manhat.ord &lt;- manhat[order(<span class="hljs-built_in">as.numeric</span>(manhat$chr),manhat$position),]<br>  manhat.ord &lt;- manhat.ord[!<span class="hljs-built_in">is.na</span>(manhat.ord$position),]<br>  <br>  <span class="hljs-comment">##Finding the maximum position for each chromosome</span><br>  max.pos &lt;- sapply(<span class="hljs-number">1</span>:<span class="hljs-number">21</span>, <span class="hljs-keyword">function</span>(i) &#123; <span class="hljs-built_in">max</span>(manhat.ord$position[manhat.ord$chr==i],<span class="hljs-number">0</span>) &#125;)<br>  max.pos2 &lt;- <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">cumsum</span>(max.pos))                  <br>  <br>  <span class="hljs-comment">#Add spacing between chromosomes</span><br>  max.pos2 &lt;- max.pos2 + <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>:<span class="hljs-number">21</span>) * xscale * <span class="hljs-number">10</span><br>  <br>  <span class="hljs-comment">#defining the positions of each snp in the plot</span><br>  manhat.ord$pos &lt;- manhat.ord$position + max.pos2[<span class="hljs-built_in">as.numeric</span>(manhat.ord$chr)]<br>  <br>  <span class="hljs-comment"># alternate coloring of chromosomes</span><br>  manhat.ord$col &lt;- col.snps[<span class="hljs-number">1</span> + <span class="hljs-built_in">as.numeric</span>(manhat.ord$chr) %% <span class="hljs-number">2</span>]<br>  <br>  <span class="hljs-comment"># draw the chromosome label roughly in the middle of each chromosome band</span><br>  text.pos &lt;- sapply(<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>:<span class="hljs-number">22</span>), <span class="hljs-keyword">function</span>(i) &#123; mean(manhat.ord$pos[manhat.ord$chr==i]) &#125;)<br>  <br>  <span class="hljs-comment"># Plot the data</span><br>  plot(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>],<br>       pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.3</span>, col= manhat.ord$col[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>], xlab=<span class="hljs-literal">NA</span>,<br>       ylab=<span class="hljs-string">&quot;Negative Log P-value&quot;</span>, axes=<span class="hljs-built_in">F</span>, ylim=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">max</span>(manhat$Neg_logP)+<span class="hljs-number">1</span>))<br>  <span class="hljs-comment">#Add x-label so that it is close to axis</span><br>  mtext(side = <span class="hljs-number">1</span>, <span class="hljs-string">&quot;Chromosome&quot;</span>, line = <span class="hljs-number">1.25</span>)<br>  <br>  points(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;imputed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;imputed&quot;</span>],<br>         pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.4</span>, col = col.imputed)<br>  <br>  points(manhat.ord$pos[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>]/xscale, manhat.ord$Neg_logP[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>],<br>         pch=<span class="hljs-number">20</span>, cex=<span class="hljs-number">.3</span>, col = manhat.ord$col[manhat.ord$type==<span class="hljs-string">&quot;typed&quot;</span>])<br>  <br>  axis(<span class="hljs-number">2</span>)<br>  abline(h=<span class="hljs-number">0</span>)<br>  <br>  SigNifSNPs &lt;- <span class="hljs-built_in">as.character</span>(GWAS[GWAS$Neg_logP &gt; Lstringent.thresh &amp; GWAS$type==<span class="hljs-string">&quot;typed&quot;</span>, <span class="hljs-string">&quot;SNP&quot;</span>])<br>  <br>  <span class="hljs-comment">#Add legend</span><br>  legend(<span class="hljs-string">&quot;topright&quot;</span>,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;Bonferroni corrected threshold (p = 5E-8)&quot;</span>, <span class="hljs-string">&quot;Candidate threshold (p = 5E-6)&quot;</span>),<br>         border=<span class="hljs-string">&quot;black&quot;</span>, col=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;gray60&quot;</span>, <span class="hljs-string">&quot;gray60&quot;</span>), pch=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), lwd=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<br>         lty=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>), pt.cex=<span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>), bty=<span class="hljs-string">&quot;o&quot;</span>, cex=<span class="hljs-number">0.6</span>)<br>  <br>  <span class="hljs-comment">#Add chromosome number</span><br>  text(text.pos/xscale, -<span class="hljs-number">.3</span>, seq(<span class="hljs-number">1</span>,<span class="hljs-number">22</span>,by=<span class="hljs-number">1</span>), xpd=<span class="hljs-literal">TRUE</span>, cex=<span class="hljs-number">.8</span>)<br>  <br>  <span class="hljs-comment">#Add bonferroni line</span><br>  abline(h=bonferroni.thresh, untf = <span class="hljs-literal">FALSE</span>, col = <span class="hljs-string">&quot;gray60&quot;</span>)<br>  <br>  <span class="hljs-comment">#Add &quot;less stringent&quot; line</span><br>  abline(h=Lstringent.thresh, untf = <span class="hljs-literal">FALSE</span>, col = <span class="hljs-string">&quot;gray60&quot;</span>, lty = <span class="hljs-number">2</span> )<br>  <br>  <span class="hljs-comment">#Plotting detected genes</span><br>  <span class="hljs-comment">#Were any genes detected?</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">length</span>(SigNifSNPs)&gt;<span class="hljs-number">0</span>)&#123;<br>    <br>    sig.snps &lt;- manhat.ord[,<span class="hljs-string">&#x27;SNP&#x27;</span>] %in% SigNifSNPs<br>    <br>    points(manhat.ord$pos[sig.snps]/xscale,<br>           manhat.ord$Neg_logP[sig.snps],<br>           pch=<span class="hljs-number">20</span>,col=col.detected, bg=col.detected,cex=<span class="hljs-number">0.5</span>)<br>    <br>    text(manhat.ord$pos[sig.snps]/xscale,<br>         manhat.ord$Neg_logP[sig.snps],<br>         <span class="hljs-built_in">as.character</span>(manhat.ord[sig.snps,<span class="hljs-number">1</span>]), col=col.text, offset=<span class="hljs-number">1</span>, adj=-<span class="hljs-number">.1</span>, cex=<span class="hljs-number">.5</span>)<br>  &#125;<br>&#125;<br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))<br><br><span class="hljs-comment">#-step10a-</span><br><span class="hljs-comment">#create manhattan plot</span><br>GWAS_Manhattan(GWAScomb)<br></code></pre></td></tr></table></figure><p><img src="manhattan_plot.png" alt="manhattan_plot"></p><h5 id="Q–Q-plots-and-the-λ‐statistic-QQ图和λ统计量"><a href="#Q–Q-plots-and-the-λ‐statistic-QQ图和λ统计量" class="headerlink" title="Q–Q plots and the λ‐statistic QQ图和λ统计量"></a>Q–Q plots and the <em>λ</em>‐statistic QQ图和λ统计量</h5><p>Q-Q图用于可视化SNP水平测试统计量的预期分布和观察分布之间的关系。在考虑了建模框架中人口亚结构的潜在混杂因素后，分布的尾部被拉近到y=x线。如果该图中的数据从y = x线上移或下移，那么我们将考虑可能的系统性偏差。最后，右上角尾部与y = x线的轻微偏差粗略地表明，数据中存在着某种形式的关联。</p><p>偏离这条路线的程度由λ统计量来正式衡量，其中接近1的数值表明对潜在的子结构进行了适当的调整。虽然在对PC进行调整后，λ得到了改善（从λ=1.014到λ=1.0032），但由于这个PennCATH样本来自一个相对同质的人群，所以没有观察到数值上的巨大差异。一般来说，目标是使λ值接近于1；λ&gt;1.2表明有分层，通常在这种情况下会包括额外的PC，在某些情况下，该研究会被排除在随后的荟萃分析中。计算一个考虑到样本量的标准化λ，在不同研究的数值对比中特别有用，以便纳入荟萃分析。我们应用以下代码为未调整和调整模型生成标准化的λ，结果是未调整和调整模型的λ分别为1.0108和1.000632。对于二元性状，可以应用标准化方法。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10b-</span><br><span class="hljs-comment">#return the GWAS using unadjusted model</span><br>phenoSub2 &lt;- phenoSub[,<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;phenotype&quot;</span>)] <span class="hljs-comment">#remove all extra fators, leave only phenotype</span><br><br>GWAA(genodata = genotype, phenodata = phenoSub2, filename = gwaa.unadj.fname)<br>GWASoutUnadj &lt;- read.table(gwaa.unadj.fname, head=<span class="hljs-literal">TRUE</span>, colClasses = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;character&quot;</span>,<span class="hljs-built_in">rep</span>(<span class="hljs-string">&quot;numeric&quot;</span>,<span class="hljs-number">4</span>)))<br><br><span class="hljs-comment">#create QQ plots for adjusted and unadjusted model outputs</span><br>par(mfrow=<span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))<br>lambdaAdj &lt;- estlambda(GWASout$t.value^<span class="hljs-number">2</span>, plot = <span class="hljs-literal">TRUE</span>, method = <span class="hljs-string">&quot;median&quot;</span>)<br>lambdaUnadj &lt;- estlambda(GWASoutUnadj$t.value^<span class="hljs-number">2</span>, plot = <span class="hljs-literal">TRUE</span>, method = <span class="hljs-string">&quot;median&quot;</span>)<br>cat(sprintf(<span class="hljs-string">&quot;Unadjusted lambda: %s\nAdjusted lambda: %s\n&quot;</span>, lambdaUnadj$estimate, lambdaAdj$estimate))<br><span class="hljs-comment">## Unadjusted lambda: 1.01417377078806</span><br><span class="hljs-comment">## Adjusted lambda: 1.00056081659278</span><br><br><span class="hljs-comment">#-step10c-</span><br><span class="hljs-comment">#calculate standardized lambda</span><br>lambdaAdj_1000 &lt;- 1+(lambdaAdj$estimate-<span class="hljs-number">1</span>)/nrow(phenoSub)*<span class="hljs-number">1000</span><br>lambdaUnadj_1000 &lt;- 1+(lambdaUnadj$estimate-<span class="hljs-number">1</span>)/nrow(phenoSub)*<span class="hljs-number">1000</span><br>cat(sprintf(<span class="hljs-string">&quot;standardized unadjusted lambda: %s\nstandard adjusted lambda: %s\n&quot;</span>, lambdaUnadj_1000, lambdaAdj_1000))<br><span class="hljs-comment">## standardized unadjusted lambda: 1.0108279379588</span><br><span class="hljs-comment">## standard adjusted lambda: 1.0004284313161</span><br></code></pre></td></tr></table></figure><p><img src="qqplot.png" alt="qqplot"></p><h5 id="Heatmaps-and-regional-association-plots-热图和区域关联图"><a href="#Heatmaps-and-regional-association-plots-热图和区域关联图" class="headerlink" title="Heatmaps and regional association plots 热图和区域关联图"></a>Heatmaps and regional association plots 热图和区域关联图</h5><p>热图和区域关联图通常在GWA分析的背景下使用，以可视化GWA显著SNPs和附近区域SNPs之间的LD模式，LD通常用 $r^2$ 或 $D′$ 来衡量，它们都是标量D的转化，定义为两个主要等位基因的联合概率与两个边际概率的乘积之间的差异，其中调整是基于等位基因频率。</p><p>阴影的程度表示LD的数量，因此较深的方块表示较高的LD。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#-step10d-</span><br>install.packages(<span class="hljs-string">&quot;LDheatmap&quot;</span>)<br>BiocManager::install(<span class="hljs-string">&quot;rtracklayer&quot;</span>)<br><br><span class="hljs-comment">#add &quot;rs247671&quot; to CETP</span><br>CETP &lt;- rbind.fill(GWASout[GWASout$SNP == <span class="hljs-string">&quot;rs247617&quot;</span>,],CETP)<br><br><span class="hljs-comment">#combine genotype and imputed genotypes for CETP region</span><br>subgen &lt;- cbind(genotype[,colnames(genotype) %in% CETP$SNP], impCETPgeno) <span class="hljs-comment">#CETP subsets from typed and imputed SNPs</span><br><br><span class="hljs-comment">#subset SNPs for only certain genptypes</span><br>certain &lt;- apply(as(subgen,<span class="hljs-string">&#x27;numeric&#x27;</span>), <span class="hljs-number">2</span>, <span class="hljs-keyword">function</span>(x) &#123;<span class="hljs-built_in">all</span>(x %in% <span class="hljs-built_in">c</span>(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-literal">NA</span>))&#125;)<br>subgen &lt;- subgen[,certain]<br><br><span class="hljs-comment">#subset and order CETP SNPs by position</span><br>CETP &lt;- CETP[CETP$SNP %in% colnames(subgen),]<br>CETP &lt;- arrange(CETP, position)<br>subgen &lt;- subgen[, order(match(colnames(subgen),CETP$SNP)) ]<br><br><span class="hljs-comment"># Create LDheatmap</span><br>ld &lt;- ld(subgen, subgen, stats=<span class="hljs-string">&quot;R.squared&quot;</span>) <span class="hljs-comment"># Find LD map of CETP SNPs</span><br><br>ll &lt;- LDheatmap(ld, CETP$position, flip=<span class="hljs-literal">TRUE</span>, name=<span class="hljs-string">&quot;myLDgrob&quot;</span>, title=<span class="hljs-literal">NULL</span>)<br><br><span class="hljs-comment"># Add genes, recombination</span><br>llplusgenes &lt;- LDheatmap.addGenes(ll, chr = <span class="hljs-string">&quot;chr16&quot;</span>, genome = <span class="hljs-string">&quot;hg19&quot;</span>, genesLocation = <span class="hljs-number">0.01</span>)<br><br><span class="hljs-comment"># Add plot of -log(p)</span><br>library(ggplot2)<br>library(grid)<br><br>plot.new()<br>llQplot2&lt;-LDheatmap.addGrob(llplusgenes, rectGrob(gp = gpar(col = <span class="hljs-string">&quot;white&quot;</span>)),height = <span class="hljs-number">.34</span>)<br>pushViewport(viewport(x = <span class="hljs-number">0.483</span>, y= <span class="hljs-number">0.76</span>, width = <span class="hljs-number">.91</span> ,height = <span class="hljs-number">.4</span>))<br></code></pre></td></tr></table></figure><p><img src="ldheatmap.png" alt="ldheatmap"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.draw(ggplotGrob(&#123;<br>  qplot(position, Neg_logP, data = CETP, xlab=<span class="hljs-string">&quot;&quot;</span>, ylab = <span class="hljs-string">&quot;Negative Log P-value&quot;</span>, xlim = <span class="hljs-built_in">range</span>(CETP$position),<br>        asp = <span class="hljs-number">1</span>/<span class="hljs-number">10</span>, color = factor(type), colour=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;#000000&quot;</span>, <span class="hljs-string">&quot;#D55E00&quot;</span>)) + <br>    theme(axis.text.x = element_blank(),<br>          axis.title.y = element_text(size = rel(<span class="hljs-number">0.75</span>)), legend.position = <span class="hljs-string">&quot;none&quot;</span>, <br>          panel.background = element_blank(), <br>          axis.line = element_line(colour = <span class="hljs-string">&quot;black&quot;</span>)) +<br>    scale_color_manual(values = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;red&quot;</span>, <span class="hljs-string">&quot;black&quot;</span>))<br>&#125;))<br></code></pre></td></tr></table></figure><p><img src="ldheatmap_new.png" alt="ldheatmap_new"></p><h5 id="使用外部资源的额外数据查询Additional-data-interrogation-using-external-resources"><a href="#使用外部资源的额外数据查询Additional-data-interrogation-using-external-resources" class="headerlink" title="使用外部资源的额外数据查询Additional data interrogation using external resources"></a>使用外部资源的额外数据查询Additional data interrogation using external resources</h5><p>如果能提供研究结果的背景，报告SNP级别的关联分析结果会更有意义。例如，研究者可能想知道一个有统计学意义的SNP是否在一个蛋白质编码基因内、基因间、或接近与被调查疾病相关的特定组织或细胞类型中的调控元素（如甲基化标记）。</p><p>可能相关的外部数据类型见下表。</p><p>这些数据分为八大类，大致按照代表从DNA信息到调节到表达的过程的顺序。</p><ol><li>SNP；</li><li>基因元件；</li><li>染色质状态；</li><li>表观遗传标记；</li><li>转录因子结合；</li><li>RNA表达；</li><li>SNP-mRNA关联；</li><li>其他组学数据。</li></ol><p>我们强调，这个表格并不全面，而是提供了一个可利用的大量外部数据资源的一瞥。与列出的每个类别相关的数据都有广泛的来源。UCSC基因组浏览器提供了一套精心设计的综合生物信息学工具和数据库，包括许多来自补充信息C，表1中所列的资源，可以进一步审视GWA的结果。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># -step10d-</span><br><span class="hljs-comment"># Create regional association plot</span><br><span class="hljs-comment"># Create data.frame of most significant SNP only</span><br>install.packages(<span class="hljs-string">&quot;coin&quot;</span>)<br>install.packages(<span class="hljs-string">&quot;~/postgwas_1.11.tar.gz&quot;</span>, repos = <span class="hljs-literal">NULL</span>, type = <span class="hljs-string">&quot;source&quot;</span>)<br>library(postgwas)<br><br>snps&lt;-data.frame(SNP=<span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>))<br><br><span class="hljs-comment"># Change column names necessary to run regionalplot function</span><br>GWAScomb &lt;- rename(GWAScomb, <span class="hljs-built_in">c</span>(p.value=<span class="hljs-string">&quot;P&quot;</span>, chr=<span class="hljs-string">&quot;CHR&quot;</span>, position=<span class="hljs-string">&quot;BP&quot;</span>))<br><br><br><span class="hljs-comment"># Edit biomartConfigs so regionalplot function</span><br><span class="hljs-comment"># pulls from human genome build 37/hg19</span><br><br>myconfig &lt;- biomartConfigs$hsapiens<br>myconfig$hsapiens$gene$host &lt;- <span class="hljs-string">&quot;grch37.ensembl.org&quot;</span><br>myconfig$hsapiens$gene$mart &lt;- <span class="hljs-string">&quot;ENSEMBL_MART_ENSEMBL&quot;</span><br>myconfig$hsapiens$snp$host &lt;- <span class="hljs-string">&quot;grch37.ensembl.org&quot;</span><br>myconfig$hsapiens$snp$mart &lt;- <span class="hljs-string">&quot;ENSEMBL_MART_SNP&quot;</span><br><br><br><span class="hljs-comment"># Run regionalplot using HAPMAP data (pop = CEU)</span><br>regionalplot(snps, GWAScomb, biomart.config = myconfig, window.size = <span class="hljs-number">400000</span>, draw.snpname = data.frame(<br>  snps = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>, <span class="hljs-string">&quot;rs247617&quot;</span>), <br>  text = <span class="hljs-built_in">c</span>(<span class="hljs-string">&quot;rs1532625&quot;</span>, <span class="hljs-string">&quot;rs247617&quot;</span>),<br>  angle = <span class="hljs-built_in">c</span>(<span class="hljs-number">20</span>, <span class="hljs-number">160</span>),<br>  <span class="hljs-built_in">length</span> = <span class="hljs-built_in">c</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), <br>  cex = <span class="hljs-built_in">c</span>(<span class="hljs-number">0.8</span>)<br>),<br>ld.options = <span class="hljs-built_in">list</span>(<br>  gts.source = <span class="hljs-number">2</span>, <br>  max.snps.per.window = <span class="hljs-number">2000</span>, <br>  rsquare.min = <span class="hljs-number">0.8</span>, <br>  show.rsquare.text = <span class="hljs-literal">FALSE</span><br>),<br>out.format = <span class="hljs-built_in">list</span>(file = <span class="hljs-literal">NULL</span>, panels.per.page = <span class="hljs-number">2</span>))<br><span class="hljs-comment">## Reading GWAS datasets ...</span><br><span class="hljs-comment">## PLINK format detected</span><br><span class="hljs-comment">## Assembling regions...</span><br><span class="hljs-comment">## Initializing biomart connection (SNPs)...</span><br><span class="hljs-comment">## Error in bmRequest(request = request, verbose = verbose) : </span><br><span class="hljs-comment">##   Not Found (HTTP 404).</span><br><span class="hljs-comment"># 尚未解决</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>GWAS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2021/09/16/hello-world/"/>
    <url>/2021/09/16/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序-V3-step2&amp;3</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV3step2&amp;3/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV3step2&amp;3/</url>
    
    <content type="html"><![CDATA[<p><em>整理人：王明慧</em></p><p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV3step2&amp;3.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序-V5-step2:Post GEM-RT Cleanup</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2/</url>
    
    <content type="html"><![CDATA[<h1 id="10×单细胞测序-V5-step2-Post-GEM-RT-Cleanup"><a href="#10×单细胞测序-V5-step2-Post-GEM-RT-Cleanup" class="headerlink" title="10×单细胞测序    V5-step2: Post GEM-RT Cleanup"></a>10×单细胞测序    V5-step2: Post GEM-RT Cleanup</h1><p><em>整理人：刘可钦</em></p><p><strong>pdf版</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step2.pdf" width="100%" height="550" type="application/pdf"></div><br><h2 id="2-0-Post-GEM-RT-Cleanup"><a href="#2-0-Post-GEM-RT-Cleanup" class="headerlink" title="2.0 Post GEM-RT Cleanup"></a>2.0 Post GEM-RT Cleanup</h2><p>【试剂准备】</p><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>Additive A</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220074</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Dynabeads MyOne SILANE</td><td>实验台冰箱上层</td><td>室温放置</td><td>2000048</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>4℃存储</td></tr><tr><td>Buffer Sample Clean Up 1</td><td>-20℃冰箱下部中层试剂盒内</td><td>水浴加热至65℃</td><td>220020</td><td>在65℃水浴锅上温浴十分钟，确认无肉眼可见的结晶物，冷却至室温。</td><td>-20℃存储</td></tr><tr><td>Recovery Agent</td><td>实验台</td><td>室温放置</td><td>220016</td><td>/</td><td>室温存储</td></tr><tr><td>Qiagen Bugger EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>Bio-Rad 10% Tween 20</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配。</td><td>室温存储</td></tr></tbody></table><h2 id="2-1-Post-GEM-RT-Cleanup-Dynabeads"><a href="#2-1-Post-GEM-RT-Cleanup-Dynabeads" class="headerlink" title="2.1 Post GEM-RT Cleanup-Dynabeads"></a>2.1 Post GEM-RT Cleanup-Dynabeads</h2><ol><li><p>在室温下向每个样本中加入 125μl Recovery Agent，然后静置等待 2min。 </p><blockquote><p><strong>需要</strong>：用移液枪头沿管壁旋转并缓慢滴加。</p><p><strong>避免</strong>：震荡混匀或吹打混匀。</p><p><strong>正确操作后的样品外观</strong>：![截屏2021-09-01 下午12.56.24](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午12.56.24.png)</p><p><em>此时中可开始制备Dynabeads Cleanup Mix。</em></p></blockquote></li><li><p>用移液枪从底部缓慢吸除 125μl Recovery Agent。</p><blockquote><p><strong>注意</strong>：出现分层现象，上层为水状液体，下层为油状液体。</p><p><strong>需要</strong>：将移液枪枪头伸入PCR管底部。</p><p><strong>避免</strong>：吸入上层水状液体；使样品从PCR管内溢出。</p><p><strong>正确操作后的样品外观</strong>：![截屏2021-09-01 下午1.09.52](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午1.09.52.png)</p></blockquote></li><li><p>配置 Dynabeads Cleanup Mix</p><blockquote><table><thead><tr><th></th><th>Nuclease-free water</th><th>Buffer Sample Clean Up 1</th><th>Dynabeads MyOne SILANE</th><th>Additive A</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220020</td><td>2000048</td><td>220074</td><td>/</td></tr><tr><td>1x(μl)</td><td>5</td><td>182</td><td>8</td><td>5</td><td>200</td></tr><tr><td>2x(μl)</td><td>11</td><td>400.4</td><td>17.6</td><td>11</td><td>440</td></tr><tr><td>3x(μl)</td><td>16.5</td><td>600.6</td><td>16.4</td><td>16.5</td><td>660</td></tr><tr><td>4x(μl)</td><td>22</td><td>801</td><td>35</td><td>22</td><td>880</td></tr><tr><td>5x(μl)</td><td>27.5</td><td>1001</td><td>44</td><td>27.5</td><td>1100</td></tr><tr><td>6x(μl)</td><td>33</td><td>1201.2</td><td>52.8</td><td>33</td><td>1320</td></tr><tr><td>7x(μl)</td><td>38.5</td><td>1401.4</td><td>61.6</td><td>38.5</td><td>1540</td></tr><tr><td>8x(μl)</td><td>44</td><td>1602</td><td>70</td><td>44</td><td>1760</td></tr><tr><td>9x(μl)</td><td>49.5</td><td>1801.8</td><td>79.2</td><td>49.5</td><td>1980</td></tr><tr><td>10x(μl)</td><td>55</td><td>2002</td><td>88</td><td>55</td><td>2200</td></tr><tr><td>11x(μl)</td><td>60.5</td><td>2</td><td>96.8</td><td>60.5</td><td>1420</td></tr><tr><td>12x(μl)</td><td>66</td><td>2402.4</td><td>105.6</td><td>66</td><td>1640</td></tr></tbody></table></blockquote></li><li><p>将 Dynabeads Cleanup Mix 涡旋震荡，向每管样品中加入 200μl，用 200μl 移液枪吹打混匀 5 次。</p></li><li><p>在室温下静置 10min。</p><blockquote><p><strong>正确操作后的样品外观</strong>：![截屏2021-09-01 下午2.37.35](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-09-01 下午2.37.35.png)</p><p><em>此时可以开始制备Elution Solution I，并准备 80% 乙醇加样槽。可将适量 80% 乙醇倒入加样槽中，暂时不用时应将加样槽放在塑料袋中防止污染。</em></p></blockquote></li><li><p>配置 Elution Solution I。</p><blockquote><table><thead><tr><th></th><th>Buffer EB</th><th>10% Tween 20</th><th>Additive A</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>/</td><td>220074</td><td>/</td></tr><tr><td>1x(μl)</td><td>98</td><td>1</td><td>1</td><td>100</td></tr><tr><td>2x(μl)</td><td>196</td><td>2</td><td>2</td><td>200</td></tr><tr><td>3x(μl)</td><td>294</td><td>3</td><td>3</td><td>300</td></tr><tr><td>4x(μl)</td><td>392</td><td>4</td><td>4</td><td>400</td></tr><tr><td>5x(μl)</td><td>490</td><td>5</td><td>5</td><td>500</td></tr><tr><td>6x(μl)</td><td>588</td><td>6</td><td>6</td><td>600</td></tr><tr><td>7x(μl)</td><td>686</td><td>7</td><td>7</td><td>700</td></tr><tr><td>8x(μl)</td><td>784</td><td>8</td><td>8</td><td>800</td></tr><tr><td>9x(μl)</td><td>882</td><td>9</td><td>9</td><td>900</td></tr><tr><td>10x(μl)</td><td>980</td><td>10</td><td>10</td><td>1000</td></tr><tr><td>11x(μl)</td><td>1078</td><td>11</td><td>11</td><td>1100</td></tr><tr><td>12x(μl)</td><td>1176</td><td>12</td><td>12</td><td>1200</td></tr></tbody></table></blockquote></li><li><p>样品静置结束后，放置于 10× Magnetic Separator high 上，直到样本澄清。</p><blockquote><p><strong>需要</strong>：在 10× Magnetic Separator 上放置 2min，使 beads 充分吸附在管壁上。</p><p><strong>注意</strong>：PCR管内的水油分层是正常现象。</p></blockquote></li><li><p>将PCR管内的液体移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 300μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，然后敞开管盖，在空气中晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Elution Solution I，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl Elution Solution I。</p></li><li><p>移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>室温下静置 1min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 35μl 澄清液体，转移至新管。</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序	V5-step3:DNA Amplification &amp; QC</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3/</url>
    
    <content type="html"><![CDATA[<h1 id="10×单细胞测序-V5-step3-DNA-Amplification-amp-QC"><a href="#10×单细胞测序-V5-step3-DNA-Amplification-amp-QC" class="headerlink" title="10×单细胞测序    V5-step3:DNA Amplification &amp; QC"></a>10×单细胞测序    V5-step3:DNA Amplification &amp; QC</h1><p><em>整理人：刘可钦</em></p><p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step3.pdf" width="100%" height="550" type="application/pdf"></div><br><h2 id="3-0-cDNA-Amplification-amp-QC"><a href="#3-0-cDNA-Amplification-amp-QC" class="headerlink" title="3.0 cDNA Amplification &amp; QC"></a>3.0 cDNA Amplification &amp; QC</h2><p>【试剂准备】</p><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>cDNA Additive</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220067</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>cDNA Primer Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td></td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Beckman Coulter SPRIselect Reagent</td><td>实验台</td><td>室温放置</td><td>/</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>室温存储</td></tr><tr><td>Amplification Master Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220125</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Equalbit dsDNA HS Assay Kit</td><td>实验台冰箱上层</td><td>室温放置</td><td>/</td><td>现用现配</td><td>4℃存储</td></tr><tr><td>Qiagen Bugger EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配。</td><td>室温存储</td></tr></tbody></table><p><strong>注意，标注测量浓度的试剂盒</strong></p><h2 id="3-1-cDNA-Amplification"><a href="#3-1-cDNA-Amplification" class="headerlink" title="3.1 cDNA Amplification"></a>3.1 cDNA Amplification</h2><ol><li><p>在冰上配置 cDNA Amplification mix，将 mix 涡旋震荡并快速离心。</p><blockquote><table><thead><tr><th></th><th>Nuclease-free water</th><th>Amplification Master Mix</th><th>cDNA Additive</th><th>cDNA Primer Mix</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220125</td><td>220067</td><td>220106</td><td>/</td></tr><tr><td>1x(μl)</td><td>8</td><td>50</td><td>5</td><td>2</td><td>65</td></tr><tr><td>2x(μl)</td><td>17.6</td><td>110</td><td>11</td><td>4.4</td><td>143</td></tr><tr><td>3x(μl)</td><td>26.4</td><td>165</td><td>16.5</td><td>6.6</td><td>214.5</td></tr><tr><td>4x(μl)</td><td>35</td><td>220</td><td>22</td><td>9</td><td>286</td></tr><tr><td>5x(μl)</td><td>44</td><td>275</td><td>27.5</td><td>11</td><td>357.5</td></tr><tr><td>6x(μl)</td><td>52.8</td><td>330</td><td>33</td><td>13.2</td><td>429</td></tr><tr><td>7x(μl)</td><td>58.8</td><td>385</td><td>38.5</td><td>14.7</td><td>497</td></tr><tr><td>8x(μl)</td><td>70</td><td>440</td><td>44</td><td>18</td><td>572</td></tr><tr><td>9x(μl)</td><td>75.6</td><td>495</td><td>49.5</td><td>18.9</td><td>643.5</td></tr><tr><td>10x(μl)</td><td>88</td><td>550</td><td>55</td><td>22</td><td>715</td></tr><tr><td>11x(μl)</td><td>96.8</td><td>605</td><td>60.5</td><td>24.2</td><td>786.5</td></tr><tr><td>12x(μl)</td><td>105.6</td><td>660</td><td>66</td><td>26.4</td><td>858</td></tr></tbody></table></blockquote></li><li><p>向每管样品（35μl）中加入 65μl 的 cDNA Amplification mix。</p></li><li><p>将移液枪量程调至 90μl，吹打混匀 5 次；然后快速离心。</p></li><li><p>在 PCR仪 上选择【10x5amp】程序，将样品放入 PCR仪，然后开始程序。</p><blockquote><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>105℃</td><td>100μl</td><td>25-50min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>1</td><td>98℃</td><td>00:00:40</td></tr><tr><td>2</td><td>98℃</td><td>00:00:20</td></tr><tr><td>3</td><td>67℃</td><td>00:00:30</td></tr><tr><td>4</td><td>72℃</td><td>00:01:00</td></tr><tr><td>5</td><td>go to step2, see table below for total # of cycles</td><td>/</td></tr><tr><td>6</td><td>72℃</td><td>00:01:00</td></tr><tr><td>7</td><td>4℃</td><td>hold</td></tr></tbody></table><p><strong>附注</strong>：【cycle数的选择】</p><table><thead><tr><th>Targeted Cell Recovery</th><th>Primary Cells Total Cycles</th><th>Cell Lines Total Cycles</th></tr></thead><tbody><tr><td>100-500</td><td>18</td><td>16</td></tr><tr><td>501-2000</td><td>16</td><td>14</td></tr><tr><td>2001-6000</td><td>14</td><td>12</td></tr><tr><td>6001-10000</td><td>13</td><td>11</td></tr></tbody></table><blockquote><p><strong>注意</strong>：tageted cell 一般为 PBMC，故 cycle 数一般设置为 14 ，即总 PCR 反应时长约为 34min。</p></blockquote><p>本步骤结束后可将样本储存于 4℃ 冰箱中，保存 72h，以待进行下一步实验。</p></blockquote></li></ol><h2 id="3-2-cDNA-Cleanup-SPRIselect"><a href="#3-2-cDNA-Cleanup-SPRIselect" class="headerlink" title="3.2 cDNA Cleanup-SPRIselect"></a>3.2 cDNA Cleanup-SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent &gt; 30s，使管内无块状沉淀，然后吸取 60μl SPRIselect Reagent(0.6x)，加入样本。再将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>样本在室温下静置 5min。</p><blockquote><p><em>此时可以开始准备 80% 乙醇加样槽。可将适量 80% 乙醇倒入加样槽中，暂时不用时应将加样槽放在塑料袋中防止污染。</em></p></blockquote></li><li><p>放在 10× Magnetic Separator high 上，直到样本澄清。</p><blockquote><p><strong>需要</strong>：在 10× Magnetic Separator high 上放置 2min，使 beads 充分吸附在管壁上。</p></blockquote></li><li><p>移除上清。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li></ol><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote><ol start="7"><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，然后敞开管盖，在空气中晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Elution Solution I，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 45.5μl Buffer EB。</p></li><li><p>移液枪量程调制 45μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>室温下静置 2min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品PCR管放在 10× Magnetic Separator high 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 45μl 澄清液体，转移至新管。</p></li><li><p>此后可将样本在 4℃ 冰箱中储存 72h，或在 -20℃ 冰箱中储存 7d，然后进行下一步操作。</p></li></ol><h2 id="3-3-cDNA-QC-amp-Quantification"><a href="#3-3-cDNA-QC-amp-Quantification" class="headerlink" title="3.3 cDNA QC &amp; Quantification"></a>3.3 cDNA QC &amp; Quantification</h2><p>【使用 Equalbit dsDNA HS Assay Kit 对样品进行浓度测定】</p><ol><li><p>按照 Equalbit Reagent 和 Equalbit Buffer 1:200 的比例配置工作液。</p></li><li><p>配置标准品：准备好标有“1”和“2”的 0.6ml EP 管，每管加入 190μl 工作液，然后分别吸取 10μl Equalbit Standard # 1 和 Equalbit Standard # 2，加入管中。</p></li><li><p>配置样品：准备好标有样品标签的 0.6ml EP 管，每管加入 199μl 工作液，然后分别吸取 1μl 样品溶液，加入管中。</p></li><li><p>将按照以上步骤配置的标准品和样品涡旋震荡，然后避光反应 2min。</p></li><li><p>通过 Qubit 荧光仪检测浓度。</p><blockquote><p><em>将每个样品的浓度记录在试验台的实验记录本上，作为 V5 step 6 的参考。</em> </p></blockquote></li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序-V5-step4&amp;5</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step4&amp;5/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step4&amp;5/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step4&amp;5.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10×单细胞测序 V5-step6:5‘ Gene Expression（GEX）Library Construction</title>
    <link href="/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6/"/>
    <url>/2021/09/03/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210903%E5%8D%95%E7%BB%86%E8%83%9E%E6%B5%8B%E5%BA%8FV5step6.pdf" width="100%" height="550" type="application/pdf"></div><br><h1 id="10×单细胞测序-V5-step6-5‘-Gene-Expression（GEX）Library-Construction"><a href="#10×单细胞测序-V5-step6-5‘-Gene-Expression（GEX）Library-Construction" class="headerlink" title="10×单细胞测序    V5-step6:5‘ Gene Expression（GEX）Library Construction"></a>10×单细胞测序    V5-step6:5‘ Gene Expression（GEX）Library Construction</h1><p><em>整理人：刘可钦</em></p><h2 id="6-0-5‘-Gene-Expression（GEX）Library-Construction"><a href="#6-0-5‘-Gene-Expression（GEX）Library-Construction" class="headerlink" title="6.0 5‘ Gene Expression（GEX）Library Construction"></a>6.0 5‘ Gene Expression（GEX）Library Construction</h2><p>【试剂准备】</p><table><thead><tr><th>试剂</th><th>试剂存储位置</th><th>试剂取用期间存储标准</th><th>试剂编号</th><th>试剂取用期间操作标准</th><th>试剂长期储存标准</th></tr></thead><tbody><tr><td>Fragmentation Bufffer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220108</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>Adaptor Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220026</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Ligation Buffer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220109</td><td>解冻，涡旋震荡，确认无沉淀，快速离心</td><td>-20℃存储</td></tr><tr><td>SI-PCR Primer</td><td>-20℃冰箱下部中层试剂盒内</td><td>室温放置</td><td>220111</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Chromium i7 Sample Index Plate</td><td>实验台冰箱下层</td><td>室温放置</td><td>220103</td><td>解冻</td><td>-20℃存储</td></tr><tr><td>Equalbit dsDNA HS Assay Kit</td><td>实验台冰箱上层</td><td>室温放置</td><td>/</td><td>现用现配</td><td>4℃存储</td></tr><tr><td>Beckman Coulter SPRIselect Reagent</td><td>实验台</td><td>室温放置</td><td>/</td><td>在用于配置混匀液前涡旋震荡≥30秒，如仍有块状物，应使用移液枪吹打混匀；使用前不可离心。</td><td>室温存储</td></tr><tr><td>Fragmentation Enzyme Blend</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220107 /220130</td><td>快速离心</td><td>-20℃存储</td></tr><tr><td>DNA Ligase</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220110 /220131</td><td>快速离心</td><td>-20℃存储</td></tr><tr><td>Amplification Master Mix</td><td>-20℃冰箱下部中层试剂盒内</td><td>冰盒放置</td><td>220125</td><td>涡旋震荡，快速离心</td><td>-20℃存储</td></tr><tr><td>Qiagen Buffer EB</td><td>实验台</td><td>室温放置</td><td>/</td><td>/</td><td>室温存储</td></tr><tr><td>10× Magnetic Separator</td><td>实验台</td><td>室温放置</td><td>230003</td><td>/</td><td>室温存储</td></tr><tr><td>Prepare 80% Ethanol Prepare 15ml for 8 reactions</td><td>实验台</td><td>室温放置</td><td>/</td><td>现用现配</td><td>室温存储</td></tr></tbody></table><h2 id="6-1-GEX-Fragmentation-End-Repair-amp-A-tailing"><a href="#6-1-GEX-Fragmentation-End-Repair-amp-A-tailing" class="headerlink" title="6.1 GEX Fragmentation, End Repair &amp; A-tailing"></a>6.1 GEX Fragmentation, End Repair &amp; A-tailing</h2><ol><li><p>将样品和写好标签的新PCR管放置在冰上。根据【3.3】测量得到的样品浓度，计算相应样品体积，使吸取的样品达到 50ng，然后将吸取的样品转移到新管内，并用 nuclease-free water 将其补足至 20μl。</p><p> 如果样品不足 50ng，则吸取 20μl 样品用于 library construction。</p><blockquote><p>此时可将 PCR仪 开始预冷。</p></blockquote></li><li><p>按照如下程序设置 PCR仪。</p><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>65℃</td><td>50μl</td><td>~35min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>Pre-cool block</td><td>4℃</td><td>Hold</td></tr><tr><td>Fragmentation</td><td>32℃</td><td>00:05:00</td></tr><tr><td>End Repair &amp; A-tailing</td><td>65℃</td><td>00:30:00</td></tr><tr><td>Hold</td><td>4℃</td><td>Hold</td></tr></tbody></table><blockquote><p>此程序名为【10xPRA】</p></blockquote></li><li><p>涡旋震荡 Fragmentation Bufffer，确认无沉淀。</p></li><li><p>在冰上配置 Fragmentation Mix，用移液枪吹打混匀，并快速离心。</p><table><thead><tr><th></th><th>Nuclease-free Water</th><th>Fragmentation Bufffer</th><th>Fragmentation Enzyme Blend</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220108</td><td>220107 / 220130</td><td>/</td></tr><tr><td>1x(μl)</td><td>15</td><td>5</td><td>10</td><td>30</td></tr><tr><td>2x(μl)</td><td>33</td><td>11</td><td>22</td><td>66</td></tr><tr><td>3x(μl)</td><td>49.5</td><td>16.5</td><td>33</td><td>99</td></tr><tr><td>4x(μl)</td><td>66</td><td>22</td><td>44</td><td>132</td></tr><tr><td>5x(μl)</td><td>82.5</td><td>27.5</td><td>55</td><td>165</td></tr><tr><td>6x(μl)</td><td>99</td><td>33</td><td>66</td><td>198</td></tr><tr><td>7x(μl)</td><td>110.25</td><td>36.75</td><td>73.5</td><td>231</td></tr><tr><td>8x(μl)</td><td>126</td><td>42</td><td>84</td><td>264</td></tr><tr><td>9x(μl)</td><td>141.75</td><td>47.25</td><td>94.5</td><td>297</td></tr><tr><td>10x(μl)</td><td>165</td><td>55</td><td>110</td><td>330</td></tr><tr><td>11x(μl)</td><td>181.5</td><td>60.5</td><td>121</td><td>363</td></tr><tr><td>12x(μl)</td><td>198</td><td>66</td><td>132</td><td>396</td></tr></tbody></table></li><li><p>向每个 20μl 的样本中加入 30μl Fragmentation Mix。</p></li><li><p>将移液枪的量程调至 30μl，然后吹打混匀 15 次，快速离心。</p></li><li><p>将样本放入预冷的 PCR仪 中（4℃），然后按下“skip”开始 PCR 程序。</p></li></ol><h2 id="6-2-GEX-Post-Fragmentation-End-Repair-amp-A-tailing-Double-Sided-Size-Selection-SPRIselect"><a href="#6-2-GEX-Post-Fragmentation-End-Repair-amp-A-tailing-Double-Sided-Size-Selection-SPRIselect" class="headerlink" title="6.2 GEX Post Fragmentation, End Repair &amp; A-tailing Double Sided Size Selection - SPRIselect"></a>6.2 GEX Post Fragmentation, End Repair &amp; A-tailing Double Sided Size Selection - SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 30μl 0.6x SPRIselect Reagent，然后将移液枪量程调至 75μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>从每管中吸取 75μl 澄清液体，转移至新管。</p></li><li><p>向每管样品加入 10μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 75μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 125μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 125μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p><blockquote><p><strong>需要</strong>：在快速离心时，贴在样品PCR管内的 beads 应朝向离心机外侧。</p></blockquote></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，但不要使 beads 过干。</p><blockquote><p><strong>需要</strong>：（若样品量较多）应立刻加入50.5μl Buffer EB，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 50.5μl Buffer EB。移液枪量程调制 50μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator high 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 50μl 澄清液体，转移至新管。</p></li></ol><h2 id="6-3-GEX-Adaptor-Ligation"><a href="#6-3-GEX-Adaptor-Ligation" class="headerlink" title="6.3 GEX Adaptor Ligation"></a>6.3 GEX Adaptor Ligation</h2><ol><li><p>配置 Adaptor Ligation Mix，用移液枪吹打混匀，并快速离心。</p><table><thead><tr><th></th><th>Nuclease-free Water</th><th>Ligation Buffer</th><th>DNA ligase</th><th>Adaptor Mix</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220109</td><td>220110 / 220131</td><td>220026</td><td>/</td></tr><tr><td>1x(μl)</td><td>17.5</td><td>20</td><td>10</td><td>2.5</td><td>50</td></tr><tr><td>2x(μl)</td><td>38.5</td><td>44</td><td>22</td><td>5.5</td><td>110</td></tr><tr><td>3x(μl)</td><td>58</td><td>66</td><td>33</td><td>8</td><td>165</td></tr><tr><td>4x(μl)</td><td>77</td><td>88</td><td>44</td><td>11</td><td>220</td></tr><tr><td>5x(μl)</td><td>96.25</td><td>110</td><td>55</td><td>13.75</td><td>275</td></tr><tr><td>6x(μl)</td><td>116</td><td>132</td><td>66</td><td>16</td><td>330</td></tr><tr><td>7x(μl)</td><td>134.75</td><td>154</td><td>77</td><td>19.25</td><td>385</td></tr><tr><td>8x(μl)</td><td>154</td><td>176</td><td>88</td><td>22</td><td>440</td></tr><tr><td>9x(μl)</td><td>173.25</td><td>198</td><td>99</td><td>24.75</td><td>495</td></tr><tr><td>10x(μl)</td><td>192.5</td><td>220</td><td>110</td><td>27.5</td><td>550</td></tr><tr><td>11x(μl)</td><td>211.75</td><td>242</td><td>121</td><td>30.25</td><td>605</td></tr><tr><td>12x(μl)</td><td>224.4</td><td>264</td><td>132</td><td>33</td><td>660</td></tr></tbody></table><ol start="2"><li><p>向每个 50μl 的样本中加入 50μl Adaptor Ligation Mix，将移液枪量程调至 90μl，然后吹打混匀 15次，快速离心。</p></li><li><p>按照如下程序设置 PCR仪。</p><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>30℃</td><td>100μl</td><td>15min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>1</td><td>20℃</td><td>00:15:00</td></tr><tr><td>2</td><td>4℃</td><td>Hold</td></tr></tbody></table><blockquote><p>此程序名为【ada】</p></blockquote></li></ol></li></ol><h2 id="6-4-GEX-Post-Ligation-Cleanup-SPRIselect"><a href="#6-4-GEX-Post-Ligation-Cleanup-SPRIselect" class="headerlink" title="6.4 GEX Post Ligation Cleanup -SPRIselect"></a>6.4 GEX Post Ligation Cleanup -SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 80μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的PCR管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p><blockquote><p><strong>注意</strong>：样品量较多时，可使用排枪。</p></blockquote></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，晾干 2min。</p><blockquote><p><strong>需要</strong>：（若样品量较多）在秒表计时超过 1min后，应立刻加入35.5μl Buffer EB，防止 beads 过干。</p></blockquote></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl Buffer EB。移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 30μl 澄清液体，转移至新管。</p></li></ol><h2 id="6-5-GEX-Sample-Index-PCR"><a href="#6-5-GEX-Sample-Index-PCR" class="headerlink" title="6.5 GEX Sample Index PCR"></a>6.5 GEX Sample Index PCR</h2><ol><li><p>为每个样本选择唯一一个确定的 sample index，不能出现同一个样本加入了两个不同的 sample index 的情况。</p></li><li><p>记录样本与 sample index 之间的对应情况。</p><blockquote><p><em>记录在实验台的实验记录本上，同时将样本与sample index之间的对应记录抄写在纸上，之后随样本一起放在塑封袋中。</em></p></blockquote></li><li><p>制备 Sample Index PCR Mix，吹打混匀并快速离心。</p><table><thead><tr><th></th><th>Nuclear-free Water</th><th>Amplification Master Mix</th><th>SI-PCR Primer</th><th>总体积</th></tr></thead><tbody><tr><td>试剂编号</td><td>/</td><td>220125</td><td>220111</td><td>/</td></tr><tr><td>1x(μl)</td><td>8</td><td>50</td><td>2</td><td>60</td></tr><tr><td>2x(μl)</td><td>17.6</td><td>110</td><td>9</td><td>264</td></tr><tr><td>3x(μl)</td><td>26.4</td><td>165</td><td>6.6</td><td>198</td></tr><tr><td>4x(μl)</td><td>35</td><td>220</td><td>9</td><td>264</td></tr><tr><td>5x(μl)</td><td>44</td><td>275</td><td>11</td><td>330</td></tr><tr><td>6x(μl)</td><td>52.8</td><td>330</td><td>13.2</td><td>396</td></tr><tr><td>7x(μl)</td><td>61.6</td><td>385</td><td>15.4</td><td>462</td></tr><tr><td>8x(μl)</td><td>70</td><td>440</td><td>18</td><td>528</td></tr><tr><td>9x(μl)</td><td>79.2</td><td>495</td><td>19.8</td><td>594</td></tr><tr><td>10x(μl)</td><td>88</td><td>550</td><td>22</td><td>660</td></tr><tr><td>11x(μl)</td><td>96.8</td><td>605</td><td>24.2</td><td>726</td></tr><tr><td>12x(μl)</td><td>105.6</td><td>660</td><td>26.4</td><td>792</td></tr></tbody></table></li><li><p>向每个 60μl 的样本中加入 30μl Sample Index PCR Mix。</p></li><li><p>向每个样本中加入 10μl 确定且唯一的 Chromium i7 Sample Index，将移液枪量程调至 90μl，然后吹打混匀 5次，快速离心。</p></li><li><p>按照如下程序设置 PCR仪。</p><table><thead><tr><th>热盖温度</th><th>反应容量</th><th>反应时间</th></tr></thead><tbody><tr><td>105℃</td><td>100μl</td><td>~40min</td></tr><tr><td>步骤</td><td>温度</td><td>时间</td></tr><tr><td>1</td><td>98℃</td><td>00:00:45</td></tr><tr><td>2</td><td>98℃</td><td>00:00:20</td></tr><tr><td>3</td><td>54℃</td><td>00:00:30</td></tr><tr><td>4</td><td>72℃</td><td>00:00:20</td></tr><tr><td>5</td><td>Go to step 2, see table below for # cycles</td><td>/</td></tr><tr><td>6</td><td>72℃</td><td>00:01:00</td></tr><tr><td>7</td><td>4℃</td><td>Hold</td></tr></tbody></table><blockquote><p><em>cycle数可按每管样品中含量计算</em></p><table><thead><tr><th>Input into Library Construction</th><th>Total Sample Index Cycles</th></tr></thead><tbody><tr><td>1-25 ng</td><td>16</td></tr><tr><td>26-50 ng</td><td>14</td></tr></tbody></table></blockquote></li><li><p>PCR 完成后，样本可储存在 4℃ 冰箱内 72h，然后进行下一步。</p></li></ol><h2 id="6-6-GEX-Post-Sample-Index-Double-Sided-Size-Selection-SPRIselect"><a href="#6-6-GEX-Post-Sample-Index-Double-Sided-Size-Selection-SPRIselect" class="headerlink" title="6.6 GEX Post Sample Index Double Sided Size Selection - SPRIselect"></a>6.6 GEX Post Sample Index Double Sided Size Selection - SPRIselect</h2><ol><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 60μl 0.6x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p><blockquote><p><em>此时可开始准备新的 PCR 管和新的 0.6ml EP 管，并写好标签。</em></p></blockquote></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>从每管中吸取 150μl 澄清液体，转移至新管。</p></li><li><p>涡旋震荡 SPRIselect Reagent，向每管样品加入 20μl 0.8x SPRIselect Reagent，然后将移液枪量程调至 150μl，吹打混匀 15 次。</p></li><li><p>室温下静置 5min。</p></li><li><p>将样品放置在 10× Magnetic Separator high 上 2 min，直到样本澄清。</p></li><li><p>将PCR管内的上清移除。</p><blockquote><p><strong>避免</strong>：移除 beads 或将 beads 吸入枪头。</p></blockquote></li><li><p>清洗第一遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li><li><p>清洗第二遍：保持样品仍然放置在10× Magnetic Separator high 上，向每个PCR管内加入 200μl 80% 乙醇，等待30s。</p></li><li><p>吸去乙醇。</p></li><li><p>将样品PCR管取出，快速离心，然后放在 10× Magnetic Separator low上。</p></li><li><p>用 200μl 移液枪将样品管内残存的乙醇吸除，但不要使 beads 过干。</p></li><li><p>将样品PCR管从 10× Magnetic Separator low 上取下，立刻向每管内加入 35.5μl EB。移液枪量程调制 30μl，每管样品吹打混匀 15 次，直到管内无块状物残留。</p></li><li><p>在室温下静置 2min。</p></li><li><p>将样品PCR管放在 10× Magnetic Separator low 上 2min，直到管内液体澄清。</p></li><li><p>从每管中吸取 35μl 澄清液体，转移至写好标签的 0.6ml EP 管。</p></li><li><p>样本可在 4℃ 冰箱里储存 72h，或放在 -20℃ 冰箱中长期储存。</p><blockquote><p>若要送测序，则放在实验台冰箱下层 -20℃ 暂存。</p></blockquote></li></ol><h2 id="6-7-GEX-Post-Library-Construction-QC"><a href="#6-7-GEX-Post-Library-Construction-QC" class="headerlink" title="6.7 GEX Post Library Construction QC"></a>6.7 GEX Post Library Construction QC</h2><p>【使用 Equalbit dsDNA HS Assay Kit 对样品进行浓度测定】</p><ol><li>按照 Equalbit Reagent 和 Equalbit Buffer 1:200 的比例配置工作液。</li><li>配置标准品：准备好标有“1”和“2”的 0.6ml EP 管，每管加入 190μl 工作液，然后分别吸取 10μl Equalbit Standard # 1 和 Equalbit Standard # 2，加入管中。</li><li>配置样品：准备好标有样品标签的 0.6ml EP 管，每管加入 199μl 工作液，然后分别吸取 1μl 样品溶液，加入管中。</li><li>将按照以上步骤配置的标准品和样品涡旋震荡，然后避光反应 2min。</li><li>通过 Qubit 荧光仪检测浓度。</li></ol>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SINGLE CELL SEQUENCING</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes</title>
    <link href="/2021/09/03/20210903%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95Transcriptome-wide%20association%20study%20of%20coronary%20artery%20disease%20identifies%20novel%20susceptibility%20genes/"/>
    <url>/2021/09/03/20210903%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E8%AE%B0%E5%BD%95Transcriptome-wide%20association%20study%20of%20coronary%20artery%20disease%20identifies%20novel%20susceptibility%20genes/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-9-3-文献阅读记录：Transcriptome-wide-association-study-of-coronary-artery-disease-identifies-novel-susceptibility-genes"><a href="#2021-9-3-文献阅读记录：Transcriptome-wide-association-study-of-coronary-artery-disease-identifies-novel-susceptibility-genes" class="headerlink" title="2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes"></a>2021.9.3-文献阅读记录：Transcriptome-wide association study of coronary artery disease identifies novel susceptibility genes</h1><p>EpiXcan</p><p>Stockholm-Tartu Atherosclerosis Reverse Network Engineering Task (STARNET) </p><p>Genotype-Tissue Expression (GTEx)</p><p>Transcriptome-wide association studies (TWAS) </p><blockquote><p>【转录组全关联研究】</p><p>用于鉴定CAD（coronary artery disease）风险基因座</p><p>GWAS 已经有力地将成千上万个基因座与复杂性状联系起来。尽管取得了这样的成功，GWAS 基因座却常常难以解释: 连锁不平衡通常模糊了驱动这种联系的因果变异，而且从 GWAS 的数据中很难确定对性状起作用的因果基因。</p><p>而TWAS可以解决上述问题。它利用expression reference panels（具有表达和基因型数据的eQTL队列）从GWAS数据集中发现基因-性状关联。首先，通过使用基因附近（通常在500千字节或1兆字节内）的等位基因变异数，表达参考板被用来学习每个基因的表达变化预测模型。这些模型被用来预测GWAS队列中每个人的基因表达。最后，对预测的基因表达和性状之间的统计关联进行估计。表达预测和关联可与个体水平的GWAS数据（PrediXcan）或与汇总水平的GWAS数据（Fusion和S-PrediXcan）同时进行。密切相关的方法包括SMR/HEIDI，它执行从基因表达到性状的孟德尔随机化（MR），以及GWAS-eQTL colocalization方法，如Sherlock、coloc、QTLMatch、eCaviar、 enloc和RTC，这些方法发现其表达受支撑GWAS命中的相同因果变异所调节的基因。</p></blockquote><p>TWAS的主要流程</p><blockquote><p>以Gong, Weiming, et al. “Integrative Analysis of Transcriptome-Wide Association Study and mRNA Expression Profiles Identifies Candidate Genes Associated With Idiopathic Pulmonary Fibrosis.” <em>Frontiers in genetics</em> 11 (2020).为例，疾病为Idiopathic pulmonary fibrosis (IPF) 。</p><p>需要：不同组织中的基因表达权重（gene expression weights of three tissues）和GWAS数据集（a large-scale genome-wide association study (GWAS) dataset）；涉及2668个IPF病例和8591个control组</p><p>【主要用于鉴定疾病的候选基因】</p><p>使用3个组织的基因表达权重和一个大规模的数据集(GWAS)进行 IPF 的转录组范围关联研究(TWAS) ，共涉及2,668个 IPF 病例和8,591个对照组。然后对 TWAS 鉴定的重要基因进行基因本体(GO)和通路富集分析。在 IPF 全基因组 mRNA 表达谱中，TWAS 重要基因的富集分析和差异表达基因(DEGs)之间的 GO 项和通路也有重叠。对 TWAS 重要基因进行蛋白质-蛋白质相互作用(PPI)网络和聚类模块分析。总的来说，TWAS 在 Bonferroni 校正 p 值阈值(0.05/14929 = 3.35 × 10-6)下鉴定了一组 IPF 候选基因，如 DSP (肺组织 PTWAS = 1.35 × 10-29)、 MUC5B (肺组织 PTWAS = 1.09 × 10-28)和 TOLLIP (全血 PTWAS = 1.41 × 10-15)。通</p><p>【通路富集分析确定多个候选通路】</p><p>通路富集分析确定了多个候选通路，如单纯疱疹病毒感染(p 值为7.93 × 10-5)和抗原加工提呈(p 值为6.55 × 10-5)。通过对 TWAS 显著基因和 DEGs 的富集分析，鉴定出38个共有的 GO 基因和8个 KEGG 通路。在 PPI 网络中，14个基因(DYNLL1、 DYNC1LI1、 DYNLL2、 HLA-DRB5、 HLA-DPB1、 HLA-DQB2、 HLA-DQA2、 HLA-DQB1、 HLA-DQB1、 HLA-DRB1、 POLR2L、 CENPP、 CENPK、 NUP133和 NUP107)同时被 hub 基因和模块分析检测到。</p></blockquote><p>Expression quantitative traits loci (eQTLs) </p><blockquote><p>用于解释GWAS信号</p></blockquote><p>studied tissues：</p><p>mammary artery (MAM)</p><p>liver (LIV)</p><p>blood (BLD)</p><p>subcutaneous fat (SF)</p><p>visceral abdominal fat (VAF)</p><p>skeletal muscle (SKLM)</p><p>coronary (COR)</p><p>tibial (TIB) arteries</p><h2 id="研究步骤"><a href="#研究步骤" class="headerlink" title="研究步骤"></a>研究步骤</h2><p>从CAD relevant tissue中获得predicted model</p><p>cross-validated prediction R2 &gt; 0.01的基因被保留</p><p>基于STARNET建立的模型允许将12995个独特的基因表达信号归咎于7种组织</p><p>基于GTEx建立的模型允许将12964个独特的基因表达信号归咎于8种组织</p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GWAS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.31-B16F1给药配置表(150只小鼠)</title>
    <link href="/2021/08/31/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8/"/>
    <url>/2021/08/31/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-31-B16F1给药配置表-150只小鼠"><a href="#2021-8-31-B16F1给药配置表-150只小鼠" class="headerlink" title="2021.8.31-B16F1给药配置表(150只小鼠)"></a>2021.8.31-B16F1给药配置表(150只小鼠)</h1><p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210830B16F1%E7%BB%99%E8%8D%AF%E9%85%8D%E7%BD%AE%E8%A1%A8.pdf" width="100%" height="550" type="application/pdf"></div><br><h2 id="1-实验设计方案"><a href="#1-实验设计方案" class="headerlink" title="1.实验设计方案"></a>1.实验设计方案</h2><p>多肽混合NH组含有编号为1，3，25的肽段，共3条肽。分为低、中、高三个剂量组，低剂量组5.8ug/肽，中剂量组29ug/肽，高剂量组58ug/肽。</p><p>多肽混合TH组含有编号为1，3，25的肽段，共3条肽。分为低、中、高三个剂量组，低剂量组5.8ug/肽，中剂量组29ug/肽，高剂量组58ug/肽。</p><h2 id="2-多肽和佐剂选择"><a href="#2-多肽和佐剂选择" class="headerlink" title="2.多肽和佐剂选择"></a>2.多肽和佐剂选择</h2><p>多肽：每瓶300ug，300uL生理盐水溶解，母液浓度1ug/uL。 </p><p>佐剂：PolyICLC，每瓶250uL，佐剂浓度2ug/uL。 </p><p>用量：计划每组10只小鼠，每只100uL注射液，每次注射1000ul, 注射7次。 </p><p>按每组照150只小鼠量来配制，即15000 uL </p><h2 id="3-抗原肽配置表"><a href="#3-抗原肽配置表" class="headerlink" title="3.抗原肽配置表"></a>3.抗原肽配置表</h2><p>【多肽用量取整前】</p><table><thead><tr><th>组别</th><th>多肽用量</th><th>佐剂用量</th><th>生理盐水</th><th>总量</th></tr></thead><tbody><tr><td>对照组</td><td>/</td><td>/</td><td>15000 uL</td><td>15000 uL</td></tr><tr><td>溶媒组</td><td>/</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液14.5瓶，共需43.5瓶多肽母液，总计13050 uL</td><td>150ug， 75uL</td><td>1875 uL</td><td>15000 uL</td></tr><tr><td>TH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液2.9瓶， 共需8.7瓶多肽母液，总计2610 uL</td><td>150ug， 75uL</td><td>12315 uL</td><td>15000 uL</td></tr><tr><td>NH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>NH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液14.5瓶，共需43.5瓶多肽母液，总计13050 uL</td><td>150ug， 75uL</td><td>1875 uL</td><td>15000 uL</td></tr><tr><td>NH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液2.9瓶， 共需8.7瓶多肽母液，总计2610 uL</td><td>150ug， 75uL</td><td>12315 uL</td><td>15000 uL</td></tr></tbody></table><p>【多肽用量取整后】</p><table><thead><tr><th>组别</th><th>多肽用量</th><th>佐剂用量</th><th>生理盐水</th><th>总量</th></tr></thead><tbody><tr><td>对照组</td><td>/</td><td>/</td><td>15000 uL</td><td>15000 uL</td></tr><tr><td>溶媒组</td><td>/</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>TH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液15(14.5)瓶，共需45瓶多肽母液，总计13500 uL</td><td>155.17ug， 77.59uL</td><td>1939.65 uL</td><td>15517.24 uL</td></tr><tr><td>TH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液3(2.9)瓶， 共需9瓶多肽母液，总计2700 uL</td><td>155.17ug， 77.59uL</td><td>12739.65 uL</td><td>15517.24 uL</td></tr><tr><td>NH-高剂量组</td><td>8700 ug/肽，3肽，每肽需肽粉29瓶，共需87瓶肽粉，总计26100 ug</td><td>150ug， 75uL</td><td>14925 uL</td><td>15000 uL</td></tr><tr><td>NH-中剂量组</td><td>4350 ug/肽，4350 uL/肽，3肽，每肽需母液15(14.5)瓶，共需45瓶多肽母液，总计13500 uL</td><td>155.17ug， 77.59uL</td><td>1939.65 uL</td><td>15517.24 uL</td></tr><tr><td>NH-低剂量组</td><td>870 ug/肽，870 uL/肽，3肽，每肽需母液3(2.9)瓶， 共需9瓶多肽母液，总计2700 uL</td><td>155.17ug， 77.59uL</td><td>12739.65 uL</td><td>15517.24 uL</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>polypeptide vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析</title>
    <link href="/2021/08/31/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90/"/>
    <url>/2021/08/31/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210831%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BB%81%E7%A7%91%E7%94%9F%E7%89%A9dCODE%20Dextramer%E5%8A%A9%E5%8A%9B10%C3%97Genomics%E8%BF%9B%E8%A1%8CTB%E7%BB%86%E8%83%9E%E6%8A%97%E5%8E%9F%E7%89%B9%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90.pdf" width="100%" height="550" type="application/pdf"></div><br><h1 id="2021-8-31-学习记录：仁科生物dCODE-Dextramer助力10×Genomics进行T-B细胞抗原特异性分析"><a href="#2021-8-31-学习记录：仁科生物dCODE-Dextramer助力10×Genomics进行T-B细胞抗原特异性分析" class="headerlink" title="2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析"></a>2021.8.31-学习记录：仁科生物dCODE Dextramer助力10×Genomics进行T/B细胞抗原特异性分析</h1><p>![截屏2021-08-31 下午2.05.55 (2)](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.05.55 (2).png)</p><p>![截屏2021-08-31 下午2.06.24](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.06.24.png)</p><blockquote><p>MHC I</p><p>结合沟两端闭合，只能结合肽段长度&lt;10个氨基酸</p><p>呈递给CD8+T细胞</p><p>MHC II</p><p>结合沟两端开放，结合肽段长度平均约15个氨基酸</p><p>呈递给CD4+T细胞</p></blockquote><p>![截屏2021-08-31 下午2.08.06](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.08.06.png)</p><p>![截屏2021-08-31 下午2.08.37](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.08.37.png)</p><blockquote><p>TCR和MHC-肽段复合物结合时间很短，因此可以通过增加MHC-肽段复合物数量来提升结合时间</p></blockquote><p>![截屏2021-08-31 下午2.09.11](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.09.11.png)</p><blockquote><p>(左上角) 骨架上带有荧光基团，MHC分子-肽段复合物</p><p>因结合位点较多（10个以上的结合位点），优势：亲和力更大，灵敏度更高。有利于研究低亲和力TCR</p><p>也可进行NGS或流式进行分选。</p></blockquote><p>dextramer上连接bar code序列，从而与10x单细胞技术结合</p><p>![截屏2021-08-31 下午2.13.42](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.13.42.png)</p><blockquote><p>PCR handle：</p><p>feature barcode：用于确定连接的肽段</p><p>capture sequence：用于筛选结合了抗原的细胞</p></blockquote><p>![截屏2021-08-31 下午2.15.28](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.15.28.png)</p><blockquote><p>增加孵育——清洗步骤，筛选出结合的细胞。</p><p>（上清和磁珠可以用于构建出两种文库信息）</p></blockquote><p>【实例】</p><p>![截屏2021-08-31 下午2.17.31](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.17.31.png)</p><blockquote><p>样品：CMV病毒血清学反应为阳性和阴性的PBMC</p><blockquote><p>阳性可与CMV结合，阴性不可与CMV结合</p></blockquote><p>能够在CMV病毒血清学反应为阳性的PBMC中筛选出对CMV病毒有特异性的T细胞，并能看出T细胞的亚群与克隆型。</p><p>但在CMV病毒血清学反应为阴性的PBMC中无法筛选出CMV病毒有特异性的T细胞，但能找到对其他病毒有特异性的T细胞。（提示患者以前感染过相应病毒）</p></blockquote><p>可以获得4种结果：</p><p>4-表面蛋白——获得细胞表面蛋白表达情况</p><p>![截屏2021-08-31 下午2.21.49](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.21.49.png)</p><blockquote><p>与10x转录组结果一起分析，也可以获得中间灰色细胞群（未经注释的细胞）的具体信息。</p></blockquote><p>【要知道哪些信息，才能进行操作？】</p><p>![截屏2021-08-31 下午2.24.39](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.24.39.png)</p><blockquote><p>需要知道样本HLA的分型与病毒肽段的信息</p><p>可购买或定制</p></blockquote><p>【想要保密肽段该怎么办？】</p><blockquote><p>可以自己diy组装，只需要购买相应分型的MHC分子和骨架，然后和肽段一起进行装载</p></blockquote><p>![截屏2021-08-31 下午2.27.23](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.27.23.png)</p><blockquote><p>要和10x产品一起使用，必须选用带有barcode信息的骨架。</p><p>只进行流式分选，则可以使用带有荧光基团的骨架。</p><p>肽段要求：95%以上的纯度</p></blockquote><p>【如果不知道MHC分子的分型，怎么办？】</p><p>![截屏2021-08-31 下午2.29.22](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.29.22.png)</p><blockquote><p>骨架上换成了生物素受体，可以将目标小分子进行生物素化，即可与骨架结合。</p></blockquote><p>![截屏2021-08-31 下午2.30.35](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.30.35.png)</p><blockquote><p>然后通过barcode检测，可以确定与小分子结合的细胞有哪些。</p></blockquote><p>应用：【LIBRA-seq】用于大规模的抗体发现</p><p>![截屏2021-08-31 下午2.31.52](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.31.52.png)</p><p>应用：【Genentech】可以用于较大规模的抗体筛选</p><p>![截屏2021-08-31 下午2.32.47](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.32.47.png)</p><p>【总结】用途：</p><p>![截屏2021-08-31 下午2.33.41](/Users/keqinliu/Library/Application Support/typora-user-images/截屏2021-08-31 下午2.33.41.png)</p>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Antigen specificity analysis</tag>
      
      <tag>dCODE Dextramer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ppp1r15A 临床试验开展情况</title>
    <link href="/2021/08/30/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5/"/>
    <url>/2021/08/30/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210830ppp1r15A%E4%B8%B4%E5%BA%8A%E8%AF%95%E9%AA%8C%E5%BC%80%E5%B1%95%E6%83%85%E5%86%B5.pdf" width="100%" height="550" type="application/pdf"></div><br><h1 id="2-ppp1r15A-临床试验开展情况"><a href="#2-ppp1r15A-临床试验开展情况" class="headerlink" title="2.ppp1r15A 临床试验开展情况"></a>2.ppp1r15A 临床试验开展情况</h1><p>PPP1R15A (蛋白磷酸酶1调控亚基15A)是一种蛋白质编码基因。与 PPP1R15A 相关的疾病包括恶性胸膜间皮瘤和骨骺发育不良，多发性，早发性糖尿病。其相关途径包括 β- 肾上腺素能信号转导和 SMAD2/SMAD3-SMAD4异三聚体的转录活性。与该基因相关的基因本体(GO)注释包括蛋白激酶结合。该基因的一个重要旁系是 PPP1R15B。</p><p>PPP1R15A招募丝氨酸/苏氨酸蛋白磷酸酶PP1，形成PPP1R15A-PP1复合物，该复合物使翻译起始因子eIF-2A/EIF2S1去磷酸化，从而逆转由应激诱导激酶启动的蛋白质合成的关闭，促进细胞从应激中恢复。另外，PPP1R15A通过促进PP1对TGFB1的去磷酸化而下调TGF-beta信号通路，可能通过诱导TP53在 “Ser-15 “上的磷酸化而促进细胞凋亡。</p><p>目前，处于临床研究阶段的PPP1R15A相关药物主要与以上通路相关。Tsaytler等人报道，此前由美国FDC批准的抗高血压药物Guanabenz可通过 GADD34-PP1c 介导的 p-eif2α 的去磷酸化作用，增强综合应激反应(ISR)。ISR是一种细胞保护反应，由各种细胞毒性损伤激活，如活性氮氧化物、谷氨酸兴奋性和内质网压力，所有这些都与多发性硬化的发病机制有关。Way等人报告，用guanabenz治疗小鼠的EAE延迟了疾病的发生并抑制了临床症状：这些效果与少突胶质细胞中p-eIF2α水平的增加和少突胶质细胞的保护有关。这些有希望的结果已成为美国国立卫生研究院进行多发性硬化症临床试验的基础（ClinicalTrials.Gov: NCT02423083）。</p><p>不过，Guanabenz同时具有α2肾上腺素激动剂的功能，这导致Guanabenz可能导致嗜睡、嗜睡等副作用。一种名为 Sephin1的 Guanabenz 衍生物，最近被证明能够保留 GADD34-PP1c 特异性抑制活性，而不会在细胞或体内产生可测量的 α2肾上腺素副作用。Chen等人报告说，Sephin1对慢性自身免疫性脑脊髓炎(EAE)小鼠的治疗显著延迟了疾病的发生，这与少突胶质细胞减少、轴突和髓鞘丢失以及 ISR 延长有关。此外，Sephin 1可以减少炎症性 CD3+t 细胞的数量和中枢神经系统内炎症性细胞因子的产生，而不影响外周免疫反应。</p><p>以上提及的两种药物中，仅有Guanabenz已在开展临床试验，Guanabenz的衍生物Sephin1仍处于动物实验阶段。</p><blockquote><p>Tsaytler, Pavel, et al. “Selective inhibition of a regulatory subunit of protein phosphatase 1 restores proteostasis.” <em>Science</em> 332.6025 (2011): 91-94.</p><p>Mháille, Aoife Ní, et al. “Increased expression of endoplasmic reticulum stress-related signaling pathway molecules in multiple sclerosis lesions.” <em>Journal of Neuropathology &amp; Experimental Neurology</em> 67.3 (2008): 200-211.</p><p>Cunnea, Paula, et al. “Expression profiles of endoplasmic reticulum stress-related molecules in demyelinating lesions and multiple sclerosis.” <em>Multiple Sclerosis Journal</em> 17.7 (2011): 808-818.</p><p>Way, Sharon W., and Brian Popko. “Harnessing the integrated stress response for the treatment of multiple sclerosis.” <em>The Lancet Neurology</em> 15.4 (2016): 434-443.</p><p>Das, Indrajit, et al. “Preventing proteostasis diseases by selective inhibition of a phosphatase regulatory subunit.” <em>Science</em> 348.6231 (2015): 239-242.</p><p>Chen, Yanan, et al. “Sephin1, which prolongs the integrated stress response, is a promising therapeutic for multiple sclerosis.” <em>Brain</em> 142.2 (2019): 344-361.</p></blockquote><p>【简表】</p><table><thead><tr><th>药物</th><th>临床试验编号</th><th>临床试验适应症</th><th>临床试验开展年份</th><th>临床试验开展国家/地区</th><th>临床试验申办机构</th><th>临床试验阶段</th><th>副反应提及</th><th>参考文献</th></tr></thead><tbody><tr><td>Guanabenz</td><td>ClinicalTrials.gov Identifier: NCT02423083</td><td>multiple sclerosis (MS)</td><td>2015.4-2017.10</td><td>美国</td><td>National Institutes of Health Clinical Center (CC) ( National Institute of Neurological Disorders and Stroke (NINDS) )</td><td>Phase 1</td><td>因该药物同时具有作为 α2肾上腺素激动剂的功能，可导致嗜睡，口干，头晕，可能导致患者在服药过量时昏迷。较不常见的副作用包括：虚弱，胸痛，水肿，心悸，焦虑，失去协调性，抑郁，瘙痒，皮疹，男性乳房发育，腹痛，便秘，腹泻，恶心，呕吐，肌肉疼痛，视力模糊，呼吸困难，鼻腔充血</td><td>Tsaytler P, Harding HP, Ron D, Bertolotti A. Selective inhibition of a regulatory subunit of protein phosphatase 1 restores proteostasis. Science 2011; 332: 91–4.                                                                                Holmes B, Brogden RN, Heel RC, Speight TM, Avery GS. Guanabenz. A review of its pharmacodynamic properties and therapeutic efficacy in hypertension. Drugs 1983; 26: 212–29.</td></tr><tr><td>Guanabenz</td><td>ClinicalTrials.gov Identifier: NCT02443103</td><td>Bone Cancer Metastasis</td><td>2015.5-2016.2</td><td>美国</td><td>Kathy Miller, Indiana University School of Medicine</td><td>Not Applicable</td><td>/</td><td>/</td></tr></tbody></table><h2 id="2-1-临床试验年度趋势"><a href="#2-1-临床试验年度趋势" class="headerlink" title="2.1.临床试验年度趋势"></a>2.1.临床试验年度趋势</h2><p>2015.4-2017.10期间，Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02423083）主要探究药物Guanabenz对多发性硬化症患者是否安全和耐受性良好。</p><p>2015.5-2016.2期间，Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02443103）主要探究药物Guanabenz在减少有骨转移的实体瘤患者的骨质翻转方面的生物活性。</p><h2 id="2-2-临床试验国家与地区分布"><a href="#2-2-临床试验国家与地区分布" class="headerlink" title="2.2.临床试验国家与地区分布"></a>2.2.临床试验国家与地区分布</h2><p>Guanabenz相关临床试验（ClinicalTrials.Gov: NCT02423083，ClinicalTrials.Gov: NCT02443103）仅在美国本土开展。</p><h2 id="2-3-临床试验申办机构分析"><a href="#2-3-临床试验申办机构分析" class="headerlink" title="2.3.临床试验申办机构分析"></a>2.3.临床试验申办机构分析</h2><p>登记号为ClinicalTrials.Gov: NCT02423083的临床试验由美国国立卫生研究院临床中心（CC）（国家神经疾病和中风研究所（NINDS））主持研究；</p><p>登记号为ClinicalTrials.Gov: NCT02443103的临床试验由印第安纳大学医学院主持研究。</p><h2 id="2-4-临床试验临床阶段及列表"><a href="#2-4-临床试验临床阶段及列表" class="headerlink" title="2.4.临床试验临床阶段及列表"></a>2.4.临床试验临床阶段及列表</h2><p>ClinicalTrials.Gov: NCT02423083处于临床试验Phase 1。</p><p>ClinicalTrials.Gov: NCT02443103临床试验阶段标记为不适用（ Not Applicable）。</p><h2 id="2-5-临床试验适应症分布"><a href="#2-5-临床试验适应症分布" class="headerlink" title="2.5.临床试验适应症分布"></a>2.5.临床试验适应症分布</h2><p>Guanabenz此前由美国FDC批准作为抗高血压药物使用，在登记号为NCT02423083的临床试验中被作为美国国立卫生研究院实验性治疗多发性硬化症临床试验的参考药物；在登记号为NCT02443103的临床试验中被印第安纳大学医学院用于作为减少患者骨癌转移的药物，并进行生物活性评估。</p>]]></content>
    
    
    <categories>
      
      <category>DATA COLLECTION</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ppp1r15A</tag>
      
      <tag>ClinicalTrials</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210827与导师talk</title>
    <link href="/2021/08/27/20210827%E4%B8%8E%E5%AF%BC%E5%B8%88talk/"/>
    <url>/2021/08/27/20210827%E4%B8%8E%E5%AF%BC%E5%B8%88talk/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210827%E4%B8%8E%E5%AF%BC%E5%B8%88talk.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>talk&amp;meeting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210826实验记录分离小鼠骨髓中的DC细胞和脾脏中的T细胞裂红和计数和混合培养</title>
    <link href="/2021/08/26/20210826%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E5%B0%8F%E9%BC%A0%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84T%E7%BB%86%E8%83%9E%E8%A3%82%E7%BA%A2%E5%92%8C%E8%AE%A1%E6%95%B0%E5%92%8C%E6%B7%B7%E5%90%88%E5%9F%B9%E5%85%BB/"/>
    <url>/2021/08/26/20210826%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E5%B0%8F%E9%BC%A0%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84T%E7%BB%86%E8%83%9E%E8%A3%82%E7%BA%A2%E5%92%8C%E8%AE%A1%E6%95%B0%E5%92%8C%E6%B7%B7%E5%90%88%E5%9F%B9%E5%85%BB/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210826%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E5%B0%8F%E9%BC%A0%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84T%E7%BB%86%E8%83%9E%E8%A3%82%E7%BA%A2%E5%92%8C%E8%AE%A1%E6%95%B0%E5%92%8C%E6%B7%B7%E5%90%88%E5%9F%B9%E5%85%BB.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210812文献阅读新冠病毒的复制周期</title>
    <link href="/2021/08/12/20210812%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%96%B0%E5%86%A0%E7%97%85%E6%AF%92%E7%9A%84%E5%A4%8D%E5%88%B6%E5%91%A8%E6%9C%9F/"/>
    <url>/2021/08/12/20210812%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%96%B0%E5%86%A0%E7%97%85%E6%AF%92%E7%9A%84%E5%A4%8D%E5%88%B6%E5%91%A8%E6%9C%9F/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210812%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB%E6%96%B0%E5%86%A0%E7%97%85%E6%AF%92%E7%9A%84%E5%A4%8D%E5%88%B6%E5%91%A8%E6%9C%9F.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SARS-CoV-2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.11-实验记录：CD4、CD8T细胞流式染色</title>
    <link href="/2021/08/11/20210811%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95CD4CD8T%E7%BB%86%E8%83%9E%E6%B5%81%E5%BC%8F%E6%9F%93%E8%89%B2/"/>
    <url>/2021/08/11/20210811%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95CD4CD8T%E7%BB%86%E8%83%9E%E6%B5%81%E5%BC%8F%E6%9F%93%E8%89%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-11-实验记录：CD4、CD8T细胞流式染色"><a href="#2021-8-11-实验记录：CD4、CD8T细胞流式染色" class="headerlink" title="2021.8.11-实验记录：CD4、CD8T细胞流式染色"></a>2021.8.11-实验记录：CD4、CD8T细胞流式染色</h1><blockquote><p>注意：每个样本应留下一个空白样本不做染色，用于校准基线。</p><p>在超净台操作时，应尽量避免开灯，防止荧光淬灭。</p></blockquote><p>配置染色工作液</p><p>染色CD4+ 1:200</p><blockquote><p>APC-eFluer 780</p></blockquote><p>染色CD8+ 1:200</p><blockquote><p>APC-FL6</p></blockquote><p>染色活细胞 1:500</p><blockquote><p>VD-FL9</p></blockquote><p>U型板每孔加入 50μl 染色工作液，暗处孵育 30min。</p><blockquote><p>这里用到的抗体自带荧光基团（是一抗），因此只需要孵育一次。</p></blockquote><p>然后 1500rpm 离心 10min，去上清。</p><p>染色胞内抗原需要进行破膜处理，然后再进行染色。</p><blockquote><p>正常情况下，荧光标记的流式抗体无法通过完整的细胞膜进入细胞内，用流式细胞仪测定细胞内抗原，需先利用破膜剂破坏细胞膜的完整性，产生可供抗体通过的小孔。破膜效果的好坏将直接影响荧光染色和结果分析。</p><p>若检测的胞内抗原带有自发荧光，这种情况下可以直接用流式细胞仪进行检测和分析，若检测需要荧光素偶联的抗体特异性结合细胞内抗原，此时需要用到破膜剂。</p></blockquote><p>U型板每孔加入 50μl 破膜液，暗处孵育 30min。</p><p>然后 1500rpm 离心 10min，去上清。</p><p>U型板每孔加入 100μl 破膜buffer，然后 1500rpm 离心 10min，去上清。</p><blockquote><p>破膜buffer原液为10x，需要稀释至1x。</p></blockquote><p>U型板每孔加入 50μl 胞内抗原染色工作液，暗处孵育 30min。</p><blockquote><p>CFFN </p><p>G2AM </p><p>MIX1</p></blockquote><p>然后 1500rpm 离心 10min，去上清，U型板每孔加入 100μl 加入破膜buffer。</p><blockquote><p>细胞多的时候可以洗一遍，少的时候可以不洗。</p></blockquote><p>然后 1500rpm 离心 10min，去上清，U型板每孔加入 100μl 破膜buffer配置的空白液。</p><blockquote><p>可以在-4℃冰箱里存放一天。</p></blockquote><p>流式细胞仪上样。</p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
      <tag>flow cytometry</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞</title>
    <link href="/2021/08/10/20210810%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84%E6%B7%8B%E5%B7%B4%E7%BB%86%E8%83%9E/"/>
    <url>/2021/08/10/20210810%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E5%88%86%E7%A6%BB%E9%AA%A8%E9%AB%93%E4%B8%AD%E7%9A%84DC%E7%BB%86%E8%83%9E%E5%92%8C%E8%84%BE%E8%84%8F%E4%B8%AD%E7%9A%84%E6%B7%8B%E5%B7%B4%E7%BB%86%E8%83%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-8-10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞"><a href="#2021-8-10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞" class="headerlink" title="2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞"></a>2021.8.10-实验记录：分离骨髓中的DC细胞和脾脏中的淋巴细胞</h1><p>（本次操作未进行裂红）</p><h2 id="分离骨髓中的DC细胞"><a href="#分离骨髓中的DC细胞" class="headerlink" title="分离骨髓中的DC细胞"></a>分离骨髓中的DC细胞</h2><p>准备：高温灭菌过的镊子、剪刀、一次性无菌注射器、1.5ml EP 管、15ml 离心管。</p><p>将新鲜小鼠后腿骨依次在 75%-80% 乙醇（EP管内）和 PBS （EP管内）中清洗。</p><p>将清洗过后的后腿骨置于细胞培养皿内，吸取适量 PBS 使后腿骨保持湿润。</p><p>用镊子夹取后腿骨中部，用剪刀剪去后腿骨两头。</p><p>用一次性无菌注射器吸取适量 PBS，然后插进大腿骨骨腔里，将骨髓冲洗出来。一根大腿骨的两头都需要冲洗，每头冲洗两次。</p><p>将 70μm 滤网放置在离心管上，将冲洗出来的骨髓悬液过滤。</p><p>用 PBS 将骨髓悬液补足至 15ml。</p><p>2000rps 离心 10min，获得沉淀在离心管底部的细胞。</p><blockquote><p>因未进行裂红，因此外观呈红色。</p></blockquote><h2 id="分离脾脏中的淋巴细胞"><a href="#分离脾脏中的淋巴细胞" class="headerlink" title="分离脾脏中的淋巴细胞"></a>分离脾脏中的淋巴细胞</h2><p>准备：高温灭菌过的镊子、剪刀、一次性无菌注射器、1.5ml EP 管、15ml 离心管。</p><p>将新鲜小鼠脾脏依次在 75%-80% 乙醇（EP管内）和 PBS （EP管内）中清洗。由于脾脏较为脆弱，用镊子夹取时需要特别注意。</p><p>将清洗过后的脾脏置于细胞培养皿内，吸取适量 PBS 使脾脏保持湿润，然后用一次性无菌注射器推注棒碾磨。</p><p>将 200μm 滤网放置在离心管上，将混有磨碎脾脏的 PBS 过滤。</p><p>用 PBS 将脾脏碾磨液补足至 10ml。</p><p>2000rps 离心 10min，获得沉淀在离心管底部的细胞。</p><blockquote><p>因未进行裂红，因此外观呈红色。</p></blockquote><h2 id="细胞培养"><a href="#细胞培养" class="headerlink" title="细胞培养"></a>细胞培养</h2><p>(培养DC细胞)</p><p>将离心管上清全部吸出，保留沉淀在离心管底部的细胞。</p><p>吸取 2ml 培养液，在离心管中吹打细胞进行重悬。</p><blockquote><p>培养液类型？</p></blockquote><p>将重悬后的细胞悬液分装到两个细胞培养皿中，每个培养皿分装 1ml。</p><p>在每个培养皿中再加入 10ml 培养液和集落刺激因子，混匀，在显微镜下镜检观察，然后放入细胞培养箱。</p><blockquote><p>集落刺激因子配置/浓度？</p></blockquote><h2 id="细胞冻存"><a href="#细胞冻存" class="headerlink" title="细胞冻存"></a>细胞冻存</h2><p>（冻存淋巴细胞）</p><p>胎牛血清与冻存液体按照 9:1 配置，细胞冻存管每管 1.5ml</p><p>一般将冻存管直接存入 -80℃ 液氮中，如果液氮罐已满，也可先放入 -20℃ 冰箱中过夜，第二天转移至液氮罐中。</p>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210809实验记录人源化小鼠全血DNA抽提</title>
    <link href="/2021/08/09/20210809%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E4%BA%BA%E6%BA%90%E5%8C%96%E5%B0%8F%E9%BC%A0%E5%85%A8%E8%A1%80DNA%E6%8A%BD%E6%8F%90/"/>
    <url>/2021/08/09/20210809%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E4%BA%BA%E6%BA%90%E5%8C%96%E5%B0%8F%E9%BC%A0%E5%85%A8%E8%A1%80DNA%E6%8A%BD%E6%8F%90/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210809%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95%E4%BA%BA%E6%BA%90%E5%8C%96%E5%B0%8F%E9%BC%A0%E5%85%A8%E8%A1%80DNA%E6%8A%BD%E6%8F%90.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cell experiment</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210719实验记录B16多肽溶液配置方法</title>
    <link href="/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95B16%E5%A4%9A%E8%82%BD%E6%BA%B6%E6%B6%B2%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95/"/>
    <url>/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95B16%E5%A4%9A%E8%82%BD%E6%BA%B6%E6%B6%B2%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95B16%E5%A4%9A%E8%82%BD%E6%BA%B6%E6%B6%B2%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>polypeptide vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210719实验记录geo2r</title>
    <link href="/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95geo2r/"/>
    <url>/2021/07/19/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95geo2r/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210719%E5%AE%9E%E9%AA%8C%E8%AE%B0%E5%BD%95geo2r.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
      <tag>SGEO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>20210719生物信息学研究方法记录</title>
    <link href="/2021/07/19/20210719%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/07/19/20210719%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="hhttps://jinsyliu.github.io/pdf/20210719%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%96%B9%E6%B3%95%E8%AE%B0%E5%BD%95.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bioiofo methods</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.7.16 GEO2R EXPERIMENT &amp; RESULTS</title>
    <link href="/2021/07/16/20210716GEO2REXPERIMENT&amp;RESULTS/"/>
    <url>/2021/07/16/20210716GEO2REXPERIMENT&amp;RESULTS/</url>
    
    <content type="html"><![CDATA[<p><strong>实验过程记录pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210716geo2r.pdf" width="100%" height="550" type="application/pdf"></div><br><p><strong>实验结果记录pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210716Results.pdf" width="100%" height="550" type="application/pdf"></div><br>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GEO</tag>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生</title>
    <link href="/2021/07/08/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/07/08/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="2021-7-8-文献阅读：mRNA-接种促进-SARS-CoV-2感染诱导的交叉变异中和抗体的产生"><a href="#2021-7-8-文献阅读：mRNA-接种促进-SARS-CoV-2感染诱导的交叉变异中和抗体的产生" class="headerlink" title="2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生"></a>2021.7.8 文献阅读：mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生</h1><p><strong>pdf版获取</strong><br><br></p><div class="row">    <embed src="https://jinsyliu.github.io/pdf/20210708%E6%96%87%E7%8C%AE%E8%AE%B0%E5%BD%95.pdf" width="100%" height="550" type="application/pdf"></div><br><blockquote><p>Stamatatos, L., Czartoski, J., Wan, Y.H., Homad, L.J., Rubin, V., Glantz, H., Neradilek, M., Seydoux, E., Jennewein, M.F., MacCamy, A.J. and Feng, J., 2021. mRNA vaccination boosts cross-variant neutralizing antibodies elicited by SARS-CoV-2 infection.</p><p>(mRNA 接种促进 SARS-CoV-2感染诱导的交叉变异中和抗体的产生)</p></blockquote><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>新型冠状病毒即严重急性呼吸系统综合症冠状病毒-2（SARS-CoV-2）betacoronavirus于2019年底在中国湖北省首次出现，此后在192个国家感染了超过1.15亿人，造成超过250万人死亡。感染是由病毒的spike protein（S）介导的，该蛋白的S1结构域包含N端结构域（NTD）、C端结构域（CTD）和受体结合结构域（RBD），负责介导与进入受体血管紧张素转换酶2（ACE2）的附着。</p><blockquote><p>S蛋白</p><p>大量的糖基化 S 蛋白覆盖在 SARS-CoV-2的表面，与宿主细胞受体血管紧张素转化酶2结合，介导病毒细胞进入。当 S 蛋白与受体结合时，位于宿主细胞膜上的 TM 蛋白酶2(TM protease serine 2，TMPRSS2)通过激活 S 蛋白促进病毒进入细胞。一旦病毒进入细胞，病毒 RNA 被释放，RNA 基因组中的多聚蛋白被翻译，病毒 RNA 基因组的复制和转录通过蛋白质切割和复制酶-转录酶复合体的组装进行。病毒 RNA 被复制，结构蛋白被合成、组装和包装在宿主细胞中，之后病毒颗粒被释放。</p><p><img src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41401-020-0485-4/MediaObjects/41401_2020_485_Fig1_HTML.png" alt="figure1"></p><p>这些蛋白质对病毒的生命周期至关重要，并为药物治疗提供了潜在的靶点。</p><p>S蛋白的大小为180-200kDa，由一个细胞外N端、一个固定在病毒膜上的跨膜（TM）结构域和一个短的细胞内C端部分组成。S通常以一种可转移的、融合前的构象存在；一旦病毒与宿主细胞相互作用，S蛋白就会发生广泛的结构重排，使病毒与宿主细胞膜融合。S蛋白上有多糖分子以进行伪装，在进入时可逃避宿主免疫系统的监视。</p><p>SARS-CoV-2 S的总长度为1273 aa，由位于N端的信号肽（1-13个氨基酸）、S1亚单位（14-685残基）和S2亚单位（686-1273残基）组成；后两个区域分别负责受体结合和膜融合。在S1亚单位中，有一个N端结构域（14-305残基）和一个受体结合结构域（RBD，319-541残基）；融合肽（FP）（788-806残基）、七肽重复序列1（HR1）（912-984残基）、HR2（1163-1213残基）、TM结构域（1213-1237残基）和细胞质结构域（1237-1273残基）组成了S2亚单位。</p><p>Huang, Y., Yang, C., Xu, X.F., Xu, W. and Liu, S.W., 2020. Structural and functional properties of SARS-CoV-2 spike protein: potential antivirus drug development for COVID-19. <em>Acta Pharmacologica Sinica</em>, <em>41</em>(9), pp.1141-1149.</p></blockquote><p>在人类与非灵长动物中，已经确定对SARS-CoV-2已有的免疫力与对再感染的保护有关，产生的中和抗体（nAbs）可能是机体对SARS-CoV-2的保护性免疫反应的重要组成部分，而且nAbs可能有助于保护人类免受再次感染。在此前已经发现，SARS-CoV-2感染迅速引起nAbs产生，并在几个月内下降，但仍可检测到。</p><blockquote><p>中和抗体 neutralizing antibody，NAb</p><p>是一种用于防止细胞被某种抗原或感染原侵害而具有保护力的抗体；其原理是通过抑制乃至中和它们的某种生化作用。</p><p>中和抗体可以导致对某些传染病的终身免疫力，并且可以用来观察一个人在从感染中恢复后是否对感染产生了免疫力。</p><p>中和抗体通过中和细胞在生物学上产生的任何效应，保护细胞免受病原体或传染性微粒的侵袭。中和使微粒不再具有传染性或致病性。中和抗体是后天免疫系统对病毒、细胞内细菌和微生物毒素的体液反应的一部分。中和抗体通过与传染性微粒表面结构(抗原)特异结合，防止微粒与宿主细胞相互作用，从而感染并破坏宿主细胞。由中和抗体引起的免疫也被称为杀菌免疫，因为免疫系统在任何感染发生之前就消除了感染性微粒。</p><p>为了进入细胞，病毒颗粒和细胞内的细菌利用其表面的分子与其目标细胞的细胞表面受体相互作用，使它们能够进入细胞并开始复制周期。中和抗体可以通过与病原体结合来抑制传染性，并阻断细胞进入所需的分子。这可能是由于抗体静态干扰附着在宿主细胞受体上的病原体或毒素。在病毒感染的情况下，单克隆抗体可以结合包膜病毒的糖蛋白或无包膜病毒的衣壳蛋白。此外，中和抗体可以通过阻止微粒经历细胞成功进入所需的结构变化来发挥作用。例如，中和抗体可以阻止病毒蛋白的构象变化，这些蛋白介导进入宿主细胞所需的膜融合。在某些情况下，即使抗体解离，病毒也无法感染。病原抗体复合物最终被巨噬细胞吸收和降解。</p><p>如新冠病毒靠刺突蛋白上的受体结合域（RBD）与人体细胞ACE2受体结合以进入细胞，若某抗体具有与此受体结合域正确位点结合，且使病毒无法进入细胞而失去感染力，则此抗体称为中和抗体，意味能中和病毒的毒力。</p><blockquote><p>中和抗体和结合抗体的区别：</p><p>并非所有结合病原微粒的抗体都是中和的。非中和性抗体（或结合性抗体），专门结合病原体，但不干扰其传染性。这可能是因为它们没有绑定到正确的区域。非中和性抗体对于标记免疫细胞的粒子非常重要，表明它已经成为目标，之后粒子被处理，因此被招募的免疫细胞破坏。</p><p>另一方面，中和抗体可以中和抗原的生物效应，而不需要免疫细胞。在某些情况下，一些病毒物种可利用非中和性抗体或与病毒颗粒结合的中和性抗体数量不足来促进其吸收进入宿主细胞。这种机制被称为抗体依赖性增强作用。已观察到登革热病毒和寨卡病毒。</p></blockquote></blockquote><p>病毒自然感染期间引起的大多数血清中和抗体反应是针对受体结合结构域RBD的。许多中和性抗RBD的单克隆抗体（mAbs）已经被确定，其中最有效的是阻断RBD-ACE2的相互作用。还发现了与病毒spike protein区域结合的中和mAbs。现在，两种基于mRNA的疫苗（Pfizer-BioNTech BNT162b2和Moderna mRNA-1273）已在几个国家开始紧急接种。这两种疫苗都编码了从2019年12月分离出的武汉-Hu-1变体中提取的稳定的S蛋白胞外域部分，在预防COVID-19方面显示出&gt;94%的效力，能够在人体中引起nAbs中和抗体的产生。</p><blockquote><p>单克隆抗体：仅识别一个抗原上的单一表位，仅由一种抗体亚型组成（例如IgG1，IgG2，IgG3）</p><p>多克隆抗体：识别任一抗原上的多个表位，主要由IgG亚类组成</p></blockquote><blockquote><p><strong>BNT162b2 vaccine</strong></p><p>BNT162b2是一种脂质纳米粒配方的核苷修饰 RNA 疫苗，编码一种预融合稳定的、膜锚定的 SARS-CoV-2全长spike protein，通过两个脯氨酸突变来锁定其前融合构象。</p><p><strong>mRNA-1273 vaccine</strong></p><p>mRNA-1273疫苗是一种脂质纳米粒包裹的 mrna 基疫苗，编码严重急性唿吸综合症冠状病毒2(SARS-CoV-2)的预融合稳定的全长spike protein</p></blockquote><p>但是，研究者们也在世界各地发现了新冠病毒进化后的变体。在英国、南非和巴西分别发现了新冠变种（B.1.1.7）、（B.1.351）和（P.1）。这些突变几乎都会增加病毒对ACE2受体的亲和力。这些突变降低了单克隆抗体、恢复期血浆和免疫者血清对中和的敏感性。因此，人们担心这些和其他新出现的病毒变异体可以逃避在感染期间产生的变异体 nAb 反应，而这些变异体在大流行早期流行，也可以逃避基于武汉 -hu-1变异体的 s 蛋白的疫苗引起的 nAb 反应。更令人担心的是，这些突变可能是在南非正在进行的 SARS-CoV-2疫苗试验中观察到的效力下降的原因。</p><p>而且，目前，研究者们对新冠病毒再感染的感染后免疫保护尚不清楚。如果一波又一波的新变种病毒不断出现，破坏人体的自然免疫保护，疫情将会变得难以控制。</p><p>因此，Stamatatos等研究者在这篇文章中调查了以前感染过新冠病毒的人在接种为新冠病毒原始武汉变体开发的基于信使RNA的疫苗4至8个月后的免疫反应性。这篇文章主要评估了受试者血清对病毒的中和敏感性，一共收集了15例 SARS-CoV-2感染者（previously infected donors ，PIDs）和13例未感染者（naïve donors ，NDs）的血清，前者在一次或两次接种前后分别接种 SARS-CoV-2疫苗，后者分别接种了两剂 SARS-CoV-2疫苗。</p><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>ELISA</p><p>抗体中和试验 Antibody neutralization experiments</p><blockquote><p>中和试验(neutralizationtest)是在体外适当条件下孵育病毒与特异性抗体的混合物，使病毒与抗体相互反应，再将混合物接种到敏感的宿主体内，然后测定残存的病毒感染力的一种方法。</p></blockquote><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><h3 id="fig-1"><a href="#fig-1" class="headerlink" title="fig.1"></a>fig.1</h3><p>用表达全长的wuhan-Hu-1 S或两个版本的B.1.351系S的假病毒进行抗体中和实验，其中一个版本在此称为B.1.351，包含定义S系的突变D80A、D215G、K417N、E484K、N501Y和D614G以及在该系中高度流行的A701V突变；第二个变体也包括一个Δ242-243缺失（B.1.351-Δ242-243）。</p><p>![F1.large (2)](/Users/keqinliu/Downloads/F1.large (2).jpg)</p><blockquote><p><strong>Fig. 1</strong>  <strong>B.1.351变异表明中和单克隆抗体的敏感性降低</strong></p><p>图中测量了所述的mAbs在293T-hACE2细胞中中和武汉-1、B.1.351和B.1.351-Δ242-243假病毒感染性的能力。括号内为每种mAb的表位特异性。EBV, Epstein-Barr病毒。数据点代表两个技术复制的平均值。数据是两个独立实验的代表。</p><p>横坐标轴是mAb的浓度（这里分为100，10，1，0.1和0.01一共五个滴度，纵坐标轴是中和效果，一般看50%血清中和终点）</p><p>A：mAb对B.1.351变体的中和效力要弱10倍左右。</p><p>B：非VH3-53 mAb CV3-1对B.1.351变体的效力降低了三到四倍。</p><p>C：CV2-75的效力略低。</p><p>D：相比之下，抗NTD的CV1 mAb无法中和B.1.351变体。</p><p>E：正如预期的那样，对照的anti–Epstein-Barr virus mAb AMMO1没有中和作用。</p><p>总之，这些数据表明，这里测试的B.1.351变体对从大流行早期的病毒变体感染者身上分离出来的mAb的中和作用更具抵抗力。</p><p>因此，研究者们继续调查了B.1.351变体是否对辉瑞-生物技术公司或Moderna mRNA疫苗在PID和NDS中引起的nAb反应有抵抗力。</p></blockquote><h3 id="fig-2"><a href="#fig-2" class="headerlink" title="fig.2"></a>fig.2</h3><p><img src="/Users/keqinliu/Downloads/F2.large.jpg" alt="F2.large"></p><blockquote><p>fig.2 <strong>单剂量的</strong>spike-derived mRNA<strong>疫苗会引起强烈的recall response</strong></p><p>A-C：通过ELISA方法，在辉瑞-生物技术公司或Moderna mRNA疫苗免疫前和免疫两次后收集的PID血清中测量特异于武汉-Hu-1变体RBD的IgG（A）、IgA（B）和IgM（C）终点抗体滴度，如所示。两次疫苗接种后在非传染性疾病患者血清中测得的终点滴度用于比较（灰色圆点）。</p><p><strong>A：三名PID经历了无症状的SARS-CoV-2感染（供体D、L和M），其中两人（L和M）在免疫前没有检测到抗RBD IgG抗体，而第三人（D）的血清抗RBD IgG抗体滴度低但可检测到。在接种前有RBD特异性IgG抗体的13个PID中，单剂量的任何一种疫苗都能使这些滴度提高~500倍。</strong></p><p><strong>B：在所有PID中，接种疫苗后RBD特异性IgA滴度的中位数增加了200倍。</strong></p><p><strong>C：总的来说，在PID中，与NDS的两次接种相比，单次接种的IgG和IgA滴度分别高出4.5倍和7.7倍。在PIDs中，RBD特异性IgM滴度通常较低，对疫苗接种的反应没有明显提高。</strong></p><p>D：在一次或两次免疫之前和之后，测量PIDs的外周血单核细胞（PBMCs）中武汉-Hu-1 RBD特异性IgG+记忆B细胞（活体、IgD-、CD19+、CD20+、CD3-、CD14、CD56-、单细胞和淋巴细胞）的频率。E和F）在一次或两次免疫之前和之后，测量PIDs的PBMCs中S6P特异性IgG+</p><p><strong>在PIDs中，接种疫苗后，RBD-（图2D）和S特异性IgG+（图2E）记忆B细胞的频率同时增加。免疫前缺乏RBD特异性IgG滴度的两个PID（供体L和M）也缺乏RBD特异性IgG+记忆B细胞（图2D），接种后S特异性IgG+记忆B细胞的频率较低。与血清学数据一致，观察到IgA+（图2F）而不是IgM+尖峰特异性记忆B细胞的频率增加（图S3）。疫苗接种还诱发了S特异性CD4+T细胞反应（图2G）。</strong></p><p>E-F：在一次或两次免疫之前和之后，测量PIDs的PBMCs中S6P特异性IgG+（E）和IgA+（F）记忆B细胞的频率。在(D)至(F)中显示了两剂疫苗后NDS的记忆B细胞的频率进行比较（灰色点）。</p><p>G：在一次或两次免疫之前和之后，测量PIDs的PBMCs中表达干扰素-γ（IFN-γ）和/或白细胞介素-2（IL-2）和/或CD40L的S特异性CD4+T细胞的频率。两次疫苗接种后，未感染供体的PBMC中S特异性CD4+T细胞的频率被显示出来进行比较（灰色圆点）。</p></blockquote><h3 id="fig-3"><a href="#fig-3" class="headerlink" title="fig.3"></a>fig.3</h3><p><img src="/Users/keqinliu/Downloads/F3.large.jpg" alt="F3.large"></p><blockquote><p>fig.3 <strong>早先存在的 SARS-CoV-2 nAb 反应是通过单剂量spike-derived mRNA疫苗加强的</strong></p><p>A至D：在使用辉瑞-生物技术公司或Moderna疫苗进行一次或两次免疫之前和之后的PID中，以及在使用两次疫苗之后的NDS中，测量导致50%中和的血清稀释度（ID50），如图所示。在（A）至（D）中，有症状和无症状的PID之间的数据点分别用实线和虚线连接。</p><p>E：辉瑞生物技术公司或Moderna公司针对wuhan-hu-1、B.1.351、B.1.351-Δ242-243和SARS-CoV-1假病毒的疫苗单次免疫之前（方块）和之后（圆圈）的PID的血清稀释导致50%的中和率（ID50），如所示。疫苗接种前无症状且抗IgG RBD抗体和RBD特异性IgG+记忆B细胞阴性的PID显示为开放圆圈。</p><p>F：用辉瑞-生物技术公司或Moderna公司的疫苗对指定的假病毒进行两次免疫后，NDS的血清的中和效力（ID50）。每个数据点代表一个不同的捐赠者，横线代表（E）和（F）中的中位数。虚线划定的是测试的最低血清稀释度。</p><p>在接种疫苗前取样的15名PID中，有12人的血清中和了武汉-Hu-1 SARS-CoV-2变体。不中和的血清来自三个无症状的PID，他们的抗RBD IgG滴度较低或无法检测，来自NDS的Pre-accine血清也没有中和作用。</p><p><strong>A：与预先存在RBD特异性IgG滴度的PID单次免疫后观察到的结合抗体的增加相一致，第一剂量后半最大中和滴度[半最大抑制稀释度（ID50）]被提高了约1000倍，而第二剂量没有影响。在接种前缺乏RBD特异性IgG滴度的两个PID中，第一剂疫苗引起了较低的中和滴度（捐赠者L的ID50=30 ，捐赠者M的ID50=200）。在NDS中，两剂疫苗引起的ID50滴度分别比PID中的一剂或两剂引起的滴度低10倍和5倍。总之，这些数据表明，在对RBD产生足够免疫记忆的PID中，单剂疫苗引起的无名反应导致RBD结合和nAb反应，优于未感染供体的两剂方案。在最近的两项研究中，在接受单一mRNA疫苗剂量的PID中也观察到了类似的结合和/或疫苗匹配的中和滴度的提高。</strong></p><p>接下来研究者评估了NDS和PID在免疫前后收集的血清中和更具抗性的B.1.351和B.1.351-Δ242-243假病毒的能力。这些变体与武汉-Hu-1变体之间有0.5和0.7%的区别。研究者还将 SARS-CoV-1假病毒作为一个与疫苗更不同的代表性变异包括在这项分析中。SARS-CoV-1和 SARS-CoV-2在总 S 蛋白、 RBD 和 RBM 中的区别分别为24%、26%和50% 。因此，一些单克隆抗体无法与 SARS-CoV-1结合而中和 SARS-CoV-2。</p><p>B.E. 接种疫苗前，15份PID的血清中有5份中和了B.1.351，只有3份的ID50滴度超过了100</p><p>C.E. 15份中有7份中和了B.1.351-Δ242-243，只有一份的滴度超过了100</p><p>E 前期疫苗血清对武汉-胡1变体的ID50中值明显高于对B.1.351或B.1.351-Δ242-243的ID50</p><p>D.E. 与高度的序列差异相一致的是，只有一个PID的血清在接种疫苗前对SARS-CoV-1表现出非常弱的中和活性</p><p>A.D.  在15名PID中的13名中，单次免疫可提高针对所有三种SARS-CoV-2变体和SARS-CoV-1的nAb滴度</p><p>E 然而，针对B.1.351的ID50滴度中值要比针对Wuhan-Hu-1的低3倍，针对B.1.351-Δ242-243的低10倍，针对SARS-CoV-1的低100倍</p><p>A-D.E 在两个缺乏RBD特异性IgG记忆的无症状供体（供体L和M）中，单次免疫并没有引起针对B.1.351变体或SARS-CoV-1的nAbs。</p><p>PID单次免疫引起的中和滴度明显高于NDS两次免疫引起的对所有测试的假病毒的中和滴度–对Wuhan-Hu-1高10倍（图3A），对B.1.351高20倍（图3B），对B.1.351-Δ242-243高30倍（图3C），而对SARS-CoV-1高7倍（图3D）。</p><p>13个接种的NDS中只有8个能达到对B.1.351-Δ242-243的80%中和，没有一个能达到对SARS-CoV-1的80%中和（图S7B）。</p></blockquote><p>B.1.351和B.1.351-Δ242-243变体包含三个RBD突变，影响了抗RBD mAbs的中和效力（fig.1）。</p><p>此外，预先存在的抗RBD IgG记忆似乎对疫苗接种的强烈回忆反应很重要。为了确定抗RBD抗体对血清中和的相对贡献，研究者在一次疫苗接种后从10个PID的血清中，以及在两次疫苗接种后从9个NDS的血清中，耗尽了RBD特异抗体。</p><h3 id="fig-4"><a href="#fig-4" class="headerlink" title="fig.4"></a>fig.4</h3><p><img src="/Users/keqinliu/Downloads/F4.large.jpg" alt="F4.large"></p><blockquote><p>fig.4 <strong>疫苗诱导的 nAbs 靶向 RBD</strong></p><p>使用固定在磁珠上的wuhan-Hu-1 RBD，从接受单一疫苗剂量后的PIDs血清或接受两个疫苗剂量后的NDS血清中吸附RBD结合的抗体。</p><p>A.B. 如图所示，通过ELISA法测量PIDs的未去除或已去除RBD的血清与1：500稀释度的RBD（A）和1：4500稀释度的S2P（B）的抗体结合。A450，450nM时的吸光度。</p><p>C 在(A)和(B)中的PIDs的未去除或RBD去除的血清中，测量导致武汉-Hu-1伪病毒50%中和的血清稀释度（ID50）</p><p>D.E. 通过ELISA法，测量未去除和RBD去除的NDS血清中与1：500稀释度的RBD（D）和1：500稀释度的S2P（E）的抗体结合。</p><p>(F)测量(D)和(E)中供体的未去除或RBD去除血清的1:120稀释度对武汉-hu-1假病毒的中和率。</p><p>通过酶联免疫吸附试验（ELISA），这种方法有效地从血清中去除RBD特异性抗体（图4，A和C），而不是抗S2P特异性抗体（图4，B和D）。这种耗竭削弱了wuhan-Hu-1病毒的血清中和作用（图4，C和F），这表明大多数由疫苗接种引起或增强的nAbs都是针对这个亚域的。</p></blockquote><p>上述结果表明，在NDS中，无论是辉瑞生物技术公司还是Moderna公司的两剂疫苗都能引起针对疫苗匹配的武汉-Hu-1的nAb滴度，针对B.1.351的滴度较低，而针对B.1.351-Δ242-243的滴度甚至更低。其他B.1.351变体对疫苗诱导的nAbs的敏感性降低也有报道。</p><p>同样，来自经历过SARS-CoV-2感染的PID的血清，在接种疫苗前有可检测到的抗RBD IgG滴度，在感染后1至9个月，对Wuhan-Hu-1的nAb滴度普遍较弱，对B.1.351变体的滴度较低或不存在，与另一项研究一致。</p><p>然而，只要在感染期间产生了RBD特异性IgG+记忆B细胞和抗体反应，用任一mRNA疫苗进行单次免疫就会引起强烈的回忆反应，使自体中和滴度提高约1000倍，这些抗体反应可交叉中和B.1.351变体，但滴度较低。在大多数先前感染的疫苗接种者中，抗B.1.351-Δ242-243的中和滴度与未感染的疫苗接种者中抗疫苗匹配的Wuhan-Hu-1的滴度相当。这是值得注意的，因为在3期试验中，这些滴度与COVID-19的95%保护率有关。此外，疫苗激发的抗体反应也能中和SARS-CoV-1，但其效力要低得多。总之，我们的数据表明，基于wuhan-hu-1变体的两种mRNA疫苗可以引起和/或增强nAb反应，但它们对不同变体的效力会降低。</p><p>研究者发现，以前感染的受试者在免疫后产生的交叉nAb反应是抗RBD抗体的结果。结合观察，疫苗引起的nAb反应对NTD有Δ242-243缺失的B.1.351变体的效力较低，这表明NTD变异可以调节新出现的变体对抗RBD nAbs的敏感性。相比之下，NTD区域本身似乎可以容忍SARS-CoV-2和其他冠状病毒的抗原性变异，它似乎不是感染或疫苗接种引起的交叉nAbs的目标。我们注意到，还有其他与这一品系相关的不太常见的突变，如L18F、Δ244、L244H和R246I，这些突变在这里没有被研究，它们可能会进一步增加对疫苗激发的抗体的抵抗力。在这项研究中，使用了一种假病毒检测方法来测量nAbs。现在有几项研究表明，真病毒和假病毒的中和作用有相当好的相关性。尽管真实病毒和假病毒检测的绝对敏感性可能不同，但我们预计我们在此报告的相对差异不会在两者之间发生变化。</p><p>尽管SARS-CoV-2疫苗的保护作用尚未确定，但在非人灵长类动物中的研究表明，即使是低滴度的nAbs也足以预防实验性SARS-CoV-2感染，特别是如果CD8+T细胞反应被启动的话。研究者们发现，大多数先前感染的受试者将从辉瑞生物技术公司或Moderna疫苗的单次免疫中受益，因为它将导致针对疫苗匹配和新出现的变体的血清nAb反应的显著增加。</p><p>观察到在第一剂疫苗接种后3至4周再接种第二剂疫苗并不能进一步提高PID的中和滴度，这些PID在接种前有明显的RBD导向的免疫记忆证据，这表明对于一些以前感染过SARS-CoV-2的人，可以推迟第二剂mRNA疫苗的接种。对第一剂疫苗前后的nAb滴度的纵向监测应被用来确定在以前感染的情况下第二剂疫苗的必要性或最佳时机。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>在接种疫苗之前，感染后的血清对病毒变体的抗体中和反应是可变的和弱的。疫苗接种使感染后血清对武汉-Hu-1和其他毒株的中和能力提高了约1000倍，对变种B.1.351的血清中和能力也有所提高。虽然对变异株的反应相对较弱，但仍显示出特有的记忆反应。</p><p>因此，接种武汉-湖北1号变种疫苗可能会对机体以后感染变种病毒所产生的的保护性反应提供促进作用。</p>]]></content>
    
    
    <categories>
      
      <category>LITERATURE READING</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SARS-CoV-2</tag>
      
      <tag>vaccine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.1.20 human RME</title>
    <link href="/2021/01/20/20210120humanRME/"/>
    <url>/2021/01/20/20210120humanRME/</url>
    
    <content type="html"><![CDATA[<h1 id="How-to-analyze-human-RME"><a href="#How-to-analyze-human-RME" class="headerlink" title="How to analyze human RME"></a>How to analyze human RME</h1><h2 id="1-Background"><a href="#1-Background" class="headerlink" title="1. Background"></a>1. Background</h2><p>区分印记基因和单等位基因</p><h3 id="1-1-RME"><a href="#1-1-RME" class="headerlink" title="1.1 RME"></a>1.1 RME</h3><p>在二倍体生物体中，一般认为每个基因的两个等位基因都会在相似的时间和水平上表达。然而，一些基因可以优先表达或严格从一个单一的等位基因，这一过程被称为单等位基因表达。单等位基因表达可能是由于等位基因之间的 DNA 序列多态性，例如在增强子或启动子序列中的多态性可能影响基因转录的效率，或基因组大部分的拷贝数变异(copy-number variations，CNVs)。在没有DNA序列多态性的情况下，也会出现单等位基因表达，最为典型的例子是雌性哺乳动物的X染色体失活（XCI）过程，它保证了XX雌性和XY雄性之间的X连锁基因剂量补偿\citep{wutz2011gene}。另一个典型的单等位基因调控的程序化例子则是印记基因。</p><p>印记基因是一种亲本起源特异性的单等位基因表达。印迹基因的单等位基因表达受生殖系等位基因特异性甲基化(allele-specific methylation，ASM，传统上称为差异甲基化区域(differentially methylated region，DMR))控制\citep{tycko2010allele, lo2003allelic}。在这些生殖系遗传系(gASMs)中 ，一个亲本等位基因的印迹控制区的 CpGs 是甲基化的，而另一个等位基因的 CpGs 是非甲基化的。当用亚硫酸氢盐Sanger测序检测时，这些区域的 PCR 克隆有一半是高甲基化的，另一半是低甲基化的，因此呈现出双峰式甲基化模式。重要的是，这些 gASMs/DMR 在胚胎发育早期的整体去甲基化和再甲基化周期中被认为是稳定的\citep{bartolomei25mammalian}。一旦由于精子和/或卵母细胞的暴露，这些遗传性组织被改变，这种改变可以作为“表观遗传记忆”进入体细胞。这种表观遗传改变的水平或许能在个体中维持数十年。此前，在一项针对跨代表观遗传的研究中，研究者们发现，出生前即暴露于荷兰饥荒的个体在出生60年后，印记的 IGF2基因的 DNA 甲基化水平仍然低于未暴露的同性兄弟姐妹\citep{heijmans2008persistent}。目前发现，大约超过100个基因座受父母起源依赖性表达的影响。许多印迹基因在出生前和出生后的新陈代谢中都起着重要作用，它们的双等位基因表达可以导致严重的表型\citep{barlow2011genomic}。不过，在某些组织比如大脑中，处于胎儿出生后神经发育的需要，神经干细胞会发生印记基因的沉默释放（release from silencing）\citep{ferron2011postnatal}。</p><p>除了亲本起源特异性单等位基因表达（parent-of-origin-specific monoallelic expression），哺乳动物基因组有大量的基因显示随机单等位基因表达(random monoallelic expression，RME)\citep{lo2003allelic, deng2014single, gendrel2014developmental}。旧观点认为，常染色体上的非印迹基因要么双细胞表达，要么双等位基因抑制。单等位基因表达被认为只发生在位于印记位点或女性 X 染色体的基因（其中一个来自父系或母系的X染色体在女性中被随机灭活）\citep{tycko2010allele}。但是，最近的研究发现，非印迹的常染色体基因的单等位基因的表达似乎不是一个偶发现象，而是在人类和小鼠基因组中的一个保守特征\citep{lo2003allelic, deng2014single, gendrel2014developmental}。虽然RME现象似乎经常发生，但表观遗传学机制好像无法对其发生进行解释\citep{gendrel2014developmental}。</p><p>这些随机单等位基因表达一般发生在常染色体基因座上\citep{chess2012mechanisms}，包括大基因家族的重要成员。这些随机单等位基因以高度组织特异性的方式表达，一般参与感觉或免疫系统功能(如人类白细胞抗原HLA)，如淋巴细胞中的免疫球蛋白（immunoglobulin）和T细胞受体基因（T cell receptor genes）、嗅觉神经元中的气味剂受体（odorant receptor ，OR）基因、浦肯野神经元（Purkinje neurons）中的原珠蛋白（protocadherins，Pcdhs）等\citep{chess2012mechanisms}。这种单基因和单配位表达（monogenic and monoallelic expression）的现象（也称为等位基因排异（allelic exclusion））被认为对明确细胞身份和保证细胞多样性至关重要。事实上，研究者认为，等位基因排斥保证了每个 b 细胞或 t 细胞只产生一个单一的抗原受体，这种方式有助于免疫多样性\citep{cedar2008choreography}。等位基因排斥似乎代表了一种普遍的表观遗传现象。重要的是，单等位基因的表达在细胞谱系和个体之间存在差异。因此，RME 可能产生多样性的基因表达模式，对细胞的命运和生理有重要影响\citep{ohlsson2007widespread}。</p><p>单等位基因表达状态可以稳定地保持在几代细胞中。</p><p>单等位表达基因在发育过程中起着重要作用。此前的研究发现，许多常染色体基因的单等位基因表达发生在体内，在正常发育过程中，并趋向于高度组织特异性\citep{gendrel2014developmental}。</p><p>RME导致的表观遗传改变与许多人类疾病的发生密切相关。例如，表观遗传学研究表明，癌细胞具有全基因组低甲基化和区域特异性低甲基化的特点，而等位基因失衡(allelic imbalance，AI)与癌症发生风险上升相关。乳腺癌和卵巢癌散发病例中，由于启动子过度甲基化导致的 BRCA1表达缺失与两种癌症的发病相关\citep{esteller2000promoter, thrall2006brca1}。先前的一项研究报道，13个人类基因中有6个，包括 BRCA1和 p53，在两个等位基因中表达有显著差异，并且这种差异是通过孟德尔定律遗传的\citep{yan2002allelic}。</p><p>此外，人类常染色体显性遗传性疾病涉及单等位基因表达。</p><h2 id="How-to-analyze-ASE-in-RNA-seq"><a href="#How-to-analyze-ASE-in-RNA-seq" class="headerlink" title="How to analyze ASE in RNA-seq?"></a>How to analyze ASE in RNA-seq?</h2><p>\citep{borel2015biased}</p><blockquote><p>To investigate the extent of allele-specific transcription of autosomal human protein-coding genes, we used single-cell RNA sequencing (RNA-seq) technology to study 203 single cells from two different human primary fibroblast cell lines. </p><p>By analyzing informative single-nucleotide variants (SNVs), we determined the relative mRNA abundance of each of the two alleles. For most of the actively transcribed genes, our results revealed that one allele was predominantly detected in a single cell at a particular point in time, whereas the second allele was at low levels or undetectable. </p><p>We observed a stochastic process given that equal numbers of single cells expressed one or the other allele and a minority of single cells expressed both alleles. Interestingly, we detected only a few genes with an equal mRNA level from both alleles in all single cells. Detailed genomic characterization of these “single-cell biallelic” genes revealed that they express high levels of mRNA in a large number of cells. </p></blockquote><p>method</p><blockquote><ol><li><p>Single-Cell Capture</p></li><li><p>cDNA Synthesis and Pre-amplification of Single Cells</p></li><li><p>Total RNA Extraction from Bulk Cell Samples</p></li><li><p>mRNA-Seq Library Preparation</p></li><li><p>Whole-Genome Sequencing</p></li><li><p>Spike-In Experiment</p><p> 由于不同文库测序深度不同，比较前当然要进行均一化！用总reads进行均一化可能最简单，其基于以下两个基本假设：</p><ul><li>绝大多数的gene表达量不变；</li><li>高表达量的gene表达量不发生改变；</li></ul><p> 但在转录组中，通常一小部分极高丰度基因往往会贡献很多reads，如果这些“位高权重”的基因还是差异表达的，则会影响所有其它基因分配到的reads数，而且，两个样本总mRNA量完全相同的前提假设也过于理想了。那如何比较呢，各个方家使出浑身解数，有用中位数的，有用75分位数的，有用几何平均数的，有用TMM(trimmed mean of Mvalues)的等等，总之要<strong>找一个更稳定的参考</strong>值。</p><p> <em>House-keeping gene(s)</em></p><p> 矫正的思路很简单，就是在变化的样本中寻找不变的量</p><p> 那么在不同RNA-seq样本中，那些是不变的量呢？一个很容易想到的就是<strong>管家基因</strong> (House-keeping gene(s))</p><p> 使用Housekeeping gene的办法来进行相对定量，这种办法在一定程度上能够解决我们遇到的问题。但其实这种办法有一个<strong>非常强的先验假设</strong>：housekeeping gene的表达量不怎么发生变化。其实housekeeping gene list有几千个，这几千个基因有一定程度上的变化是有可能的。</p><p> An RNA spike-in is an RNA transcript of known sequence and quantity used to calibrate measurements in RNA hybridization assays, such as DNA microarray experiments, RT-qPCR, and RNA-Seq.</p><p> A spike-in is designed to bind to a DNA molecule with a matching sequence, known as a control probe. This process of specific binding is called hybridization. A known quantity of RNA spike-in is mixed with the experiment sample during preparation. The degree of hybridization between the spike-ins and the control probes is used to normalize the hybridization measurements of the sample RNA.</p><p> 在RNA-Seq建库的过程中掺入一些预先知道序列信息以及序列绝对数量的内参。这样在进行RNA-Seq测序的时候就可以通过不同样本之间内参（spike-in）的量来做一条标准曲线，就可以非常准确地对不同样本之间的表达量进行矫正。在这种操作下，可以一定程度上认为是一种绝对定量。（类似于housekeeping gene）</p><p> 举例说明：</p><p> 通过在样品制备过程中，混入指定数量的spike-in，我们就可以知道不同样本中的基因绝对比表达值。如等细胞数的样本A和样本B，在每个样本中，我加入了等量的spike-in。最后分析发现，spike-in占样本A的1%，但是占样本B的5%。这表明样本A的RNA表达量也许普遍比样本B的表达量高五倍左右。</p><p> <strong>ERCC control RNA</strong></p><p> ERCC = External RNA Controls Consortium</p><p> ERCC就是一个专门为了定制一套spike-in RNA而成立的组织，这个组织早在2003年的时候就已经宣告成立。主要的工作就是设计了一套非常好用的spike-in RNA，方便microarray，以及RNA-Seq进行内参定量。</p><p> 在RNA-Seq中增加ERCC的绝对量是可以获得FPKM的绝对量的增加，并且两者成非常好的线性关系。这也是我们能够对RNA-Seq样本进行掺入内参的一个基本前提。</p><p> R中用来处理带有ERCC spike-in的RNA-Seq数据的包：RUVSeq \citep{risso2014normalization}</p></li><li><p>RPSM Calculation</p><p> RPSM stands for reads at a single-nucleotide position per sequencing read length (in kb) and per million mapped reads. The formula for RPSM is (10^6 × A) / (B × C), where A is the number of mappable reads at a nucleotide position, B is the total number of mappable reads of the sample, and C is the sequencing read length (in kb; C = 0.199).</p></li><li><p>Read Mapping for RNA-Seq Samples</p></li><li><p>ASE analysis</p><p> ASE analysis was performed as in \citep{lappalainen2013transcriptome} In brief, we considered heterozygous sites obtained from whole-genome sequencing with DNA reads supporting both alleles. We used a minimum site quality call of 200. We excluded sites susceptible to allelic mapping bias, namely (1) sites with 50 bp mappability &lt; 1 according to the UCSC mappability track (implying that the 50 bp flanking region of the site is not unique in the genome), and (2) sites where overlapping simulated RNA-seq reads showed a &gt;5% mapping difference between those that carried the reference allele and those that carried the non-reference allele (see the methods in \citep{lappalainen2013transcriptome}).</p><p> In all analyses, we only used uniquely mapped RNA-seq reads (GEM mapping quality &gt; 150) and sites with base quality &gt; 20 and support from at least 16 reads. Using information from SAMtools (v.0.1.19) mpileup\citep{li2009sequence}, we obtained for each site and each sample the number of reads mapping in the reference, the number of alternative alleles, and the sum of both. Each site was then annotated with the overlapped genomic feature in GENCODE annotation v.15 or the novel exons from the de novo assemblies of each sample. For each site, the number of single cells (and non-single cells) where the site was assessed was also counted. The distribution of allelic ratios for all samples is reported in Figure S9.</p><p> 等位基因特异性表达不平衡（Allelic Expression Imbalance，AEI）可以作为表型用于寻找功能顺式作用多态性，同时可以作为转录区的分子标记来观察同一个体中不同等位基因的特异性表达差异。在杂合子个体中，分别来自父亲与母亲的等位基因，它们在同一细胞中，处于相同的外部环境中，在没有顺式作用多态性（或特定基因表观遗传修饰）的情况下，他们的表达量应该是一样的。与此相反，个体的顺式作用多态性会影响基因的表达及mRNA的加工，导致等位基因有不同的mRNA表达量水平，即AEI(等位基因表达不平衡)。它可以作为一个综合所有顺式作用因子的定量测量。另外，当目的SNP位点位于转录区时，可以直接在总RNA反转录cDNA中观察到SNP 不同等位基因的特异性表达差异，也就是用这个SNP作为Marker对两条不同allele分别进行表达定量。从而观察在同一杂合子个体中两种不同的等位基因型是否对表达水平造成了影响，也就是说排除了个体差异和环境影响之后是否存在由该位点不同基因型所造成的表达差异。该实验需要此SNP位点分型为杂合子的个体的基因组DNA和目的组织细胞抽提得到的总RNA（或者已经反转录好的cDNA）。实验中我们将用基因组DNA的两条allele作为1:1的校正内参，观察目的组织细胞中的RNA中两条allele的比例是否偏离1:1，最终判断是否存在AEI现象，进一步确定该位点与表达水平的关系。</p><p> （需要检测的对象：杂合子的个体的基因组DNA和目的组织细胞抽提得到的总RNA）</p></li><li><p>Gene Quantification and De Novo Assembly</p><p>We used the software Cufflinks (v.2.1.1)\citep{trapnell2012differential, trapnell2010transcript} with default parameters and GENCODE v.12 as a reference annotation\citep{harrow2012gencode}. On the basis of Cufflinks transcript (170,086) quantifications, we selected for further analysis single cells that passed the arbitrary threshold of 12,000 transcripts expressed at FPKM (fragments per kilobase of exon per million reads mapped) &gt; 0.3. We retained 163 UCF1014 single-cell samples expressing an average of 15,807 transcripts (the remaining samples expressed an average of 4,998 transcripts). Additionally, for each sample we performed de novo assembly to identify novel transcripts (Figure S4) without using the reference annotation. We then used the program cuffcompare to compare the assembled transcripts with the GENCODE reference annotation (v.15). Finally, for the four bulk RNA samples, we merged the four assemblies into a merged bulk RNA assembly. We compared each single-cell de novo assembly against the merged bulk RNA assembly to identify novel single-cell-specific transcripts. The program intersectBed from bedtools28 was used for this last comparison.</p></li></ol></blockquote><p>softwares（主要针对ASE分析）</p><blockquote><ol><li><p>SAMtools (v.0.1.19)</p></li><li><p>GENCODE annotation v.15</p></li><li><p>GENCODE v.12</p></li><li><p>Cufflinks(v. 2.1.1)</p></li><li><p>cuffcompare</p></li><li><p>GENCODE reference annotation (v.15).</p></li><li><p>intersectBed （from bedtools）</p></li><li><p>gemtools v. 1.6.2</p></li><li><p>RUVSeq(R) (处理spike-in内参) \citep{borel2015biased}</p></li><li><p>GATK ASEReadCounter \citep{mckenna2010genome}</p><p>如何利用SNP信息构建伪亲代基因组，然后把子代的测序信息mapping上去(用STAR）？</p><p>输入：BAM files (with proper headers) to be analyzed for ASE；A VCF file with specific sites to process</p><p>输出：A table of allele counts at the given sites. By default, it is formatted as a tab-delimited text file that is readable by R and compatible with <a href="http://www.well.ox.ac.uk/~rivas/mamba/">Mamba</a>, a downstream tool developed for allele-specific expression analysis.</p></li><li><p>Bedtools</p></li><li><p>STAR</p></li><li><p>Mamba</p><p>a tool for further analysis data by GATK</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>t.code.sf.net<span class="hljs-regexp">/p/m</span>ambas/mambas mambas-mambas <span class="hljs-comment">#install</span><br></code></pre></td></tr></table></figure></li><li><p>MBASED(利用RNA-seq数据进行ASE检测，将多个单核苷酸变异位点的信息聚合在一起，以获得ASE的基因水平测量，即使在事先没有相位信息的情况下也可以进行) \citep{mayba2014mbased}</p></li><li><p>GeneiASE(仅使用 RNA-seq 数据，不需要已知或估计的单倍型，并且可以作为可下载的软件包使用。问题是，不能确定真正的单倍型，不能确定基因究竟是来自于父系等位基因还是母系等位基因的表达。) \citep{edsgard2016geneiase}</p></li><li><p>QuASAR(R包，当基因型数据无法获取时，可以用此方法。 i)从下一代测序读取基因分型，ii)对杂合子位点的等位基因不平衡进行推断。测序数据可以是 RNA-seq、 DNase-seq、 ATAC-seq 或任何其他类型的高通量测序数据。) \citep{harvey2015quasar}</p></li><li><p>ASEP（只用RNA-seq数据检测ASE）\citep{fan2020asep}</p></li><li><p>SCALE（需要提前确定来自父母系的等位基因，R中的输入数据是矩阵格式，分为母系基因的read count matrix和父系基因的read count matrix，输出是某个基因的父系与母系等位基因表达量/频率）\citep{borel2015biased}</p></li><li><p>phASER \citep{castel2016rare}</p><p>输入：VCF文件（VCF，或 Variant Call Format，它是一种标准化的文本文件格式，用于表示 SNP、 indel 和结构变化调用。VCF 规范过去由千人基因组计划卫生组织维护，但其管理和进一步开发已被基因组学与健康全球联盟的基因组数据工具包团队接管。）tabix index for the VCF，BAM format file containing RNA-seq reads，index for the BAM file。</p></li></ol></blockquote><p>eQTL analysis</p><blockquote><p>Expression quantitative trait loci (eQTL) 基因表达数量性状基因座</p><p>eQTL 研究成本高昂，需要大样本量和对每个样本进行全基因组分型</p><p>To date, most eQTL studies have considered the effects of genetic variation on expression within a single tissue (typically blood). </p><p>分析软件/程序：</p><p>MT-eQTL</p></blockquote><p>ASE analysis</p><blockquote><p>analysis of allele-specific expression (ASE) 分析等位基因特异性表达</p><p>通常是通过计算与杂合位点上每个等位基因相匹配的 RNA-seq 读数和检验1:1等位基因比率的零假设来实现的</p><p>原则上，当基因型信息不容易获得时，可以从 RNA-seq 读数直接推断。然而，在考虑基因型调用的不确定性的情况下，目前还没有联合推断基因型和进行 ASE 推断的方法。</p></blockquote><p>利用SNP来定位不同来源的等位基因 \citep{xie2019modeling}    BLMRM方法（R包）</p><blockquote><p>公牛的 DNA 经过了下一代测序(DNA-seq) ，以确定他的基因组和母牛的参考基因组之间的所有 SNPs。</p><p>然后应用基因组分析工具包(Genome Analysis Toolkit，GATK)\citep{mckenna2010genome}和 SAMtools \citep{li2011statistical}来调用 SNP，只使用两个管道所识别的 SNPs 来生成伪 基因组。</p><p>最后，利用 HISAT2 \citep{kim2015hisat}和 BWA \citep{li2009fast}将来自母牛 × 公牛 F1代的 RNA-seq 片段定位到二倍体基因组，并保留两种方法鉴定的变异体，以减少假阳性的可能影响。</p></blockquote><p>利用亲本特异性 SNPs 分析等位基因特异表达基因。\citep{ahn2019analysis}</p><blockquote><p>Method: 进行了父母基因组和后代转录组测序使用下一代测序。</p><p>随后，利用单核苷酸多态性(single nucleotide polymorphism，SNPs)的个体基因组定位和用于正反杂交的同一品种亲本的联合基因组定位，采用两种不同的方法对 snp 进行了基因组尺度识别。</p><p>利用亲本特异性 SNPs 分析等位基因特异表达基因。</p><p>Result: 由于测序结果的基因组覆盖率较低(约4 ×) ，大多数 SNPs 对于亲本谱系鉴定后代表达的等位基因没有信息价值，因此被排除在我们的分析之外。因此，包含336个基因的436个单核苷酸多态性可用于检测父系等位基因在后代中的不平衡表达。通过计算双亲等位基因在后代中的阅读比例，我们鉴定了7个表现等位基因偏向表达的基因(p &lt; 0.05) ，其中包括以前报道的3个基因和本研究中新发现的4个基因。</p><p>Read mapping: 下载该物种的参考基因组。使用 BWA MEM 包(版本0.7.17-r1188) \citep{li2009fast}将序列读取与引用对齐。SAM 文件使用 samtools 索引转换为 BAM 格式，并使用 samtools sort \citep{li2009sequence}进行排序。RNA-seq 读取到参考基因组的映射是使用带有默认选项和2-pass 模式的 STAR 包(版本2.5.3 a)进行的。</p><p>Variant calling and filtration： 使用 Picard 工具中的 markduplices (2.15.0版， <a href="https://broadinstitute.github.io/Picard/)%E5%88%A0%E9%99%A4%E4%BA%86%E6%98%A0%E5%B0%84%E8%AF%BB%E5%8F%96%E7%9A%84%E5%89%AF%E6%9C%AC%E3%80%82%E5%AF%B9%E4%BA%8E">https://broadinstitute.github.io/Picard/)删除了映射读取的副本。对于</a> RNA-seq 读操作，read 组使用 GATK AddOrReplaceReadGroups 添加到映射读操作中，而使用 GATK Split NCigarReads \citep{poplin2017scaling}删除内含区域中映射的溢出读操作。基本质量的阅读是重新校准使用 GATK BaseRecalibrator (版本3.8)的全基因组测序和 RNA-seq 的结果，质量调整的阅读是使用 GATK PrintReads。父母基因组和后代转录组的变异体分别用 GATK 和 HaplotypeCaller 命名，而所谓的变异体用 GATK GenotypeGVCFs \citep{poplin2017scaling}进行联合基因分型。基因型变体用 NCBI dbSNP 150 \citep{sherry2001dbsnp}和 ENSEMBL 注释(发行版92)注释，使用 GATK VariantAnnotator 和 snpEff \citep{cingolani2012program}。随后，使用 GATK variantfilling 和 selectvariant 去除强链偏倚变异(Fisher strand &gt; 30)、低质量深度变异(&lt; 2)和35bp 窗口内3个或3个以上单核苷酸多单核苷酸多态性(SNP)变异体。我们还过滤了低深度变异(个体映射读深度[ DP ] &lt; 3，同一品种联合映射读深度 &lt; 6)。最后，利用 gatkselectvariant 和 snpSift \citep{ruden2012using}筛选出外显 snp。</p><p>Workflow:</p><p><img src="/Users/keqinliu/studying_document/bioinfo/human_RME/images/workflow.jpg" alt="workflow"></p></blockquote><blockquote><p>母体读数的比例计算为1 - 父体读数的比例。在该研究中，采用的任意判断等位基因表达偏倚的标准对于任何给定的等位基因都是 &lt; 0.3或 &gt; 0.7。当比值在0.3和0.7之间时，则认为它是双等位基因表达。</p></blockquote><p>利用千人基因组计划鉴别等位基因表达\citep{jadhav2019rna}</p><blockquote><p>数据来源：65 trios from the HapMap / 1000 genomes projects with RNA-Seq data from lymphoblastoid cell lines (LCLs)，and 131 trios from the Genome-of-the-Netherlands （查资料发现好像是血液样本的WGS测序？）</p><p>目前思路：</p><p>先选用4个CHS家庭（一共8位父母的基因组测序数据low coverage，4个孩子的RNA-seq数据，其中两个男孩，两个女孩）试着分析</p></blockquote><p>family trio 1(SH007)</p><p>**Collection UUID:**qr1hi-4zz18-hxa1at658d85c1r（用于在run program时使用）</p><p>*Content address:*d41d8cd98f00b204e9800998ecf8427e+0</p><table><thead><tr><th>HG00421(father)  <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1606795">https://www.ebi.ac.uk/ena/browser/view/SRR1606795</a> (downloaded) (fastq-dump ing) 59520 (bam downloaded)</th></tr></thead><tbody><tr><td>HG00422(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1606537">https://www.ebi.ac.uk/ena/browser/view/SRR1606537</a> (downloaded)(fastq-dump ing) 59419 (bam downloaded)</td></tr><tr><td>HG00423(female child, Lymphoblastoid cell total RNA)  <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432923">https://www.ebi.ac.uk/ena/browser/view/SRX2432923</a> （downloaded）(bam)</td></tr></tbody></table><p>Family trio 2(SH002)</p><table><thead><tr><th>HG00406(father) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1602073">https://www.ebi.ac.uk/ena/browser/view/SRR1602073</a> (fastq-dump ing) 58908 (bam downloaded)</th></tr></thead><tbody><tr><td>HG00407(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1602075">https://www.ebi.ac.uk/ena/browser/view/SRR1602075</a>  (downloading) 42363 (bam downloaded)</td></tr><tr><td>HG00408(female child, Lymphoblastoid cell total RNA) <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432921">https://www.ebi.ac.uk/ena/browser/view/SRX2432921</a> (bam)</td></tr></tbody></table><p>Family trio3(SH014)</p><table><thead><tr><th>HG00442(father) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1607190">https://www.ebi.ac.uk/ena/browser/view/SRR1607190</a> (fastq-dump ing)18181  (downloaded)</th></tr></thead><tbody><tr><td>HG00443(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1606504">https://www.ebi.ac.uk/ena/browser/view/SRR1606504</a> (fastq-dump ing)65250 (downloading bam) 11075</td></tr><tr><td>HG00444(male child, Lymphoblastoid cell total RNA) <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432926">https://www.ebi.ac.uk/ena/browser/view/SRX2432926</a> (bam)</td></tr></tbody></table><p>family trio 4(SH021)</p><table><thead><tr><th>HG00463(father) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1596842">https://www.ebi.ac.uk/ena/browser/view/SRR1596842</a> (mapping) 49012 (downloaded)</th></tr></thead><tbody><tr><td>HG00464(mother) <a href="https://www.ebi.ac.uk/ena/browser/view/SRR1596844">https://www.ebi.ac.uk/ena/browser/view/SRR1596844</a> (prefetching) 13266 (downloaded)</td></tr><tr><td>HG00465(male child, Lymphoblastoid cell total RNA) <a href="https://www.ebi.ac.uk/ena/browser/view/SRX2432931">https://www.ebi.ac.uk/ena/browser/view/SRX2432931</a> (bam)</td></tr></tbody></table><p>QC by fastqc</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">fastqc /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR5117458/SRR5117458.fastq.gz --extract -o /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/fastqc_report <br><br>fastqc /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR5117459/SRR5117459.fastq.gz --extract -o /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/fastqc_report #failed<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">in</span> SH007/fastqc_report</span><br></code></pre></td></tr></table></figure><p>GATK preprocess</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools faidx new_hg19.fa #generate .fai<br>samtools dict new_hg19.fa -o new_hg19.dict # generate .dict<br></code></pre></td></tr></table></figure><p>mapping by STAR/hisat2</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta"> #</span><span class="bash">generate index</span><br> /Users/keqinliu/STAR-2.7.6a/bin/MacOSX_x86_64/STAR --runThreadN 6 --runMode genomeGenerate \<br> --genomeDir /Users/keqinliu/studying_document/bioinfo/human_RME/STAR/SH007 \<br> --genomeFastaFiles /Users/keqinliu/Downloads/hg38.fa \ <br> --sjdbGTFfile /Users/keqinliu/Downloads/human.gtf \<br> --sjdbOverhang 100<br><span class="hljs-meta"> </span><br><span class="hljs-meta"> #</span><span class="bash"> <span class="hljs-keyword">do</span> mapping</span><br> STAR --runThreadN 20 --genomeDir ~/reference/index/STAR/mm10/ \<br> --readFilesIn SRR3589959_1.fastq SRR3589959_2.fastq \<br> --outSAMtype BAM SortedByCoordinate \<br> --outFileNamePrefix ./SRR3589959<br> <br><span class="hljs-meta"> </span><br><span class="hljs-meta">#</span><span class="bash"> the problem is the processing seems never end!</span><br><span class="hljs-meta">#</span><span class="bash"> and STAR took too much storage</span><br><span class="hljs-meta">#</span><span class="bash"> change to hisat2</span><br><span class="hljs-meta">#</span><span class="bash"> ref genome</span><br><br>hisat2 -x /Users/keqinliu/Downloads/hg38/genome \<br>-1 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.fastq.gz \<br>-S /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.sam <br><span class="hljs-meta">#</span><span class="bash"> report error</span><br><span class="hljs-meta">#</span><span class="bash"> Error: Must specify at least one <span class="hljs-built_in">read</span> input with -U/-1/-2</span><br><span class="hljs-meta">#</span><span class="bash"> Overall time: 00:00:00</span><br><span class="hljs-meta">#</span><span class="bash"> (ERR): hisat2-align exited with value 1</span><br><br>hisat2 -x /Users/keqinliu/Downloads/hg38/genome \<br>-U /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.fastq.gz \<br>-S /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR1606795.sam # it works<br><br><br></code></pre></td></tr></table></figure><p>Mac turn off/on </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo pmset -b sleep 0; sudo pmset -b disablesleep 1 # sleep function off<br><br>sudo pmset -b sleep 5; sudo pmset -b disablesleep 0 # sleep function on<br></code></pre></td></tr></table></figure><p>report</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># SRR2432923.sam(child)</span><br><span class="hljs-attribute">2599467</span> reads; of these:<br>  <span class="hljs-attribute">2599467</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">149548</span> (<span class="hljs-number">5</span>.<span class="hljs-number">75</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">1933123</span> (<span class="hljs-number">74</span>.<span class="hljs-number">37</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">516796</span> (<span class="hljs-number">19</span>.<span class="hljs-number">88</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">94</span>.<span class="hljs-number">25</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR1606795.sam(mother)</span><br><span class="hljs-attribute">3638957</span> reads; of these:<br>  <span class="hljs-attribute">3638957</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">727664</span> (<span class="hljs-number">20</span>.<span class="hljs-number">00</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">2715042</span> (<span class="hljs-number">74</span>.<span class="hljs-number">61</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">196251</span> (<span class="hljs-number">5</span>.<span class="hljs-number">39</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">80</span>.<span class="hljs-number">00</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR1606537.sam(father)</span><br><br><span class="hljs-comment"># SRR1602073.sam (father)</span><br><span class="hljs-attribute">2507162</span> reads; of these:<br>  <span class="hljs-attribute">2507162</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">302285</span> (<span class="hljs-number">12</span>.<span class="hljs-number">06</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">2065134</span> (<span class="hljs-number">82</span>.<span class="hljs-number">37</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">139743</span> (<span class="hljs-number">5</span>.<span class="hljs-number">57</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">87</span>.<span class="hljs-number">94</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR1602075.sam (mother)</span><br><span class="hljs-attribute">gzip</span>: /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH<span class="hljs-number">002</span>/SRR<span class="hljs-number">1602075</span>/SRR<span class="hljs-number">1602075</span>.fastq.gz: unexpected end of file<br><span class="hljs-attribute">gzip</span>: /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH<span class="hljs-number">002</span>/SRR<span class="hljs-number">1602075</span>/SRR<span class="hljs-number">1602075</span>.fastq.gz: uncompress failed<br><span class="hljs-attribute">6341028</span> reads; of these:<br>  <span class="hljs-attribute">6341028</span> (<span class="hljs-number">100</span>.<span class="hljs-number">00</span>%) were unpaired; of these:<br>    <span class="hljs-attribute">290072</span> (<span class="hljs-number">4</span>.<span class="hljs-number">57</span>%) aligned <span class="hljs-number">0</span> times<br>    <span class="hljs-attribute">5817396</span> (<span class="hljs-number">91</span>.<span class="hljs-number">74</span>%) aligned exactly <span class="hljs-number">1</span> time<br>    <span class="hljs-attribute">233560</span> (<span class="hljs-number">3</span>.<span class="hljs-number">68</span>%) aligned &gt;<span class="hljs-number">1</span> times<br><span class="hljs-attribute">95</span>.<span class="hljs-number">43</span>% overall alignment rate<br><br><span class="hljs-comment"># SRR5117454.sam(child)</span><br><br></code></pre></td></tr></table></figure><p>sam to bam</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> SH007</span><br>samtools view -S SRR2432923.sam -b &gt; SRR2432923.bam #child<br>samtools view -S SRR1606795.sam -b &gt; SRR1606795.bam #mother<br>samtools view -S SRR1606537.sam -b &gt; SRR1606537.bam #father<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> SH002</span><br>samtools view -S SRR1602073.sam -b &gt; SRR1602073.bam #father<br>samtools view -S SRR1602075.sam -b &gt; SRR1602075.bam #mother<br>samtools view -S SRR5117454.sam -b &gt; SRR5117454.bam<br></code></pre></td></tr></table></figure><p>GATK hyplotypeCaller</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs shell">/Users/keqinliu/Downloads/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>   -R /Users/keqinliu/Downloads/resources_broad_hg38_v0_Homo_sapiens_assembly38.fasta \<br>   -I /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR2432923.bam \ # child<br>   -O /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRR2432923.g.vcf.gz \<br>   -ERC GVCF <br>   -G Standard \<br>   -G AS_Standard<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> report error!</span><br><span class="hljs-meta">#</span><span class="bash"> </span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">then</span> try to check whether bam file is damaged</span><br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH007/SRX2432923/SRR2432923.bam<br><span class="hljs-meta">#</span><span class="bash"> ruturn 0</span><br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH002/SRR1602073.bam <br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH002/SRR5117454.bam <br><span class="hljs-meta">#</span><span class="bash"> all <span class="hljs-built_in">return</span> 0</span><br><span class="hljs-meta">#</span><span class="bash"> so bam file is damaged</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> check whether sam file is damaged</span><br>samtools view -c -f 1 -F 12 /Users/keqinliu/studying_document/bioinfo/human_RME/raw_data/SH002/SRR1602073.sam<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">return</span> 0</span><br><span class="hljs-meta">#</span><span class="bash"> so sam file is dameged</span><br></code></pre></td></tr></table></figure><p>GATK GenotypeGVCFs</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs"><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">ascp -k <span class="hljs-number">1</span> -QT -l <span class="hljs-number">300</span>m -P33001 -i ~<span class="hljs-regexp">/.aspera/</span>connect<span class="hljs-regexp">/etc/</span>asperaweb_id_dsa.openssh era-fasp@fasp.sra.ebi.ac.uk:<span class="hljs-variable">$SRR1606795</span>.<br><br>ascp -i asperaweb_id_dsa.openssh -Tr -Q -l <span class="hljs-number">6</span>M -P33001 -L- -k1 era-fasp@fasp.sra.ebi.ac.uk:<span class="hljs-regexp">/vol1/</span>fastq<span class="hljs-regexp">/SRR160/</span><span class="hljs-number">007</span><span class="hljs-regexp">/SRR1606537/</span>SRR1606537.fastq.gz<br><br>ascp -k <span class="hljs-number">1</span> -QT -l <span class="hljs-number">300</span>m -P33001 -i ~<span class="hljs-regexp">/.aspera/</span>connect<span class="hljs-regexp">/etc/</span>asperaweb_id_dsa.openssh anonftp@ftp-private.ncbi.nlm.nih.gov:<span class="hljs-regexp">//</span>sra<span class="hljs-regexp">/sra-instant/</span>reads<span class="hljs-regexp">/ByExp/</span>sra<span class="hljs-regexp">/SRX/</span>SRX727<span class="hljs-regexp">/SRX727828/</span>SRR1606795/SRR1606795.sra.<br><br>ascp -v -QT -l <span class="hljs-number">400</span>m -P33001 -k1 -i ~<span class="hljs-regexp">/.aspera/</span>connect<span class="hljs-regexp">/etc/</span>asperaweb_id_dsa.openssh anonftp@ftp.ncbi.nlm.nih.gov:<span class="hljs-regexp">/sra/</span>sra-instant<span class="hljs-regexp">/reads/</span>ByRun<span class="hljs-regexp">/sra/</span>SRR<span class="hljs-regexp">/SRR160/</span>SRR1606795/SRR1606795.sra. <br><br>ftp.sra.ebi.ac.uk<span class="hljs-regexp">/vol1/</span>fastq<span class="hljs-regexp">/SRR160/</span><span class="hljs-number">007</span><span class="hljs-regexp">/SRR1606537/</span>SRR1606537.fastq.gz<br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>sratoolkit.<span class="hljs-number">2.10</span>.<span class="hljs-number">8</span>-ubuntu64<span class="hljs-regexp">/bin/</span>fastq-<span class="hljs-keyword">dump</span> -I --split-files<br><br><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>sratoolkit.<span class="hljs-number">2.10</span>.<span class="hljs-number">8</span>-ubuntu64<span class="hljs-regexp">/bin/</span>prefetch SRR1602075<br></code></pre></td></tr></table></figure><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">STAR <span class="hljs-params">--genomeDir</span> <span class="hljs-string">/data/mouse/human_rme/genome_index</span> \<br>    <span class="hljs-params">--runThreadN</span> 20 \<br>    <span class="hljs-params">--readFilesIn</span> sample_r1.fq.gz sample_r2.fq.gz \<br>    <span class="hljs-comment"># --readFilesCommand zcat \</span><br>    <span class="hljs-params">--outFileNamePrefix</span> sample \<br>    <span class="hljs-params">--outSAMtype</span> BAM SortedByCoordinate \<br>    <span class="hljs-params">--outBAMsortingThreadN</span> 10<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index<span class="hljs-regexp">/gatk-4.1.9.0/g</span>atk --java-options <span class="hljs-string">&quot;-Xmx4g&quot;</span> HaplotypeCaller  \<br>   -R <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index/hg19.fa \<br>   -I <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>SH007/SRR5117458.<span class="hljs-number">1</span>.bam \ <span class="hljs-comment"># child</span><br>   -O <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>SH007/SRR5117458.<span class="hljs-number">1</span>.g.vcf.gz \<br>   -ERC GVCF <br>   -G Standard \<br>   -G AS_Standard<br><br>https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/samtools/</span>samtools<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/1.11/</span>samtools-<span class="hljs-number">1.11</span>.tar.bz2<br></code></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@RG</span> <span class="hljs-attribute">ID</span>:HG00423  <span class="hljs-attribute">PL</span>:illumina <span class="hljs-attribute">PU</span>:H0164ALXX140820.<span class="hljs-number">2</span>    <span class="hljs-attribute">LB</span>:Solexa-<span class="hljs-number">272222</span>    <span class="hljs-attribute">PI</span>:<span class="hljs-number">0</span>    <span class="hljs-attribute">DT</span>:<span class="hljs-number">2014</span><span class="hljs-attribute">-08-20T00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>-<span class="hljs-number">0400</span> <span class="hljs-attribute">SM</span>:NA12878  <span class="hljs-attribute">CN</span>:BI<br></code></pre></td></tr></table></figure><p>use GATK to do with 1000genome bam file </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/hg19.fa \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam \<br>-O /data/mouse/human_rme/SH007/HG00421.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>error report:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-keyword">A</span> USER ERROR has occurred: Input files reference and reads have incompatible contigs: No overlapping contigs found.<br>  reference contigs = [chr1, chr2, chr3, chr4, chr5, chr6, chr7, chrX, chr8, chr9, chr10, chr11]<br>  reads contigs = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, X, Y, MT, GL<span class="hljs-number">000207.1</span>, GL<span class="hljs-number">000226.1</span>, GL<span class="hljs-number">000229.1</span>, GL<span class="hljs-number">000231.1</span>, GL<span class="hljs-number">000210.1</span>, GL<span class="hljs-number">000239.1</span>, GL<span class="hljs-number">000235.1</span>, GL<span class="hljs-number">000201.1</span>, GL<span class="hljs-number">000247.1</span>, GL<span class="hljs-number">000245.1</span>, GL<span class="hljs-number">000197.1</span>, GL<span class="hljs-number">000203.1</span>, GL<span class="hljs-number">000246.1</span>, GL<span class="hljs-number">000249.1</span>, GL<span class="hljs-number">000196.1</span>, GL<span class="hljs-number">000248.1</span>, GL<span class="hljs-number">000244.1</span>, GL<span class="hljs-number">000238.1</span>, GL<span class="hljs-number">000202.1</span>, GL<span class="hljs-number">000234.1</span>, GL<span class="hljs-number">000232.1</span>, GL<span class="hljs-number">000206.1</span>, GL<span class="hljs-number">000240.1</span>, GL<span class="hljs-number">000236.1</span>, GL<span class="hljs-number">000241.1</span>, GL<span class="hljs-number">000243.1</span>, GL<span class="hljs-number">000242.1</span>, GL<span class="hljs-number">000230.1</span>, GL<span class="hljs-number">000237.1</span>, GL<span class="hljs-number">000233.1</span>, GL<span class="hljs-number">000204.1</span>, GL<span class="hljs-number">000198.1</span>, GL<span class="hljs-number">000208.1</span>, GL<span class="hljs-number">000191.1</span>, GL<span class="hljs-number">000227.1</span>, GL<span class="hljs-number">000228.1</span>, GL<span class="hljs-number">000214.1</span>, GL<span class="hljs-number">000221.1</span>, GL<span class="hljs-number">000209.1</span>, GL<span class="hljs-number">000218.1</span>, GL<span class="hljs-number">000220.1</span>, GL<span class="hljs-number">000213.1</span>, GL<span class="hljs-number">000211.1</span>, GL<span class="hljs-number">000199.1</span>, GL<span class="hljs-number">000217.1</span>, GL<span class="hljs-number">000216.1</span>, GL<span class="hljs-number">000215.1</span>, GL<span class="hljs-number">000205.1</span>, GL<span class="hljs-number">000219.1</span>, GL<span class="hljs-number">000224.1</span>, GL<span class="hljs-number">000223.1</span>, GL<span class="hljs-number">000195.1</span>, GL<span class="hljs-number">000212.1</span>, GL<span class="hljs-number">000222.1</span>, GL<span class="hljs-number">000200.1</span>, GL<span class="hljs-number">000193.1</span>, GL<span class="hljs-number">000194.1</span>, GL<span class="hljs-number">000225.1</span>, GL<span class="hljs-number">000192.1</span>, NC_007605, hs37d5]<br></code></pre></td></tr></table></figure><p>Use hg19 ref genome</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/hg19.fa \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam \<br>-O /data/mouse/human_rme/SH007/HG00421.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>error report:</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-keyword">A</span> USER ERROR has occurred: Input files reference and reads have incompatible contigs: No overlapping contigs found.<br>  reference contigs = [chr1, chr2, chr3, chr4, chr5, chr6, chr7, chrX, chr8, chr9, chr10, chr11]<br>  reads contigs = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">15</span>, <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, X, Y, MT, GL<span class="hljs-number">000207.1</span>, GL<span class="hljs-number">000226.1</span>, GL<span class="hljs-number">000229.1</span>, GL<span class="hljs-number">000231.1</span>, GL<span class="hljs-number">000210.1</span>, GL<span class="hljs-number">000239.1</span>, GL<span class="hljs-number">000235.1</span>, GL<span class="hljs-number">000201.1</span>, GL<span class="hljs-number">000247.1</span>, GL<span class="hljs-number">000245.1</span>, GL<span class="hljs-number">000197.1</span>, GL<span class="hljs-number">000203.1</span>, GL<span class="hljs-number">000246.1</span>, GL<span class="hljs-number">000249.1</span>, GL<span class="hljs-number">000196.1</span>, GL<span class="hljs-number">000248.1</span>, GL<span class="hljs-number">000244.1</span>, GL<span class="hljs-number">000238.1</span>, GL<span class="hljs-number">000202.1</span>, GL<span class="hljs-number">000234.1</span>, GL<span class="hljs-number">000232.1</span>, GL<span class="hljs-number">000206.1</span>, GL<span class="hljs-number">000240.1</span>, GL<span class="hljs-number">000236.1</span>, GL<span class="hljs-number">000241.1</span>, GL<span class="hljs-number">000243.1</span>, GL<span class="hljs-number">000242.1</span>, GL<span class="hljs-number">000230.1</span>, GL<span class="hljs-number">000237.1</span>, GL<span class="hljs-number">000233.1</span>, GL<span class="hljs-number">000204.1</span>, GL<span class="hljs-number">000198.1</span>, GL<span class="hljs-number">000208.1</span>, GL<span class="hljs-number">000191.1</span>, GL<span class="hljs-number">000227.1</span>, GL<span class="hljs-number">000228.1</span>, GL<span class="hljs-number">000214.1</span>, GL<span class="hljs-number">000221.1</span>, GL<span class="hljs-number">000209.1</span>, GL<span class="hljs-number">000218.1</span>, GL<span class="hljs-number">000220.1</span>, GL<span class="hljs-number">000213.1</span>, GL<span class="hljs-number">000211.1</span>, GL<span class="hljs-number">000199.1</span>, GL<span class="hljs-number">000217.1</span>, GL<span class="hljs-number">000216.1</span>, GL<span class="hljs-number">000215.1</span>, GL<span class="hljs-number">000205.1</span>, GL<span class="hljs-number">000219.1</span>, GL<span class="hljs-number">000224.1</span>, GL<span class="hljs-number">000223.1</span>, GL<span class="hljs-number">000195.1</span>, GL<span class="hljs-number">000212.1</span>, GL<span class="hljs-number">000222.1</span>, GL<span class="hljs-number">000200.1</span>, GL<span class="hljs-number">000193.1</span>, GL<span class="hljs-number">000194.1</span>, GL<span class="hljs-number">000225.1</span>, GL<span class="hljs-number">000192.1</span>, NC_007605, hs37d5]<br></code></pre></td></tr></table></figure><p>use hg38 get error report</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs smali">A USER ERROR has occurred: Input files reference<span class="hljs-built_in"> and </span>reads have incompatible contigs: No overlapping contigs found.<br>  reference contigs = [chr1, chr10, chr11, chr11_KI270721v1_random, chr12, chr13, chr14, chr14_GL000009v2_random, chr14_GL000225v1_random, chr14_KI270722v1_random, chr14_GL000194v1_random, chr14_KI270723v1_random, chr14_KI270724v1_random, chr14_KI270725v1_random, chr14_KI270726v1_random, chr15, chr15_KI270727v1_random, chr16, chr16_KI270728v1_random, chr17, chr17_GL000205v2_random, chr17_KI270729v1_random, chr17_KI270730v1_random, chr18, chr19, chr1_KI270706v1_random, chr1_KI270707v1_random, chr1_KI270708v1_random, chr1_KI270709v1_random, chr1_KI270710v1_random, chr1_KI270711v1_random, chr1_KI270712v1_random, chr1_KI270713v1_random, chr1_KI270714v1_random, chr2, chr20, chr21, chr22, chr22_KI270731v1_random, chr22_KI270732v1_random, chr22_KI270733v1_random, chr22_KI270734v1_random, chr22_KI270735v1_random, chr22_KI270736v1_random, chr22_KI270737v1_random, chr22_KI270738v1_random, chr22_KI270739v1_random, chr2_KI270715v1_random, chr2_KI270716v1_random, chr3, chr3_GL000221v1_random, chr4, chr4_GL000008v2_random, chr5, chr5_GL000208v1_random, chr6, chr7, chr8, chr9, chr9_KI270717v1_random, chr9_KI270718v1_random, chr9_KI270719v1_random, chr9_KI270720v1_random, chr1_KI270762v1_alt, chr1_KI270766v1_alt, chr1_KI270760v1_alt, chr1_KI270765v1_alt, chr1_GL383518v1_alt, chr1_GL383519v1_alt, chr1_GL383520v2_alt, chr1_KI270764v1_alt, chr1_KI270763v1_alt, chr1_KI270759v1_alt, chr1_KI270761v1_alt, chr2_KI270770v1_alt, chr2_KI270773v1_alt, chr2_KI270774v1_alt, chr2_KI270769v1_alt, chr2_GL383521v1_alt, chr2_KI270772v1_alt, chr2_KI270775v1_alt, chr2_KI270771v1_alt, chr2_KI270768v1_alt, chr2_GL582966v2_alt, chr2_GL383522v1_alt, chr2_KI270776v1_alt, chr2_KI270767v1_alt, chr3_JH636055v2_alt, chr3_KI270783v1_alt, chr3_KI270780v1_alt, chr3_GL383526v1_alt, chr3_KI270777v1_alt, chr3_KI270778v1_alt, chr3_KI270781v1_alt, chr3_KI270779v1_alt, chr3_KI270782v1_alt, chr3_KI270784v1_alt, chr4_KI270790v1_alt, chr4_GL383528v1_alt, chr4_KI270787v1_alt, chr4_GL000257v2_alt, chr4_KI270788v1_alt, chr4_GL383527v1_alt, chr4_KI270785v1_alt, chr4_KI270789v1_alt, chr4_KI270786v1_alt, chr5_KI270793v1_alt, chr5_KI270792v1_alt, chr5_KI270791v1_alt, chr5_GL383532v1_alt, chr5_GL949742v1_alt, chr5_KI270794v1_alt, chr5_GL339449v2_alt, chr5_GL383530v1_alt, chr5_KI270796v1_alt, chr5_GL383531v1_alt, chr5_KI270795v1_alt, chr6_GL000250v2_alt, chr6_KI270800v1_alt, chr6_KI270799v1_alt, chr6_GL383533v1_alt, chr6_KI270801v1_alt, chr6_KI270802v1_alt, chr6_KB021644v2_alt, chr6_KI270797v1_alt, chr6_KI270798v1_alt, chr7_KI270804v1_alt, chr7_KI270809v1_alt, chr7_KI270806v1_alt, chr7_GL383534v2_alt, chr7_KI270803v1_alt, chr7_KI270808v1_alt, chr7_KI270807v1_alt, chr7_KI270805v1_alt, chr8_KI270818v1_alt, chr8_KI270812v1_alt, chr8_KI270811v1_alt, chr8_KI270821v1_alt, chr8_KI270813v1_alt, chr8_KI270822v1_alt, chr8_KI270814v1_alt, chr8_KI270810v1_alt, chr8_KI270819v1_alt, chr8_KI270820v1_alt, chr8_KI270817v1_alt, chr8_KI270816v1_alt, chr8_KI270815v1_alt, chr9_GL383539v1_alt, chr9_GL383540v1_alt, chr9_GL383541v1_alt, chr9_GL383542v1_alt, chr9_KI270823v1_alt, chr10_GL383545v1_alt, chr10_KI270824v1_alt, chr10_GL383546v1_alt, chr10_KI270825v1_alt, chr11_KI270832v1_alt, chr11_KI270830v1_alt, chr11_KI270831v1_alt, chr11_KI270829v1_alt, chr11_GL383547v1_alt, chr11_JH159136v1_alt, chr11_JH159137v1_alt, chr11_KI270827v1_alt, chr11_KI270826v1_alt, chr12_GL877875v1_alt, chr12_GL877876v1_alt, chr12_KI270837v1_alt, chr12_GL383549v1_alt, chr12_KI270835v1_alt, chr12_GL383550v2_alt, chr12_GL383552v1_alt, chr12_GL383553v2_alt, chr12_KI270834v1_alt, chr12_GL383551v1_alt, chr12_KI270833v1_alt, chr12_KI270836v1_alt, chr13_KI270840v1_alt, chr13_KI270839v1_alt, chr13_KI270843v1_alt, chr13_KI270841v1_alt, chr13_KI270838v1_alt, chr13_KI270842v1_alt, chr14_KI270844v1_alt, chr14_KI270847v1_alt, chr14_KI270845v1_alt, chr14_KI270846v1_alt, chr15_KI270852v1_alt, chr15_KI270851v1_alt, chr15_KI270848v1_alt, chr15_GL383554v1_alt, chr15_KI270849v1_alt, chr15_GL383555v2_alt, chr15_KI270850v1_alt, chr16_KI270854v1_alt, chr16_KI270856v1_alt, chr16_KI270855v1_alt, chr16_KI270853v1_alt, chr16_GL383556v1_alt, chr16_GL383557v1_alt, chr17_GL383563v3_alt, chr17_KI270862v1_alt, chr17_KI270861v1_alt, chr17_KI270857v1_alt, chr17_JH159146v1_alt, chr17_JH159147v1_alt, chr17_GL383564v2_alt, chr17_GL000258v2_alt, chr17_GL383565v1_alt, chr17_KI270858v1_alt, chr17_KI270859v1_alt, chr17_GL383566v1_alt, chr17_KI270860v1_alt, chr18_KI270864v1_alt, chr18_GL383567v1_alt, chr18_GL383570v1_alt, chr18_GL383571v1_alt, chr18_GL383568v1_alt, chr18_GL383569v1_alt, chr18_GL383572v1_alt, chr18_KI270863v1_alt, chr19_KI270868v1_alt, chr19_KI270865v1_alt, chr19_GL383573v1_alt, chr19_GL383575v2_alt, chr19_GL383576v1_alt, chr19_GL383574v1_alt, chr19_KI270866v1_alt, chr19_KI270867v1_alt, chr19_GL949746v1_alt, chr20_GL383577v2_alt, chr20_KI270869v1_alt, chr20_KI270871v1_alt, chr20_KI270870v1_alt, chr21_GL383578v2_alt, chr21_KI270874v1_alt, chr21_KI270873v1_alt, chr21_GL383579v2_alt, chr21_GL383580v2_alt, chr21_GL383581v2_alt, chr21_KI270872v1_alt, chr22_KI270875v1_alt, chr22_KI270878v1_alt, chr22_KI270879v1_alt, chr22_KI270876v1_alt, chr22_KI270877v1_alt, chr22_GL383583v2_alt, chr22_GL383582v2_alt, chrX_KI270880v1_alt, chrX_KI270881v1_alt, chr19_KI270882v1_alt, chr19_KI270883v1_alt, chr19_KI270884v1_alt, chr19_KI270885v1_alt, chr19_KI270886v1_alt, chr19_KI270887v1_alt, chr19_KI270888v1_alt, chr19_KI270889v1_alt, chr19_KI270890v1_alt, chr19_KI270891v1_alt, chr1_KI270892v1_alt, chr2_KI270894v1_alt, chr2_KI270893v1_alt, chr3_KI270895v1_alt, chr4_KI270896v1_alt, chr5_KI270897v1_alt, chr5_KI270898v1_alt, chr6_GL000251v2_alt, chr7_KI270899v1_alt, chr8_KI270901v1_alt, chr8_KI270900v1_alt, chr11_KI270902v1_alt, chr11_KI270903v1_alt, chr12_KI270904v1_alt, chr15_KI270906v1_alt, chr15_KI270905v1_alt, chr17_KI270907v1_alt, chr17_KI270910v1_alt, chr17_KI270909v1_alt, chr17_JH159148v1_alt, chr17_KI270908v1_alt, chr18_KI270912v1_alt, chr18_KI270911v1_alt, chr19_GL949747v2_alt, chr22_KB663609v1_alt, chrX_KI270913v1_alt, chr19_KI270914v1_alt, chr19_KI270915v1_alt, chr19_KI270916v1_alt, chr19_KI270917v1_alt, chr19_KI270918v1_alt, chr19_KI270919v1_alt, chr19_KI270920v1_alt, chr19_KI270921v1_alt, chr19_KI270922v1_alt, chr19_KI270923v1_alt, chr3_KI270924v1_alt, chr4_KI270925v1_alt, chr6_GL000252v2_alt, chr8_KI270926v1_alt, chr11_KI270927v1_alt, chr19_GL949748v2_alt, chr22_KI270928v1_alt, chr19_KI270929v1_alt, chr19_KI270930v1_alt, chr19_KI270931v1_alt, chr19_KI270932v1_alt, chr19_KI270933v1_alt, chr19_GL000209v2_alt, chr3_KI270934v1_alt, chr6_GL000253v2_alt, chr19_GL949749v2_alt, chr3_KI270935v1_alt, chr6_GL000254v2_alt, chr19_GL949750v2_alt, chr3_KI270936v1_alt, chr6_GL000255v2_alt, chr19_GL949751v2_alt, chr3_KI270937v1_alt, chr6_GL000256v2_alt, chr19_GL949752v1_alt, chr6_KI270758v1_alt, chr19_GL949753v2_alt, chr19_KI270938v1_alt, chrM, chrUn_KI270302v1, chrUn_KI270304v1, chrUn_KI270303v1, chrUn_KI270305v1, chrUn_KI270322v1, chrUn_KI270320v1, chrUn_KI270310v1, chrUn_KI270316v1, chrUn_KI270315v1, chrUn_KI270312v1, chrUn_KI270311v1, chrUn_KI270317v1, chrUn_KI270412v1, chrUn_KI270411v1, chrUn_KI270414v1, chrUn_KI270419v1, chrUn_KI270418v1, chrUn_KI270420v1, chrUn_KI270424v1, chrUn_KI270417v1, chrUn_KI270422v1, chrUn_KI270423v1, chrUn_KI270425v1, chrUn_KI270429v1, chrUn_KI270442v1, chrUn_KI270466v1, chrUn_KI270465v1, chrUn_KI270467v1, chrUn_KI270435v1, chrUn_KI270438v1, chrUn_KI270468v1, chrUn_KI270510v1, chrUn_KI270509v1, chrUn_KI270518v1, chrUn_KI270508v1, chrUn_KI270516v1, chrUn_KI270512v1, chrUn_KI270519v1, chrUn_KI270522v1, chrUn_KI270511v1, chrUn_KI270515v1, chrUn_KI270507v1, chrUn_KI270517v1, chrUn_KI270529v1, chrUn_KI270528v1, chrUn_KI270530v1, chrUn_KI270539v1, chrUn_KI270538v1, chrUn_KI270544v1, chrUn_KI270548v1, chrUn_KI270583v1, chrUn_KI270587v1, chrUn_KI270580v1, chrUn_KI270581v1, chrUn_KI270579v1, chrUn_KI270589v1, chrUn_KI270590v1, chrUn_KI270584v1, chrUn_KI270582v1, chrUn_KI270588v1, chrUn_KI270593v1, chrUn_KI270591v1, chrUn_KI270330v1, chrUn_KI270329v1, chrUn_KI270334v1, chrUn_KI270333v1, chrUn_KI270335v1, chrUn_KI270338v1, chrUn_KI270340v1, chrUn_KI270336v1, chrUn_KI270337v1, chrUn_KI270363v1, chrUn_KI270364v1, chrUn_KI270362v1, chrUn_KI270366v1, chrUn_KI270378v1, chrUn_KI270379v1, chrUn_KI270389v1, chrUn_KI270390v1, chrUn_KI270387v1, chrUn_KI270395v1, chrUn_KI270396v1, chrUn_KI270388v1, chrUn_KI270394v1, chrUn_KI270386v1, chrUn_KI270391v1, chrUn_KI270383v1, chrUn_KI270393v1, chrUn_KI270384v1, chrUn_KI270392v1, chrUn_KI270381v1, chrUn_KI270385v1, chrUn_KI270382v1, chrUn_KI270376v1, chrUn_KI270374v1, chrUn_KI270372v1, chrUn_KI270373v1, chrUn_KI270375v1, chrUn_KI270371v1, chrUn_KI270448v1, chrUn_KI270521v1, chrUn_GL000195v1, chrUn_GL000219v1, chrUn_GL000220v1, chrUn_GL000224v1, chrUn_KI270741v1, chrUn_GL000226v1, chrUn_GL000213v1, chrUn_KI270743v1, chrUn_KI270744v1, chrUn_KI270745v1, chrUn_KI270746v1, chrUn_KI270747v1, chrUn_KI270748v1, chrUn_KI270749v1, chrUn_KI270750v1, chrUn_KI270751v1, chrUn_KI270752v1, chrUn_KI270753v1, chrUn_KI270754v1, chrUn_KI270755v1, chrUn_KI270756v1, chrUn_KI270757v1, chrUn_GL000214v1, chrUn_KI270742v1, chrUn_GL000216v2, chrUn_GL000218v1, chrX, chrY, chrY_KI270740v1_random, chr1_KQ031383v1_fix, chr1_KQ983255v1_alt, chr1_KN538361v1_fix, chr1_KQ458383v1_alt, chr1_KN196473v1_fix, chr1_KZ208904v1_alt, chr1_KN196472v1_fix, chr1_KZ208905v1_alt, chr1_KQ458382v1_alt, chr1_KV880763v1_alt, chr1_KN196474v1_fix, chr1_KN538360v1_fix, chr1_KZ208906v1_fix, chr1_KQ458384v1_alt, chr2_KQ031384v1_fix, chr2_KZ208907v1_alt, chr2_KQ983256v1_alt, chr2_KZ208908v1_alt, chr2_KN538363v1_fix, chr2_KN538362v1_fix, chr3_KV766192v1_fix, chr3_KN196475v1_fix, chr3_KQ031385v1_fix, chr3_KN538364v1_fix, chr3_KZ208909v1_alt, chr3_KQ031386v1_fix, chr3_KN196476v1_fix, chr4_KQ090013v1_alt, chr4_KQ090014v1_alt, chr4_KQ090015v1_alt, chr4_KV766193v1_alt, chr4_KQ983257v1_fix, chr4_KQ983258v1_alt, chr5_KZ208910v1_alt, chr5_KN196477v1_alt, chr5_KV575243v1_alt, chr5_KV575244v1_fix, chr6_KZ208911v1_fix, chr6_KQ090017v1_alt, chr6_KQ031387v1_fix, chr6_KN196478v1_fix, chr6_KQ090016v1_fix, chr6_KV766194v1_fix, chr7_KV880764v1_fix, chr7_KV880765v1_fix, chr7_KZ208912v1_fix, chr7_KZ208913v1_alt, chr7_KQ031388v1_fix, chr8_KZ208915v1_fix, chr8_KV880767v1_fix, chr8_KV880766v1_fix, chr8_KZ208914v1_fix, chr9_KQ090018v1_alt, chr9_KQ090019v1_alt, chr9_KN196479v1_fix, chr10_KN538367v1_fix, chr10_KQ090020v1_alt, chr10_KN196480v1_fix, chr10_KQ090021v1_fix, chr10_KN538366v1_fix, chr10_KN538365v1_fix, chr11_KQ759759v1_fix, chr11_KN538368v1_alt, chr11_KV766195v1_fix, chr11_KQ090022v1_fix, chr11_KN196481v1_fix, chr12_KQ090023v1_alt, chr12_KZ208916v1_fix, chr12_KN538369v1_fix, chr12_KN196482v1_fix, chr12_KZ208918v1_alt, chr12_KQ759760v1_fix, chr12_KZ208917v1_fix, chr12_KN538370v1_fix, chr13_KN538372v1_fix, chr13_KQ090024v1_alt, chr13_KN196483v1_fix, chr13_KN538373v1_fix, chr13_KQ090025v1_alt, chr13_KN538371v1_fix, chr14_KZ208920v1_fix, chr14_KZ208919v1_alt, chr15_KN538374v1_fix, chr15_KQ031389v1_alt, chr16_KQ090026v1_alt, chr16_KV880768v1_fix, chr16_KQ090027v1_alt, chr16_KZ208921v1_alt, chr16_KQ031390v1_alt, chr17_KV766196v1_fix, chr17_KV575245v1_fix, chr17_KV766198v1_alt, chr17_KV766197v1_alt, chr18_KQ458385v1_alt, chr18_KQ090028v1_fix, chr18_KZ208922v1_fix, chr19_KQ458386v1_fix, chr19_KN196484v1_fix, chr19_KV575246v1_alt, chr19_KV575247v1_alt, chr19_KV575248v1_alt, chr19_KV575249v1_alt, chr19_KV575250v1_alt, chr19_KV575251v1_alt, chr19_KV575252v1_alt, chr19_KV575253v1_alt, chr19_KV575254v1_alt, chr19_KV575255v1_alt, chr19_KV575256v1_alt, chr19_KV575257v1_alt, chr19_KV575259v1_alt, chr19_KV575260v1_alt, chr19_KV575258v1_alt, chr22_KN196485v1_alt, chr22_KQ458387v1_alt, chr22_KQ458388v1_alt, chr22_KN196486v1_alt, chr22_KQ759761v1_alt, chr22_KQ759762v1_fix, chrX_KV766199v1_alt, chrY_KZ208923v1_fix, chrY_KZ208924v1_fix, chrY_KN196487v1_fix, chr1_KZ559100v1_fix, chr3_KZ559104v1_fix, chr3_KZ559105v1_alt, chr3_KZ559103v1_alt, chr3_KZ559102v1_alt, chr3_KZ559101v1_alt, chr7_KZ559106v1_alt, chr8_KZ559107v1_alt, chr11_KZ559109v1_fix, chr11_KZ559108v1_fix, chr11_KZ559111v1_alt, chr11_KZ559110v1_alt, chr12_KZ559112v1_alt, chr16_KZ559113v1_fix, chr17_KZ559114v1_alt, chr18_KZ559116v1_alt, chr18_KZ559115v1_fix]<br>  reads contigs = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, X, Y, MT, GL000207.1, GL000226.1, GL000229.1, GL000231.1, GL000210.1, GL000239.1, GL000235.1, GL000201.1, GL000247.1, GL000245.1, GL000197.1, GL000203.1, GL000246.1, GL000249.1, GL000196.1, GL000248.1, GL000244.1, GL000238.1, GL000202.1, GL000234.1, GL000232.1, GL000206.1, GL000240.1, GL000236.1, GL000241.1, GL000243.1, GL000242.1, GL000230.1, GL000237.1, GL000233.1, GL000204.1, GL000198.1, GL000208.1, GL000191.1, GL000227.1, GL000228.1, GL000214.1, GL000221.1, GL000209.1, GL000218.1, GL000220.1, GL000213.1, GL000211.1, GL000199.1, GL000217.1, GL000216.1, GL000215.1, GL000205.1, GL000219.1, GL000224.1, GL000223.1, GL000195.1, GL000212.1, GL000222.1, GL000200.1, GL000193.1, GL000194.1, GL000225.1, GL000192.1, NC_007605, hs37d5]<br><br>***********************************************************************<br>Set the<span class="hljs-keyword"> system</span> property GATK_STACKTRACE_ON_USER_EXCEPTION (--java-options &#x27;-DGATK_STACKTRACE_ON_USER_EXCEPTION=true&#x27;) to print the stack trace.<br></code></pre></td></tr></table></figure><p>Use human_g1k_v37.fasta as reference genome</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam \<br>-O /data/mouse/human_rme/SH007/HG00421.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>error report</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">A USER ERROR <span class="hljs-built_in">has</span> occurred: Traversal by intervals was requested but some <span class="hljs-built_in">input</span> <span class="hljs-keyword">files</span> are not indexed.<br>Please <span class="hljs-built_in">index</span> <span class="hljs-keyword">all</span> <span class="hljs-built_in">input</span> <span class="hljs-keyword">file</span><span class="hljs-variable">s:</span><br><br>samtools <span class="hljs-built_in">index</span> /data/mouse/human_rme/SH007/HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.<span class="hljs-number">20130415</span>.bam<br></code></pre></td></tr></table></figure><p>then try to index by samtools</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools index /data/mouse/human_rme/SH007/HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam<br></code></pre></td></tr></table></figure><p>Error report</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[W::bam_hdr_read] EOF marker <span class="hljs-keyword">is</span> absent. The <span class="hljs-keyword">input</span> <span class="hljs-keyword">is</span> probably truncated<br>[E::bgzf_read_block] Failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">read</span> BGZF block data at <span class="hljs-keyword">offset</span> <span class="hljs-number">4612181361</span> expected <span class="hljs-number">18560</span> bytes; hread returned <span class="hljs-number">12925</span><br>[E::bgzf_read] <span class="hljs-keyword">Read</span> block operation failed <span class="hljs-keyword">with</span> error <span class="hljs-number">4</span> <span class="hljs-keyword">after</span> <span class="hljs-number">0</span> <span class="hljs-keyword">of</span> <span class="hljs-number">4</span> bytes<br>samtools <span class="hljs-keyword">index</span>: failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">create</span> <span class="hljs-keyword">index</span> <span class="hljs-keyword">for</span> &quot;/data/mouse/human_rme/SH007/HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam&quot;: <span class="hljs-keyword">No</span> such file <span class="hljs-keyword">or</span> directory<br></code></pre></td></tr></table></figure><p>Guess: bam file is probably truncated, check bam file</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tail HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam | hexdump -C<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs tap">00000000  c1 c5<span class="hljs-number"> 58 </span>42 f1 3a a6<span class="hljs-number"> 89 </span><span class="hljs-number"> 41 </span>9b<span class="hljs-number"> 13 </span>31 bb da cd 6a  |..XB.:..A..1...j|<br>00000010  eb<span class="hljs-number"> 60 </span>5d cc 8a 1e<span class="hljs-number"> 33 </span>ec  cf cd<span class="hljs-number"> 36 </span>53<span class="hljs-number"> 54 </span>e0 ac c1  |.`]...3...6ST...|<br>00000020  cd 6f<span class="hljs-number"> 09 </span>1c f8<span class="hljs-number"> 32 </span>db c1 <span class="hljs-number"> 99 </span>6d<span class="hljs-number"> 91 </span>c6<span class="hljs-number"> 02 </span>b2 b2<span class="hljs-number"> 55 </span> |.o...2...m.....U|<br>00000030 <span class="hljs-number"> 64 </span>ab 0e<span class="hljs-number"> 63 </span>25 d2<span class="hljs-number"> 70 </span>d3 <span class="hljs-number"> 61 </span>19<span class="hljs-number"> 37 </span>84 d8 b7 d9 8d  |d..c%.p.a.7.....|<br>00000040  5a b8<span class="hljs-number"> 02 </span>f1<span class="hljs-number"> 31 </span>fe<span class="hljs-number"> 33 </span>3f <span class="hljs-number"> 07 </span>68 e7<span class="hljs-number"> 79 </span>94 2b ff f6  |Z...1.3?.h.y.+..|<br>00000050  8a a2<span class="hljs-number"> 03 </span>2a<span class="hljs-number"> 47 </span>e8<span class="hljs-number"> 45 </span>85  9d<span class="hljs-number"> 79 </span>39 8e 4b 8e fe<span class="hljs-number"> 91 </span> |...*G.E..y9.K...|<br>00000060  e9<span class="hljs-number"> 74 </span>72 6e cf<span class="hljs-number"> 35 </span>bd 3e  1f 9c 3b a3 fe<span class="hljs-number"> 00 </span>98<span class="hljs-number"> 43 </span> |.trn.5.&gt;..;....C|<br>00000070 <span class="hljs-number"> 97 </span>69 bb<span class="hljs-number"> 07 </span>12<span class="hljs-number"> 40 </span>64<span class="hljs-number"> 98 </span> 2e<span class="hljs-number"> 00 </span>70<span class="hljs-number"> 59 </span>b6 8a db<span class="hljs-number"> 86 </span> |.i...@d...pY....|<br>00000080  0a<span class="hljs-number"> 65 </span>bb<span class="hljs-number"> 34 </span>c4 8a a1 e9 <span class="hljs-number"> 34 </span>6b 9c<span class="hljs-number"> 36 </span>e3<span class="hljs-number"> 45 </span>22 b6  |.e.4....4k.6.E&quot;.|<br>00000090  c6<span class="hljs-number"> 83 </span>d9<span class="hljs-number"> 40 </span>a9<span class="hljs-number"> 32 </span>5d<span class="hljs-number"> 08 </span> 1c<span class="hljs-number"> 07 </span>40 8d 3a<span class="hljs-number"> 05 </span>17 4d  |...@.2]...@.:..M|<br>000000a0  d1<span class="hljs-number"> 14 </span>a8<span class="hljs-number"> 18 </span>16<span class="hljs-number"> 96 </span>e1 f7  ae ef aa e9<span class="hljs-number"> 49 </span>f4 f6<span class="hljs-number"> 77 </span> |............I..w|<br>000000b0 <span class="hljs-number"> 56 </span>a4<span class="hljs-number"> 65 </span>11 e8 c5 c9 ee <span class="hljs-number"> 79 </span>39 8e eb 9a<span class="hljs-number"> 33 </span>77<span class="hljs-number"> 22 </span> |V.e.....y9...3w&quot;|<br>000000c0  e4 5c cc a5<span class="hljs-number"> 44 </span>43 cc 0b <span class="hljs-number"> 88 </span>db 1d<span class="hljs-number"> 00 </span>99<span class="hljs-number"> 18 </span>bd 2d  |.\..DC.........-|<br>000000d0 <span class="hljs-number"> 13 </span>1b db<span class="hljs-number"> 02 </span>85 0b 4f b1  a1 c4 f6 a3<span class="hljs-number"> 27 </span>cc<span class="hljs-number"> 76 </span>eb  |......O.....&#x27;.v.|<br>000000e0 <span class="hljs-number"> 59 </span>49 4a cd<span class="hljs-number"> 70 </span>87<span class="hljs-number"> 93 </span>15 <span class="hljs-number"> 38 </span>10<span class="hljs-number"> 01 </span>44 7f 5c e0<span class="hljs-number"> 45 </span> |YIJ.p...8..D.\.E|<br>000000f0 <span class="hljs-number"> 53 </span>5a f9<span class="hljs-number"> 08 </span>b3<span class="hljs-number"> 14 </span>c0 bb  e4 da<span class="hljs-number"> 96 </span>85<span class="hljs-number"> 27 </span>6b<span class="hljs-number"> 58 </span>be  |SZ..........&#x27;kX.|<br>00000100  3e<span class="hljs-number"> 47 </span>71<span class="hljs-number"> 27 </span>de f6 b3 ef  4c<span class="hljs-number"> 27 </span>b0<span class="hljs-number"> 26 </span>de b6 dd<span class="hljs-number"> 84 </span> |&gt;Gq&#x27;....L&#x27;.&amp;....|<br>00000110 <span class="hljs-number"> 38 </span>b9<span class="hljs-number"> 51 </span>1b af<span class="hljs-number"> 61 </span>b9 0a  ce 0c<span class="hljs-number"> 13 </span>06<span class="hljs-number"> 46 </span>c5<span class="hljs-number"> 39 </span>8e  |8.Q..a......F.9.|<br>00000120 <span class="hljs-number"> 35 </span>b1<span class="hljs-number"> 24 </span>2a 2b<span class="hljs-number"> 94 </span>ea<span class="hljs-number"> 06 </span><span class="hljs-number"> 17 </span>9a<span class="hljs-number"> 98 </span>28 d2<span class="hljs-number"> 81 </span>77<span class="hljs-number"> 48 </span> |5.$*+......(..wH|<br>00000130  3d<span class="hljs-number"> 57 </span>88<span class="hljs-number"> 40 </span>a4<span class="hljs-number"> 79 </span>96 f3  7c 0f<span class="hljs-number"> 62 </span>05 4a e2<span class="hljs-number"> 44 </span>c7  |=W.@.y..|.b.J.D.|<br>00000140 <span class="hljs-number"> 34 </span>a4 0e d9 df 0b 0a<span class="hljs-number"> 49 </span><span class="hljs-number"> 18 </span>07 7c cf f5 fd d2 3c  |4......I..|....&lt;|<br>00000150  ab ba a2<span class="hljs-number"> 80 </span>f2 fb 8a d5 <span class="hljs-number"> 24 </span>d2 fd e5<span class="hljs-number"> 15 </span>19 1c<span class="hljs-number"> 94 </span> |........$.......|<br>00000160 <span class="hljs-number"> 33 </span>59 dc<span class="hljs-number"> 55 </span>38<span class="hljs-number"> 95 </span>2e c1 <span class="hljs-number"> 15 </span>2c<span class="hljs-number"> 28 </span>fc d4<span class="hljs-number"> 35 </span>d7 e1  |3Y.U8....,(..5..|<br>00000170 <span class="hljs-number"> 01 </span>23 b0 ce 4b d9<span class="hljs-number"> 92 </span>08 <span class="hljs-number"> 71 </span>69 6c<span class="hljs-number"> 82 </span>1b<span class="hljs-number"> 41 </span>22<span class="hljs-number"> 88 </span> |.<span class="hljs-comment">#..K...qil..A&quot;.|</span><br>00000180 <span class="hljs-number"> 74 </span>51<span class="hljs-number"> 15 </span>8a<span class="hljs-number"> 07 </span>52 f9 ea <span class="hljs-number"> 28 </span>94<span class="hljs-number"> 05 </span>3f 0c b0 f0 ce  |tQ...R..(..?....|<br>00000190 <span class="hljs-number"> 45 </span>6c<span class="hljs-number"> 94 </span>44<span class="hljs-number"> 59 </span>65<span class="hljs-number"> 42 </span>12 <span class="hljs-number"> 85 </span>a2 df 9e 2e<span class="hljs-number"> 45 </span>52<span class="hljs-number"> 15 </span> |El.DYeB......ER.|<br>000001a0 <span class="hljs-number"> 88 </span>17<span class="hljs-number"> 72 </span>e6 1d 6c dd<span class="hljs-number"> 99 </span> 9f 7d<span class="hljs-number"> 45 </span>61 a8<span class="hljs-number"> 56 </span>f3 fe  |..r..l...&#125;Ea.V..|<br>000001b0  6a 7d<span class="hljs-number"> 87 </span>e7 1a e9 fe ca  0a<span class="hljs-number"> 77 </span>8b 5a<span class="hljs-number"> 26 </span>72<span class="hljs-number"> 51 </span>76  |j&#125;.......w.Z&amp;rQv|<br>000001c0 <span class="hljs-number"> 72 </span>5e b7 e4 ca<span class="hljs-number"> 77 </span>bf ec <span class="hljs-number"> 19 </span>08 d3 cc a8 1f<span class="hljs-number"> 45 </span>0e  |r^...w........E.|<br>000001d0  ca 6a<span class="hljs-number"> 01 </span>85 f2 0b<span class="hljs-number"> 45 </span>08  b4<span class="hljs-number"> 24 </span>2b d0<span class="hljs-number"> 58 </span>c4 a2 e8  |.j....E..$+.X...|<br>000001e0  c6<span class="hljs-number"> 64 </span>cb f3<span class="hljs-number"> 85 </span>36<span class="hljs-number"> 41 </span>b8  0d cf<span class="hljs-number"> 00 </span>d2<span class="hljs-number"> 89 </span>00 8e e6  |.d...6A.........|<br>000001f0  ef<span class="hljs-number"> 72 </span>16 e1 f6 e8<span class="hljs-number"> 84 </span>fb  be 1f<span class="hljs-number"> 45 </span>c5<span class="hljs-number"> 62 </span>d1<span class="hljs-number"> 09 </span>0b  |.r........E.b...|<br>00000200  3b bb 9e<span class="hljs-number"> 50 </span>14<span class="hljs-number"> 42 </span>8c 4d <span class="hljs-number"> 96 </span>bf<span class="hljs-number"> 41 </span>e9 dd bb<span class="hljs-number"> 91 </span>88  |;..P.B.M..A.....|<br>00000210  c2 dd 5d<span class="hljs-number"> 42 </span>bd<span class="hljs-number"> 48 </span>f1 b5  9d<span class="hljs-number"> 09 </span>9a 8c<span class="hljs-number"> 75 </span>a3 1c 1f  |..]B.H......u...|<br>00000220  4e<span class="hljs-number"> 50 </span>dc 9a<span class="hljs-number"> 33 </span>6d<span class="hljs-number"> 94 </span>ed <span class="hljs-number"> 23 </span>8b<span class="hljs-number"> 01 </span>d8<span class="hljs-number"> 44 </span>a2 ef<span class="hljs-number"> 47 </span> |NP..3m..<span class="hljs-comment">#...D..G|</span><br>00000230  6f 6d 6c fc<span class="hljs-number"> 02 </span>90 2e<span class="hljs-number"> 07 </span><span class="hljs-number"> 27 </span>5a<span class="hljs-number"> 46 </span>c3 fe<span class="hljs-number"> 68 </span>30 0e  |oml.....&#x27;ZF..h0.|<br>00000240 <span class="hljs-number"> 75 </span>73 7d<span class="hljs-number"> 38 </span>bf 4c 8f c3  9f<span class="hljs-number"> 51 </span>87 f5 c6 e7 5d 0f  |us&#125;8.L...Q....].|<br>00000250  ce bb f3 c1 e4 bc eb 3f <span class="hljs-number"> 21 </span>07 a3 fb 2a<span class="hljs-number"> 74 </span>c4 0b  |.......?!...*t..|<br>00000260 <span class="hljs-number"> 85 </span>00 4e<span class="hljs-number"> 47 </span>11 ed 6e<span class="hljs-number"> 17 </span> b6<span class="hljs-number"> 44 </span>bc<span class="hljs-number"> 15 </span>3b 5b 3b 9b  |..NG..n..D..;[;.|<br>00000270  f0 d8<span class="hljs-number"> 75 </span>24<span class="hljs-number"> 77 </span>15 f3 fd  e0 ee 7e<span class="hljs-number"> 29 </span>a4<span class="hljs-number"> 39 </span>30 eb  |..u$w.....~).90.|<br>00000280  0f<span class="hljs-number"> 20 </span>d8 cd<span class="hljs-number"> 07 </span>ed 7b<span class="hljs-number"> 27 </span> 0f 4e ee<span class="hljs-number"> 55 </span>2f<span class="hljs-number"> 66 </span>28<span class="hljs-number"> 71 </span> |. ....&#123;&#x27;.N.U/f(q|<br>00000290 <span class="hljs-number"> 88 </span>e2 f6 dc<span class="hljs-number"> 10 </span>c5 2b cf <span class="hljs-number"> 46 </span>e6 7f<span class="hljs-number"> 06 </span>fa af 3d bc  |......+.F.....=.|<br>000002a0 <span class="hljs-number"> 28 </span>16 f3 a3 ef 2c 8a<span class="hljs-number"> 16 </span><span class="hljs-number"> 34 </span>20<span class="hljs-number"> 18 </span>6b b4 4e 9a<span class="hljs-number"> 67 </span> |(....,..4 .k.N.g|<br>000002b0  1b<span class="hljs-number"> 27 </span>77<span class="hljs-number"> 32 </span>bc 1f c9<span class="hljs-number"> 21 </span> 7a f3 1c a2 2b bb<span class="hljs-number"> 83 </span>61  |.&#x27;w2...!z...+..a|<br>000002c0  ae 0b de a4 d7 c9 6d<span class="hljs-number"> 87 </span><span class="hljs-number"> 77 </span>dd cd 1b<span class="hljs-number"> 47 </span>bb<span class="hljs-number"> 31 </span>67  |......m.w...G.1g|<br>000002d0  b9<span class="hljs-number"> 98 </span>c5<span class="hljs-number"> 07 </span>71 a9<span class="hljs-number"> 78 </span>58 <span class="hljs-number"> 22 </span>bb 3b<span class="hljs-number"> 81 </span>5f<span class="hljs-number"> 88 </span>f8<span class="hljs-number"> 81 </span> |....q.xX&quot;.;._...|<br>000002e0 <span class="hljs-number"> 47 </span>92<span class="hljs-number"> 42 </span>71<span class="hljs-number"> 87 </span>45<span class="hljs-number"> 31 </span>c0  aa b7 5c ae<span class="hljs-number"> 76 </span>b9 b8<span class="hljs-number"> 01 </span> |G.Bq.E1...\.v...|<br>000002f0  a1<span class="hljs-number"> 05 </span>b0 bc<span class="hljs-number"> 30 </span>74 e2<span class="hljs-number"> 03 </span> 6c<span class="hljs-number"> 26 </span>01 5f 9e<span class="hljs-number"> 73 </span>e0 3c  |....0t..l&amp;._.s.&lt;|<br>00000300  8b<span class="hljs-number"> 25 </span>7d a1<span class="hljs-number"> 74 </span>70 e7 c8 <span class="hljs-number"> 15 </span>b1<span class="hljs-number"> 24 </span>a2<span class="hljs-number"> 28 </span>19 1c 9f  |.%&#125;.tp....$.(...|<br>00000310  4c<span class="hljs-number"> 92 </span>85 c0 e2<span class="hljs-number"> 75 </span>bb e5  fb<span class="hljs-number"> 41 </span>ad<span class="hljs-number"> 75 </span>bf b6 1e<span class="hljs-number"> 52 </span> |L....u...A.u...R|<br>00000320 <span class="hljs-number"> 48 </span>48 5c a6 0b<span class="hljs-number"> 03 </span>be<span class="hljs-number"> 39 </span> d7<span class="hljs-number"> 07 </span>35<span class="hljs-number"> 39 </span>f0<span class="hljs-number"> 50 </span>cc af  |HH\....9..59.P..|<br>00000330  b0<span class="hljs-number"> 10 </span>01 4f<span class="hljs-number"> 84 </span>fb f0 bc  bb 9a<span class="hljs-number"> 33 </span>d9 cd<span class="hljs-number"> 47 </span>1c f0  |...O......3..G..|<br>00000340  3c d8<span class="hljs-number"> 73 </span>5c<span class="hljs-number"> 56 </span>88<span class="hljs-number"> 14 </span>d9  f3<span class="hljs-number"> 75 </span>24<span class="hljs-number"> 72 </span>81<span class="hljs-number"> 70 </span>9c 2d  |&lt;.s\V....u$r.p.-|<br>00000350  a2 a4<span class="hljs-number"> 91 </span>c2 8f 4a<span class="hljs-number"> 48 </span>bd  8a 3a f5 f7<span class="hljs-number"> 62 </span>e6 8b<span class="hljs-number"> 94 </span> |.....JH..:..b...|<br>00000360  ee 0a d7 a3 5b<span class="hljs-number"> 41 </span>bc b5  e7<span class="hljs-number"> 09 </span>f0<span class="hljs-number"> 40 </span>94<span class="hljs-number"> 14 </span>73 3e  |....[A.....@..s&gt;|<br>00000370 <span class="hljs-number"> 09 </span>c1<span class="hljs-number"> 69 </span>3f cf dd 0a 9d <span class="hljs-number"> 19 </span>07 fb e6 0a 0e f6 c5  |..i?............|<br>00000380  0b 4e<span class="hljs-number"> 61 </span>22<span class="hljs-number"> 66 </span>64 c5<span class="hljs-number"> 95 </span> af e3<span class="hljs-number"> 77 </span>87 3d c7 e9<span class="hljs-number"> 31 </span> |.Na&quot;fd....w.=..1|<br>00000390 <span class="hljs-number"> 26 </span>34<span class="hljs-number"> 66 </span>b7<span class="hljs-number"> 44 </span>c2<span class="hljs-number"> 50 </span>46 <span class="hljs-number"> 80 </span>a9<span class="hljs-number"> 58 </span>94 b2<span class="hljs-number"> 85 </span>8e d8  |&amp;4f.D.PF..X.....|<br>000003a0  cd<span class="hljs-number"> 64 </span>58 1c<span class="hljs-number"> 10 </span>29 ac d4 <span class="hljs-number"> 11 </span>4a d0 2a ec 3a<span class="hljs-number"> 60 </span>b6  |.dX..)...J.*.:`.|<br>000003b0  af<span class="hljs-number"> 29 </span>29<span class="hljs-number"> 27 </span>2c<span class="hljs-number"> 10 </span>28 b0 <span class="hljs-number"> 01 </span>d1 b1 4c 7c cc 4a a2  |.))&#x27;,.(....L|.J.|<br>000003c0  f2 a7 b0 5d ea<span class="hljs-number"> 89 </span>48 6d <span class="hljs-number"> 07 </span>02 c4 d1<span class="hljs-number"> 97 </span>35 f7 af  |...]..Hm.....5..|<br>000003d0 <span class="hljs-number"> 47 </span>9a f1 b7<span class="hljs-number"> 57 </span>64 bf<span class="hljs-number"> 50 </span> d0<span class="hljs-number"> 64 </span>49 5c<span class="hljs-number"> 79 </span>5e bc e4  |G...Wd.P.dI\y^..|<br>000003e0  ca f8<span class="hljs-number"> 62 </span>4f aa<span class="hljs-number"> 93 </span>77<span class="hljs-number"> 87 </span> 1d<span class="hljs-number"> 81 </span>8d cf<span class="hljs-number"> 38 </span>c6<span class="hljs-number"> 63 </span>a7  |..bO..w.....8.c.|<br>000003f0  a3 6c a1 b2 6c 7b bd b0  0f<span class="hljs-number"> 21 </span>d3<span class="hljs-number"> 58 </span>4f 6d<span class="hljs-number"> 89 </span>d2  |.l..l&#123;...!.XOm..|<br>00000400 <span class="hljs-number"> 58 </span>d9<span class="hljs-number"> 01 </span>9c<span class="hljs-number"> 59 </span>01 a6 cb  b3<span class="hljs-number"> 65 </span>b1<span class="hljs-number"> 65 </span>0c 2e 2a c7  |X...Y....e.e..*.|<br>00000410  c7<span class="hljs-number"> 38 </span>eb<span class="hljs-number"> 32 </span>d9<span class="hljs-number"> 27 </span>3b<span class="hljs-number"> 99 </span> a6 ca<span class="hljs-number"> 76 </span>d8 e0 5a df b5  |.8.2.&#x27;;...v..Z..|<br>00000420  9d a6 fa d2 8d<span class="hljs-number"> 99 </span>b4 c0 <span class="hljs-number"> 32 </span>d0<span class="hljs-number"> 28 </span>41<span class="hljs-number"> 20 </span>16 9b 4d  |........2.(A ..M|<br>00000430 <span class="hljs-number"> 27 </span>72<span class="hljs-number"> 03 </span>b6 d9<span class="hljs-number"> 74 </span>98 b9  d3 de cc 9d<span class="hljs-number"> 76 </span>7a d8<span class="hljs-number"> 81 </span> |&#x27;r...t......vz..|<br>00000440  da e9 b0<span class="hljs-number"> 51 </span>cf e9 e0<span class="hljs-number"> 70 </span><span class="hljs-number"> 77 </span>7f<span class="hljs-number"> 34 </span>34<span class="hljs-number"> 03 </span>d3 e1<span class="hljs-number"> 72 </span> |...Q...pw.44...r|<br>00000450  c8 fa 5d<span class="hljs-number"> 87 </span>71 5e a2<span class="hljs-number"> 31 </span> f1<span class="hljs-number"> 71 </span>6d<span class="hljs-number"> 15 </span>c4<span class="hljs-number"> 65 </span>01<span class="hljs-number"> 86 </span> |..].q^.1.qm..e..|<br>00000460  0d d8 ad c7<span class="hljs-number"> 53 </span>23 8d dd  aa 8b<span class="hljs-number"> 18 </span>26<span class="hljs-number"> 00 </span>b2 6d d5  |....S<span class="hljs-comment">#.....&amp;..m.|</span><br>00000470  b3<span class="hljs-number"> 43 </span>6c b8 e2<span class="hljs-number"> 02 </span>30<span class="hljs-number"> 56 </span> d8 a3 5a b6 ab<span class="hljs-number"> 84 </span>50 4f  |.Cl...0V..Z...PO|<br>00000480 <span class="hljs-number"> 19 </span>c7<span class="hljs-number"> 81 </span>34<span class="hljs-number"> 70 </span>66 0c 8c <span class="hljs-number"> 51 </span>5a<span class="hljs-number"> 39 </span>b1<span class="hljs-number"> 55 </span>67 bd<span class="hljs-number"> 28 </span> |...4pf..QZ9.Ug.(|<br>00000490 <span class="hljs-number"> 44 </span>5b bf<span class="hljs-number"> 77 </span>d6 ba<span class="hljs-number"> 52 </span>57  cd<span class="hljs-number"> 47 </span>3e f2<span class="hljs-number"> 91 </span>a7 8f f4  |D[.w..RW.G&gt;.....|<br>000004a0  c4 a4 e5 db<span class="hljs-number"> 17 </span>47 5f 7f  fe 9d e5<span class="hljs-number"> 55 </span>41 cd<span class="hljs-number"> 56 </span>bd  |.....G_....UA.V.|<br>000004b0 <span class="hljs-number"> 56 </span>ad 9d 8d 9b f3 1e 6d  bb<span class="hljs-number"> 80 </span>33 7c 3b 1a<span class="hljs-number"> 75 </span>47  |V......m..3|;.uG|<br>000004c0  7c<span class="hljs-number"> 98 </span>e7<span class="hljs-number"> 80 </span>f1<span class="hljs-number"> 90 </span>75 4c <span class="hljs-number"> 77 </span>14<span class="hljs-number"> 62 </span>9f<span class="hljs-number"> 02 </span>a6<span class="hljs-number"> 14 </span>88  ||.....uLw.b.....|<br>000004d0  c6 cc<span class="hljs-number"> 39 </span>e6 1e ca<span class="hljs-number"> 76 </span>9d <span class="hljs-number"> 12 </span>6e 2a 4e<span class="hljs-number"> 55 </span>12<span class="hljs-number"> 43 </span>50  |..9...v..n*NU.CP|<br>000004e0  0c 4e<span class="hljs-number"> 05 </span>f7 8a<span class="hljs-number"> 61 </span>24 8c <span class="hljs-number"> 95 </span>76<span class="hljs-number"> 34 </span>75 cd<span class="hljs-number"> 13 </span>c1<span class="hljs-number"> 29 </span> |.N...a$..v4u...)|<br>000004f0  4e<span class="hljs-number"> 14 </span>49 df e3<span class="hljs-number"> 10 </span>b5<span class="hljs-number"> 01 </span><span class="hljs-number"> 43 </span>66<span class="hljs-number"> 56 </span>d0<span class="hljs-number"> 52 </span>79 4c<span class="hljs-number"> 65 </span> |N.I.....CfV.RyLe|<br>00000500  8b<span class="hljs-number"> 85 </span>ca<span class="hljs-number"> 29 </span>8b<span class="hljs-number"> 50 </span>ac e7 <span class="hljs-number"> 12 </span>c1 b9 e7<span class="hljs-number"> 39 </span>10 b0 0a  |...).P......9...|<br>00000510  e8<span class="hljs-number"> 99 </span>8f c6<span class="hljs-number"> 01 </span>ef 0f 2e <span class="hljs-number"> 49 </span>95 cc 0d<span class="hljs-number"> 73 </span>5f 1f<span class="hljs-number"> 68 </span> |........I...s_.h|<br>00000520  6d f7 2f a5<span class="hljs-number"> 29 </span>b3 b6<span class="hljs-number"> 89 </span> ed 0b<span class="hljs-number"> 65 </span>74 af a8<span class="hljs-number"> 22 </span>95  |m./.).....et..&quot;.|<br>00000530  b5 3c d8<span class="hljs-number"> 64 </span>50 c5 b6<span class="hljs-number"> 96 </span> e2 c7 6c 7a db<span class="hljs-number"> 26 </span>29<span class="hljs-number"> 92 </span> |.&lt;.dP.....lz.&amp;).|<br>00000540  2c<span class="hljs-number"> 92 </span>c6 b6 a6 6c<span class="hljs-number"> 08 </span>ce  a0 5c 3e b5 5d<span class="hljs-number"> 10 </span>da 2e  |,....l...\&gt;.]...|<br>00000550  e3 b5 ed a6 fc<span class="hljs-number"> 12 </span>dd ca  f5<span class="hljs-number"> 68 </span>37 fd ae b7 2f d6  |.........h7.../.|<br>00000560 <span class="hljs-number"> 82 </span>7e fd 9d<span class="hljs-number"> 65 </span>a9<span class="hljs-number"> 92 </span>7a  f5 b4 7a d6 a8 8f 4f c3  |.~..e..z..z...O.|<br>00000570  2b fb 8c fc<span class="hljs-number"> 10 </span>57 f5<span class="hljs-number"> 76 </span> fa<span class="hljs-number"> 21 </span>41<span class="hljs-number"> 59 </span>76 ad<span class="hljs-number"> 43 </span>a2  |+....W.v.!AYv.C.|<br>00000580 <span class="hljs-number"> 70 </span>be d8<span class="hljs-number"> 76 </span>e5<span class="hljs-number"> 00 </span>58 dc  6a<span class="hljs-number"> 71 </span>05 dc<span class="hljs-number"> 58 </span>f5 2e 5c  |p..v..X.jq..X..\|<br>00000590  8c<span class="hljs-number"> 25 </span>50<span class="hljs-number"> 29 </span>5f a6 4a<span class="hljs-number"> 85 </span><span class="hljs-number"> 12 </span>eb<span class="hljs-number"> 15 </span>26<span class="hljs-number"> 64 </span>d2<span class="hljs-number"> 30 </span>14  |.%P)_.J....&amp;d.0.|<br>000005a0  0c b7<span class="hljs-number"> 63 </span>56<span class="hljs-number"> 60 </span>c8 a8<span class="hljs-number"> 62 </span><span class="hljs-number"> 80 </span>89 0c 9f<span class="hljs-number"> 69 </span>db<span class="hljs-number"> 82 </span>aa  |..cV`..b....i...|<br>000005b0  a5<span class="hljs-number"> 56 </span>a9 cc 0b b6 b6<span class="hljs-number"> 02 </span> a1<span class="hljs-number"> 13 </span>a0 1b 2b 5c c7 5f  |.V..........+\._|<br>000005c0  7c<span class="hljs-number"> 67 </span>59 f1 b6 de 3c ad  d7 cf c6 a3 6e<span class="hljs-number"> 57 </span>b7<span class="hljs-number"> 64 </span> ||gY...&lt;.....nW.d|<br>000005d0 <span class="hljs-number"> 86 </span>6b b2 4c ae<span class="hljs-number"> 17 </span>71 6e  db<span class="hljs-number"> 77 </span>8c 5d 2f<span class="hljs-number"> 62 </span>a5 ab  |.k.L..qn.w.]/b..|<br>000005e0 <span class="hljs-number"> 33 </span>ef 2a<span class="hljs-number"> 75 </span>2a 6c d3 3a  6e 8f 4d<span class="hljs-number"> 15 </span>b3 da e0 d8  |3.*u*l.:n.M.....|<br>000005f0  ad<span class="hljs-number"> 43 </span>68<span class="hljs-number"> 56 </span>4e 4b c7<span class="hljs-number"> 83 </span><span class="hljs-number"> 70 </span>01<span class="hljs-number"> 45 </span>7c a5 cc<span class="hljs-number"> 96 </span>6b  |.ChVNK..p.E|...k|<br>00000600 <span class="hljs-number"> 80 </span>a9 0b 1c<span class="hljs-number"> 30 </span>c6<span class="hljs-number"> 46 </span>00 <span class="hljs-number"> 15 </span>70 dc c2 b1 9e<span class="hljs-number"> 52 </span>5e  |....0.F..p....R^|<br>00000610  f7 7a<span class="hljs-number"> 53 </span>a0 db 2b 2c fa  e7 2f<span class="hljs-number"> 16 </span>36 4e da<span class="hljs-number"> 67 </span>a7  |.zS..+,../.6N.g.|<br>00000620  b5 7a e6 3a ae<span class="hljs-number"> 65 </span>cc dd <span class="hljs-number"> 73 </span>a7 d3 0d<span class="hljs-number"> 85 </span>e2 a8 0e  |.z.:.e..s.......|<br>00000630  8c 4d<span class="hljs-number"> 26 </span>06<span class="hljs-number"> 05 </span>d1<span class="hljs-number"> 62 </span>b0  6f<span class="hljs-number"> 29 </span>b0 6f<span class="hljs-number"> 11 </span>55<span class="hljs-number"> 70 </span>13  |.M&amp;...b.o).o.Up.|<br>00000640  eb<span class="hljs-number"> 77 </span>c5<span class="hljs-number"> 58 </span>e8 a1 5c f6 <span class="hljs-number"> 89 </span>56 e3 5c<span class="hljs-number"> 27 </span>ae<span class="hljs-number"> 32 </span>4e  |.w.X..\..V.\&#x27;.2N|<br>00000650  a3<span class="hljs-number"> 08 </span>65 d1 0c b3 5b<span class="hljs-number"> 35 </span><span class="hljs-number"> 70 </span>f7<span class="hljs-number"> 37 </span>b3<span class="hljs-number"> 63 </span>dc f0 2b  |..e...[5p.7.c..+|<br>00000660 <span class="hljs-number"> 18 </span>c7<span class="hljs-number"> 82 </span>73 a2<span class="hljs-number"> 04 </span>5f 4f  a0 5f 9c<span class="hljs-number"> 25 </span>8d bf 7b<span class="hljs-number"> 85 </span> |...s.._O._.%..&#123;.|<br>00000670 <span class="hljs-number"> 45 </span>ff 0c<span class="hljs-number"> 00 </span>fd 4b 4b<span class="hljs-number"> 65 </span> e4 b3<span class="hljs-number"> 56 </span>eb<span class="hljs-number"> 64 </span>5c<span class="hljs-number"> 46 </span>be  |E....KKe..V.d\F.|<br>00000680  2e cc<span class="hljs-number"> 79 </span>16<span class="hljs-number"> 31 </span>2c<span class="hljs-number"> 14 </span>63 <span class="hljs-number"> 43 </span>19<span class="hljs-number"> 90 </span>08 6c<span class="hljs-number"> 41 </span>07<span class="hljs-number"> 18 </span> |..y.1,.cC...lA..|<br>00000690  2b<span class="hljs-number"> 70 </span>f2 d9<span class="hljs-number"> 45 </span>d2<span class="hljs-number"> 76 </span>7b <span class="hljs-number"> 11 </span>a0 4a 8d<span class="hljs-number"> 04 </span>9a<span class="hljs-number"> 17 </span>33  |+p..E.v&#123;..J....3|<br>000006a0  6d<span class="hljs-number"> 67 </span>61<span class="hljs-number"> 70 </span>0e<span class="hljs-number"> 00 </span>d0 2c <span class="hljs-number"> 53 </span>4c 7a<span class="hljs-number"> 26 </span>40<span class="hljs-number"> 10 </span>31<span class="hljs-number"> 09 </span> |mgap...,SLz&amp;@.1.|<br>000006b0  8a<span class="hljs-number"> 29 </span>7b 6e b2 bc<span class="hljs-number"> 73 </span>aa <span class="hljs-number"> 65 </span>b9 9c<span class="hljs-number"> 09 </span>b9 db f1 8c  |.)&#123;n..s.e.......|<br>000006c0 <span class="hljs-number"> 75 </span>07 ba b3 e2<span class="hljs-number"> 30 </span>44<span class="hljs-number"> 11 </span> 0e b3<span class="hljs-number"> 74 </span>18 ce<span class="hljs-number"> 09 </span>6e 5c  |u....0D...t...n\|<br>000006d0 <span class="hljs-number"> 13 </span>65<span class="hljs-number"> 70 </span>27 d9<span class="hljs-number"> 38 </span>dc<span class="hljs-number"> 78 </span><span class="hljs-number"> 96 </span>c8 a6 df<span class="hljs-number"> 11 </span>1c 5c<span class="hljs-number"> 09 </span> |.ep&#x27;.8.x......\.|<br>000006e0 <span class="hljs-number"> 69 </span>8b<span class="hljs-number"> 18 </span>65 7b<span class="hljs-number"> 40 </span>1e<span class="hljs-number"> 57 </span><span class="hljs-number"> 80 </span>fd<span class="hljs-number"> 99 </span>63 7b<span class="hljs-number"> 56 </span>aa 0a  |i..e&#123;@.W...c&#123;V..|<br>000006f0  5a ad<span class="hljs-number"> 55 </span>0c c4 d1<span class="hljs-number"> 22 </span>6c  f3 c5<span class="hljs-number"> 45 </span>bd<span class="hljs-number"> 49 </span>36 2d 0e  |Z.U...&quot;l..E.I6-.|<br>00000700  8c 5b e9 d4 2e<span class="hljs-number"> 81 </span>c4 a5  5e<span class="hljs-number"> 98 </span>ad 8f d6<span class="hljs-number"> 74 </span>c8 a5  |.[......^....t..|<br>00000710  3b 1d<span class="hljs-number"> 09 </span>f8 ec db<span class="hljs-number"> 17 </span>55 <span class="hljs-number"> 00 </span>51 a4 ce 5b 8c<span class="hljs-number"> 58 </span>26  |;......U.Q..[.X&amp;|<br>00000720 <span class="hljs-number"> 82 </span>74 ce ed ac<span class="hljs-number"> 46 </span>b7<span class="hljs-number"> 32 </span><span class="hljs-number"> 48 </span>31<span class="hljs-number"> 17 </span>bc<span class="hljs-number"> 76 </span>7f e6 b5  |.t...F.2H1..v...|<br>00000730  9f<span class="hljs-number"> 30 </span>55 b4 f4<span class="hljs-number"> 88 </span>02 9c <span class="hljs-number"> 46 </span>2c e5 ef 6e b9 e4 ee  |.0U.....F,..n...|<br>00000740 <span class="hljs-number"> 91 </span>bf                                             |..|<br>00000742<br></code></pre></td></tr></table></figure><p>seems 28 byte empty BGZF block as an EOF marker is absent</p><p>Try </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools view -b -q 20 HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.bam &gt; HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.new.bam<br></code></pre></td></tr></table></figure><p>return</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs applescript">[W::bam_hdr_read] EOF marker <span class="hljs-keyword">is</span> absent. The input <span class="hljs-keyword">is</span> probably truncated<br>[E::bgzf_read_block] Failed <span class="hljs-keyword">to</span> <span class="hljs-built_in">read</span> BGZF block data <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">4612181361</span> expected <span class="hljs-number">18560</span> bytes; hread returned <span class="hljs-number">12925</span><br>[E::bgzf_read] Read block operation failed <span class="hljs-keyword">with</span> <span class="hljs-keyword">error</span> <span class="hljs-number">4</span> <span class="hljs-keyword">after</span> <span class="hljs-number">0</span> <span class="hljs-keyword">of</span> <span class="hljs-number">4</span> bytes<br>[main_samview] truncated <span class="hljs-built_in">file</span>.<br></code></pre></td></tr></table></figure><p>then try to use HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.new.bam by samtools index:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools index HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.20130415.new.bam<br></code></pre></td></tr></table></figure><p>(No error return!)</p><p>try GATK</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index<span class="hljs-regexp">/gatk-4.1.9.0/g</span>atk --java-<span class="hljs-keyword">options</span> <span class="hljs-string">&quot;-Xmx4g&quot;</span> HaplotypeCaller  \<br>-R <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/g</span>enome_index/human_g1k_v37.fasta \<br>-I HG00421.mapped.ILLUMINA.bwa.CHS.low_coverage.<span class="hljs-number">20130415</span>.<span class="hljs-keyword">new</span>.bam \<br>-O <span class="hljs-regexp">/data/m</span>ouse<span class="hljs-regexp">/human_rme/</span>SH007/HG00421_new.vcf.gz \<br>-ERC GVCF <br></code></pre></td></tr></table></figure><p>mapping by STAR (没有gtf文件时的做法：)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">STAR --runThreadN 6 --runMode genomeGenerate \<br>--genomeDir /data/mouse/human_rme/genome_index \<br>--genomeFastaFiles /data/mouse/human_rme/genome_index/human_g1k_v37.fasta #generate index<br><br>STAR --genomeDir /data/mouse/human_rme/genome_index \<br>    --runThreadN 20 \<br>    --readFilesIn sample_r1.fq.gz sample_r2.fq.gz \<br>    # --readFilesCommand zcat \<br>    --outFileNamePrefix sample \<br>    --outSAMtype BAM SortedByCoordinate \<br>    --outBAMsortingThreadN 10 #do mapping<br></code></pre></td></tr></table></figure><p>12.2 进度：</p><p><strong>SH007</strong></p><p>genotypeGVCF done HG00422  (5110)</p><p>genotypeGVCF HG00421  ready</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">GATK genotypeGVCF</span><br>/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; GenotypeGVCFs \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-V HG00422_new.vcf.gz \<br>-O HG00422_genotypeGVCF.vcf.gz<br></code></pre></td></tr></table></figure><p>HG00423 can’t do gatk missing RG </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools view -H HG00444Aligned.sortedByCoord.out.bam | grep &#x27;^@RG&#x27;<br></code></pre></td></tr></table></figure><p>return : none！</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar /data/mouse/human_rme/genome_index/picard.jar <br></code></pre></td></tr></table></figure><p>try AddOrReplaceReadGroups</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -jar /data/mouse/human_rme/genome_index/picard.jar AddOrReplaceReadGroups \<br>I=HG00423Aligned.sortedByCoord.out.bam \<br>O=HG00423Aligned.sortedByCoord.out.new.bam \<br>RGID=4 \<br>RGLB=lib1 \<br>RGPL=illumina \<br>RGPU=unit1 \<br>RGSM=20<br></code></pre></td></tr></table></figure><p>then try samtools index</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">samtools index HG00423Aligned.sortedByCoord.out.new.bam<br></code></pre></td></tr></table></figure><p>(it seems work!!!) </p><p>gatk doing HG00423 65457 (shuting down)</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk --java-options <span class="hljs-string">&quot;-Xmx4g&quot;</span> HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423Aligned</span>.</span></span>sortedByCoord.out.<span class="hljs-keyword">new</span>.bam \<br>-O /data/mouse/human_rme/SH007/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423_new</span>.</span></span>vcf.gz \<br>-ERC GVCF<br><br># return<br>Using GATK jar /data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar<br>Running:<br>    java -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>use_async_io_read_samtools=<span class="hljs-literal">false</span> -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>use_async_io_write_samtools=<span class="hljs-literal">true</span> -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>use_async_io_write_tribble=<span class="hljs-literal">false</span> -<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dsamjdk</span>.</span></span>compression_level=<span class="hljs-number">2</span> -Xmx4g -jar /data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar HaplotypeCaller -R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta -I <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423Aligned</span>.</span></span>sortedByCoord.out.<span class="hljs-keyword">new</span>.bam -O /data/mouse/human_rme/SH007/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HG00423_new</span>.</span></span>vcf.gz -ERC GVCF<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.494</span> INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar!/com/intel/gkl/native/libgkl_compression.so<br>Dec <span class="hljs-number">02</span>, <span class="hljs-number">2020</span> <span class="hljs-number">3</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05</span> PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine<br>INFO: Failed <span class="hljs-keyword">to</span> detect whether we are running on Google Compute Engine.<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.775</span> INFO  HaplotypeCaller - ------------------------------------------------------------<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.776</span> INFO  HaplotypeCaller - The Genome Analysis Toolkit (GATK) v4.<span class="hljs-number">1.9</span>.<span class="hljs-number">0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.776</span> INFO  HaplotypeCaller - For support <span class="hljs-keyword">and</span> documentation go <span class="hljs-keyword">to</span> https:<span class="hljs-comment">//software.broadinstitute.org/gatk/</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - Executing <span class="hljs-keyword">as</span> zhuyufei@bdp-svr05 on Linux v5.<span class="hljs-number">3.1</span>-<span class="hljs-number">1.</span>el7.elrepo.x86_64 amd64<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - Java runtime: OpenJDK <span class="hljs-number">64</span>-Bit Server VM v1.<span class="hljs-number">8.0_152</span>-release-<span class="hljs-number">1056</span>-b12<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - Start Date/Time: <span class="hljs-number">2020</span>年<span class="hljs-number">12</span>月<span class="hljs-number">2</span>日 下午<span class="hljs-number">03</span>时<span class="hljs-number">21</span>分<span class="hljs-number">05</span>秒<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - ------------------------------------------------------------<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.832</span> INFO  HaplotypeCaller - ------------------------------------------------------------<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.833</span> INFO  HaplotypeCaller - HTSJDK Version: <span class="hljs-number">2.23</span>.<span class="hljs-number">0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - Picard Version: <span class="hljs-number">2.23</span>.<span class="hljs-number">3</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.COMPRESSION_LEVEL : <span class="hljs-number">2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : <span class="hljs-literal">false</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : <span class="hljs-literal">true</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : <span class="hljs-literal">false</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - Deflater: IntelDeflater<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - Inflater: IntelInflater<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.834</span> INFO  HaplotypeCaller - GCS max retries/reopens: <span class="hljs-number">20</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.835</span> INFO  HaplotypeCaller - Requester pays: disabled<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">05.835</span> INFO  HaplotypeCaller - Initializing engine<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.227</span> INFO  HaplotypeCaller - Done initializing engine<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.228</span> INFO  HaplotypeCallerEngine - Tool is <span class="hljs-keyword">in</span> reference confidence mode <span class="hljs-keyword">and</span> the annotation, the following changes will be made <span class="hljs-keyword">to</span> any specified annotations: &#x27;StrandBiasBySample&#x27; will be enabled. &#x27;ChromosomeCounts&#x27;, &#x27;FisherStrand&#x27;, &#x27;StrandOddsRatio&#x27; <span class="hljs-keyword">and</span> &#x27;QualByDepth&#x27; annotations have been disabled<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.235</span> INFO  HaplotypeCallerEngine - Standard Emitting <span class="hljs-keyword">and</span> Calling confidence set <span class="hljs-keyword">to</span> <span class="hljs-number">0.0</span> <span class="hljs-keyword">for</span> reference-model confidence output<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.235</span> INFO  HaplotypeCallerEngine - All sites annotated <span class="hljs-keyword">with</span> PLs forced <span class="hljs-keyword">to</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">for</span> reference-model confidence output<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.248</span> INFO  NativeLibraryLoader - Loading libgkl_utils.so from jar:file:/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar!/com/intel/gkl/native/libgkl_utils.so<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.249</span> INFO  NativeLibraryLoader - Loading libgkl_pairhmm_omp.so from jar:file:/data/mouse/human_rme/genome_index/gatk-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>/gatk-package-<span class="hljs-number">4.1</span>.<span class="hljs-number">9.0</span>-local.jar!/com/intel/gkl/native/libgkl_pairhmm_omp.so<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Using CPU-supported AVX-<span class="hljs-number">512</span> instructions<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Flush-<span class="hljs-keyword">to</span>-zero (FTZ) is enabled <span class="hljs-keyword">when</span> running PairHMM<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Available threads: <span class="hljs-number">64</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  IntelPairHmm - Requested threads: <span class="hljs-number">4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.301</span> INFO  PairHMM - Using the OpenMP multi-threaded AVX-accelerated native PairHMM implementation<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.336</span> INFO  ProgressMeter - Starting traversal<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">06.337</span> INFO  ProgressMeter -        Current Locus  Elapsed Minutes     Regions Processed   Regions/Minute<br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">16.341</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">11753701</span>              <span class="hljs-number">0.2</span>                 <span class="hljs-number">39180</span>         <span class="hljs-number">235056.5</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">26.339</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">28001701</span>              <span class="hljs-number">0.3</span>                 <span class="hljs-number">93340</span>         <span class="hljs-number">279992.0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">36.340</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">42413701</span>              <span class="hljs-number">0.5</span>                <span class="hljs-number">141380</span>         <span class="hljs-number">282731.7</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">46.341</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">57197701</span>              <span class="hljs-number">0.7</span>                <span class="hljs-number">190660</span>         <span class="hljs-number">285961.4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">21</span>:<span class="hljs-number">59.455</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">70118701</span>              <span class="hljs-number">0.9</span>                <span class="hljs-number">233730</span>         <span class="hljs-number">264017.2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">09.454</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">84668701</span>              <span class="hljs-number">1.1</span>                <span class="hljs-number">282230</span>         <span class="hljs-number">268292.2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">19.454</span> INFO  ProgressMeter -           <span class="hljs-number">1</span>:<span class="hljs-number">99485701</span>              <span class="hljs-number">1.2</span>                <span class="hljs-number">331620</span>         <span class="hljs-number">272128.2</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">29.454</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">111821701</span>              <span class="hljs-number">1.4</span>                <span class="hljs-number">372740</span>         <span class="hljs-number">269071.3</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">39.455</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">125609701</span>              <span class="hljs-number">1.6</span>                <span class="hljs-number">418700</span>         <span class="hljs-number">269786.7</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">49.617</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">139055701</span>              <span class="hljs-number">1.7</span>                <span class="hljs-number">463520</span>         <span class="hljs-number">269279.6</span><br><span class="hljs-number">15</span>:<span class="hljs-number">22</span>:<span class="hljs-number">59.643</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">153017701</span>              <span class="hljs-number">1.9</span>                <span class="hljs-number">510060</span>         <span class="hljs-number">270106.4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">09.768</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">163760701</span>              <span class="hljs-number">2.1</span>                <span class="hljs-number">545870</span>         <span class="hljs-number">265350.4</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">19.767</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">176396701</span>              <span class="hljs-number">2.2</span>                <span class="hljs-number">587990</span>         <span class="hljs-number">264403.8</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">29.983</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">188480701</span>              <span class="hljs-number">2.4</span>                <span class="hljs-number">628270</span>         <span class="hljs-number">262424.3</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">39.984</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">201497701</span>              <span class="hljs-number">2.6</span>                <span class="hljs-number">671660</span>         <span class="hljs-number">262288.6</span><br><span class="hljs-number">15</span>:<span class="hljs-number">23</span>:<span class="hljs-number">50.582</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">213197701</span>              <span class="hljs-number">2.7</span>                <span class="hljs-number">710660</span>         <span class="hljs-number">259609.7</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">00.582</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">225782701</span>              <span class="hljs-number">2.9</span>                <span class="hljs-number">752610</span>         <span class="hljs-number">259155.8</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">10.583</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">236975701</span>              <span class="hljs-number">3.1</span>                <span class="hljs-number">789920</span>         <span class="hljs-number">257240.1</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">20.582</span> INFO  ProgressMeter -          <span class="hljs-number">1</span>:<span class="hljs-number">247268701</span>              <span class="hljs-number">3.2</span>                <span class="hljs-number">824230</span>         <span class="hljs-number">254595.0</span><br><span class="hljs-number">15</span>:<span class="hljs-number">24</span>:<span class="hljs-number">46.185</span> INFO  HaplotypeCaller - Shutting down engine<br><span class="hljs-literal">[<span class="hljs-number">2020</span>年<span class="hljs-number">12</span>月<span class="hljs-number">2</span>日 下午<span class="hljs-number">03</span>时<span class="hljs-number">24</span>分<span class="hljs-number">46</span>秒]</span> org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller <span class="hljs-keyword">done</span>. Elapsed time: <span class="hljs-number">3.68</span> minutes.<br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>total<span class="hljs-constructor">Memory()</span>=<span class="hljs-number">4291821568</span><br>Exception <span class="hljs-keyword">in</span> thread <span class="hljs-string">&quot;main&quot;</span> java.lang.OutOfMemoryError: Java heap space<br>        at java.util.stream.Nodes$DoubleArrayNode.&lt;init&gt;(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Nodes</span>.</span></span>java:<span class="hljs-number">1429</span>)<br>        at java.util.stream.Nodes$DoubleFixedNodeBuilder.&lt;init&gt;(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Nodes</span>.</span></span>java:<span class="hljs-number">1589</span>)<br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Nodes</span>.</span></span>double<span class="hljs-constructor">Builder(Nodes.<span class="hljs-params">java</span>:279)</span><br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DoublePipeline</span>.</span></span>make<span class="hljs-constructor">NodeBuilder(DoublePipeline.<span class="hljs-params">java</span>:164)</span><br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractPipeline</span>.</span></span>evaluate(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractPipeline</span>.</span></span>java:<span class="hljs-number">543</span>)<br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractPipeline</span>.</span></span>evaluate<span class="hljs-constructor">ToArrayNode(AbstractPipeline.<span class="hljs-params">java</span>:260)</span><br>        at java.util.stream.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DoublePipeline</span>.</span></span><span class="hljs-keyword">to</span><span class="hljs-constructor">Array(DoublePipeline.<span class="hljs-params">java</span>:506)</span><br>        at org.broadinstitute.hellbender.utils.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MathUtils</span>.</span></span>median(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MathUtils</span>.</span></span>java:<span class="hljs-number">841</span>)<br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlock</span>.</span></span>get<span class="hljs-constructor">MedianDP(GVCFBlock.<span class="hljs-params">java</span>:75)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HomRefBlock</span>.</span></span>create<span class="hljs-constructor">HomRefGenotype(HomRefBlock.<span class="hljs-params">java</span>:73)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlock</span>.</span></span><span class="hljs-keyword">to</span><span class="hljs-constructor">VariantContext(GVCFBlock.<span class="hljs-params">java</span>:49)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlockCombiner</span>.</span></span>emit<span class="hljs-constructor">CurrentBlock(GVCFBlockCombiner.<span class="hljs-params">java</span>:177)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFBlockCombiner</span>.</span></span>signal<span class="hljs-constructor">EndOfInput(GVCFBlockCombiner.<span class="hljs-params">java</span>:227)</span><br>        at org.broadinstitute.hellbender.utils.variant.writers.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFWriter</span>.</span></span>close(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GVCFWriter</span>.</span></span>java:<span class="hljs-number">70</span>)<br>        at org.broadinstitute.hellbender.tools.walkers.haplotypecaller.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HaplotypeCaller</span>.</span></span>close<span class="hljs-constructor">Tool(HaplotypeCaller.<span class="hljs-params">java</span>:216)</span><br>        at org.broadinstitute.hellbender.engine.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">GATKTool</span>.</span></span><span class="hljs-keyword">do</span><span class="hljs-constructor">Work(GATKTool.<span class="hljs-params">java</span>:1053)</span><br>        at org.broadinstitute.hellbender.cmdline.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CommandLineProgram</span>.</span></span>run<span class="hljs-constructor">Tool(CommandLineProgram.<span class="hljs-params">java</span>:140)</span><br>        at org.broadinstitute.hellbender.cmdline.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CommandLineProgram</span>.</span></span>instance<span class="hljs-constructor">MainPostParseArgs(CommandLineProgram.<span class="hljs-params">java</span>:192)</span><br>        at org.broadinstitute.hellbender.cmdline.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CommandLineProgram</span>.</span></span>instance<span class="hljs-constructor">Main(CommandLineProgram.<span class="hljs-params">java</span>:211)</span><br>        at org.broadinstitute.hellbender.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>run<span class="hljs-constructor">CommandLineProgram(Main.<span class="hljs-params">java</span>:160)</span><br>        at org.broadinstitute.hellbender.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>main<span class="hljs-constructor">Entry(Main.<span class="hljs-params">java</span>:203)</span><br>        at org.broadinstitute.hellbender.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>main(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>java:<span class="hljs-number">289</span>)<br><br></code></pre></td></tr></table></figure><p><strong>SH014</strong></p><p>HG00442 vcf ready</p><p>HG00443 vcf ready</p><p>gatk HaplotypeCaller doing HG00444 but shutting down (1299)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I HG00444Aligned.sortedByCoord.out.new.bam \<br>-O /data/mouse/human_rme/SH014/HG00444_new.vcf.gz \<br>-ERC GVCF<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">return</span></span><br>Using GATK jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar<br>Running:<br>    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx4g -jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar HaplotypeCaller -R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta -I HG00444Aligned.sortedByCoord.out.new.bam -O /data/mouse/human_rme/SH014/HG00444_new.vcf.gz -ERC GVCF<br>15:51:47.944 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so<br>Dec 02, 2020 3:51:48 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine<br>INFO: Failed to detect whether we are running on Google Compute Engine.<br>15:51:48.116 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:51:48.116 INFO  HaplotypeCaller - The Genome Analysis Toolkit (GATK) v4.1.9.0<br>15:51:48.117 INFO  HaplotypeCaller - For support and documentation go to https://software.broadinstitute.org/gatk/<br>15:51:48.225 INFO  HaplotypeCaller - Executing as zhuyufei@bdp-svr05 on Linux v5.3.1-1.el7.elrepo.x86_64 amd64<br>15:51:48.225 INFO  HaplotypeCaller - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_152-release-1056-b12<br>15:51:48.225 INFO  HaplotypeCaller - Start Date/Time: 2020年12月2日 下午03时51分47秒<br>15:51:48.225 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:51:48.225 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:51:48.226 INFO  HaplotypeCaller - HTSJDK Version: 2.23.0<br>15:51:48.226 INFO  HaplotypeCaller - Picard Version: 2.23.3<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.COMPRESSION_LEVEL : 2<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : false<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : true<br>15:51:48.227 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : false<br>15:51:48.227 INFO  HaplotypeCaller - Deflater: IntelDeflater<br>15:51:48.227 INFO  HaplotypeCaller - Inflater: IntelInflater<br>15:51:48.227 INFO  HaplotypeCaller - GCS max retries/reopens: 20<br>15:51:48.228 INFO  HaplotypeCaller - Requester pays: disabled<br>15:51:48.228 INFO  HaplotypeCaller - Initializing engine<br>15:51:48.606 INFO  HaplotypeCaller - Done initializing engine<br>15:51:48.608 INFO  HaplotypeCallerEngine - Tool is in reference confidence mode and the annotation, the following changes will be made to any specified annotations: &#x27;StrandBiasBySample&#x27; will be enabled. &#x27;ChromosomeCounts&#x27;, &#x27;FisherStrand&#x27;, &#x27;StrandOddsRatio&#x27; and &#x27;QualByDepth&#x27; annotations have been disabled<br>15:51:48.615 INFO  HaplotypeCallerEngine - Standard Emitting and Calling confidence set to 0.0 for reference-model confidence output<br>15:51:48.615 INFO  HaplotypeCallerEngine - All sites annotated with PLs forced to true for reference-model confidence output<br>15:51:48.631 INFO  NativeLibraryLoader - Loading libgkl_utils.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_utils.so<br>15:51:48.632 INFO  NativeLibraryLoader - Loading libgkl_pairhmm_omp.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_pairhmm_omp.so<br>15:51:48.687 INFO  IntelPairHmm - Using CPU-supported AVX-512 instructions<br>15:51:48.687 INFO  IntelPairHmm - Flush-to-zero (FTZ) is enabled when running PairHMM<br>15:51:48.688 INFO  IntelPairHmm - Available threads: 64<br>15:51:48.688 INFO  IntelPairHmm - Requested threads: 4<br>15:51:48.688 INFO  PairHMM - Using the OpenMP multi-threaded AVX-accelerated native PairHMM implementation<br>15:51:48.725 INFO  ProgressMeter - Starting traversal<br>15:51:48.725 INFO  ProgressMeter -        Current Locus  Elapsed Minutes     Regions Processed   Regions/Minute<br>15:51:58.727 INFO  ProgressMeter -           1:11600701              0.2                 38670         232020.0<br>15:52:08.726 INFO  ProgressMeter -           1:27983701              0.3                 93280         279826.0<br>15:52:18.727 INFO  ProgressMeter -           1:42827701              0.5                142760         285501.0<br>15:52:28.747 INFO  ProgressMeter -           1:57899701              0.7                193000         289340.9<br>15:52:39.822 INFO  ProgressMeter -           1:70169701              0.9                233900         274654.1<br>15:52:49.822 INFO  ProgressMeter -           1:85727701              1.0                285760         280629.2<br>15:52:59.823 INFO  ProgressMeter -          1:101075701              1.2                336920         284328.7<br>15:53:09.824 INFO  ProgressMeter -          1:113090701              1.4                376970         278896.2<br>15:53:19.906 INFO  ProgressMeter -          1:127433701              1.5                424780         279518.8<br>15:53:29.910 INFO  ProgressMeter -          1:142109701              1.7                473700         280899.8<br>15:53:39.985 INFO  ProgressMeter -          1:155774701              1.9                519250         280019.8<br>15:53:49.996 INFO  ProgressMeter -          1:166265701              2.0                554220         274205.7<br>15:54:00.097 INFO  ProgressMeter -          1:178859701              2.2                596200         272297.5<br>15:54:10.227 INFO  ProgressMeter -          1:191456701              2.4                638190         270608.7<br>15:54:20.303 INFO  ProgressMeter -          1:204050701              2.5                680170         269237.4<br>15:54:30.432 INFO  ProgressMeter -          1:216647701              2.7                722160         267951.3<br>15:54:40.525 INFO  ProgressMeter -          1:229241701              2.9                764140         266870.8<br>15:54:50.526 INFO  ProgressMeter -          1:240734701              3.0                802450         264835.0<br>15:55:26.303 INFO  HaplotypeCaller - Shutting down engine<br>[2020年12月2日 下午03时55分26秒] org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller done. Elapsed time: 3.64 minutes.<br>Runtime.totalMemory()=4291821568<br>Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space<br>        at java.util.stream.Nodes$DoubleArrayNode.&lt;init&gt;(Nodes.java:1429)<br>        at java.util.stream.Nodes$DoubleFixedNodeBuilder.&lt;init&gt;(Nodes.java:1589)<br>        at java.util.stream.Nodes.doubleBuilder(Nodes.java:279)<br>        at java.util.stream.DoublePipeline.makeNodeBuilder(DoublePipeline.java:164)<br>        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:543)<br>        at java.util.stream.AbstractPipeline.evaluateToArrayNode(AbstractPipeline.java:260)<br>        at java.util.stream.DoublePipeline.toArray(DoublePipeline.java:506)<br>        at org.broadinstitute.hellbender.utils.MathUtils.median(MathUtils.java:841)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.getMedianDP(GVCFBlock.java:75)<br>        at org.broadinstitute.hellbender.utils.variant.writers.HomRefBlock.createHomRefGenotype(HomRefBlock.java:73)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.toVariantContext(GVCFBlock.java:49)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.emitCurrentBlock(GVCFBlockCombiner.java:177)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.signalEndOfInput(GVCFBlockCombiner.java:227)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFWriter.close(GVCFWriter.java:70)<br>        at org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller.closeTool(HaplotypeCaller.java:216)<br>        at org.broadinstitute.hellbender.engine.GATKTool.doWork(GATKTool.java:1053)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.runTool(CommandLineProgram.java:140)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMainPostParseArgs(CommandLineProgram.java:192)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMain(CommandLineProgram.java:211)<br>        at org.broadinstitute.hellbender.Main.runCommandLineProgram(Main.java:160)<br>        at org.broadinstitute.hellbender.Main.mainEntry(Main.java:203)<br>        at org.broadinstitute.hellbender.Main.main(Main.java:289)<br></code></pre></td></tr></table></figure><p>Solution: java程序溢出</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-Xmx75000M</span><br></code></pre></td></tr></table></figure><p><strong>SH021</strong></p><p>HG00463 vcf ready</p><p>gatk doing HG00464 but shutting down (633) </p><figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs julia"><span class="hljs-built_in">Exception</span> <span class="hljs-keyword">in</span> thread <span class="hljs-string">&quot;main&quot;</span> java.lang.<span class="hljs-built_in">OutOfMemoryError</span>: Java heap space<br></code></pre></td></tr></table></figure><p>gatk HaplotypeCaller doing HG00465 but shutting down(729)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs shell">/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk --java-options &quot;-Xmx4g&quot; HaplotypeCaller  \<br>-R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta \<br>-I HG00465Aligned.sortedByCoord.out.new.bam \<br>-O /data/mouse/human_rme/SH021/HG00465_new.vcf.gz \<br>-ERC GVCF<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">return</span></span><br>Using GATK jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar<br>Running:<br>    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx4g -jar /data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar HaplotypeCaller -R /data/mouse/human_rme/genome_index/human_g1k_v37.fasta -I HG00465Aligned.sortedByCoord.out.new.bam -O /data/mouse/human_rme/SH021/HG00465_new.vcf.gz -ERC GVCF<br>15:35:01.927 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_compression.so<br>Dec 02, 2020 3:35:02 PM shaded.cloud_nio.com.google.auth.oauth2.ComputeEngineCredentials runningOnComputeEngine<br>INFO: Failed to detect whether we are running on Google Compute Engine.<br>15:35:02.092 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:35:02.092 INFO  HaplotypeCaller - The Genome Analysis Toolkit (GATK) v4.1.9.0<br>15:35:02.093 INFO  HaplotypeCaller - For support and documentation go to https://software.broadinstitute.org/gatk/<br>15:35:02.192 INFO  HaplotypeCaller - Executing as zhuyufei@bdp-svr05 on Linux v5.3.1-1.el7.elrepo.x86_64 amd64<br>15:35:02.192 INFO  HaplotypeCaller - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_152-release-1056-b12<br>15:35:02.192 INFO  HaplotypeCaller - Start Date/Time: 2020年12月2日 下午03时35分01秒<br>15:35:02.192 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:35:02.193 INFO  HaplotypeCaller - ------------------------------------------------------------<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Version: 2.23.0<br>15:35:02.194 INFO  HaplotypeCaller - Picard Version: 2.23.3<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.COMPRESSION_LEVEL : 2<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : false<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : true<br>15:35:02.194 INFO  HaplotypeCaller - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : false<br>15:35:02.195 INFO  HaplotypeCaller - Deflater: IntelDeflater<br>15:35:02.195 INFO  HaplotypeCaller - Inflater: IntelInflater<br>15:35:02.195 INFO  HaplotypeCaller - GCS max retries/reopens: 20<br>15:35:02.195 INFO  HaplotypeCaller - Requester pays: disabled<br>15:35:02.195 INFO  HaplotypeCaller - Initializing engine<br>15:35:02.568 INFO  HaplotypeCaller - Done initializing engine<br>15:35:02.569 INFO  HaplotypeCallerEngine - Tool is in reference confidence mode and the annotation, the following changes will be made to any specified annotations: &#x27;StrandBiasBySample&#x27; will be enabled. &#x27;ChromosomeCounts&#x27;, &#x27;FisherStrand&#x27;, &#x27;StrandOddsRatio&#x27; and &#x27;QualByDepth&#x27; annotations have been disabled<br>15:35:02.576 INFO  HaplotypeCallerEngine - Standard Emitting and Calling confidence set to 0.0 for reference-model confidence output<br>15:35:02.576 INFO  HaplotypeCallerEngine - All sites annotated with PLs forced to true for reference-model confidence output<br>15:35:02.589 INFO  NativeLibraryLoader - Loading libgkl_utils.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_utils.so<br>15:35:02.590 INFO  NativeLibraryLoader - Loading libgkl_pairhmm_omp.so from jar:file:/data/mouse/human_rme/genome_index/gatk-4.1.9.0/gatk-package-4.1.9.0-local.jar!/com/intel/gkl/native/libgkl_pairhmm_omp.so<br>15:35:02.642 INFO  IntelPairHmm - Using CPU-supported AVX-512 instructions<br>15:35:02.642 INFO  IntelPairHmm - Flush-to-zero (FTZ) is enabled when running PairHMM<br>15:35:02.642 INFO  IntelPairHmm - Available threads: 64<br>15:35:02.642 INFO  IntelPairHmm - Requested threads: 4<br>15:35:02.642 INFO  PairHMM - Using the OpenMP multi-threaded AVX-accelerated native PairHMM implementation<br>15:35:02.671 INFO  ProgressMeter - Starting traversal<br>15:35:02.672 INFO  ProgressMeter -        Current Locus  Elapsed Minutes     Regions Processed   Regions/Minute<br>15:35:12.675 INFO  ProgressMeter -           1:13535701              0.2                 45120         270720.0<br>15:35:22.673 INFO  ProgressMeter -           1:28421701              0.3                 94740         284220.0<br>15:35:32.672 INFO  ProgressMeter -           1:42599701              0.5                142000         284000.0<br>15:35:42.673 INFO  ProgressMeter -           1:56069701              0.7                186900         280343.0<br>15:35:59.292 INFO  ProgressMeter -           1:70610701              0.9                235370         249425.1<br>15:36:09.292 INFO  ProgressMeter -           1:83174701              1.1                277250         249699.8<br>15:36:19.293 INFO  ProgressMeter -           1:97466701              1.3                324890         254413.3<br>15:36:29.294 INFO  ProgressMeter -          1:108578701              1.4                361930         250696.1<br>15:36:39.295 INFO  ProgressMeter -          1:121907701              1.6                406360         252337.4<br>15:36:49.407 INFO  ProgressMeter -          1:135599701              1.8                452000         254087.2<br>15:36:59.411 INFO  ProgressMeter -          1:148913701              1.9                496380         255131.7<br>15:37:10.510 INFO  ProgressMeter -          1:157865701              2.1                526220         246978.2<br>15:37:20.743 INFO  ProgressMeter -          1:168830701              2.3                562770         244556.8<br>15:37:30.823 INFO  ProgressMeter -          1:180791701              2.5                602640         244064.5<br>15:37:40.934 INFO  ProgressMeter -          1:192755701              2.6                642520         243591.0<br>15:37:50.934 INFO  ProgressMeter -          1:205016701              2.8                683390         243687.8<br>15:38:00.935 INFO  ProgressMeter -          1:217073701              3.0                723580         243543.5<br>15:38:10.935 INFO  ProgressMeter -          1:228584701              3.1                761950         242835.8<br>15:38:20.935 INFO  ProgressMeter -          1:239054701              3.3                796850         241149.4<br>15:38:49.666 INFO  HaplotypeCaller - Shutting down engine<br>[2020年12月2日 下午03时38分49秒] org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller done. Elapsed time: 3.80 minutes.<br>Runtime.totalMemory()=4292345856<br>Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space<br>        at java.util.stream.Nodes$DoubleArrayNode.&lt;init&gt;(Nodes.java:1429)<br>        at java.util.stream.Nodes$DoubleFixedNodeBuilder.&lt;init&gt;(Nodes.java:1589)<br>        at java.util.stream.Nodes.doubleBuilder(Nodes.java:279)<br>        at java.util.stream.DoublePipeline.makeNodeBuilder(DoublePipeline.java:164)<br>        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:543)<br>        at java.util.stream.AbstractPipeline.evaluateToArrayNode(AbstractPipeline.java:260)<br>        at java.util.stream.DoublePipeline.toArray(DoublePipeline.java:506)<br>        at org.broadinstitute.hellbender.utils.MathUtils.median(MathUtils.java:841)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.getMedianDP(GVCFBlock.java:75)<br>        at org.broadinstitute.hellbender.utils.variant.writers.HomRefBlock.createHomRefGenotype(HomRefBlock.java:73)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlock.toVariantContext(GVCFBlock.java:49)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.emitCurrentBlock(GVCFBlockCombiner.java:177)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFBlockCombiner.signalEndOfInput(GVCFBlockCombiner.java:227)<br>        at org.broadinstitute.hellbender.utils.variant.writers.GVCFWriter.close(GVCFWriter.java:70)<br>        at org.broadinstitute.hellbender.tools.walkers.haplotypecaller.HaplotypeCaller.closeTool(HaplotypeCaller.java:216)<br>        at org.broadinstitute.hellbender.engine.GATKTool.doWork(GATKTool.java:1053)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.runTool(CommandLineProgram.java:140)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMainPostParseArgs(CommandLineProgram.java:192)<br>        at org.broadinstitute.hellbender.cmdline.CommandLineProgram.instanceMain(CommandLineProgram.java:211)<br>        at org.broadinstitute.hellbender.Main.runCommandLineProgram(Main.java:160)<br>        at org.broadinstitute.hellbender.Main.mainEntry(Main.java:203)<br>        at org.broadinstitute.hellbender.Main.main(Main.java:289)<br></code></pre></td></tr></table></figure><p><strong>SH002</strong></p><p>gatk HaplotypeCaller doing HG00407 (1060)</p><p>gatk HaplotypeCaller doing HG00406(1182) (but shutting down at Current Locus 1:246638732; try agin then shutting Current Locus down 1:241940732)</p><p>gatk HaplotypeCaller doing HG00408 (1455) (but shutting down at Current Locus 1:240860701 )</p><h1 id="imprinting-gene"><a href="#imprinting-gene" class="headerlink" title="imprinting gene"></a>imprinting gene</h1><p>基因铭印\parencite{reik2001genomic}是在真兽类哺乳动物中观察到的一种表观遗传现象。对于大多数常染色体基因，两个亲本拷贝都是转录或沉默。然而，在一小组基因中，其中一个拷贝以亲本特有的方式被关闭，从而导致单等位基因表达。这些基因被称为“印迹”，因为沉默的基因拷贝在卵子或精子中具有表观遗传标记或印迹。</p><p>印迹基因在胎儿和胎盘组织中发挥重要作用，在产前和产后的发育和生长中发挥重要作用\parencite{morison2005census}。有趣的是，母方表达的基因会限制胚胎的生长，而父方表达的基因会促进胚胎的生长。Igf2和 Igf2r在小鼠体内的拮抗作用是这种突出场景的一个典型案例。父方表达Igf2基因的缺失导致了宫内生长迟缓。另一方面，缺失母方表达的Igf2r基因，导致过度生长\parencite{lau1994loss}。</p><p>母方和父方表达的基因的拮抗作用引发了一系列进化理论的争论，旨在解释在“自然选择”过程中遗传印记的起源。目前最为科学接受的理论是亲属理论\parencite{haig1989selective, moore1991genomic}。简单地说，这个理论认为在多配偶的哺乳动物物种中，沉默来自母系的生长抑制基因可以导致胚胎的生长。这与营养需求增加有关，从而导致以后代为代价开发母亲资源，而后代可能是另一个男性的后代。</p><p>一个基因调控机制的进化优先沉默一个基因的亲本等位基因意味着父方和母方表达基因在进化过程中经历不同的选择压力。这一假设得到了两个群体揭示了不同的序列保守模式的支持。父系表达基因的蛋白质编码 DNA 序列在不同哺乳动物中保存得很好，而母系表达基因则差异很大。是否父方和母方表达的基因在分子功能和基因调控上也不同，这是一个尚未详细研究的问题。许多研究表明，印迹基因不仅在胚胎发育过程中起重要作用，而且还具有出生后的功能。因此，以产前发育为中心的亲属理论或许可以解释基因铭印进化的某些方面，但不是全部\parencite{hamed2012cellular}。</p><p>在出生后的发育过程中，基因铭印会影响内分泌网络、能量代谢和行为。对小鼠的敲除研究表明，表达 Peg1和 Peg3基因的两个父方基因具有明显的行为表型\parencite{lefebvre1998abnormal}。从父亲那里遗传到这些基因的非等位基因的雌性表现出缺乏母性照顾行为，包括吞食胎盘和筑巢以及幼崽聚集。</p><p>另一个有趣的事实是，胎盘哺乳动物如老鼠和人类，以及有袋动物如负鼠和袋鼠，都有基因铭印。卵生哺乳动物，如鸭嘴兽和针鼹鼠，似乎缺乏印记基因。胎盘哺乳动物和有袋类动物区别于卵生哺乳动物的一个生殖策略是允许胚胎直接影响用于自身生长的母性资源的数量。相反，在卵子中发育的胚胎不能直接影响母体资源。大多数无脊椎动物和脊椎动物使用产卵繁殖策略。值得注意的是，它们也可以进行孤雌生殖ー一种繁殖形式，即雌配子不经过雄配子受精而发育成一个新的二倍体个体(注意，孤雌生殖胚胎来自同一母体基因组的复制，而图2中描述的雌核发育胚胎来自两个不同的母体基因组)。生物体进行单性生殖的能力很可能表明基因铭印的完全缺失，因为这表明父系基因组是可有可无的。然而，在哺乳动物中，印迹基因表达控制胎儿生长的直接结果是孤雌生殖是不可能的。双亲都必须产生可存活的后代，使哺乳动物完全依赖有性生殖进行繁殖。因此，哺乳动物几乎不存在孤雌生殖现象\parencite{renfree2009evolution}。</p><p>为什么基因铭印只在一些哺乳动物中进化，而在脊椎动物中却没有？基因组印记的三个特征ーー许多印记基因的生长调节功能，印记基因对胎盘哺乳动物和有袋哺乳动物的限制，以及父系基因组对胎儿发育的必要性，为两个同样有吸引力的假说提供了证据。</p><p>第一个假设提出，基因铭印的进化是为了回应“父母冲突”的情况\parencite{moore1991genomic}。这源于母体和父体基因组的对立利益: 胚胎的发育依赖于父母一方，但是受到胚胎的影响，胚胎的基因组来自父母双方。父方表达的印记基因被认为可以促进胚胎发育，从而最大限度地提高拥有特定父方基因组的个体后代的适应性。母方表达的印迹基因被认为可以抑制胎儿的生长。这将使得母系资源更平等地分配给所有后代，并增加母系基因组向多个后代的传递，这些后代可能有不同的父系基因组。</p><p>第二个假设被称为“滋养层防御”\parencite{varmuza1994genomic}。这就提出，如果自发的卵母细胞激活导致胚胎的完全发育，那么母体基因组就有可能因为具备内部繁殖的解剖学条件而面临风险。由于男性缺乏必要的内部繁殖解剖设备，他们不共享相同的风险，应自发激活精子发生。因此，印记被认为可以抑制母染色体上促进胎盘发育的基因，或者激活限制这一过程的基因。因此，胎盘侵入母体子宫血管所必需的基因只能在受精后由父体基因组表达。</p><p>这两种假说都指出印迹基因在调节胎盘发育和功能方面的作用，然而，无论是亲代冲突还是滋养层防御模型都不能为所有的数据提供完整的解释\parencite{wilkins2003good}。有趣的是，植物胚乳中也发现了印迹基因，这种组织被比作胎盘，因为它将营养资源从亲本植物转移到胚胎中\parencite{grossniklaus2014transcriptional}。这一发现加强了关于基因铭印是作为调节父母和子女之间营养物质转移的手段进化而来的论点。有可能的是，并不是一个集群中的所有基因都是刻意为之的印记机制的目标，有些基因可能只是这个过程的“无辜旁观者”，而且它们的功能也不能提供有关基因铭印的信息。受印迹机制影响的无辜旁观者基因的存在可以令人满意地解释印迹基因的奇特丰富性，但在发育过程中没有明显的生物学功能\parencite{bartolomei1997genomic}。</p><h2 id="method-design"><a href="#method-design" class="headerlink" title="method design"></a>method design</h2><p>artical: <a href="https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0">https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0</a></p><p>这篇文章的主要思路是通过SNV来确定子代基因来自于父母双方的哪一方。</p><p>印记基因假说：</p><blockquote><p>Genomic imprinting is a special case of mono-allelic expression where genes are expressed in a parent-of-origin (PofO)-specific manner. Although several hypotheses exist to explain why genomic imprinting occurs, the parental conflict hypothesis that imprinted genes evolved from a parental battle between males and females to influence the allocation of maternal resources to offspring. This type of mono-allelic expression can be observed in mammals at different developmental stages and is dependent on stage, cell, and tissue type.</p></blockquote><h3 id="Material"><a href="#Material" class="headerlink" title="Material"></a>Material</h3><p>165 trio from HapMap/1000 Genomes Projects with RNA-Seq data from lymphoblastoid cell lines (LCLs) and 131 trios from the Genome-of-the-Netherlands </p><h3 id="Focus"><a href="#Focus" class="headerlink" title="Focus"></a>Focus</h3><p>complete imprinting (exclusive expression of the paternal or maternal allele) and incomplete imprinting (bias in expression towards the maternal or paternal allele)</p><h3 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h3><p>allele-specific RNA-Seq analysis of parent-offspring trios: </p><p>used phased genotypes to compute the relative expression from the maternal and paternal alleles in RNA-Seq reads at expressed heterozygous single nucleotide variants (SNVs);</p><p>summed the paternal and maternal counts for all heterozygous SNVs contained in a gene(irrespective of their exonic or intronic nature);</p><p>statistical tests to check for consistent parental expression bias of autosomal genes within the populations: Wilcoxon signed-rank (WSR) test and ShrinkBayes (SB);</p><ol><li><p>Strand-specific RNA-Seq in lymphoblastoid cell lines</p><ol><li><p>quality control by fastqc (version 0.11.2)</p></li><li><p>Over-represented sequences were removed by trimmomatic (version 0.32) [reads ≥ 30 bp in length were kept]</p></li><li><p>Cleaned reads were mapped to the human reference genome (hg19) with Gencode v16 annotations by STAR aligner (version 2.3.0) [yielding a mean of 79% uniquely mapped reads]</p></li><li><p>intermediate BAM file processing such as add read groups and sorting and merging BAM files of the same samples by Picard (version 1.112)</p></li><li><p>correct for mapping errors and biases which can result in false-positive allele-specific read assignments by WASP software (version 0.1)<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4626402/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4626402/</a> [resulting in the removal of a mean of 36% of reads that overlapped SNVs in each sample] {WASP input: bam; then identifies mapped reads that overlap known polymorphisms}</p></li><li><p>SNVs in each offspring were assigned on parental origin </p></li><li><p>determine allele-specific expression by heterozygous sites</p></li><li><p>quantified reference and alternate RNA-Seq reads mapped at heterozygous loci by AlleleCounter (v0.2, <a href="https://github.com/secastel/allelecounter">https://github.com/secastel/allelecounter</a>) </p></li><li><p>reference and alternate allele counts were used with PofO information to assign counts to the maternal and paternal alleles at each heterozygous site [Reads that did not uniquely map, or had base quality ≤ 10, were discarded.]</p></li><li><p>Use filter to reduce the mapping errors:</p><p>① removing heterozygous SNVs that had a mappability score &lt; 1 (based on the “CRG GEM Alignability of 50mers with no more than 2 mismatches” track, downloaded from UCSC genome browser)</p><p>② removing heterozygous SNVs that overlapped CNVs with MAF ≥ 5% identified in samples from the 1000 Genomes and HapMap Projects (ftp://<a href="http://ftp.1000genomes.ebi.ac.uk/vol1/withdrawn/phase3/integrated_sv_map/">ftp.1000genomes.ebi.ac.uk/vol1/withdrawn/phase3/integrated_sv_map/</a> and common CNVs</p><p>③ removing heterozygous SNVs that are segmental duplications</p><p>④ removing heterozygous SNVs that are simple repeats (both downloaded from “Variation and Repeats” track group of the UCSC genome browser). </p><p>[These filters resulted in the removal of 21% of heterozygous sites, leaving ~ 3.1 million sites for downstream analysis.]</p></li><li><p>Genotyping DNA: </p><p>BEAGLE  (<a href="https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0#ref-CR57">https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-019-0674-0#ref-CR57</a>) and IMPUTE2. Using GATK:UnifiedGenotyper as input for BEAGLE, treating all samples as unrelated. SHAPEIT2 and MVNcall19 were then used along with trio information to phase the complete set of SNVs. Each haplotype transmitted to the offspring, and therefore, allelic parental origin was then obtained from the phased haplotypes</p></li></ol></li><li><p>overall Genotype data processing</p><ol><li><p>get genotype data from smples</p><p> The <strong>GATK</strong> joint genotyping workflow can be applied in genotyping, here list the steps:</p><p> ①Versions 3.0 and above of GATK offer the possibility of calling DNA variants on cohorts of samples using the <strong>HaplotypeCaller</strong> algorithm in Genomic Variant Call Format (GVCF) mode.</p><p> input: RNA data</p><p> output: one GVCF file per sample</p><p> ②variants are called from the GVCF files through a joint genotyping analysis. </p></li><li><p>quality control: resolving strand inconsistencies, removing multi-allelic SNVs and indels, removing SNVs not present in the 1000 Genomes data</p></li><li><p>Use PLINK (versions 1.07 and 1.9), vcftools (version 0.1.15) and Beagle Utilities to convert coordinates from hg18 to hg19</p></li></ol></li></ol><h1 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h1><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br></pre></td><td class="code"><pre><code class="hljs tex">@article&#123;wutz2011gene,<br>  title=&#123;Gene silencing in X-chromosome inactivation: advances in understanding facultative heterochromatin formation&#125;,<br>  author=&#123;Wutz, Anton&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;12&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;542--553&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;barlow2011genomic,<br>  title=&#123;Genomic imprinting: a mammalian epigenetic discovery model&#125;,<br>  author=&#123;Barlow, Denise P&#125;,<br>  journal=&#123;Annual review of genetics&#125;,<br>  volume=&#123;45&#125;,<br>  pages=&#123;379--403&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Annual Reviews&#125;<br>&#125;<br><br>@article&#123;ferron2011postnatal,<br>  title=&#123;Postnatal loss of Dlk1 imprinting in stem cells and niche astrocytes regulates neurogenesis&#125;,<br>  author=&#123;Ferr&#123;<span class="hljs-keyword">\&#x27;</span>o&#125;n, Sacri R and Charalambous, Marika and Radford, Elizabeth and McEwen, Kirsten and Wildner, Hendrik and Hind, Eleanor and Morante-Redolat, Jose Manuel and Laborda, Jorge and Guillemot, Francois and Bauer, Steven R and others&#125;,<br>  journal=&#123;Nature&#125;,<br>  volume=&#123;475&#125;,<br>  number=&#123;7356&#125;,<br>  pages=&#123;381--385&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;lo2003allelic,<br>  title=&#123;Allelic variation in gene expression is common in the human genome&#125;,<br>  author=&#123;Lo, H Shuen and Wang, Zhining and Hu, Ying and Yang, Howard H and Gere, Sheryl and Buetow, Kenneth H and Lee, Maxwell P&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;13&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;1855--1862&#125;,<br>  year=&#123;2003&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@misc&#123;bartolomei25mammalian,<br>  title=&#123;Mammalian genomic imprinting. Cold Spring Harb Perspect Biol. 2011; 3 (7)&#125;,<br>  author=&#123;Bartolomei, MS and Ferguson-Smith, AC&#125;,<br>  publisher=&#123;Epub 2011/05/18. doi: 10.1101/cshperspect. a002592. PubMed PMID: 21576252&#125;<br>&#125;<br><br>@article&#123;heijmans2008persistent,<br>  title=&#123;Persistent epigenetic differences associated with prenatal exposure to famine in humans&#125;,<br>  author=&#123;Heijmans, Bastiaan T and Tobi, Elmar W and Stein, Aryeh D and Putter, Hein and Blauw, Gerard J and Susser, Ezra S and Slagboom, P Eline and Lumey, LH&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;105&#125;,<br>  number=&#123;44&#125;,<br>  pages=&#123;17046--17049&#125;,<br>  year=&#123;2008&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;deng2014single,<br>  title=&#123;Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells&#125;,<br>  author=&#123;Deng, Qiaolin and Ramsk&#123;<span class="hljs-keyword">\&quot;</span>o&#125;ld, Daniel and Reinius, Bj&#123;<span class="hljs-keyword">\&quot;</span>o&#125;rn and Sandberg, Rickard&#125;,<br>  journal=&#123;Science&#125;,<br>  volume=&#123;343&#125;,<br>  number=&#123;6167&#125;,<br>  pages=&#123;193--196&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;American Association for the Advancement of Science&#125;<br>&#125;<br><br>@article&#123;gendrel2014developmental,<br>  title=&#123;Developmental dynamics and disease potential of random monoallelic gene expression&#125;,<br>  author=&#123;Gendrel, Anne-Valerie and Attia, Mikael and Chen, Chong-Jian and Diabangouaya, Patricia and Servant, Nicolas and Barillot, Emmanuel and Heard, Edith&#125;,<br>  journal=&#123;Developmental cell&#125;,<br>  volume=&#123;28&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;366--380&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;chess2012mechanisms,<br>  title=&#123;Mechanisms and consequences of widespread random monoallelic expression&#125;,<br>  author=&#123;Chess, Andrew&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;13&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;421--428&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;tycko2010allele,<br>  title=&#123;Allele-specific DNA methylation: beyond imprinting&#125;,<br>  author=&#123;Tycko, Benjamin&#125;,<br>  journal=&#123;Human molecular genetics&#125;,<br>  volume=&#123;19&#125;,<br>  number=&#123;R2&#125;,<br>  pages=&#123;R210--R220&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;ohlsson2007widespread,<br>  title=&#123;Widespread monoallelic expression&#125;,<br>  author=&#123;Ohlsson, Rolf&#125;,<br>  journal=&#123;Science&#125;,<br>  volume=&#123;318&#125;,<br>  number=&#123;5853&#125;,<br>  pages=&#123;1077--1078&#125;,<br>  year=&#123;2007&#125;,<br>  publisher=&#123;American Association for the Advancement of Science&#125;<br>&#125;<br><br>@article&#123;esteller2000promoter,<br>  title=&#123;Promoter hypermethylation and BRCA1 inactivation in sporadic breast and ovarian tumors&#125;,<br>  author=&#123;Esteller, Manel and Silva, Jose Maria and Dominguez, Gemma and Bonilla, Felix and Matias-Guiu, Xavier and Lerma, Enrique and Bussaglia, Elena and Prat, Jaime and Harkes, I Clara and Repasky, Elizabeth A and others&#125;,<br>  journal=&#123;JNCI: Journal of the National Cancer Institute&#125;,<br>  volume=&#123;92&#125;,<br>  number=&#123;7&#125;,<br>  pages=&#123;564--569&#125;,<br>  year=&#123;2000&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;thrall2006brca1,<br>  title=&#123;BRCA1 expression in a large series of sporadic ovarian carcinomas: a Gynecologic Oncology Group study&#125;,<br>  author=&#123;Thrall, M and Gallion, HH and Kryscio, R and Kapali, M and Armstrong, DK and Deloia, Julie A&#125;,<br>  journal=&#123;International Journal of Gynecologic Cancer&#125;,<br>  volume=&#123;16&#125;,<br>  number=&#123;Suppl 1&#125;,<br>  pages=&#123;166--171&#125;,<br>  year=&#123;2006&#125;,<br>  publisher=&#123;BMJ Specialist Journals&#125;<br>&#125;<br><br>@article&#123;yan2002allelic,<br>  title=&#123;Allelic variation in human gene expression&#125;,<br>  author=&#123;Yan, Hai and Yuan, Weishi and Velculescu, Victor E and Vogelstein, Bert and Kinzler, Kenneth W and others&#125;,<br>  journal=&#123;Science&#125;,<br>  volume=&#123;297&#125;,<br>  number=&#123;5584&#125;,<br>  pages=&#123;1143--1143&#125;,<br>  year=&#123;2002&#125;<br>&#125;<br><br>@article&#123;cedar2008choreography,<br>  title=&#123;Choreography of Ig allelic exclusion&#125;,<br>  author=&#123;Cedar, Howard and Bergman, Yehudit&#125;,<br>  journal=&#123;Current opinion in immunology&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;308--317&#125;,<br>  year=&#123;2008&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;borel2015biased,<br>  title=&#123;Biased allelic expression in human primary fibroblast single cells&#125;,<br>  author=&#123;Borel, Christelle and Ferreira, Pedro G and Santoni, Federico and Delaneau, Olivier and Fort, Alexandre and Popadin, Konstantin Y and Garieri, Marco and Falconnet, Emilie and Ribaux, Pascale and Guipponi, Michel and others&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;96&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;70--80&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;risso2014normalization,<br>  title=&#123;Normalization of RNA-seq data using factor analysis of control genes or samples&#125;,<br>  author=&#123;Risso, Davide and Ngai, John and Speed, Terence P and Dudoit, Sandrine&#125;,<br>  journal=&#123;Nature biotechnology&#125;,<br>  volume=&#123;32&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;896--902&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;lappalainen2013transcriptome,<br>  title=&#123;Transcriptome and genome sequencing uncovers functional variation in humans&#125;,<br>  author=&#123;Lappalainen, Tuuli and Sammeth, Michael and Friedl&#123;<span class="hljs-keyword">\&quot;</span>a&#125;nder, Marc R and Ac‘t Hoen, Peter and Monlong, Jean and Rivas, Manuel A and Gonzalez-Porta, Mar and Kurbatova, Natalja and Griebel, Thasso and Ferreira, Pedro G and others&#125;,<br>  journal=&#123;Nature&#125;,<br>  volume=&#123;501&#125;,<br>  number=&#123;7468&#125;,<br>  pages=&#123;506--511&#125;,<br>  year=&#123;2013&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;li2009sequence,<br>  title=&#123;The sequence alignment/map format and SAMtools&#125;,<br>  author=&#123;Li, Heng and Handsaker, Bob and Wysoker, Alec and Fennell, Tim and Ruan, Jue and Homer, Nils and Marth, Gabor and Abecasis, Goncalo and Durbin, Richard&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;16&#125;,<br>  pages=&#123;2078--2079&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;trapnell2012differential,<br>  title=&#123;Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks&#125;,<br>  author=&#123;Trapnell, Cole and Roberts, Adam and Goff, Loyal and Pertea, Geo and Kim, Daehwan and Kelley, David R and Pimentel, Harold and Salzberg, Steven L and Rinn, John L and Pachter, Lior&#125;,<br>  journal=&#123;Nature protocols&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;562--578&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;trapnell2010transcript,<br>  title=&#123;Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation&#125;,<br>  author=&#123;Trapnell, Cole and Williams, Brian A and Pertea, Geo and Mortazavi, Ali and Kwan, Gordon and Van Baren, Marijke J and Salzberg, Steven L and Wold, Barbara J and Pachter, Lior&#125;,<br>  journal=&#123;Nature biotechnology&#125;,<br>  volume=&#123;28&#125;,<br>  number=&#123;5&#125;,<br>  pages=&#123;511--515&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;harrow2012gencode,<br>  title=&#123;GENCODE: the reference human genome annotation for The ENCODE Project&#125;,<br>  author=&#123;Harrow, Jennifer and Frankish, Adam and Gonzalez, Jose M and Tapanari, Electra and Diekhans, Mark and Kokocinski, Felix and Aken, Bronwen L and Barrell, Daniel and Zadissa, Amonida and Searle, Stephen and others&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;22&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1760--1774&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;xie2019modeling,<br>  title=&#123;Modeling allele-specific expression at the gene and SNP levels simultaneously by a Bayesian logistic mixed regression model&#125;,<br>  author=&#123;Xie, Jing and Ji, Tieming and Ferreira, Marco AR and Li, Yahan and Patel, Bhaumik N and Rivera, Rocio M&#125;,<br>  journal=&#123;BMC bioinformatics&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;530&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br><br>@article&#123;mckenna2010genome,<br>  title=&#123;The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data&#125;,<br>  author=&#123;McKenna, Aaron and Hanna, Matthew and Banks, Eric and Sivachenko, Andrey and Cibulskis, Kristian and Kernytsky, Andrew and Garimella, Kiran and Altshuler, David and Gabriel, Stacey and Daly, Mark and others&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1297--1303&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;li2011statistical,<br>  title=&#123;A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data&#125;,<br>  author=&#123;Li, Heng&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;27&#125;,<br>  number=&#123;21&#125;,<br>  pages=&#123;2987--2993&#125;,<br>  year=&#123;2011&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;kim2015hisat,<br>  title=&#123;HISAT: a fast spliced aligner with low memory requirements&#125;,<br>  author=&#123;Kim, Daehwan and Langmead, Ben and Salzberg, Steven L&#125;,<br>  journal=&#123;Nature methods&#125;,<br>  volume=&#123;12&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;357--360&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;li2009fast,<br>  title=&#123;Fast and accurate short read alignment with Burrows--Wheeler transform&#125;,<br>  author=&#123;Li, Heng and Durbin, Richard&#125;,<br>  journal=&#123;bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;14&#125;,<br>  pages=&#123;1754--1760&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;mayba2014mbased,<br>  title=&#123;MBASED: allele-specific expression detection in cancer tissues and cell lines&#125;,<br>  author=&#123;Mayba, Oleg and Gilbert, Houston N and Liu, Jinfeng and Haverty, Peter M and Jhunjhunwala, Suchit and Jiang, Zhaoshi and Watanabe, Colin and Zhang, Zemin&#125;,<br>  journal=&#123;Genome biology&#125;,<br>  volume=&#123;15&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;405&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;edsgard2016geneiase,<br>  title=&#123;GeneiASE: Detection of condition-dependent and static allele-specific expression from RNA-seq data without haplotype information&#125;,<br>  author=&#123;Edsg&#123;<span class="hljs-keyword">\&quot;</span>a&#125;rd, Daniel and Iglesias, Maria Jesus and Reilly, Sarah-Jayne and Hamsten, Anders and Tornvall, Per and Odeberg, Jacob and Emanuelsson, Olof&#125;,<br>  journal=&#123;Scientific reports&#125;,<br>  volume=&#123;6&#125;,<br>  pages=&#123;21134&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;harvey2015quasar,<br>  title=&#123;QuASAR: quantitative allele-specific analysis of reads&#125;,<br>  author=&#123;Harvey, Chris T and Moyerbrailean, Gregory A and Davis, Gordon O and Wen, Xiaoquan and Luca, Francesca and Pique-Regi, Roger&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;31&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;1235--1242&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;fan2020asep,<br>  title=&#123;ASEP: Gene-based detection of allele-specific expression across individuals in a population by RNA sequencing&#125;,<br>  author=&#123;Fan, Jiaxin and Hu, Jian and Xue, Chenyi and Zhang, Hanrui and Susztak, Katalin and Reilly, Muredach P and Xiao, Rui and Li, Mingyao&#125;,<br>  journal=&#123;PLoS Genetics&#125;,<br>  volume=&#123;16&#125;,<br>  number=&#123;5&#125;,<br>  pages=&#123;e1008786&#125;,<br>  year=&#123;2020&#125;,<br>  publisher=&#123;Public Library of Science&#125;<br>&#125;<br><br>@article&#123;castel2016rare,<br>  title=&#123;Rare variant phasing and haplotypic expression from RNA sequencing with phASER&#125;,<br>  author=&#123;Castel, Stephane E and Mohammadi, Pejman and Chung, Wendy K and Shen, Yufeng and Lappalainen, Tuuli&#125;,<br>  journal=&#123;Nature communications&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;1--6&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;li2009fast,<br>  title=&#123;Fast and accurate short read alignment with Burrows--Wheeler transform&#125;,<br>  author=&#123;Li, Heng and Durbin, Richard&#125;,<br>  journal=&#123;bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;14&#125;,<br>  pages=&#123;1754--1760&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;li2009sequence,<br>  title=&#123;The sequence alignment/map format and SAMtools&#125;,<br>  author=&#123;Li, Heng and Handsaker, Bob and Wysoker, Alec and Fennell, Tim and Ruan, Jue and Homer, Nils and Marth, Gabor and Abecasis, Goncalo and Durbin, Richard&#125;,<br>  journal=&#123;Bioinformatics&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;16&#125;,<br>  pages=&#123;2078--2079&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;poplin2017scaling,<br>  title=&#123;Scaling accurate genetic variant discovery to tens of thousands of samples&#125;,<br>  author=&#123;Poplin, Ryan and Ruano-Rubio, Valentin and DePristo, Mark A and Fennell, Tim J and Carneiro, Mauricio O and Van der Auwera, Geraldine A and Kling, David E and Gauthier, Laura D and Levy-Moonshine, Ami and Roazen, David and others&#125;,<br>  journal=&#123;BioRxiv&#125;,<br>  pages=&#123;201178&#125;,<br>  year=&#123;2017&#125;,<br>  publisher=&#123;Cold Spring Harbor Laboratory&#125;<br>&#125;<br><br>@article&#123;sherry2001dbsnp,<br>  title=&#123;dbSNP: the NCBI database of genetic variation&#125;,<br>  author=&#123;Sherry, Stephen T and Ward, M-H and Kholodov, M and Baker, J and Phan, Lon and Smigielski, Elizabeth M and Sirotkin, Karl&#125;,<br>  journal=&#123;Nucleic acids research&#125;,<br>  volume=&#123;29&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;308--311&#125;,<br>  year=&#123;2001&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;cingolani2012program,<br>  title=&#123;A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of Drosophila melanogaster strain w1118; iso-2; iso-3&#125;,<br>  author=&#123;Cingolani, Pablo and Platts, Adrian and Wang, Le Lily and Coon, Melissa and Nguyen, Tung and Wang, Luan and Land, Susan J and Lu, Xiangyi and Ruden, Douglas M&#125;,<br>  journal=&#123;Fly&#125;,<br>  volume=&#123;6&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;80--92&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Taylor <span class="hljs-keyword">\&amp;</span> Francis&#125;<br>&#125;<br><br>@article&#123;ruden2012using,<br>  title=&#123;Using Drosophila melanogaster as a model for genotoxic chemical mutational studies with a new program, SnpSift&#125;,<br>  author=&#123;Ruden, Douglas Mark and Cingolani, Pablo and Patel, Viral M and Coon, Melissa and Nguyen, Tung and Land, Susan J and Lu, Xiangyi&#125;,<br>  journal=&#123;Frontiers in genetics&#125;,<br>  volume=&#123;3&#125;,<br>  pages=&#123;35&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Frontiers&#125;<br>&#125;<br><br>@article&#123;ahn2019analysis,<br>  title=&#123;Analysis of allele-specific expression using RNA-seq of the Korean native pig and Landrace reciprocal cross&#125;,<br>  author=&#123;Ahn, Byeongyong and Choi, Min-Kyeung and Yum, Joori and Cho, In-Cheol and Kim, Jin-Hoi and Park, Chankyu&#125;,<br>  journal=&#123;Asian-Australasian journal of animal sciences&#125;,<br>  volume=&#123;32&#125;,<br>  number=&#123;12&#125;,<br>  pages=&#123;1816&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;Asian-Australasian Association of Animal Production Societies (AAAP)&#125;<br>&#125;<br><br>@article&#123;jadhav2019rna,<br>  title=&#123;RNA-Seq in 296 phased trios provides a high-resolution map of genomic imprinting&#125;,<br>  author=&#123;Jadhav, Bharati and Monajemi, Ramin and Gagalova, Kristina K and Ho, Daniel and Draisma, Harmen HM and van de Wiel, Mark A and Franke, Lude and Heijmans, Bastiaan T and van Meurs, Joyce and Jansen, Rick and others&#125;,<br>  journal=&#123;BMC biology&#125;,<br>  volume=&#123;17&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;50&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;BioMed Central&#125;<br>&#125;<br><br>@article&#123;barallon2010recommendation,<br>  title=&#123;Recommendation of short tandem repeat profiling for authenticating human cell lines, stem cells, and tissues&#125;,<br>  author=&#123;Barallon, Rita and Bauer, Steven R and Butler, John and Capes-Davis, Amanda and Dirks, Wilhelm G and Elmore, Eugene and Furtado, Manohar and Kline, Margaret C and Kohara, Arihiro and Los, Georgyi V and others&#125;,<br>  journal=&#123;In Vitro Cellular <span class="hljs-keyword">\&amp;</span> Developmental Biology-Animal&#125;,<br>  volume=&#123;46&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;727--732&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;dumache2018chimerism,<br>  title=&#123;Chimerism Monitoring by Short Tandem Repeat (STR) Markers in Allogeneic Stem Cell Transplantation.&#125;,<br>  author=&#123;Dumache, Raluca and Enache, Alexandra and Barbarii, Ligia and Constantinescu, Carmen and Pascalau, Andreea and Jinca, Cristian and Arghirescu, Smaranda&#125;,<br>  journal=&#123;Clinical laboratory&#125;,<br>  volume=&#123;64&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1535--1543&#125;,<br>  year=&#123;2018&#125;<br>&#125;<br><br>@article&#123;nims2010short,<br>  title=&#123;Short tandem repeat profiling: part of an overall strategy for reducing the frequency of cell misidentification&#125;,<br>  author=&#123;Nims, Raymond W and Sykes, Greg and Cottrill, Karin and Ikonomi, Pranvera and Elmore, Eugene&#125;,<br>  journal=&#123;In Vitro Cellular <span class="hljs-keyword">\&amp;</span> Developmental Biology-Animal&#125;,<br>  volume=&#123;46&#125;,<br>  number=&#123;10&#125;,<br>  pages=&#123;811--819&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Springer&#125;<br>&#125;<br><br>@article&#123;huang2002mutation,<br>  title=&#123;Mutation patterns at dinucleotide microsatellite loci in humans&#125;,<br>  author=&#123;Huang, Qing-Yang and Xu, Fu-Hua and Shen, Hui and Deng, Hong-Yi and Liu, Yong-Jun and Liu, Yao-Zhong and Li, Jin-Long and Recker, Robert R and Deng, Hong-Wen&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;70&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;625--634&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;di1998heterogeneity,<br>  title=&#123;Heterogeneity of microsatellite mutations within and between loci, and implications for human demographic histories&#125;,<br>  author=&#123;Di Rienzo, Anna and Donnelly, Peter and Toomajian, Chris and Sisk, Bronwyn and Hill, Adrian and Petzl-Erler, Maria Luiza and Haines, G Ken and Barch, David H&#125;,<br>  journal=&#123;Genetics&#125;,<br>  volume=&#123;148&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;1269--1284&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Genetics Soc America&#125;<br>&#125;<br><br>@article&#123;hastbacka1992linkage,<br>  title=&#123;Linkage disequilibrium mapping in isolated founder populations: diastrophic dysplasia in Finland&#125;,<br>  author=&#123;H&#123;<span class="hljs-keyword">\&quot;</span>a&#125;stbacka, Johanna and de la Chapelle, Albert and Kaitila, Ilkka and Sistonen, Pertti and Weaver, Alix and Lander, Eric&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;2&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;204--211&#125;,<br>  year=&#123;1992&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;holtkemper2001mutation,<br>  title=&#123;Mutation rates at two human Y-chromosomal microsatellite loci using small pool PCR techniques&#125;,<br>  author=&#123;Holtkemper, Ulrike and Rolf, Burkhard and Hohoff, Carsten and Forster, Peter and Brinkmann, Bernd&#125;,<br>  journal=&#123;Human molecular genetics&#125;,<br>  volume=&#123;10&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;629--633&#125;,<br>  year=&#123;2001&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;huang2002mutation,<br>  title=&#123;Mutation patterns at dinucleotide microsatellite loci in humans&#125;,<br>  author=&#123;Huang, Qing-Yang and Xu, Fu-Hua and Shen, Hui and Deng, Hong-Yi and Liu, Yong-Jun and Liu, Yao-Zhong and Li, Jin-Long and Recker, Robert R and Deng, Hong-Wen&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;70&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;625--634&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;fan2007brief,<br>  title=&#123;A brief review of short tandem repeat mutation&#125;,<br>  author=&#123;Fan, Hao and Chu, Jia-You&#125;,<br>  journal=&#123;Genomics, proteomics <span class="hljs-keyword">\&amp;</span> bioinformatics&#125;,<br>  volume=&#123;5&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;7--14&#125;,<br>  year=&#123;2007&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;benson1999tandem,<br>  title=&#123;Tandem repeats finder: a program to analyze DNA sequences&#125;,<br>  author=&#123;Benson, Gary&#125;,<br>  journal=&#123;Nucleic acids research&#125;,<br>  volume=&#123;27&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;573--580&#125;,<br>  year=&#123;1999&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;gymrek2012lobstr,<br>  title=&#123;lobSTR: a short tandem repeat profiler for personal genomes&#125;,<br>  author=&#123;Gymrek, Melissa and Golan, David and Rosset, Saharon and Erlich, Yaniv&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;22&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;1154--1162&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;tang2017strscan,<br>  title=&#123;STRScan: targeted profiling of short tandem repeats in whole-genome sequencing data&#125;,<br>  author=&#123;Tang, Haixu and Nzabarushimana, Etienne&#125;,<br>  journal=&#123;BMC bioinformatics&#125;,<br>  volume=&#123;18&#125;,<br>  number=&#123;11&#125;,<br>  pages=&#123;31--36&#125;,<br>  year=&#123;2017&#125;,<br>  publisher=&#123;BioMed Central&#125;<br>&#125;<br><br>@misc&#123;andrews2010fastqc,<br>  title=&#123;FastQC: a quality control tool for high throughput sequence data&#125;,<br>  author=&#123;Andrews, Simon and others&#125;,<br>  year=&#123;2010&#125;,<br>  publisher=&#123;Babraham Bioinformatics, Babraham Institute, Cambridge, United Kingdom&#125;<br>&#125;<br><br>@article&#123;kent2002human,<br>  title=&#123;The human genome browser at UCSC&#125;,<br>  author=&#123;Kent, W James and Sugnet, Charles W and Furey, Terrence S and Roskin, Krishna M and Pringle, Tom H and Zahler, Alan M and Haussler, David&#125;,<br>  journal=&#123;Genome research&#125;,<br>  volume=&#123;12&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;996--1006&#125;,<br>  year=&#123;2002&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;richard2008comparative,<br>  title=&#123;Comparative genomics and molecular dynamics of DNA repeats in eukaryotes&#125;,<br>  author=&#123;Richard, Guy-Franck and Kerrest, Alix and Dujon, Bernard&#125;,<br>  journal=&#123;Microbiology and molecular biology reviews&#125;,<br>  volume=&#123;72&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;686--727&#125;,<br>  year=&#123;2008&#125;,<br>  publisher=&#123;Am Soc Microbiol&#125;<br>&#125;<br><br>@article&#123;gulcher2012microsatellite,<br>  title=&#123;Microsatellite markers for linkage and association studies&#125;,<br>  author=&#123;Gulcher, Jeffrey&#125;,<br>  journal=&#123;Cold Spring Harbor Protocols&#125;,<br>  volume=&#123;2012&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;pdb--top068510&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Cold Spring Harbor Laboratory Press&#125;<br>&#125;<br><br>@article&#123;brinkmann1998mutation,<br>  title=&#123;Mutation rate in human microsatellites: influence of the structure and length of the tandem repeat&#125;,<br>  author=&#123;Brinkmann, Bernd and Klintschar, Michael and Neuhuber, Franz and H&#123;<span class="hljs-keyword">\&quot;</span>u&#125;hne, Julia and Rolf, Burkhard&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;62&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;1408--1415&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;kit1961equilibrium,<br>  title=&#123;Equilibrium sedimentation in density gradients of DNA preparations from animal tissues&#125;,<br>  author=&#123;Kit, Saul&#125;,<br>  journal=&#123;Journal of molecular biology&#125;,<br>  volume=&#123;3&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;711--IN2&#125;,<br>  year=&#123;1961&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@book&#123;turnpenny2016emery,<br>  title=&#123;Emery&#x27;s Elements of Medical Genetics E-Book&#125;,<br>  author=&#123;Turnpenny, Peter D and Ellard, Sian&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Elsevier Health Sciences&#125;<br>&#125;<br><br>@article&#123;king1997evolutionary,<br>  title=&#123;Evolutionary tuning knobs&#125;,<br>  author=&#123;King, David G and Soller, Morris and Kashi, Yechezkel&#125;,<br>  journal=&#123;Endeavour&#125;,<br>  volume=&#123;21&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;36--40&#125;,<br>  year=&#123;1997&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;chistiakov2006microsatellites,<br>  title=&#123;Microsatellites and their genomic distribution, evolution, function and applications: a review with special reference to fish genetics&#125;,<br>  author=&#123;Chistiakov, Dimitry A and Hellemans, Bart and Volckaert, Filip AM&#125;,<br>  journal=&#123;Aquaculture&#125;,<br>  volume=&#123;255&#125;,<br>  number=&#123;1-4&#125;,<br>  pages=&#123;1--29&#125;,<br>  year=&#123;2006&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;pearson2005repeat,<br>  title=&#123;Repeat instability: mechanisms of dynamic mutations&#125;,<br>  author=&#123;Pearson, Christopher E and Edamura, Kerrie Nichol and Cleary, John D&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;6&#125;,<br>  number=&#123;10&#125;,<br>  pages=&#123;729--742&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;klintschar2004haplotype,<br>  title=&#123;Haplotype studies support slippage as the mechanism of germline mutations in short tandem repeats&#125;,<br>  author=&#123;Klintschar, Michael and Dauber, Eva-Maria and Ricci, Ugo and Cerri, Nicoletta and Immel, Uta-Dorothee and Kleiber, Manfred and Mayr, Wolfgang R&#125;,<br>  journal=&#123;Electrophoresis&#125;,<br>  volume=&#123;25&#125;,<br>  number=&#123;20&#125;,<br>  pages=&#123;3344--3348&#125;,<br>  year=&#123;2004&#125;,<br>  publisher=&#123;Wiley Online Library&#125;<br>&#125;<br><br>@article&#123;brinkmann1998mutation,<br>  title=&#123;Mutation rate in human microsatellites: influence of the structure and length of the tandem repeat&#125;,<br>  author=&#123;Brinkmann, Bernd and Klintschar, Michael and Neuhuber, Franz and H&#123;<span class="hljs-keyword">\&quot;</span>u&#125;hne, Julia and Rolf, Burkhard&#125;,<br>  journal=&#123;The American Journal of Human Genetics&#125;,<br>  volume=&#123;62&#125;,<br>  number=&#123;6&#125;,<br>  pages=&#123;1408--1415&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;gymrek2016abundant,<br>  title=&#123;Abundant contribution of short tandem repeats to gene expression variation in humans&#125;,<br>  author=&#123;Gymrek, Melissa and Willems, Thomas and Guilmatre, Audrey and Zeng, Haoyang and Markus, Barak and Georgiev, Stoyan and Daly, Mark J and Price, Alkes L and Pritchard, Jonathan K and Sharp, Andrew J and others&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;48&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;22--29&#125;,<br>  year=&#123;2016&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;marcotte1999census,<br>  title=&#123;A census of protein repeats&#125;,<br>  author=&#123;Marcotte, Edward M and Pellegrini, Matteo and Yeates, Todd O and Eisenberg, David&#125;,<br>  journal=&#123;Journal of molecular biology&#125;,<br>  volume=&#123;293&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;151--160&#125;,<br>  year=&#123;1999&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;sutherland1995simple,<br>  title=&#123;Simple tandem DNA repeats and human genetic disease.&#125;,<br>  author=&#123;Sutherland, Grant R and Richards, Robert I&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;92&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;3636--3641&#125;,<br>  year=&#123;1995&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;hancock2005simple,<br>  title=&#123;Simple sequence repeats in proteins and their significance for network evolution&#125;,<br>  author=&#123;Hancock, John M and Simon, Michelle&#125;,<br>  journal=&#123;Gene&#125;,<br>  volume=&#123;345&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;113--118&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;fondon2004molecular,<br>  title=&#123;Molecular origins of rapid and continuous morphological evolution&#125;,<br>  author=&#123;Fondon, John W and Garner, Harold R&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;101&#125;,<br>  number=&#123;52&#125;,<br>  pages=&#123;18058--18063&#125;,<br>  year=&#123;2004&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;verstrepen2005intragenic,<br>  title=&#123;Intragenic tandem repeats generate functional variability&#125;,<br>  author=&#123;Verstrepen, Kevin J and Jansen, An and Lewitter, Fran and Fink, Gerald R&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;37&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;986--990&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;moxon1994adaptive,<br>  title=&#123;Adaptive evolution of highly mutable loci in pathogenic bacteria&#125;,<br>  author=&#123;Moxon, E Richard and Rainey, Paul B and Nowak, Martin A and Lenski, Richard E&#125;,<br>  journal=&#123;Current biology&#125;,<br>  volume=&#123;4&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;24--33&#125;,<br>  year=&#123;1994&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;grunewald2015chimeric,<br>  title=&#123;Chimeric EWSR1-FLI1 regulates the Ewing sarcoma susceptibility gene EGR2 via a GGAA microsatellite&#125;,<br>  author=&#123;Gr&#123;<span class="hljs-keyword">\&quot;</span>u&#125;newald, Thomas GP and Bernard, Virginie and Gilardi-Hebenstreit, Pascale and Raynal, Virginie and Surdez, Didier and Aynaud, Marie-Ming and Mirabeau, Olivier and Cidre-Aranaz, Florencia and Tirode, Franck and Zaidi, Sakina and others&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;47&#125;,<br>  number=&#123;9&#125;,<br>  pages=&#123;1073--1078&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;musa2019cooperation,<br>  title=&#123;Cooperation of cancer drivers with regulatory germline variants shapes clinical outcomes&#125;,<br>  author=&#123;Musa, Julian and Cidre-Aranaz, Florencia and Aynaud, Marie-Ming and Orth, Martin F and Knott, Maximilian ML and Mirabeau, Olivier and Mazor, Gal and Varon, Mor and H&#123;<span class="hljs-keyword">\&quot;</span>o&#125;lting, Tilman LB and Grosset&#123;<span class="hljs-keyword">\^</span>e&#125;te, Sandrine and others&#125;,<br>  journal=&#123;Nature communications&#125;,<br>  volume=&#123;10&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;1--10&#125;,<br>  year=&#123;2019&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;forster2015elevated,<br>  title=&#123;Elevated germline mutation rate in teenage fathers&#125;,<br>  author=&#123;Forster, Peter and Hohoff, Carsten and Dunkelmann, Bettina and Sch&#123;<span class="hljs-keyword">\&quot;</span>u&#125;renkamp, Marianne and Pfeiffer, Heidi and Neuhuber, Franz and Brinkmann, Bernd&#125;,<br>  journal=&#123;Proceedings of the Royal Society B: Biological Sciences&#125;,<br>  volume=&#123;282&#125;,<br>  number=&#123;1803&#125;,<br>  pages=&#123;20142898&#125;,<br>  year=&#123;2015&#125;,<br>  publisher=&#123;The Royal Society&#125;<br>&#125;<br><br>@article&#123;weber1993mutation,<br>  title=&#123;Mutation of human short tandem repeats&#125;,<br>  author=&#123;Weber, James L and Wong, Carmen&#125;,<br>  journal=&#123;Human molecular genetics&#125;,<br>  volume=&#123;2&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;1123--1128&#125;,<br>  year=&#123;1993&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;jarne1996microsatellites,<br>  title=&#123;Microsatellites, from molecules to populations and back&#125;,<br>  author=&#123;Jarne, Philippe and Lagoda, Pierre JL&#125;,<br>  journal=&#123;Trends in ecology <span class="hljs-keyword">\&amp;</span> evolution&#125;,<br>  volume=&#123;11&#125;,<br>  number=&#123;10&#125;,<br>  pages=&#123;424--429&#125;,<br>  year=&#123;1996&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;kruglyak1998equilibrium,<br>  title=&#123;Equilibrium distributions of microsatellite repeat length resulting from a balance between slippage events and point mutations&#125;,<br>  author=&#123;Kruglyak, Semyon and Durrett, Richard T and Schug, Malcolm D and Aquadro, Charles F&#125;,<br>  journal=&#123;Proceedings of the National Academy of Sciences&#125;,<br>  volume=&#123;95&#125;,<br>  number=&#123;18&#125;,<br>  pages=&#123;10774--10778&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;National Acad Sciences&#125;<br>&#125;<br><br>@article&#123;reik2001genomic,<br>  title=&#123;Genomic imprinting: parental influence on the genome&#125;,<br>  author=&#123;Reik, Wolf and Walter, J&#123;<span class="hljs-keyword">\&quot;</span>o&#125;rn&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;2&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;21--32&#125;,<br>  year=&#123;2001&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;morison2005census,<br>  title=&#123;A census of mammalian imprinting&#125;,<br>  author=&#123;Morison, Ian M and Ramsay, Joshua P and Spencer, Hamish G&#125;,<br>  journal=&#123;TRENDS in Genetics&#125;,<br>  volume=&#123;21&#125;,<br>  number=&#123;8&#125;,<br>  pages=&#123;457--465&#125;,<br>  year=&#123;2005&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;lau1994loss,<br>  title=&#123;Loss of the imprinted IGF2/cation-independent mannose 6-phosphate receptor results in fetal overgrowth and perinatal lethality.&#125;,<br>  author=&#123;Lau, MM and Stewart, CE and Liu, Ziying and Bhatt, Harshida and Rotwein, Peter and Stewart, Colin L&#125;,<br>  journal=&#123;Genes <span class="hljs-keyword">\&amp;</span> Development&#125;,<br>  volume=&#123;8&#125;,<br>  number=&#123;24&#125;,<br>  pages=&#123;2953--2963&#125;,<br>  year=&#123;1994&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;haig1989selective,<br>  title=&#123;Selective forces in the emergence of the seed habit&#125;,<br>  author=&#123;Haig, David and Westoby, Mark&#125;,<br>  journal=&#123;Biological Journal of the Linnean Society&#125;,<br>  volume=&#123;38&#125;,<br>  number=&#123;3&#125;,<br>  pages=&#123;215--238&#125;,<br>  year=&#123;1989&#125;,<br>  publisher=&#123;Oxford University Press&#125;<br>&#125;<br><br>@article&#123;moore1991genomic,<br>  title=&#123;Genomic imprinting in mammalian development: a parental tug-of-war&#125;,<br>  author=&#123;Moore, Tom and Haig, David&#125;,<br>  journal=&#123;Trends in genetics&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;45--49&#125;,<br>  year=&#123;1991&#125;,<br>  publisher=&#123;Elsevier Current Trends&#125;<br>&#125;<br><br>@article&#123;lefebvre1998abnormal,<br>  title=&#123;Abnormal maternal behaviour and growth retardation associated with loss of the imprinted gene Mest&#125;,<br>  author=&#123;Lefebvre, Louis and Viville, St&#123;<span class="hljs-keyword">\&#x27;</span>e&#125;phane and Barton, Sheila C and Ishino, Fumitoshi and Keverne, Eric B and Surani, M Azim&#125;,<br>  journal=&#123;Nature genetics&#125;,<br>  volume=&#123;20&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;163--169&#125;,<br>  year=&#123;1998&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;hamed2012cellular,<br>  title=&#123;Cellular functions of genetically imprinted genes in human and mouse as annotated in the gene ontology&#125;,<br>  author=&#123;Hamed, Mohamed and Ismael, Siba and Paulsen, Martina and Helms, Volkhard&#125;,<br>  journal=&#123;PloS one&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;11&#125;,<br>  pages=&#123;e50285&#125;,<br>  year=&#123;2012&#125;,<br>  publisher=&#123;Public Library of Science&#125;<br>&#125;<br><br>@article&#123;renfree2009evolution,<br>  title=&#123;Evolution of genomic imprinting: insights from marsupials and monotremes&#125;,<br>  author=&#123;Renfree, Marilyn B and Hore, Timothy A and Shaw, Geoffrey and Marshall Graves, Jennifer A and Pask, Andrew J&#125;,<br>  journal=&#123;Annual review of genomics and human genetics&#125;,<br>  volume=&#123;10&#125;,<br>  pages=&#123;241--262&#125;,<br>  year=&#123;2009&#125;,<br>  publisher=&#123;Annual Reviews&#125;<br>&#125;<br><br>@article&#123;moore1991genomic,<br>  title=&#123;Genomic imprinting in mammalian development: a parental tug-of-war&#125;,<br>  author=&#123;Moore, Tom and Haig, David&#125;,<br>  journal=&#123;Trends in genetics&#125;,<br>  volume=&#123;7&#125;,<br>  number=&#123;2&#125;,<br>  pages=&#123;45--49&#125;,<br>  year=&#123;1991&#125;,<br>  publisher=&#123;Elsevier Current Trends&#125;<br>&#125;<br><br>@article&#123;varmuza1994genomic,<br>  title=&#123;Genomic imprinting—defusing the ovarian time bomb&#125;,<br>  author=&#123;Varmuza, Sue and Mann, Mellissa&#125;,<br>  journal=&#123;Trends in Genetics&#125;,<br>  volume=&#123;10&#125;,<br>  number=&#123;4&#125;,<br>  pages=&#123;118--123&#125;,<br>  year=&#123;1994&#125;,<br>  publisher=&#123;Elsevier&#125;<br>&#125;<br><br>@article&#123;wilkins2003good,<br>  title=&#123;What good is genomic imprinting: the function of parent-specific gene expression&#125;,<br>  author=&#123;Wilkins, Jon F and Haig, David&#125;,<br>  journal=&#123;Nature Reviews Genetics&#125;,<br>  volume=&#123;4&#125;,<br>  number=&#123;5&#125;,<br>  pages=&#123;359--368&#125;,<br>  year=&#123;2003&#125;,<br>  publisher=&#123;Nature Publishing Group&#125;<br>&#125;<br><br>@article&#123;grossniklaus2014transcriptional,<br>  title=&#123;Transcriptional silencing by polycomb-group proteins&#125;,<br>  author=&#123;Grossniklaus, Ueli and Paro, Renato&#125;,<br>  journal=&#123;Cold Spring Harbor perspectives in biology&#125;,<br>  volume=&#123;6&#125;,<br>  number=&#123;11&#125;,<br>  pages=&#123;a019331&#125;,<br>  year=&#123;2014&#125;,<br>  publisher=&#123;Cold Spring Harbor Lab&#125;<br>&#125;<br><br>@article&#123;bartolomei1997genomic,<br>  title=&#123;Genomic imprinting in mammals&#125;,<br>  author=&#123;Bartolomei, Marisa S and Tilghman, Shirley M&#125;,<br>  journal=&#123;Annual review of genetics&#125;,<br>  volume=&#123;31&#125;,<br>  number=&#123;1&#125;,<br>  pages=&#123;493--525&#125;,<br>  year=&#123;1997&#125;,<br>  publisher=&#123;Annual Reviews 4139 El Camino Way, PO Box 10139, Palo Alto, CA 94303-0139, USA&#125;<br>&#125;<br><br><br><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BIOINFO EXPERIMENT RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRME</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021.1.19 python practice</title>
    <link href="/2021/01/19/20210119pythonpractice/"/>
    <url>/2021/01/19/20210119pythonpractice/</url>
    
    <content type="html"><![CDATA[<h1 id="python-practice"><a href="#python-practice" class="headerlink" title="python practice"></a>python practice</h1><p>python practice</p><p>python version: 2.7</p><p>tutorial: Python生物信息学数据管理</p><h2 id="lesson4"><a href="#lesson4" class="headerlink" title="lesson4"></a>lesson4</h2><h3 id="count"><a href="#count" class="headerlink" title="count"></a>count</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">seq =<span class="hljs-string">&#x27;&#x27;&#x27;MDDREDLVYQAKLAEQAERYDEMVESMKKVAGMDVELTVEERNLLSVAYKNVIGARRASW</span><br><span class="hljs-string">RIISSIEQKEENKGGEDKLKMIREYRQMVETELKLICCDILDVLDKHLIPAANTGESKVF</span><br><span class="hljs-string">YYKMKGDYHRYLAEFATGNDRKEAAENSLVAYKAASDIAMTELPPTHPIRLGLALNFSVF</span><br><span class="hljs-string">YYEILNSPDRACRLAKAAFDDAIAELDTLSEESYKDSTLIMQLLRDNLTLWTSDMQGDGE</span><br><span class="hljs-string">EQNKEALQDVEDENQ&#x27;&#x27;&#x27;</span><br>number = seq.count(<span class="hljs-string">&#x27;W&#x27;</span>)<br><span class="hljs-built_in">print</span> number<br></code></pre></td></tr></table></figure><h3 id="fasta-filter"><a href="#fasta-filter" class="headerlink" title="fasta filter"></a>fasta filter</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.2</span><br><span class="hljs-keyword">import</span> os<br>path_1= os.path.abspath(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;fasta_filter.fasta&#x27;</span>)<br>file_new = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">if</span> seq[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq.count(<span class="hljs-string">&#x27;W&#x27;</span>) &gt; <span class="hljs-number">1</span>:<br>            file_new.write(header + seq)<br>            seq = <span class="hljs-string">&#x27;&#x27;</span><br>            header = line<br><span class="hljs-keyword">if</span> seq[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq.count(<span class="hljs-string">&#x27;W&#x27;</span>) &gt;= <span class="hljs-number">2</span>:<br>    file_new.write(header + seq)<br>file_new.close()<br>file_read.close()<br></code></pre></td></tr></table></figure><h3 id="calculate-ratio"><a href="#calculate-ratio" class="headerlink" title="calculate ratio"></a>calculate ratio</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.3</span><br><span class="hljs-keyword">import</span> os<br>path = (os.path.abspath(<span class="hljs-string">&#x27;multiple_DNA.fasta&#x27;</span>))<br>file_read = <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        head = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = line + seq<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-built_in">print</span> head,a,g,c,t<br>        head = line<br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>    seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-built_in">print</span> head,a,g,c,t<br>file_read.close()<br></code></pre></td></tr></table></figure><h3 id="calculate-ratio-from-gb-file"><a href="#calculate-ratio-from-gb-file" class="headerlink" title="calculate ratio from gb file"></a>calculate ratio from gb file</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-comment">#homework for 4.5.5</span><br><span class="hljs-keyword">import</span> os<br>path = (<span class="hljs-string">&#x27;AY810830.GB&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_gb&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>] == <span class="hljs-string">&#x27;ACCESSION&#x27;</span>:<br>        AC = line.split()[<span class="hljs-number">1</span>].strip()<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;ORIGIN&#x27;</span>:<br>        flag = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> flag == <span class="hljs-number">1</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">if</span> fields != <span class="hljs-string">&#x27;&#x27;</span>:<br>            seq = <span class="hljs-string">&#x27;&#x27;</span>.join(fields[<span class="hljs-number">1</span>:])<br>            seq = seq.upper()<br>            file_write.write(seq)<br><br>file_read.close()<br>file_write.close()<br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test_gb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = file.read()<br>a = seq.count(<span class="hljs-string">&#x27;A&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>g = seq.count(<span class="hljs-string">&#x27;G&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>c = seq.count(<span class="hljs-string">&#x27;C&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br>t = seq.count(<span class="hljs-string">&#x27;T&#x27;</span>)/<span class="hljs-built_in">float</span>(<span class="hljs-built_in">len</span>(seq))<br><span class="hljs-built_in">print</span> a,g,c,t<br>    <br>file.close<br></code></pre></td></tr></table></figure><h3 id="read-ac-from-gb-file-and-write-into-fasta-file"><a href="#read-ac-from-gb-file-and-write-into-fasta-file" class="headerlink" title="read ac from gb.file and write into fasta.file"></a>read ac from gb.file and write into fasta.file</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#read ac from gb.file and write into fasta.file</span><br><span class="hljs-keyword">import</span> os<br>path_1 = os.path.abspath(<span class="hljs-string">&#x27;AY810830.gb&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;AY810830.fasta&#x27;</span>)<br>file_gb = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_fasta = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>flag = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_gb:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">9</span>] == <span class="hljs-string">&#x27;ACCESSION&#x27;</span>:<br>        AC = line.split()[<span class="hljs-number">1</span>].strip()<br>        file_fasta.write(<span class="hljs-string">&#x27;&gt;&#x27;</span>+<span class="hljs-string">&#x27;|&#x27;</span>+AC+<span class="hljs-string">&#x27;|&#x27;</span>+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;ORIGIN&#x27;</span>:<br>        flag = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> flag == <span class="hljs-number">1</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">if</span> fields != []:<br>            seq = <span class="hljs-string">&#x27;&#x27;</span>.join(fields[<span class="hljs-number">1</span>:])<br>            file_fasta.write(seq.upper()+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>            <span class="hljs-built_in">print</span> seq<br>file_gb.close()<br>file_fasta.close()<br></code></pre></td></tr></table></figure><h3 id="read-fasta-and-write-homo-sapien-to-a-new-fasta"><a href="#read-fasta-and-write-homo-sapien-to-a-new-fasta" class="headerlink" title="read fasta and write homo sapien to a new fasta"></a>read fasta and write homo sapien to a new fasta</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#read fasta and write homo sapien to a new fasta</span><br><span class="hljs-keyword">import</span> os<br>path_1 = os.path.abspath(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>)<br>path_2 = os.path.abspath(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path_1,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_write = <span class="hljs-built_in">open</span>(path_2,<span class="hljs-string">&#x27;w&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Homo sapiens&#x27;</span> <span class="hljs-keyword">in</span> header:<br>            file_write.write(header + seq)<br>            seq = <span class="hljs-string">&#x27;&#x27;</span><br>            header = line<br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">in</span> header:<br>    file_write.write(header + seq)<br>file_write.close()<br></code></pre></td></tr></table></figure><h3 id="save-multiple-fasta-from-fasta"><a href="#save-multiple-fasta-from-fasta" class="headerlink" title="save multiple fasta from fasta"></a>save multiple fasta from fasta</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#homework for 4.5.1</span><br><span class="hljs-keyword">import</span> os<br>path = os.path.abspath(<span class="hljs-string">&#x27;Swissprot.fasta&#x27;</span>)<br>file_read = <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;r&#x27;</span>)<br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = seq + line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        file_write = <span class="hljs-built_in">open</span>(<span class="hljs-built_in">str</span>(header.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]), <span class="hljs-string">&#x27;w&#x27;</span>)<br>        file_write.write(header + seq.upper())<br>        header = line<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> header:<br>    AC = header.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    file_write = <span class="hljs-built_in">open</span>(<span class="hljs-built_in">str</span>(AC), <span class="hljs-string">&#x27;w&#x27;</span>)<br>    file_write.write(header + seq.upper())<br>        <br>file_write.close()<br>file_read.close()<br></code></pre></td></tr></table></figure><h2 id="lesson5"><a href="#lesson5" class="headerlink" title="lesson5"></a>lesson5</h2><h3 id="4-5-1-dictionary"><a href="#4-5-1-dictionary" class="headerlink" title="4.5.1 dictionary"></a>4.5.1 dictionary</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">dic = &#123;<span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;START&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;Glycin&#x27;</span> &#125;<br><span class="hljs-built_in">print</span> dic.keys()<br><span class="hljs-built_in">print</span> dic.values()<br><span class="hljs-built_in">print</span> dic<br></code></pre></td></tr></table></figure><h3 id="4-5-2"><a href="#4-5-2" class="headerlink" title="4.5.2"></a>4.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br>number_start = <span class="hljs-number">0</span><br>number_stop = <span class="hljs-number">0</span><br>rna_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        rna_seq = rna_seq + line.strip()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(rna_seq), <span class="hljs-number">3</span>):<br>    codon = rna_seq[i:i+<span class="hljs-number">3</span>]<br>    <span class="hljs-keyword">if</span> codon == <span class="hljs-string">&#x27;AUG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;GUG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;AUA&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UUG&#x27;</span>:<br>        number_start = number_start + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span> codon == <span class="hljs-string">&#x27;UAG&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UGA&#x27;</span> <span class="hljs-keyword">or</span> codon == <span class="hljs-string">&#x27;UAA&#x27;</span>:<br>        number_stop = number_stop + <span class="hljs-number">1</span><br>    <br><span class="hljs-built_in">print</span> number_start,number_stop<br></code></pre></td></tr></table></figure><h3 id="4-5-2-2"><a href="#4-5-2-2" class="headerlink" title="4.5.2(2)"></a>4.5.2(2)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>text = <span class="hljs-string">&#x27;&#x27;</span><br>check = &#123;<span class="hljs-string">&#x27;(MMPs)&#x27;</span>:<span class="hljs-string">&#x27;(MMPs) found&#x27;</span>, <span class="hljs-string">&#x27;cells&#x27;</span>:<span class="hljs-string">&#x27;cells found&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;abstract.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    text += line<br>    columns = line.split()<br>    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> columns:<br>        <span class="hljs-keyword">if</span> word <span class="hljs-keyword">in</span> check:<br>            <span class="hljs-built_in">print</span> check[word]<br>      <br><span class="hljs-built_in">print</span> text<br></code></pre></td></tr></table></figure><h3 id="4-5-4"><a href="#4-5-4" class="headerlink" title="4.5.4"></a>4.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">aa_seq = <span class="hljs-string">&#x27;MVDREQLVQKARLAEQAERYDDMAAAMKNVTELNEPLSNEERNLLSVAYKNVVGARRSSW\</span><br><span class="hljs-string">RVISSIEQKTSADGNEKKIEMVRAYREKIEKELEAVCQDVLSLLDNYLIKNCSETQYESK\</span><br><span class="hljs-string">VFYLKMKGDYYRYLAEVATGEKRATVVESSEKAYSEAHEISKEHMQPTHPIRLGLALNYS\</span><br><span class="hljs-string">VFYYEIQNAPEQACHLAKTAFDDAIAELDTLNEDSYKDSTLIMQLLRDNLTLWTSDQQDD\</span><br><span class="hljs-string">DGGEGNN&#x27;</span><br><span class="hljs-built_in">print</span> aa_seq<br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>pref_E = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br>pref_H = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;0.97&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;1.30&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.80&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;0.26&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.28&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.81&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;0.71&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.60&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;0.74&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.22&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.67&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.62&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.63&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.90&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.72&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.19&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;1.29&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> aa_seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> pref_H <span class="hljs-keyword">and</span> res <span class="hljs-keyword">in</span> pref_E:<br>        <span class="hljs-keyword">if</span> pref_H[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_E[res] &lt; pref_H[res]:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;H&#x27;</span><br>        <span class="hljs-keyword">elif</span> pref_E[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_H[res] &lt; pref_E[res]:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;E&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            output_seq = output_seq + <span class="hljs-string">&#x27;L&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure><h3 id="4-5-5"><a href="#4-5-5" class="headerlink" title="4.5.5"></a>4.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python">seq = <span class="hljs-string">&#x27;MVDREQLVQKARLAEQAERYDDMAAAMKNVTELNEPLSNEERNLLSVAYKNVVGARRSSW\</span><br><span class="hljs-string">RVISSIEQKTSADGNEKKIEMVRAYREKIEKELEAVCQDVLSLLDNYLIKNCSETQYESK\</span><br><span class="hljs-string">VFYLKMKGDYYRYLAEVATGEKRATVVESSEKAYSEAHEISKEHMQPTHPIRLGLALNYS\</span><br><span class="hljs-string">VFYYEIQNAPEQACHLAKTAFDDAIAELDTLNEDSYKDSTLIMQLLRDNLTLWTSDQQDD\</span><br><span class="hljs-string">DGGEGNN&#x27;</span><br><br>aa_table = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br><br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> aa_table:<br>        <span class="hljs-keyword">if</span> aa_table[res] &gt; <span class="hljs-string">&#x27;1.00&#x27;</span>:<br>            output_seq += res.upper()<br>        <span class="hljs-keyword">else</span>:<br>            output_seq += res.lower()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br>        <span class="hljs-keyword">break</span><br>    <br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure><h3 id="find-“MMP”-and-“cell”-in-abstract"><a href="#find-“MMP”-and-“cell”-in-abstract" class="headerlink" title="find “MMP” and “cell” in abstract"></a>find “MMP” and “cell” in abstract</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>number_1 = <span class="hljs-number">0</span><br>number_2 = <span class="hljs-number">0</span><br>abstract = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;abstract.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    abstract = abstract + line.strip()<br><span class="hljs-built_in">print</span> abstract<br><br>number_1 = abstract.count(<span class="hljs-string">&#x27;MMPs&#x27;</span>)<br>number_2 = abstract.count(<span class="hljs-string">&#x27;cell&#x27;</span>)<br><br><span class="hljs-keyword">if</span> number_1 &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;MMPs found&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;MMPs not found&#x27;</span><br><span class="hljs-keyword">if</span> number_2 &gt; <span class="hljs-number">0</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;cell found&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;cell not found&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="protein-disorder-prediction"><a href="#protein-disorder-prediction" class="headerlink" title="protein disorder prediction"></a>protein disorder prediction</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>propensities = &#123;<br>   <span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-number">0.2299</span>, <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-number">0.5523</span>, <span class="hljs-string">&#x27;Q&#x27;</span>:-<span class="hljs-number">0.18770</span>, <span class="hljs-string">&#x27;A&#x27;</span>:-<span class="hljs-number">0.2615</span>,<br>   <span class="hljs-string">&#x27;R&#x27;</span>:-<span class="hljs-number">0.1766</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0.1429</span>, <span class="hljs-string">&#x27;C&#x27;</span>:-<span class="hljs-number">0.01515</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-number">0.0089</span>,<br>   <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">0.2276</span>, <span class="hljs-string">&#x27;E&#x27;</span>:-<span class="hljs-number">0.2047</span>, <span class="hljs-string">&#x27;V&#x27;</span>:-<span class="hljs-number">0.38620</span>, <span class="hljs-string">&#x27;F&#x27;</span>:-<span class="hljs-number">0.2256</span>,<br>   <span class="hljs-string">&#x27;W&#x27;</span>:-<span class="hljs-number">0.2434</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-number">0.4332</span>, <span class="hljs-string">&#x27;H&#x27;</span>:-<span class="hljs-number">0.00120</span>, <span class="hljs-string">&#x27;Y&#x27;</span>:-<span class="hljs-number">0.2075</span>,<br>   <span class="hljs-string">&#x27;I&#x27;</span>:-<span class="hljs-number">0.4222</span>, <span class="hljs-string">&#x27;K&#x27;</span>:-<span class="hljs-number">0.1001</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">0.33793</span>, <span class="hljs-string">&#x27;M&#x27;</span>:-<span class="hljs-number">0.2259</span><br>   &#125;<br>input_seq = <span class="hljs-string">&quot;IVGGYTCGANTVPYQVSLNSGYHFCGGSLINSQWVVSAAHCYKSG\</span><br><span class="hljs-string">IQVRLGEDNINVVEGNEQFISASKSIVHPSYNSNTLNNDIMLIKLKSAASLNSR\</span><br><span class="hljs-string">VASISLPTSCASAGTQCLISGWGNTKSSGTSYPDVLKCLKAPILSDSSCKSAYP\</span><br><span class="hljs-string">GQITSNMFCAGYLEGGKDSCQGDSGGPVVCSGKLQGIVSWGSGCAQKNKPGVYT\</span><br><span class="hljs-string">KVCNYVSWIKQTIASN&quot;</span><br>output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>threshod = <span class="hljs-number">0.3</span><br><span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>    <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> propensities:<br>        <span class="hljs-keyword">if</span> propensities[res] &gt;= threshod:<br>            output_seq = output_seq + res.upper()<br>        <span class="hljs-keyword">else</span>:<br>            output_seq = output_seq + res.lower()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized charachter:&#x27;</span> , res<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span> output_seq<br></code></pre></td></tr></table></figure><h3 id="read-from-a-pdb-file-and-write-into-a-amino-acid-form"><a href="#read-from-a-pdb-file-and-write-into-a-amino-acid-form" class="headerlink" title="read from a pdb file and write into a amino-acid form"></a>read from a pdb file and write into a amino-acid form</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>aa_codes = &#123;<br>     <span class="hljs-string">&#x27;ALA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CYS&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;ASP&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GLU&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br>     <span class="hljs-string">&#x27;PHE&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;GLY&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;HIS&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;LYS&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>     <span class="hljs-string">&#x27;ILE&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;LEU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;MET&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;ASN&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>     <span class="hljs-string">&#x27;PRO&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;GLN&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;ARG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;SER&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>     <span class="hljs-string">&#x27;THR&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;VAL&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;TYR&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;TRP&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>&#125;<br>aa_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-string">&#x27;SEQRES&#x27;</span>:<br>        fields = line.split()<br>        <span class="hljs-keyword">for</span> resname <span class="hljs-keyword">in</span> fields[<span class="hljs-number">4</span>:]:<br>           aa_seq = aa_seq + aa_codes[resname]<br>i = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;1TLD&#x27;</span><br><span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(aa_seq):<br>    <span class="hljs-built_in">print</span> aa_seq[i:i+<span class="hljs-number">48</span>]<br>    i = i+<span class="hljs-number">48</span><br></code></pre></td></tr></table></figure><h3 id="translate-RNA-into-amino-acid-input-is-RNA-seq"><a href="#translate-RNA-into-amino-acid-input-is-RNA-seq" class="headerlink" title="translate RNA into amino-acid (input is RNA-seq)"></a>translate RNA into amino-acid (input is RNA-seq)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br><br><span class="hljs-comment"># read the RNA sequence into a single string</span><br>rna = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>): <br>        rna = rna + line.strip()<br><br><span class="hljs-comment"># translate one frame at a time</span><br><span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    prot = <span class="hljs-string">&#x27;&#x27;</span> <br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Reading frame &#x27;</span> + <span class="hljs-built_in">str</span>(frame + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(frame, <span class="hljs-built_in">len</span>(rna), <span class="hljs-number">3</span>):<br>        codon = rna[i:i + <span class="hljs-number">3</span>]<br>        <span class="hljs-keyword">if</span> codon <span class="hljs-keyword">in</span> codon_table:<br>            <span class="hljs-keyword">if</span> codon_table[codon] == <span class="hljs-string">&#x27;STOP&#x27;</span>:<br>                prot = prot + <span class="hljs-string">&#x27;*&#x27;</span><br>            <span class="hljs-keyword">else</span>: <br>                prot = prot + codon_table[codon]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># handle too short codons</span><br>            prot = prot + <span class="hljs-string">&#x27;-&#x27;</span> <br><br>    <span class="hljs-comment"># format to blocks of 48 columns</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(prot):<br>        <span class="hljs-built_in">print</span> prot[i:i + <span class="hljs-number">48</span>]<br>        i = i + <span class="hljs-number">48</span><br></code></pre></td></tr></table></figure><h3 id="translate-RNA-into-amino-acid-input-is-RNA-file"><a href="#translate-RNA-into-amino-acid-input-is-RNA-file" class="headerlink" title="translate RNA into amino-acid (input is RNA-file)"></a>translate RNA into amino-acid (input is RNA-file)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#translate rna to amino_acid</span><br><span class="hljs-keyword">import</span> os<br>file_read = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;A06662-RNA.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>codon_table = &#123;<br>    <span class="hljs-string">&#x27;GCU&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCC&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;GCG&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CGU&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGC&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>,   <br>    <span class="hljs-string">&#x27;CGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;CGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGA&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;AGG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;UCU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>    <span class="hljs-string">&#x27;UCA&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;UCG&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGU&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AGC&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;AUU&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;AUC&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>,<br>    <span class="hljs-string">&#x27;AUA&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;UUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;UUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUC&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;CUA&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>,<br>    <span class="hljs-string">&#x27;CUG&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;GGU&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGC&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGA&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GGG&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;GUU&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>,<br>    <span class="hljs-string">&#x27;GUC&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUA&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;GUG&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;ACU&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACC&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;ACA&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>,<br>    <span class="hljs-string">&#x27;ACG&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;CCU&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCC&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCA&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;CCG&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;AAU&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAC&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>, <span class="hljs-string">&#x27;GAU&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GAC&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;UGU&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;UGC&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;CAA&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>,<br>    <span class="hljs-string">&#x27;CAG&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;GAA&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;GAG&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-string">&#x27;CAU&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;CAC&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;AAA&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>    <span class="hljs-string">&#x27;AAG&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>, <span class="hljs-string">&#x27;UUU&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UUC&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;UAU&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;UAC&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;AUG&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>,<br>    <span class="hljs-string">&#x27;UGG&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>,<br>    <span class="hljs-string">&#x27;UAG&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UGA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span>, <span class="hljs-string">&#x27;UAA&#x27;</span>:<span class="hljs-string">&#x27;STOP&#x27;</span><br>    &#125;<br>rna = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_read:<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>):<br>        rna = rna + line.strip()<br><span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    prot = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;read frame&#x27;</span> + <span class="hljs-built_in">str</span>(frame + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(frame, <span class="hljs-built_in">len</span>(rna), <span class="hljs-number">3</span>):<br>        codon = rna[i:i + <span class="hljs-number">3</span>]<br>        <span class="hljs-keyword">if</span> codon <span class="hljs-keyword">in</span> codon_table:<br>            <span class="hljs-keyword">if</span> codon_table[codon] == <span class="hljs-string">&#x27;STOP&#x27;</span>:<br>                prot = prot + <span class="hljs-string">&#x27;*&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                prot = prot + codon_table[codon]<br>        <span class="hljs-keyword">else</span>:<br>            prot = prot + <span class="hljs-string">&#x27;-&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(prot):<br>        <span class="hljs-built_in">print</span> prot[i:i + <span class="hljs-number">48</span>]<br>        i = i + <span class="hljs-number">48</span><br><br>file_read.close()<br></code></pre></td></tr></table></figure><h2 id="lesson6"><a href="#lesson6" class="headerlink" title="lesson6"></a>lesson6</h2><h3 id="6-5-1"><a href="#6-5-1" class="headerlink" title="6.5.1"></a>6.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new_swissprot.fasta&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>ac = <span class="hljs-string">&#x27;&#x27;</span><br>AC = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">and</span> ac == <span class="hljs-string">&#x27;&#x27;</span>:<br>        ac = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>].strip()<br>        <span class="hljs-built_in">print</span> ac<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">elif</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span> <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>        file_write.write(ac + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        ac = <span class="hljs-string">&#x27;&#x27;</span><br><br>file_write.close()<br></code></pre></td></tr></table></figure><h3 id="6-5-2"><a href="#6-5-2" class="headerlink" title="6.5.2"></a>6.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_write = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>index = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    index += <span class="hljs-number">1</span><br>    number = index%<span class="hljs-number">2</span><br>    <span class="hljs-keyword">if</span> number == <span class="hljs-number">0</span>:<br>        file_write.write(line)<br>        <span class="hljs-built_in">print</span> line<br>        <br>file_write.close()<br></code></pre></td></tr></table></figure><h3 id="6-5-3"><a href="#6-5-3" class="headerlink" title="6.5.3"></a>6.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>list_1 = []<br>list_2 = []<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_1:<br>    list_1.append(line)<br>    <br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_2:<br>    list_2.append(line)<br><br><br>set_1 = <span class="hljs-built_in">set</span>(list_1)<br>set_2 = <span class="hljs-built_in">set</span>(list_2)<br>dif = set_1.symmetric_difference(set_2)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&quot;dif&quot;</span>, <span class="hljs-built_in">list</span>(dif)<br></code></pre></td></tr></table></figure><h3 id="6-5-4"><a href="#6-5-4" class="headerlink" title="6.5.4"></a>6.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>file_1 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;SwissProt.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>file_2 = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;deleted_text.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>list_1 = []<br>list_2 = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_1:<br>    list_1.append(line)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file_2:<br>    list_2.append(line)<br><br>set_1 = <span class="hljs-built_in">set</span>(list_1)<br>set_2 = <span class="hljs-built_in">set</span>(list_2)<br>set_unique1 = set_1.difference(set_2)<br>set_unique2 = set_2.difference(set_1)<br>set_same1 = set_1.intersection(set_2)<br><br>write_1 = []<br>write_2 = []<br>write_3 = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_unique1:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&gt;&#x27;</span>:<br>        write_1.append(line.strip())<br><span class="hljs-built_in">print</span> write_1<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_unique2:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;&lt;&#x27;</span>:<br>        write_2.append(line.strip())<br><span class="hljs-built_in">print</span> write_2<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> set_same1:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;#&#x27;</span>:<br>        write_3.append(line.strip())<br><span class="hljs-built_in">print</span> write_3<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\n&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="6-5-5"><a href="#6-5-5" class="headerlink" title="6.5.5"></a>6.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>tracking = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts.tracking&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts_filtered.tracking&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> tracking:<br>    columns = track.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    wildtype = columns[<span class="hljs-number">4</span>:<span class="hljs-number">7</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    treatment = columns[<span class="hljs-number">7</span>:<span class="hljs-number">10</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    <span class="hljs-keyword">if</span> wildtype &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> treatment &lt; <span class="hljs-number">1</span>:<br>        output_file.write(track)<br>tracking.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="find-different-number-from-2-list"><a href="#find-different-number-from-2-list" class="headerlink" title="find different number from 2 list"></a>find different number from 2 list</h3><p>solution 1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>data_b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>]<br>data_a_not_b = []<br>data_b_not_a = []<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_a:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data_b:<br>        data_a_not_b.append(number)<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_b:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data_a:<br>        data_b_not_a.append(number)<br><span class="hljs-built_in">print</span> data_a_not_b, data_b_not_a<br></code></pre></td></tr></table></figure><p>solution 2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])<br>data_b = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>])d<br>data1 = data_a.difference(data_b)<br>data2 = data_b.difference(data_a)<br><span class="hljs-built_in">print</span> data1, data2<br></code></pre></td></tr></table></figure><h3 id="save-same-number-from-2-list"><a href="#save-same-number-from-2-list" class="headerlink" title="save same number from 2 list"></a>save same number from 2 list</h3><p>solution1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<br>data_b = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>]<br>data = []<br><span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> data_a:<br>    <span class="hljs-keyword">if</span> number <span class="hljs-keyword">in</span> data_b:<br>        data.append(number)<br><span class="hljs-built_in">print</span> data<br></code></pre></td></tr></table></figure><p>solution2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">data_a1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>])<br>data_b1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>])   <br>data_1 = data_a1.intersection(data_b1)<br><span class="hljs-built_in">print</span> data_1<br></code></pre></td></tr></table></figure><h3 id="remove-element-from-set"><a href="#remove-element-from-set" class="headerlink" title="remove element from set"></a>remove element from set</h3><p>remove function</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.remove(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure><p>pop function</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.pop()<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure><p>discard function</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = <span class="hljs-built_in">set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])<br>s1.discard(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span> s1<br></code></pre></td></tr></table></figure><h3 id="transcript-ilter"><a href="#transcript-ilter" class="headerlink" title="transcript ilter"></a>transcript ilter</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">fimport os<br>tracking = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;transcripts.tracking&#x27;</span>)<br>out_put = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> track <span class="hljs-keyword">in</span> tracking:<br>    columns = track.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    wildtype = columns[<span class="hljs-number">4</span>:<span class="hljs-number">7</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    treatment = columns[<span class="hljs-number">7</span>:<span class="hljs-number">10</span>].count(<span class="hljs-string">&#x27;-&#x27;</span>)<br>    <span class="hljs-keyword">if</span> wildtype &lt; <span class="hljs-number">2</span> <span class="hljs-keyword">and</span> treatment &lt; <span class="hljs-number">2</span>:<br>        out_put += track<br><span class="hljs-built_in">print</span> out_put<br></code></pre></td></tr></table></figure><h2 id="lesson7"><a href="#lesson7" class="headerlink" title="lesson7"></a>lesson7</h2><h3 id="turn-table-into-dict"><a href="#turn-table-into-dict" class="headerlink" title="turn table into dict"></a>turn table into dict</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>table = [[<span class="hljs-string">&#x27;protein&#x27;</span>,<span class="hljs-string">&#x27;ext1&#x27;</span>,<span class="hljs-string">&#x27;ext2&#x27;</span>,<span class="hljs-string">&#x27;ext3&#x27;</span>],<br>         [<span class="hljs-number">0.16</span>, <span class="hljs-number">0.038</span>, <span class="hljs-number">0.044</span>, <span class="hljs-number">0.040</span>],<br>         [<span class="hljs-number">0.33</span>, <span class="hljs-number">0.089</span>, <span class="hljs-number">0.095</span>, <span class="hljs-number">0.091</span>],<br>         [<span class="hljs-number">0.66</span>, <span class="hljs-number">0.184</span>, <span class="hljs-number">0.191</span>, <span class="hljs-number">0.191</span>],<br>         [<span class="hljs-number">1.00</span>, <span class="hljs-number">0.280</span>, <span class="hljs-number">0.292</span>, <span class="hljs-number">0.283</span>],<br>         [<span class="hljs-number">1.32</span>, <span class="hljs-number">0.365</span>, <span class="hljs-number">0.367</span>, <span class="hljs-number">0.365</span>],<br>         [<span class="hljs-number">1.66</span>, <span class="hljs-number">0.444</span>, <span class="hljs-number">0.441</span>, <span class="hljs-number">0.444</span>]]<br><span class="hljs-built_in">dict</span> = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    n = n + <span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">0</span>], key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">1</span>], key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">2</span>], key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">3</span>]&#125;<br>    <span class="hljs-built_in">dict</span>[<span class="hljs-string">&#x27;row&#x27;</span> + <span class="hljs-built_in">str</span>(n)] = entry<br><span class="hljs-built_in">print</span> <span class="hljs-built_in">dict</span><br>    <br><br>list_1 = []<br><span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> <span class="hljs-built_in">dict</span>:<br>    key = <span class="hljs-built_in">dict</span>[entry]<br>    list_1.append([key[<span class="hljs-string">&#x27;protein&#x27;</span>], key[<span class="hljs-string">&#x27;ext1&#x27;</span>], key[<span class="hljs-string">&#x27;ext2&#x27;</span>], key[<span class="hljs-string">&#x27;ext3&#x27;</span>]])<br><span class="hljs-built_in">print</span> list_1<br><br>out = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table:<br>    line = [<span class="hljs-built_in">str</span>(cell) <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> row]<br>    out = out + <span class="hljs-string">&#x27;\t&#x27;</span>.join(line) + <span class="hljs-string">&#x27;\n&#x27;</span><br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>).write(out)<br></code></pre></td></tr></table></figure><h3 id="7-5-1"><a href="#7-5-1" class="headerlink" title="7.5.1"></a>7.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> table<br><br>ext1 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext1.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">1</span>]))<br><br>ext2 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext2.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">2</span>]))<br><br>ext3 = []<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    ext3.append(<span class="hljs-built_in">float</span>(row[<span class="hljs-number">3</span>]))<br><br>ave1 = <span class="hljs-built_in">sum</span>(ext1)/<span class="hljs-built_in">len</span>(ext1)<br>ave2 = <span class="hljs-built_in">sum</span>(ext2)/<span class="hljs-built_in">len</span>(ext2)<br>ave3 = <span class="hljs-built_in">sum</span>(ext3)/<span class="hljs-built_in">len</span>(ext3)<br>ave_all = [<span class="hljs-string">&#x27;average&#x27;</span>, ave1, ave2, ave3]<br><br>table.insert(<span class="hljs-number">7</span>, ave_all)<br><span class="hljs-built_in">print</span> table<br></code></pre></td></tr></table></figure><h3 id="7-5-2"><a href="#7-5-2" class="headerlink" title="7.5.2"></a>7.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;table_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-built_in">dict</span> = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    n = n+<span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">0</span>], key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">1</span>], key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">2</span>], key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">3</span>]&#125;<br>    <span class="hljs-built_in">dict</span>[<span class="hljs-string">&#x27;row&#x27;</span>+<span class="hljs-built_in">str</span>(n)] = entry<br><br><span class="hljs-built_in">print</span> <span class="hljs-built_in">dict</span><br></code></pre></td></tr></table></figure><h3 id="7-5-3"><a href="#7-5-3" class="headerlink" title="7.5.3"></a>7.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>RNA_table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;RNA_table.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    RNA_table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><span class="hljs-built_in">print</span> RNA_table<br></code></pre></td></tr></table></figure><h3 id="7-5-4"><a href="#7-5-4" class="headerlink" title="7.5.4"></a>7.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>RNA_table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;RNA_table.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    RNA_table.append(line.strip().split(<span class="hljs-string">&#x27;\t&#x27;</span>))<br><br><span class="hljs-built_in">print</span> RNA_table<br><br>RNA_dic = &#123;&#125;<br>n = <span class="hljs-number">0</span><br>key = RNA_table[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> RNA_table[<span class="hljs-number">1</span>:]:<br>    n = n+<span class="hljs-number">1</span><br>    entry = &#123;key[<span class="hljs-number">0</span>]:row[<span class="hljs-number">1</span>],key[<span class="hljs-number">1</span>]:row[<span class="hljs-number">2</span>],key[<span class="hljs-number">2</span>]:row[<span class="hljs-number">3</span>],key[<span class="hljs-number">3</span>]:row[<span class="hljs-number">4</span>]&#125;<br>    RNA_dic[n] = entry<br><span class="hljs-built_in">print</span> RNA_dic<br>                    <br>seq1 = <span class="hljs-string">&#x27;AGCAUCUA&#x27;</span><br>seq2 = <span class="hljs-string">&#x27;ACCGUUCU&#x27;</span><br><br>seq_dic = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;U&#x27;</span>:<span class="hljs-string">&#x27;4&#x27;</span>&#125;<br><br>score = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> base1, base2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(seq1,seq2):<br>    entry = RNA_dic[<span class="hljs-built_in">float</span>(seq_dic[base1])]<br>    score = score + <span class="hljs-built_in">float</span>(entry[base2])<br><span class="hljs-built_in">print</span> score<br></code></pre></td></tr></table></figure><h3 id="7-5-5"><a href="#7-5-5" class="headerlink" title="7.5.5"></a>7.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>lowry_data = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lowry_data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    lowry_data.append(line.strip().split())<br><span class="hljs-built_in">print</span> lowry_data[<span class="hljs-number">1</span>]<br><br>    <br>lowry_table = lowry_data[<span class="hljs-number">1</span>:]<br>protein, ext1, ext2, ext3 = <span class="hljs-built_in">zip</span>(*lowry_table)<br>new_table = <span class="hljs-built_in">zip</span>(protein)<br><span class="hljs-keyword">for</span> prot <span class="hljs-keyword">in</span> new_table:<br>    <span class="hljs-built_in">print</span> prot<br><br>lowry_dic = &#123;&#125;<br>n = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> lowry_data[<span class="hljs-number">1</span>:]:<br>    key = &#123;<span class="hljs-string">&#x27;ext1&#x27;</span>:row[<span class="hljs-number">1</span>],<span class="hljs-string">&#x27;ext2&#x27;</span>:row[<span class="hljs-number">2</span>],<span class="hljs-string">&#x27;ext3&#x27;</span>:row[<span class="hljs-number">3</span>]&#125;<br>    lowry_dic[row[n]] = key<br><span class="hljs-built_in">print</span> lowry_dic<br>    <br>    <br><span class="hljs-built_in">print</span> lowry_dic[<span class="hljs-string">&#x27;0.16&#x27;</span>]    <br><br><span class="hljs-built_in">print</span> lowry_dic.keys()<br></code></pre></td></tr></table></figure><h2 id="lesson8"><a href="#lesson8" class="headerlink" title="lesson8"></a>lesson8</h2><h3 id="8-5-1"><a href="#8-5-1" class="headerlink" title="8.5.1"></a>8.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lowry_data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;new_lowry_data&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br>header = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>        columns = line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>        table.append(columns)<br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    columns = line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>    columns[<span class="hljs-number">1</span>] = <span class="hljs-built_in">float</span>(columns[<span class="hljs-number">1</span>])<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">1</span>))<br><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    <span class="hljs-keyword">if</span> i &lt; <span class="hljs-number">3</span>:<br>        row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>        output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        i = i+<span class="hljs-number">1</span><br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-2"><a href="#8-5-2" class="headerlink" title="8.5.2"></a>8.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_by_length_Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br>length = <span class="hljs-number">0</span><br>header = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        length = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line.strip()<br>        length += <span class="hljs-built_in">len</span>(line)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        row = [header, seq, length]<br>        table.append(row)<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> header != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    row = [header, seq, length]<br>    table.append(row)<br><br><br><span class="hljs-built_in">print</span> table<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table:<br>    row[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(row[<span class="hljs-number">2</span>])<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">2</span>))<br><br>output_file.write(<span class="hljs-string">&#x27;Gene ID&#x27;</span> +<span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;sequence&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;seq length&#x27;</span> + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>output_file.close()<br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-3"><a href="#8-5-3" class="headerlink" title="8.5.3"></a>8.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;excel_file.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_excel_file.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    row = line.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    table.append(row)<br><span class="hljs-built_in">print</span> table<br><br>table_new = []<br><span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> table[<span class="hljs-number">1</span>:]:<br>    col[<span class="hljs-number">3</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">3</span>])<br>    col[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">2</span>])<br>    col[<span class="hljs-number">1</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">1</span>])<br>    col[<span class="hljs-number">0</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">0</span>])<br>    table_new.append(col)<br>table_new_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>))<br><br><span class="hljs-built_in">print</span> table_new_sorted<br><br>output_file.write(<span class="hljs-string">&#x27;protein&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;ext1&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-string">&#x27;ext2&#x27;</span> + <span class="hljs-string">&#x27;\t&#x27;</span> +<span class="hljs-string">&#x27;ext3&#x27;</span> + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_new_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-4"><a href="#8-5-4" class="headerlink" title="8.5.4"></a>8.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>dic = &#123;&#125;<br>header = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header == <span class="hljs-string">&#x27;&#x27;</span>:<br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> header != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line.strip()<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        dic[header] = seq<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>        header = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br><span class="hljs-keyword">if</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    dic[header] = seq<br><br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(dic):<br>    <span class="hljs-built_in">print</span> key, dic[key]<br><br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="8-5-5"><a href="#8-5-5" class="headerlink" title="8.5.5"></a>8.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;BlastOut.csv&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;sorted_blastout.csv&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    col = line.split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>    col[<span class="hljs-number">2</span>] = <span class="hljs-built_in">float</span>(col[<span class="hljs-number">2</span>])<br>    table.append(col)<br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(<span class="hljs-number">2</span>),reverse = <span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br>    output_file.write(<span class="hljs-string">&#x27;\t&#x27;</span>.join(row) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>input_file.close()<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="sort-table"><a href="#sort-table" class="headerlink" title="sort table"></a>sort table</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> itemgetter<br>table = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;random_distribution.tsv&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    columns = line.split()<br>    columns = [<span class="hljs-built_in">float</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> columns]<br>    table.append(columns)<br><br>column = <span class="hljs-number">1</span><br>table_sorted = <span class="hljs-built_in">sorted</span>(table, key = itemgetter(column))<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> table_sorted:<br>    row = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> row]<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\t&#x27;</span>.join(row)<br></code></pre></td></tr></table></figure><h2 id="lesson9"><a href="#lesson9" class="headerlink" title="lesson9"></a>lesson9</h2><h3 id="9-5-1"><a href="#9-5-1" class="headerlink" title="9.5.1"></a>9.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>pro_seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    pro_seq += line<br><span class="hljs-keyword">for</span> base <span class="hljs-keyword">in</span> pro_seq:<br>    motif = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;C(.&#123;1,4&#125;)C&#x27;</span>)<br>    all_matches = motif.findall(pro_seq)<br>    matches = motif.finditer(pro_seq)<br><span class="hljs-keyword">if</span> all_matches:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;motif matched:&#x27;</span><br>    <span class="hljs-keyword">for</span> motif <span class="hljs-keyword">in</span> matches:<br>        <span class="hljs-built_in">print</span> motif.group()<br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="9-5-2"><a href="#9-5-2" class="headerlink" title="9.5.2"></a>9.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;multiple abstracts.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>text = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    text += line<br>word1 = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;[Ii][Nn]&#x27;</span>)<br>word2 = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;[In][Ss]&#x27;</span>)<br><br><br>word1_matches = word1.findall(text)<br>word2_matches = word2.findall(text)<br><br>number1 = <span class="hljs-number">0</span><br>number2 = <span class="hljs-number">0</span><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;in:&#x27;</span>,<span class="hljs-built_in">len</span>(word1_matches)<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;is&#x27;</span>,<span class="hljs-built_in">len</span>(word2_matches)<br><br>input_file.close()<br></code></pre></td></tr></table></figure><h3 id="9-5-3"><a href="#9-5-3" class="headerlink" title="9.5.3"></a>9.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br>input_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>header = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br>Homo_kinase_seq = <span class="hljs-string">&#x27;&#x27;</span><br>motif = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;R.[ST][^P]&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> input_file:<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;kinase&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq = line<br>        Homo_kinase_seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>        Homo_kinase_seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;Homo sapien&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;kinase&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line:<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq == <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><br>motif_match = motif.findall(Homo_kinase_seq)<br><span class="hljs-built_in">print</span> motif_match<br></code></pre></td></tr></table></figure><h3 id="9-5-4"><a href="#9-5-4" class="headerlink" title="9.5.4"></a>9.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br><br>url = <span class="hljs-string">&#x27;https://pubmed.ncbi.nlm.nih.gov/18235848/&#x27;</span><br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><br><br>author_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;data-ga-label=&quot;(.&#123;10,40&#125;)&lt;&#x27;</span>)<br>author_text = author_regexp.finditer(html)<br><br><br><span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> author_text:<br>    <span class="hljs-built_in">print</span> name.group(<span class="hljs-number">1</span>)<br>    <span class="hljs-built_in">print</span> name.start()<br>    <span class="hljs-built_in">print</span> name.end()<br></code></pre></td></tr></table></figure><h3 id="find-TFBS-matches-in-genome"><a href="#find-TFBS-matches-in-genome" class="headerlink" title="find TFBS matches in genome"></a>find TFBS matches in genome</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br>genome_seq = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;genome.txt&#x27;</span>).read()<br>sites = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;TFBS.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    fields = line.split()<br>    site = fields[<span class="hljs-number">1</span>]<br>    tf = fields[<span class="hljs-number">0</span>]<br>    sites.append((tf,site))<br><br><span class="hljs-keyword">for</span> tf,site <span class="hljs-keyword">in</span> sites:<br>    tfsite = re.<span class="hljs-built_in">compile</span>(site)<br>    all_matches = tfsite.findall(genome_seq)<br>    matches = tfsite.finditer(genome_seq)<br>    <span class="hljs-keyword">if</span> all_matches:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;tf&#x27;</span>,<span class="hljs-string">&#x27;:&#x27;</span><br>        <span class="hljs-keyword">for</span> tfbs <span class="hljs-keyword">in</span> matches:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;\t&#x27;</span>,tfbs.group(),tfbs.start(),tfbs.end()<br></code></pre></td></tr></table></figure><h3 id="read-html"><a href="#read-html" class="headerlink" title="read html"></a>read html</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br>pmid = <span class="hljs-string">&#x27;18235848&#x27;</span><br>url = <span class="hljs-string">&#x27;http://www.ncbi.nlm.nih.gov/pubmed?term=%s&#x27;</span> % pmid<br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><span class="hljs-built_in">print</span> html<br>title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>title_text = title_regexp.search(html)<br>abstract_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&quot;S.&#123;20,3000&#125;\.&quot;&#x27;</span>)<br>abstract_text = abstract_regexp.search(html)<br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;ABSTRACT:&#x27;</span>, abstract_text.group()<br></code></pre></td></tr></table></figure><h3 id="read-multiple-html"><a href="#read-multiple-html" class="headerlink" title="read multiple html"></a>read multiple html</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br>pmid = [<span class="hljs-string">&#x27;18235848&#x27;</span>,<span class="hljs-string">&#x27;22607149&#x27;</span>,<span class="hljs-string">&#x27;2405002&#x27;</span>,<span class="hljs-string">&#x27;21630672&#x27;</span>]<br><span class="hljs-keyword">for</span> pmid <span class="hljs-keyword">in</span> pmid:<br>    url = <span class="hljs-string">&#x27;http://www.ncbi.nlm.nih.gov/pubmed?term=%s&#x27;</span> % pmid<br>    <span class="hljs-keyword">import</span> ssl<br>    ssl._create_default_https_context = ssl._create_unverified_context<br>    handler = urllib2.urlopen(url)<br>    html = handler.read()<br>    title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>    title_text = title_regexp.search(html)<br>    abstract_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&quot;S.&#123;20,3000&#125;\.&quot;&#x27;</span>)<br>    abstract_text = abstract_regexp.search(html)<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;ABSTRACT:&#x27;</span>, abstract_text.group()<br></code></pre></td></tr></table></figure><h3 id="read-title-from-AO3-html"><a href="#read-title-from-AO3-html" class="headerlink" title="read title from AO3 html"></a>read title from AO3 html</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib2<br><span class="hljs-keyword">import</span> re<br><br><br>url = <span class="hljs-string">&#x27;https://archiveofourown.org/works/7289389&#x27;</span><br><span class="hljs-keyword">import</span> ssl<br>ssl._create_default_https_context = ssl._create_unverified_context<br>handler = urllib2.urlopen(url)<br>html = handler.read()<br><span class="hljs-built_in">print</span> html<br>title_regexp = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;&lt;title&gt;.&#123;5,400&#125;&lt;/title&gt;&#x27;</span>)<br>title_text = title_regexp.search(html)<br><br><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;TITLE:&#x27;</span>, title_text.group()<br></code></pre></td></tr></table></figure><h2 id="lesson10"><a href="#lesson10" class="headerlink" title="lesson10"></a>lesson10</h2><h3 id="10-5-1"><a href="#10-5-1" class="headerlink" title="10.5.1"></a>10.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> struct<br><br>seq = []<br>header = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">turn_pdb_to_fasta</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read a pdb file and turn to fasta file&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">global</span> header,seq<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(pdb_file):<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;DBREF&#x27;</span>):<br>            header = line.split()[<span class="hljs-number">6</span>]<br>        <span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;SEQRES&#x27;</span>):<br>            seq.append(line.split()[<span class="hljs-number">4</span>:])<br>    <span class="hljs-keyword">return</span> header, seq<br><br><br>header, seq = turn_pdb_to_fasta(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>)<br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&#x27;&gt;&#x27;</span> + header + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>proseq = <span class="hljs-string">&#x27;&#x27;</span><br>aa_codes = &#123;<br>     <span class="hljs-string">&#x27;ALA&#x27;</span>:<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;CYS&#x27;</span>:<span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;ASP&#x27;</span>:<span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;GLU&#x27;</span>:<span class="hljs-string">&#x27;E&#x27;</span>,<br>     <span class="hljs-string">&#x27;PHE&#x27;</span>:<span class="hljs-string">&#x27;F&#x27;</span>, <span class="hljs-string">&#x27;GLY&#x27;</span>:<span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;HIS&#x27;</span>:<span class="hljs-string">&#x27;H&#x27;</span>, <span class="hljs-string">&#x27;LYS&#x27;</span>:<span class="hljs-string">&#x27;K&#x27;</span>,<br>     <span class="hljs-string">&#x27;ILE&#x27;</span>:<span class="hljs-string">&#x27;I&#x27;</span>, <span class="hljs-string">&#x27;LEU&#x27;</span>:<span class="hljs-string">&#x27;L&#x27;</span>, <span class="hljs-string">&#x27;MET&#x27;</span>:<span class="hljs-string">&#x27;M&#x27;</span>, <span class="hljs-string">&#x27;ASN&#x27;</span>:<span class="hljs-string">&#x27;N&#x27;</span>,<br>     <span class="hljs-string">&#x27;PRO&#x27;</span>:<span class="hljs-string">&#x27;P&#x27;</span>, <span class="hljs-string">&#x27;GLN&#x27;</span>:<span class="hljs-string">&#x27;Q&#x27;</span>, <span class="hljs-string">&#x27;ARG&#x27;</span>:<span class="hljs-string">&#x27;R&#x27;</span>, <span class="hljs-string">&#x27;SER&#x27;</span>:<span class="hljs-string">&#x27;S&#x27;</span>,<br>     <span class="hljs-string">&#x27;THR&#x27;</span>:<span class="hljs-string">&#x27;T&#x27;</span>, <span class="hljs-string">&#x27;VAL&#x27;</span>:<span class="hljs-string">&#x27;V&#x27;</span>, <span class="hljs-string">&#x27;TYR&#x27;</span>:<span class="hljs-string">&#x27;Y&#x27;</span>, <span class="hljs-string">&#x27;TRP&#x27;</span>:<span class="hljs-string">&#x27;W&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> seq:<br>    <span class="hljs-keyword">for</span> aa <span class="hljs-keyword">in</span> row:<br>        aa_name = aa_codes[aa]<br>        proseq += aa_name<br><span class="hljs-built_in">print</span> proseq<br></code></pre></td></tr></table></figure><h3 id="10-5-2"><a href="#10-5-2" class="headerlink" title="10.5.2"></a>10.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> save_multiple_fasta_from_fasta <span class="hljs-keyword">import</span> save_ac_and_seq_from_fasta<br>AC = <span class="hljs-string">&#x27;&#x27;</span><br>seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;Homo_sapien.fasta&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>):<br>    <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>) <span class="hljs-keyword">and</span> AC == <span class="hljs-string">&#x27;&#x27;</span>:<br>        AC = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;&gt;&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> AC != <span class="hljs-string">&#x27;&#x27;</span>:<br>        seq += line<br>    <span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;&gt;&#x27;</span>) <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>        save_ac_and_seq_from_fasta(AC, seq)<br>        AC = line.split(<span class="hljs-string">&#x27;|&#x27;</span>)[<span class="hljs-number">1</span>]<br>        seq = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">if</span> AC != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&#x27;&#x27;</span>:<br>    save_ac_and_seq_from_fasta(AC, seq)<br></code></pre></td></tr></table></figure><h3 id="10-5-3"><a href="#10-5-3" class="headerlink" title="10.5.3"></a>10.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> calculate_atom_distance <span class="hljs-keyword">import</span> calculate_distance<br><span class="hljs-keyword">from</span> get_main_residues_from_1TLD_pdb <span class="hljs-keyword">import</span> parse_atom_line<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_3_result.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_ca_atoms</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;get all ca atom data from pdb&#x27;&#x27;&#x27;</span><br>    pdb = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>    ca_list = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> pdb:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;ATOM&#x27;</span>):<br>            data = parse_atom_line(line)<br>            chain, res_type, res_num, atom, x, y, z = data<br>            <span class="hljs-keyword">if</span> atom == <span class="hljs-string">&#x27;CA&#x27;</span> <span class="hljs-keyword">and</span> chain == <span class="hljs-string">&#x27;A&#x27;</span>:<br>                ca_list.append(data)<br>    pdb.close()<br>    <span class="hljs-keyword">return</span> ca_list<br><br>ca_atoms = get_ca_atoms(<span class="hljs-string">&#x27;1TLD.pdb&#x27;</span>)<br><span class="hljs-keyword">for</span> i, atom1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ca_atoms):<br>    name1 = atom1[<span class="hljs-number">1</span>] + atom1[<span class="hljs-number">2</span>]<br>    coord1 = atom1[<span class="hljs-number">4</span>:]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(ca_atoms)):<br>        atom2 = ca_atoms[j]<br>        name2 = atom2[<span class="hljs-number">1</span>] + atom2[<span class="hljs-number">2</span>]<br>        coord2 = atom2[<span class="hljs-number">4</span>:]<br>        dist = calculate_distance(coord1, coord2)<br>        output_file.write(name1 + <span class="hljs-string">&#x27;\t&#x27;</span> + name2 + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-built_in">str</span>(dist) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output_file.close()<br>            <br><span class="hljs-built_in">input</span> = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_3_result.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>)<br>all_distance = []<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>:<br>    distance = <span class="hljs-built_in">float</span>(line.split(<span class="hljs-string">&#x27;\t&#x27;</span>)[<span class="hljs-number">2</span>])<br>    all_distance.append(distance)<br><br><span class="hljs-built_in">min</span>(all_distance)<br></code></pre></td></tr></table></figure><h3 id="10-5-4"><a href="#10-5-4" class="headerlink" title="10.5.4"></a>10.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> calculate_atom_distance <span class="hljs-keyword">import</span> calculate_distance<br><span class="hljs-keyword">from</span> get_main_residues_from_1TLD_pdb <span class="hljs-keyword">import</span> parse_atom_line<br>output_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;10_5_4_result.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_ca_atoms</span>(<span class="hljs-params">pdb_file</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;get all ca atom data from pdb&#x27;&#x27;&#x27;</span><br>    pdb = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;3G5U.pdb&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>    list_A = []<br>    list_B = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> pdb:<br>        <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;ATOM&#x27;</span>):<br>            data = parse_atom_line(line)<br>            chain, res_type, res_num, atom, x, y, z = data<br>            <span class="hljs-keyword">if</span> chain == <span class="hljs-string">&#x27;A&#x27;</span>:<br>                list_A.append(data)<br>            <span class="hljs-keyword">elif</span> chain == <span class="hljs-string">&#x27;B&#x27;</span>:<br>                list_B.append(data)<br>                <br>    pdb.close()<br>    <span class="hljs-keyword">return</span> list_A, list_B<br><br>A_atoms, B_atoms = get_ca_atoms(<span class="hljs-string">&#x27;3G5U.pdb&#x27;</span>)<br><span class="hljs-keyword">for</span> i, atom1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(A_atoms):<br>    name1 = atom1[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;\t&#x27;</span> + atom1[<span class="hljs-number">1</span>] + atom1[<span class="hljs-number">2</span>]<br>    coord1 = atom1[<span class="hljs-number">4</span>:]<br>    <span class="hljs-keyword">for</span> j, atom2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(B_atoms):<br>        atom2 = B_atoms[j]<br>        name2 = atom1[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;\t&#x27;</span> + atom2[<span class="hljs-number">1</span>] + atom2[<span class="hljs-number">2</span>]<br>        coord2 = atom2[<span class="hljs-number">4</span>:]<br>        dist = calculate_distance(coord1, coord2)<br>        <span class="hljs-keyword">if</span> dist &lt; <span class="hljs-number">6</span>:<br>            output_file.write(name1 + <span class="hljs-string">&#x27;\t&#x27;</span> + name2 + <span class="hljs-string">&#x27;\t&#x27;</span> + <span class="hljs-built_in">str</span>(dist) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>output_file.close()<br></code></pre></td></tr></table></figure><h3 id="10-5-5"><a href="#10-5-5" class="headerlink" title="10.5.5"></a>10.5.5</h3><p>protein_accessibility_prediction.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">accessibility</span>(<span class="hljs-params">input_seq</span>):</span><br>    output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>    pref_E = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;1.45&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;0.77&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.98&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;1.53&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.12&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.53&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;1.24&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.00&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;1.07&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.34&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.73&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.59&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.17&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.79&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;0.82&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.14&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;0.61&#x27;</span>&#125;<br>    pref_H = &#123;<span class="hljs-string">&#x27;A&#x27;</span>:<span class="hljs-string">&#x27;0.97&#x27;</span>,<span class="hljs-string">&#x27;C&#x27;</span>:<span class="hljs-string">&#x27;1.30&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>:<span class="hljs-string">&#x27;0.80&#x27;</span>,<span class="hljs-string">&#x27;E&#x27;</span>:<span class="hljs-string">&#x27;0.26&#x27;</span>,<span class="hljs-string">&#x27;F&#x27;</span>:<span class="hljs-string">&#x27;1.28&#x27;</span>,<span class="hljs-string">&#x27;G&#x27;</span>:<span class="hljs-string">&#x27;0.81&#x27;</span>,<br>          <span class="hljs-string">&#x27;H&#x27;</span>:<span class="hljs-string">&#x27;0.71&#x27;</span>,<span class="hljs-string">&#x27;I&#x27;</span>:<span class="hljs-string">&#x27;1.60&#x27;</span>,<span class="hljs-string">&#x27;K&#x27;</span>:<span class="hljs-string">&#x27;0.74&#x27;</span>,<span class="hljs-string">&#x27;L&#x27;</span>:<span class="hljs-string">&#x27;1.22&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>:<span class="hljs-string">&#x27;1.67&#x27;</span>,<span class="hljs-string">&#x27;N&#x27;</span>:<span class="hljs-string">&#x27;0.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;P&#x27;</span>:<span class="hljs-string">&#x27;0.62&#x27;</span>,<span class="hljs-string">&#x27;Q&#x27;</span>:<span class="hljs-string">&#x27;1.63&#x27;</span>,<span class="hljs-string">&#x27;R&#x27;</span>:<span class="hljs-string">&#x27;0.90&#x27;</span>,<span class="hljs-string">&#x27;S&#x27;</span>:<span class="hljs-string">&#x27;0.72&#x27;</span>,<span class="hljs-string">&#x27;T&#x27;</span>:<span class="hljs-string">&#x27;1.20&#x27;</span>,<span class="hljs-string">&#x27;V&#x27;</span>:<span class="hljs-string">&#x27;1.65&#x27;</span>,<br>          <span class="hljs-string">&#x27;W&#x27;</span>:<span class="hljs-string">&#x27;1.19&#x27;</span>,<span class="hljs-string">&#x27;Y&#x27;</span>:<span class="hljs-string">&#x27;1.29&#x27;</span>&#125;<br>    <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>        <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> pref_H <span class="hljs-keyword">and</span> res <span class="hljs-keyword">in</span> pref_E:<br>            <span class="hljs-keyword">if</span> pref_H[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_E[res] &lt; pref_H[res]:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;H&#x27;</span><br>            <span class="hljs-keyword">elif</span> pref_E[res] &gt;= <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> pref_H[res] &lt; pref_E[res]:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;E&#x27;</span><br>            <span class="hljs-keyword">else</span>:<br>                output_seq = output_seq + <span class="hljs-string">&#x27;L&#x27;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized character&#x27;</span>, res<br>    <span class="hljs-keyword">return</span> output_seq<br></code></pre></td></tr></table></figure><p>protein_disorder_predict.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">protein_disorder_predict</span>(<span class="hljs-params">input_seq</span>):</span><br>    propensities = &#123;<span class="hljs-string">&#x27;N&#x27;</span>: <span class="hljs-number">0.2299</span>, <span class="hljs-string">&#x27;P&#x27;</span>: <span class="hljs-number">0.5523</span>, <span class="hljs-string">&#x27;Q&#x27;</span>:-<span class="hljs-number">0.18770</span>, <span class="hljs-string">&#x27;A&#x27;</span>:-<span class="hljs-number">0.2615</span>,<br>    <span class="hljs-string">&#x27;R&#x27;</span>:-<span class="hljs-number">0.1766</span>, <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-number">0.1429</span>, <span class="hljs-string">&#x27;C&#x27;</span>:-<span class="hljs-number">0.01515</span>, <span class="hljs-string">&#x27;T&#x27;</span>: <span class="hljs-number">0.0089</span>,<br>    <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">0.2276</span>, <span class="hljs-string">&#x27;E&#x27;</span>:-<span class="hljs-number">0.2047</span>, <span class="hljs-string">&#x27;V&#x27;</span>:-<span class="hljs-number">0.38620</span>, <span class="hljs-string">&#x27;F&#x27;</span>:-<span class="hljs-number">0.2256</span>,<br>    <span class="hljs-string">&#x27;W&#x27;</span>:-<span class="hljs-number">0.2434</span>, <span class="hljs-string">&#x27;G&#x27;</span>: <span class="hljs-number">0.4332</span>, <span class="hljs-string">&#x27;H&#x27;</span>:-<span class="hljs-number">0.00120</span>, <span class="hljs-string">&#x27;Y&#x27;</span>:-<span class="hljs-number">0.2075</span>,<br>    <span class="hljs-string">&#x27;I&#x27;</span>:-<span class="hljs-number">0.4222</span>, <span class="hljs-string">&#x27;K&#x27;</span>:-<span class="hljs-number">0.1001</span>, <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">0.33793</span>, <span class="hljs-string">&#x27;M&#x27;</span>:-<span class="hljs-number">0.2259</span>&#125;<br>    output_seq = <span class="hljs-string">&#x27;&#x27;</span><br>    threshod = <span class="hljs-number">0.3</span><br>    <span class="hljs-keyword">for</span> res <span class="hljs-keyword">in</span> input_seq:<br>        <span class="hljs-keyword">if</span> res <span class="hljs-keyword">in</span> propensities:<br>            <span class="hljs-keyword">if</span> propensities[res] &gt;= threshod:<br>                output_seq = output_seq + res.upper()<br>            <span class="hljs-keyword">else</span>:<br>                output_seq = output_seq + res.lower()<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;unrecognized charachter:&#x27;</span> , res<br>    <span class="hljs-keyword">return</span> output_seq<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> protein_disorder_predict <span class="hljs-keyword">import</span> protein_disorder_predict<br><span class="hljs-keyword">from</span> protein_accessibility_predict <span class="hljs-keyword">import</span> accessibility<br><br>input_seq = <span class="hljs-string">&#x27;MTMDKSELVQKAKLAEQAERYDDMAAAMKAVTEQGHELSNEERNLLSVAYKNVVGARRSS\</span><br><span class="hljs-string">WRVISSIEQKTERNEKKQQMGKEYREKIEAELQDICNDVLELLDKYLIPNATQPESKVFY\</span><br><span class="hljs-string">LKMKGDYFRYLSEVASGDNKQTTVSNSQQAYQEAFEISKKEMQPTHPIRLGLALNFSVFY\</span><br><span class="hljs-string">YEILNSPEKACSLAKTAFDEAIAELDTLNEESYKDSTLIMQLLRDNLTLWTSENQGDEGD\</span><br><span class="hljs-string">AGEGEN&#x27;</span><br><br>predictor = <span class="hljs-string">&#x27;2&#x27;</span><br><span class="hljs-keyword">if</span> predictor == <span class="hljs-string">&#x27;1&#x27;</span>:<br>    prediction = protein_disorder_predict(input_seq)<br>    <span class="hljs-built_in">print</span> prediction<br><span class="hljs-keyword">elif</span> predictor == <span class="hljs-string">&#x27;2&#x27;</span>:<br>    prediction = accessibility(input_seq)<br>    <span class="hljs-built_in">print</span> prediction<br></code></pre></td></tr></table></figure><h2 id="lesson11"><a href="#lesson11" class="headerlink" title="lesson11"></a>lesson11</h2><h3 id="11-5-1-11-5-2"><a href="#11-5-1-11-5-2" class="headerlink" title="11.5.1+11.5.2"></a>11.5.1+11.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + self.get_PDB_code() + self.get_angle1() + self.get_angle2()<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure><h3 id="11-5-3"><a href="#11-5-3" class="headerlink" title="11.5.3"></a>11.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + <span class="hljs-string">&#x27;\t&#x27;</span> +\<br>               self.get_PDB_code() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle1() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle2()<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure><h3 id="11-5-4-module"><a href="#11-5-4-module" class="headerlink" title="11.5.4_module"></a>11.5.4_module</h3><p>TRANSMEMBRANE_HELICES</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">transmembrane_helices</span>:</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, protein</span>):</span><br>        self.protein = protein<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_protein_name</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Potassium channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Chloride channal&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_PDB_code</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ljvm&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lmsl&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;lkpl&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle1</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;354.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;359.2&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;361.3&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_angle2</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">if</span> self.protein == <span class="hljs-string">&quot;Potassium channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;351.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;345.7&quot;</span><br>        <span class="hljs-keyword">elif</span> self.protein == <span class="hljs-string">&quot;Chloride channal&quot;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;344.6&quot;</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> self.get_protein_name() + <span class="hljs-string">&#x27;\t&#x27;</span> +\<br>               self.get_PDB_code() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle1() +<span class="hljs-string">&#x27;\t&#x27;</span>+\<br>               self.get_angle2()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> TRANSMEMBRANE_HELICES <span class="hljs-keyword">import</span> transmembrane_helices<br><br>protein1 = transmembrane_helices(<span class="hljs-string">&quot;Potassium channal&quot;</span>)<br>protein2 = transmembrane_helices(<span class="hljs-string">&quot;Mechanosensitivity channal&quot;</span>)<br>protein3 = transmembrane_helices(<span class="hljs-string">&quot;Chloride channal&quot;</span>)<br><br><span class="hljs-built_in">print</span> protein1<br><span class="hljs-built_in">print</span> protein2<br><span class="hljs-built_in">print</span> protein3<br></code></pre></td></tr></table></figure><h3 id="11-5-5"><a href="#11-5-5" class="headerlink" title="11.5.5"></a>11.5.5</h3><p>neurons</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">neuron_data = []<br><span class="hljs-keyword">import</span> math<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DentriticLengths</span>:</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, filename</span>):</span><br>        self.filename = filename<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_data</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        <span class="hljs-keyword">return</span> neuron_data<br>        <br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_average</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        average = <span class="hljs-built_in">sum</span>(neuron_data)/<span class="hljs-built_in">len</span>(neuron_data)<br>        <span class="hljs-keyword">return</span> average<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_sttddev</span>(<span class="hljs-params">self</span>):</span><br>        square = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(self.filename):<br>            neuron_data.append(<span class="hljs-built_in">float</span>(line))<br>        average = <span class="hljs-built_in">sum</span>(neuron_data)/<span class="hljs-built_in">len</span>(neuron_data)<br>        <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_data:<br>            n = length - average<br>            square += n**<span class="hljs-number">2</span><br>        sttddev = math.sqrt(square / <span class="hljs-built_in">len</span>(neuron_data))<br>        <span class="hljs-keyword">return</span> sttddev<br><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(neuron_data), <span class="hljs-built_in">str</span>(self.get_average()), <span class="hljs-built_in">str</span>(self.get_sttddev())<br><br><br>n = DentriticLengths(<span class="hljs-string">&quot;neuron_data.txt&quot;</span>)<br><span class="hljs-built_in">print</span> n.get_data()<br><span class="hljs-built_in">print</span> n.get_average()<br><span class="hljs-built_in">print</span> n.get_sttddev()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> neurons <span class="hljs-keyword">import</span> DentriticLengths<br><br>n = Dentriticlengths(<span class="hljs-string">&quot;neuron_data.txt&quot;</span>)<br><span class="hljs-built_in">print</span> n<br></code></pre></td></tr></table></figure><h2 id="lesson12"><a href="#lesson12" class="headerlink" title="lesson12"></a>lesson12</h2><h3 id="12-5-1"><a href="#12-5-1" class="headerlink" title="12.5.1"></a>12.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = bigger + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondary = [], []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span>:<br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br>primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.txt&#x27;</span>)<br>count_pri = evaluate_data(primary)<br>count_sec = evaluate_data(secondary)<br>write_output(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br></code></pre></td></tr></table></figure><h3 id="12-5-2"><a href="#12-5-2" class="headerlink" title="12.5.2"></a>12.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = bigger + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondary = [], []<br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span>:<br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br><span class="hljs-keyword">try</span>:<br>    primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.xls&#x27;</span>)<br>    count_pri = evaluate_data(primary)<br>    count_sec = evaluate_data(secondary)<br>    write_output(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br><span class="hljs-keyword">except</span> IOError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;You have input a wrong file name&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure><h3 id="12-5-3"><a href="#12-5-3" class="headerlink" title="12.5.3"></a>12.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_input_file</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read input file and turn it to data&#x27;&#x27;&#x27;</span><br>    neuron_length = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        length = <span class="hljs-built_in">float</span>(line.split()[<span class="hljs-number">1</span>])<br>        neuron_length.append(length)<br>    <span class="hljs-keyword">return</span> neuron_length<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br><span class="hljs-keyword">try</span>:<br>    filename = <span class="hljs-string">&quot;12_5_3_test.txt&quot;</span><br>    neuron_length = read_input_file(filename)<br>    <span class="hljs-built_in">print</span> calculate_average(neuron_length)<br>    <span class="hljs-built_in">print</span> calculate_stdev(neuron_length)<br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;could not convert string to float: -&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure><h3 id="12-5-4"><a href="#12-5-4" class="headerlink" title="12.5.4"></a>12.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> math<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_input_file</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;read input file and turn it to data&#x27;&#x27;&#x27;</span><br>    neuron_length = []<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>            <span class="hljs-keyword">try</span>:<br>                length = <span class="hljs-built_in">float</span>(line.split()[<span class="hljs-number">1</span>])<br>                neuron_length.append(length)<br>            <span class="hljs-keyword">except</span> ValueError:<br>                <span class="hljs-built_in">print</span> <span class="hljs-string">&quot; - can not be transformed into float&quot;</span><br>                <span class="hljs-keyword">raise</span> SystemExit       <br>        <span class="hljs-keyword">return</span> neuron_length<br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;could not convert string to float: -&quot;</span><br>        <span class="hljs-keyword">raise</span> SystemExit<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(neuron_length)/<span class="hljs-built_in">len</span>(neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br><br>filename = <span class="hljs-string">&quot;12_5_3_test.txt&quot;</span><br>neuron_length = read_input_file(filename)<br><span class="hljs-built_in">print</span> calculate_average(neuron_length)<br><span class="hljs-built_in">print</span> calculate_stdev(neuron_length)<br></code></pre></td></tr></table></figure><h3 id="12-5-5"><a href="#12-5-5" class="headerlink" title="12.5.5"></a>12.5.5</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> math<br>        <br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_average</span>(<span class="hljs-params">float_neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate average of neuron length&#x27;&#x27;&#x27;</span><br>    average = <span class="hljs-built_in">sum</span>(float_neuron_length)/<span class="hljs-built_in">len</span>(float_neuron_length)<br>    <span class="hljs-keyword">return</span> average<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculate_stdev</span>(<span class="hljs-params">float_neuron_length</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;calculate sttdev of neuron length&#x27;&#x27;&#x27;</span><br>    square = <span class="hljs-number">0</span><br>    average = <span class="hljs-built_in">sum</span>(float_neuron_length)/<span class="hljs-built_in">len</span>(float_neuron_length)<br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> float_neuron_length:<br>        square += (length - average)**<span class="hljs-number">2</span><br>    stdev = math.sqrt(square/<span class="hljs-built_in">len</span>(float_neuron_length))<br>    <span class="hljs-keyword">return</span> stdev<br><br>raw_neuron_length = []<br>float_neuron_length = []<br>number = <span class="hljs-literal">None</span><br><span class="hljs-keyword">while</span> number != <span class="hljs-string">&#x27;q&#x27;</span>:<br>    number = raw_input(<span class="hljs-string">&quot;Insert a number: &quot;</span>)<br>    raw_neuron_length.append(number)<br><span class="hljs-built_in">print</span> raw_neuron_length<br><span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> raw_neuron_length:<br>    <span class="hljs-keyword">if</span> length != <span class="hljs-string">&#x27;q&#x27;</span>:<br>        float_neuron_length.append(<span class="hljs-built_in">float</span>(length))<br><span class="hljs-built_in">print</span> float_neuron_length<br>   <br><span class="hljs-built_in">print</span> calculate_average(float_neuron_length)<br><span class="hljs-built_in">print</span> calculate_stdev(float_neuron_length)<br></code></pre></td></tr></table></figure><h3 id="handling-exceptions"><a href="#handling-exceptions" class="headerlink" title="handling exceptions"></a>handling exceptions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Catching errors with try.. except</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.3.3 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">try</span>:<br>    a = <span class="hljs-built_in">float</span>(raw_input(<span class="hljs-string">&quot;Insert a number:&quot;</span>))<br>    <span class="hljs-built_in">print</span> a<br><span class="hljs-keyword">except</span> ValueError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;You haven&#x27;t inserted a number. Please retry.&quot;</span><br>    <span class="hljs-keyword">raise</span> SystemExit<br></code></pre></td></tr></table></figure><h3 id="handling-exceptions-else"><a href="#handling-exceptions-else" class="headerlink" title="handling exceptions else"></a>handling exceptions else</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Catching errors with try.. except.. else</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.3.3 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">try</span>:<br>    filename = raw_input(<span class="hljs-string">&quot;Insert a filename:&quot;</span>)<br>    in_file = <span class="hljs-built_in">open</span>(filename)<br><span class="hljs-keyword">except</span> IOError:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;The filename %s has not been found.&quot;</span> % filename<br>    <span class="hljs-keyword">raise</span> SystemExit<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> in_file:<br>        <span class="hljs-built_in">print</span> line<br>        in_file.close()<br></code></pre></td></tr></table></figure><h3 id="programs-with-bugs"><a href="#programs-with-bugs" class="headerlink" title="programs with bugs"></a>programs with bugs</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">A program with bugs. Try to fix them all!</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 12.2.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">evaluate_data</span>(<span class="hljs-params">data, lower=<span class="hljs-number">100</span>, upper=<span class="hljs-number">300</span></span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Counts data points in three bins.&quot;&quot;&quot;</span><br>    smaller = <span class="hljs-number">0</span><br>    between = <span class="hljs-number">0</span><br>    bigger  = <span class="hljs-number">0</span><br>    <br>    <span class="hljs-keyword">for</span> length <span class="hljs-keyword">in</span> data:<br>        <span class="hljs-keyword">if</span> length &lt; lower:<br>            smaller = smaller + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> lower &lt; length &lt; upper:<br>            between = between + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> length &gt; upper:<br>            bigger = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> smaller, between, bigger<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_data</span>(<span class="hljs-params">filename</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span><br>    primary, secondry = [], []<br><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(filename):<br>        category, length = line.split(<span class="hljs-string">&quot;\t&quot;</span>)<br>        length = <span class="hljs-built_in">float</span>(length)<br>        <span class="hljs-keyword">if</span> category == <span class="hljs-string">&quot;Primary&quot;</span><br>            primary.append(length)<br>        <span class="hljs-keyword">elif</span> category == <span class="hljs-string">&quot;Secondary&quot;</span>:<br>            secondary.append(length)<br>    <span class="hljs-keyword">return</span> primary, secondary<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write_output</span>(<span class="hljs-params">filename, count_pri, count_sec</span>):</span><br>    <span class="hljs-string">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span><br>    output = <span class="hljs-built_in">open</span>(filename,<span class="hljs-string">&quot;w&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;category      &lt;100  100-300   &gt;300\n&quot;</span>)<br>    output.write(<span class="hljs-string">&quot;Primary  :  %5i   %5i   %5i\n&quot;</span> % count_pri)<br>    output.write(<span class="hljs-string">&quot;Secondary:  %5i   %5i   %5i\n&quot;</span> % count_sec)<br>    output.close()<br><br>primary, secondary = read_data(<span class="hljs-string">&#x27;neuron_data.xls&#x27;</span>)<br>count_pri = evaluate_data(primary)<br>count_sec = evaluate_data(secondary)<br>write_output_file(<span class="hljs-string">&#x27;results.txt&#x27;</span> , count_pri,count_sec)<br></code></pre></td></tr></table></figure><h2 id="lesson13"><a href="#lesson13" class="headerlink" title="lesson13"></a>lesson13</h2><h3 id="13-5-1"><a href="#13-5-1" class="headerlink" title="13.5.1"></a>13.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rpy2.robjects <span class="hljs-keyword">as</span> robjects<br>r = robjects.r<br>table = r(<span class="hljs-string">&quot;read.table(&#x27;data_for_practice_1.txt&#x27;, sep = &#x27;\t&#x27;)&quot;</span>)<br>m = r.mean(table[<span class="hljs-number">1</span>], trim = <span class="hljs-number">0</span>, na_rm = <span class="hljs-string">&#x27;FALSE&#x27;</span>)<br>sdev = r.sd(table[<span class="hljs-number">1</span>])<br>value = <span class="hljs-number">0.01844</span><br>zscore = (m[<span class="hljs-number">0</span>] - value)/sdev[<span class="hljs-number">0</span>]<br>x = r.<span class="hljs-built_in">abs</span>(zscore)<br>pvalue = r.pnorm(-x[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span> m[<span class="hljs-number">0</span>], sdev[<span class="hljs-number">0</span>], zscore, pvalue[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><h3 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-built_in">print</span> sys.argv<br></code></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rpy2.robjects <span class="hljs-keyword">as</span> robjects<br>r = robjects.r<br>table = r(<span class="hljs-string">&quot;read.table(&#x27;Chi-square_input.txt&#x27;,header = TRUE, sep = &#x27;\t&#x27;)&quot;</span>)<br>cont_table = r.table(table[<span class="hljs-number">1</span>],table[<span class="hljs-number">2</span>])<br>chitest = r(<span class="hljs-string">&#x27;chisq.test&#x27;</span>)<br><span class="hljs-built_in">print</span> chitest(table[<span class="hljs-number">1</span>],table[<span class="hljs-number">2</span>])<br></code></pre></td></tr></table></figure><h3 id="os-listdir-test"><a href="#os-listdir-test" class="headerlink" title="os_listdir_test"></a>os_listdir_test</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> os.listdir(<span class="hljs-string">&#x27;/Users/keqinliu/studying document/bioinfo/python/practice/chapter13-practice&#x27;</span>):<br>    os.system(<span class="hljs-string">&#x27;&lt;my_program&gt;%s&#x27;</span>%(filename))<br></code></pre></td></tr></table></figure><h2 id="lesson14"><a href="#lesson14" class="headerlink" title="lesson14"></a>lesson14</h2><h3 id="14-5-4"><a href="#14-5-4" class="headerlink" title="14.5.4"></a>14.5.4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>dir_list = os.listdir(<span class="hljs-string">&#x27;/Users/keqinliu/studying_document/bioinfo/python_practice/chapter14-practice/&#x27;</span>)<br><span class="hljs-built_in">print</span> dir_list<br>dir_count = <span class="hljs-built_in">len</span>(dir_list)<br><span class="hljs-built_in">print</span> dir_count<br></code></pre></td></tr></table></figure><h3 id="avoid-file-closing-lag"><a href="#avoid-file-closing-lag" class="headerlink" title="avoid_file_closing_lag"></a>avoid_file_closing_lag</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Avoid the lag when applications share files.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 14.3.5 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br>sys.path.append(<span class="hljs-string">&#x27;/home/RNA-seq/&#x27;</span>)<br><span class="hljs-keyword">from</span> pathvariables <span class="hljs-keyword">import</span> tophat_dir, index_dir, cufflinks_dir<br><br><span class="hljs-comment"># the tophat program creates a file </span><br>os.system(<span class="hljs-string">&#x27;tophat -o &#x27;</span> + tophat_dir + <span class="hljs-string">&#x27; &#x27;</span> + index_dir + <span class="hljs-string">&#x27;sample.fastq&#x27;</span>)<br><br><span class="hljs-comment"># here we don&#x27;t know whether the tophat output file is already finished</span><br><span class="hljs-comment"># we open and close a dummy file, so the operating system catches up</span><br>lag_file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;dummy.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>lag_file.write(<span class="hljs-string">&#x27;tophat completed&#x27;</span>)<br>lag_file.close()<br><br><span class="hljs-comment"># read the output file</span><br><span class="hljs-keyword">if</span> os.path.exists(<span class="hljs-string">&#x27;/home/RNA-seq/dummy.txt&#x27;</span>):<br>    os.system(<span class="hljs-string">&#x27;cufflinks -o &#x27;</span> + cufflinks_dir + <span class="hljs-string">&#x27; &#x27;</span><br>              + tophat_dir + <span class="hljs-string">&#x27;/accepted_hits.bam&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="bl2seq-wrapper"><a href="#bl2seq-wrapper" class="headerlink" title="bl2seq_wrapper"></a>bl2seq_wrapper</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Python wrapper for the bl2seq program.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 15.4.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> urllib2<br><br>sys.path.append(<span class="hljs-string">&#x27;pathmodules/&#x27;</span>)<br><span class="hljs-keyword">from</span> blastvariables <span class="hljs-keyword">import</span> *<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_bl2seq</span>(<span class="hljs-params">seq1, seq2</span>):</span><br>    os.system(<span class="hljs-string">&quot;bl2seq -p blastp -i &quot;</span> + input_seq + seq1 + <span class="hljs-string">&quot;.fasta -j &quot;</span><br>              + input_seq + seq2 + <span class="hljs-string">&quot;.fasta -o &quot;</span> + blast_out + seq1<br>              + <span class="hljs-string">&quot;-&quot;</span> + seq2 + <span class="hljs-string">&quot;.aln&quot;</span>)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_seq</span>(<span class="hljs-params">seq1, seq2</span>):</span><br>    <span class="hljs-keyword">for</span> seq <span class="hljs-keyword">in</span> (seq1, seq2):<br>        url = <span class="hljs-string">&#x27;http://www.uniprot.org/uniprot/&#x27;</span> + seq + <span class="hljs-string">&#x27;.fasta&#x27;</span><br>        handler = urllib2.urlopen(url)<br>        fasta = handler.read()<br>        out = <span class="hljs-built_in">open</span>(input_seq + seq + <span class="hljs-string">&#x27;.fasta&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>        out.write(fasta)<br>        out.close()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-keyword">try</span>:<br>        seq1 = sys.argv[<span class="hljs-number">1</span>]<br>        seq2 = sys.argv[<span class="hljs-number">2</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;usage: Bl2seqWrapper.py seq1-UniprotAC seq2-UniprotAC&#x27;</span><br>        <span class="hljs-keyword">raise</span> SystemExit<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> os.path.exists(input_seq + seq1 + <span class="hljs-string">&#x27;.fasta&#x27;</span>) <span class="hljs-keyword">and</span> os.path.exists(input_seq + seq2 + <span class="hljs-string">&#x27;.fasta&#x27;</span>):<br>            run_bl2seq(seq1, seq2)<br>        <span class="hljs-keyword">else</span>:<br>            get_seq(seq1, seq2)<br>            run_bl2seq(seq1, seq2)<br></code></pre></td></tr></table></figure><h3 id="cuffcompare-pipeline"><a href="#cuffcompare-pipeline" class="headerlink" title="cuffcompare_pipeline"></a>cuffcompare_pipeline</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">Run two external programs from one Python script.</span><br><span class="hljs-string"></span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">(c) 2013 Allegra Via and Kristian Rother</span><br><span class="hljs-string">    Licensed under the conditions of the Python License</span><br><span class="hljs-string"></span><br><span class="hljs-string">    This code appears in section 14.2.2 of the book</span><br><span class="hljs-string">    &quot;Managing Biological Data with Python&quot;.</span><br><span class="hljs-string">-----------------------------------------------------------</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-comment"># THIS CODE HAS NOT BEEN TESTED BEFORE SUBMISSION</span><br><br><span class="hljs-keyword">import</span> os<br><br>tophat_output_dir = <span class="hljs-string">&#x27;/home/RNA-seq/tophat&#x27;</span><br>tophat_output_file = <span class="hljs-string">&#x27;accepted_hits.bam&#x27;</span><br>bowtie_index_dir = <span class="hljs-string">&#x27;/home/RNA-seq/index&#x27;</span><br>cufflinks_output_dir = <span class="hljs-string">&#x27;/home/RNA-seq/cufflinks&#x27;</span><br>cufflinks_output_file = <span class="hljs-string">&#x27;transcripts.gtf&#x27;</span><br>illumina_output_file = <span class="hljs-string">&#x27;sample.fastq&#x27;</span><br><br>tophat_command = <span class="hljs-string">&#x27;tophat -o %s %s %s&#x27;</span> % (tophat_output_dir, bowtie_index_dir, illumina_output_file)<br>os.system(tophat_command)<br><br>cufflinks_command = <span class="hljs-string">&#x27;cufflinks -o %s %s%s%s&#x27;</span> % (cufflinks_output_dir, tophat_output_dir, os.sep, tophat_output_file)<br>os.system(cufflinks_command)<br></code></pre></td></tr></table></figure><h2 id="lesson16"><a href="#lesson16" class="headerlink" title="lesson16"></a>lesson16</h2><h3 id="16-2"><a href="#16-2" class="headerlink" title="16.2"></a>16.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> pie, title, figure, savefig<br>nucleotides = <span class="hljs-string">&#x27;G&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;U&#x27;</span><br>count = [<span class="hljs-number">1024</span>, <span class="hljs-number">759</span>, <span class="hljs-number">606</span>, <span class="hljs-number">398</span>]<br>explode = [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.05</span>, <span class="hljs-number">0.05</span>]<br><br>colors = [<span class="hljs-string">&#x27;#f0f0f0&#x27;</span>, <span class="hljs-string">&#x27;#dddddd&#x27;</span>, <span class="hljs-string">&#x27;#bbbbbb&#x27;</span>, <span class="hljs-string">&#x27;#999999&#x27;</span>]<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_percent</span>(<span class="hljs-params">value</span>):</span><br>    <span class="hljs-string">&#x27;&#x27;&#x27;FORMATS FLOAT VALUES IN PIE SLICES TO PERCENT&#x27;&#x27;&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;%4.1f%%&quot;</span> % (value)<br><br>figure(<span class="hljs-number">1</span>)<br>title(<span class="hljs-string">&#x27;Nucleotides in 23s RNA from T.thermophilus&#x27;</span>)<br>pie(count, explode=explode, labels=nucleotides, shadow=<span class="hljs-literal">None</span>, colors=colors, autopct=get_percent)<br>savefig(<span class="hljs-string">&#x27;figure3&#x27;</span>, dpi=<span class="hljs-number">300</span>)<br></code></pre></td></tr></table></figure><h3 id="16-3-1"><a href="#16-3-1" class="headerlink" title="16.3.1"></a>16.3.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, plot, savefig<br>xdata = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>ydata = [<span class="hljs-number">1.25</span>, <span class="hljs-number">2.33</span>, <span class="hljs-number">4.3</span>, <span class="hljs-number">9.00</span>]<br>figure()<br>plot(xdata, ydata)<br>savefig(<span class="hljs-string">&#x27;figure1.png&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="16-4-1"><a href="#16-4-1" class="headerlink" title="16.4.1"></a>16.4.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, plot, text, axis, savefig, title<br><span class="hljs-keyword">import</span> math<br><br>figure()<br>xdata = [<span class="hljs-number">0.1</span> * i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)]<br>ydata = [math.sin(y) <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> xdata]<br><br>plot(xdata, ydata, <span class="hljs-string">&#x27;kd&#x27;</span>, linewidth = <span class="hljs-number">1</span>)<br>axis([<span class="hljs-number">0</span>, <span class="hljs-number">3</span> * math.pi, -<span class="hljs-number">1.2</span>, <span class="hljs-number">1.2</span>])<br>title(<span class="hljs-string">&#x27;y=sin(x)&#x27;</span>)<br>savefig(<span class="hljs-string">&#x27;figure2.png&#x27;</span>, dpi = <span class="hljs-number">300</span>) <br></code></pre></td></tr></table></figure><h3 id="16-5-1"><a href="#16-5-1" class="headerlink" title="16.5.1"></a>16.5.1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, title, xlabel, ylabel, yticks, barh, axis, savefig<br>length = [<span class="hljs-number">16.38</span><br>, <span class="hljs-number">139.90</span><br>, <span class="hljs-number">441.46</span><br>, <span class="hljs-number">29.03</span><br>, <span class="hljs-number">40.93</span><br>, <span class="hljs-number">202.07</span><br>, <span class="hljs-number">142.30</span><br>, <span class="hljs-number">346.00</span><br>, <span class="hljs-number">300.00</span>]<br>neuron = [<span class="hljs-string">&quot;neuron1&quot;</span>,<span class="hljs-string">&quot;neuron2&quot;</span>,<span class="hljs-string">&quot;neuron3&quot;</span>,<span class="hljs-string">&quot;neuron4&quot;</span>,<span class="hljs-string">&quot;neuron5&quot;</span>,<span class="hljs-string">&quot;neuron6&quot;</span>,<span class="hljs-string">&quot;neuron7&quot;</span>\<br>          ,<span class="hljs-string">&quot;neuron8&quot;</span>,<span class="hljs-string">&quot;neuron9&quot;</span>]<br><br>figure()<br>title(<span class="hljs-string">&quot;Lengths of neoron&quot;</span>)<br>xlabel(<span class="hljs-string">&quot;length&quot;</span>)<br>ylabel(<span class="hljs-string">&quot;neuron&quot;</span>)<br>barh(neuron, length)<br><br>savefig(<span class="hljs-string">&quot;16.5.1.png&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="16-5-2"><a href="#16-5-2" class="headerlink" title="16.5.2"></a>16.5.2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> title, xlabel, ylabel, figure, plot, savefig, errorbar, xticks<br>figure()<br><br>t_data = [<span class="hljs-number">606</span>, <span class="hljs-number">759</span>, <span class="hljs-number">1024</span>, <span class="hljs-number">398</span>]<br>x1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>err1 = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>errorbar(x1, t_data, err1, fmt=<span class="hljs-string">&quot;ro&quot;</span>)<br>e_data = [<span class="hljs-number">762</span>, <span class="hljs-number">639</span>, <span class="hljs-number">912</span>, <span class="hljs-number">591</span>]<br>x2 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>err2 = [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>errorbar(x2, e_data, err2, fmt=<span class="hljs-string">&quot;rs&quot;</span>)<br><br><br>ylabel(<span class="hljs-string">&quot;Ratio of base count&quot;</span>)<br>xlabel(<span class="hljs-string">&quot;Base&quot;</span>)<br>xticks(x1, (<span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;U&quot;</span>))<br>title(<span class="hljs-string">&quot;T.thermophiles / E.coli&quot;</span>)<br>savefig(<span class="hljs-string">&quot;16.5.2.png&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="16-5-3"><a href="#16-5-3" class="headerlink" title="16.5.3"></a>16.5.3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> pylab <span class="hljs-keyword">import</span> figure, title, xlabel, ylabel, hist, axis, grid, savefig<br>seqlength = []<br>seq = <span class="hljs-string">&quot;&quot;</span><br>title = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;SwissProt.fasta&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> title == <span class="hljs-string">&quot;&quot;</span>:<br>        title = line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> title != <span class="hljs-string">&quot;&quot;</span>:<br>        seq += line<br>    <span class="hljs-keyword">elif</span> <span class="hljs-string">&quot;&gt;&quot;</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">and</span> seq != <span class="hljs-string">&quot;&quot;</span>:<br>        length = <span class="hljs-built_in">len</span>(seq)<br>        seqlength.append(length)<br>        seq = <span class="hljs-string">&quot;&quot;</span><br>        title = line<br>length = <span class="hljs-built_in">len</span>(seq)<br>seqlength.append(length)<br><br><span class="hljs-built_in">print</span> seqlength<br>        <br>n_bin = <span class="hljs-number">2</span><br>figure()<br>num, bins, patches = hist(seqlength, n_bin, density = <span class="hljs-number">1.0</span>, histtype = <span class="hljs-string">&quot;bar&quot;</span>, \<br>                          facecolor = <span class="hljs-string">&quot;green&quot;</span>, alpha = <span class="hljs-number">0.7</span>,rwidth = <span class="hljs-number">0.85</span>)<br><br>xlabel(<span class="hljs-string">&quot;seqlength&quot;</span>)<br>ylabel(<span class="hljs-string">&quot;frequence&quot;</span>)<br>axis()<br>grid(<span class="hljs-literal">True</span>)<br>savefig(<span class="hljs-string">&quot;16.5.3.png&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="draw-comparison-of-test-and-train-accuracy"><a href="#draw-comparison-of-test-and-train-accuracy" class="headerlink" title="draw comparison of test and train accuracy"></a>draw comparison of test and train accuracy</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#use n_neighbors as independent variable,</span><br><span class="hljs-comment">#get comparison of train_data accuracy and test_data accuracy</span><br><span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier<br><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_breast_cancer<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>cancer = load_breast_cancer()<br>X_train, X_test, y_train, y_test = train_test_split(cancer.data, cancer.target,<br>                                                    stratify=cancer.target,<br>                                                    random_state = <span class="hljs-number">66</span> )<br>training_accuracy=[]<br>test_accuracy=[]<br>neighbors_setting=<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">11</span>)<br><br><span class="hljs-keyword">for</span> n_neighbors <span class="hljs-keyword">in</span> neighbors_setting:<br>    clf = KNeighborsClassifier(n_neighbors = n_neighbors)<br>    clf.fit(X_train, y_train)<br>    training_accuracy.append(clf.score(X_train, y_train))<br>    test_accuracy.append(clf.score(X_test, y_test))<br><br>plt.plot(neighbors_setting, training_accuracy, label=<span class="hljs-string">&quot;training_accuracy&quot;</span>)<br>plt.plot(neighbors_setting, test_accuracy, label=<span class="hljs-string">&quot;test_accuracy&quot;</span>)<br>plt.ylabel(<span class="hljs-string">&quot;accuracy&quot;</span>)<br>plt.xlabel(<span class="hljs-string">&quot;n_neighbors&quot;</span>)<br>plt.legend()<br>plt.show()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LEARNING RECORDS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PYTHON</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
